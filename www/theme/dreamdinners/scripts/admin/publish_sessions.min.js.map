{"version":3,"names":["admin_publish_sessions_init","getNewItemsInSelection","items_string","form","document","getElementById","startElem","startDate","value","startCell","endElem","endDate","endCell","alert","isSafari","ci","i","parentNode","cells","length","startCol","cellIndex","startRow","rowIndex","endCol","endRow","y","tempStartCol","tempEndCol","x","thisCell","calendarName","rows","images","getElementsByTagName","item","id","name","substr","serializeNewSessions","item_ids","hiliteIcon","index","img","src","PATH","image_admin","unHiliteIcon","onSetFillWindowStart","selectedCell","getAttribute","endID","endTD","operation","submit","onSetFillWindowEnd","startID","startTD","onClearFillWindow","onEditClick","window","location","onSessionClick","saveItems","style","display","publishItems","onDeleteClick","obj","theSpan","theCell","removeChild"],"sourceRoot":"js/src/admin","sources":["publish_sessions.js"],"sourcesContent":["function admin_publish_sessions_init()\r\n{\r\n\r\n}\r\n\r\nfunction getNewItemsInSelection()\r\n{\r\n\titems_string = \"\";\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\tstartElem = document.getElementById(\"start\");\r\n\r\n\tvar startDate = startElem.value;\r\n\tif (startDate != null && startDate != \"\") {\r\n\t\tvar startCell = document.getElementById(startDate);\r\n\t}\r\n\r\n\tendElem = document.getElementById(\"end\");\r\n\tvar endDate = endElem.value;\r\n\r\n\tif (endDate != null && endDate != \"\") {\r\n\t\tvar endCell = document.getElementById(endDate);\r\n\t}\r\n\r\n\tif (endCell == null && startCell == null)\r\n\t{\r\n\t\talert (\"Please set a Date Range\");\r\n\t\treturn items_string;\r\n\t}\r\n\r\n\tif (endCell == null){endCell = startCell;}\r\n\r\n\tif (startCell == null){startCell = endCell;}\r\n\r\n\tif (isSafari) {\r\n\tvar ci = -1;\r\n\t for (var i = 0; i < startCell.parentNode.cells.length; i++) {\r\n\t   if (startCell === startCell.parentNode.cells[i]) {\r\n\t     ci = i;\r\n\t   }\r\n\t }\r\n\t if (ci == -1){alert(\"Problem: acessing cells. Please notify Dream dinners staff\"); // this should never happen\r\n}\r\n\tstartCol = ci;\r\n\t} else  {\r\n\t\tvar startCol= startCell.cellIndex;\r\n\t}\r\n\r\n\tvar startRow = startCell.parentNode.rowIndex;\r\n\r\n\tif (isSafari) {\r\n\tci = -1;\r\n\t for (var i = 0; i < endCell.parentNode.cells.length; i++) {\r\n\t   if (endCell === endCell.parentNode.cells[i]) {\r\n\t     ci = i;\r\n\t   }\r\n\t }\r\n\t if (ci == -1){alert(\"Problem: acessing cells. Please notify Dream dinners staff\"); // this should never happen\r\n}\r\n\tendCol = ci;\r\n\t} else  {\r\n\t\tvar endCol= endCell.cellIndex;\r\n\t}\r\n\r\n\tvar endRow = endCell.parentNode.rowIndex;\r\n\r\n\titems_string = \"\";\r\n\r\n\tfor (y = startRow; y <= endRow; y++)\r\n\t{\r\n\t\tif (y == startRow){tempStartCol = startCol;} else {tempStartCol = 0;}\r\n\r\n\t\tif (y == endRow){tempEndCol = endCol;} else {tempEndCol = 6;}\r\n\r\n\t\tfor (x = tempStartCol; x <= tempEndCol; x++)\r\n\t\t{\r\n\t\t\tthisCell=document.getElementById(calendarName).rows[y].cells[x];\r\n\r\n\t\t\tif (thisCell)\r\n\t\t\t{\r\n\t\t\t\timages = thisCell.getElementsByTagName(\"img\");\r\n\r\n\t\t\t\tfor (i= 0; i < images.length; i++)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tif (images.item(i).id < 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titems_string += (images.item(i).id + \"^\" + thisCell.id + \"^\" +  images.item(i).name + \"|\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn items_string.substr(0, items_string.length - 1);\r\n}\r\n\r\nfunction serializeNewSessions()\r\n{\r\n\t// send all the new sessions back to the server\r\n\titems_string = \"\";\r\n\r\n\tfor (y = 2; y <= 8; y++)\r\n\t{\r\n\t\tfor (x = 0; x <= 6; x++)\r\n\t\t{\r\n\t\t\tthisCell=document.getElementById(calendarName).rows[y].cells[x];\r\n\r\n\t\t\tif (thisCell)\r\n\t\t\t{\r\n\t\t\t\timages = thisCell.getElementsByTagName(\"img\");\r\n\r\n\t\t\t\tfor (i= 0; i < images.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (images.item(i).id < 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titems_string += (images.item(i).id + \"^\" + thisCell.id + \"^\" +  images.item(i).name + \"|\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tform = document.getElementById(\"fillWindowForm\");\r\n\t\titem_ids = document.getElementById(\"item_ids\");\r\n\t\titem_ids.value = items_string.substr(0, items_string.length - 1);\r\n\t}\r\n}\r\n\r\nfunction hiliteIcon(id, index)\r\n{\r\n\timg = document.getElementById(id);\r\n\r\n\tswitch(index)\r\n\t{\r\n\t\tcase 1:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_pub_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 2:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_saved_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 3:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_new_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 4:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_closed_hl.png';\r\n\t\t\treturn;\r\n\t}\r\n}\r\n\r\nfunction unHiliteIcon(id, index)\r\n{\r\n\timg = document.getElementById(id);\r\n\r\n\tswitch(index)\r\n\t{\r\n\t\tcase 1:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_pub.png';\r\n\t\t\treturn;\r\n\t\tcase 2:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_saved.png';\r\n\t\t\treturn;\r\n\t\tcase 3:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_new.png';\r\n\t\t\treturn;\r\n\t\tcase 4:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_closed.png';\r\n\t\t\treturn;\r\n\t}\r\n}\r\n\r\nfunction onSetFillWindowStart()\r\n{\r\n\tif (selectedCell)\r\n\t{\r\n\t\tif( !selectedCell.getAttribute( 'validForMenu' ) )\r\n\t\t{\r\n\t\t\tserializeNewSessions();\r\n\r\n\t\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\t\tendID = document.getElementById(\"end\").value;\r\n\t\t\tif (endID != null && endID != \"\")\r\n\t\t\t{\r\n\t\t\t\tendTD = document.getElementById(endID);\r\n\t\t\t\tendCol= endTD.cellIndex;\r\n\t\t\t\tendRow = endTD.parentNode.rowIndex;\r\n\r\n\t\t\t\tvar startCol= selectedCell.cellIndex;\r\n\t\t\t\tvar startRow = selectedCell.parentNode.rowIndex;\r\n\r\n\t\t\t\tif (endRow < startRow || (endRow == startRow && endCol < startCol))\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.getElementById(\"end\").value = selectedCell.id;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstartElem = document.getElementById(\"start\");\r\n\t\t\tstartElem.value = selectedCell.id;\r\n\r\n\t\t\toperation = document.getElementById(\"operation\");\r\n\t\t\toperation.value = null;\r\n\r\n\t\t\tform.submit();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert( \"Sorry, you selected a date outside of the valid menu range.\\nPlease select a date between the two arrows.\" );\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\talert(\"Please select a start day by clicking on a day in calendar\");\r\n\t}\r\n}\r\n\r\nfunction onSetFillWindowEnd()\r\n{\r\n\tif (selectedCell)\r\n\t{\r\n\t\tif( !selectedCell.getAttribute( 'validForMenu' ) ) {\r\n\t\t\tserializeNewSessions();\r\n\r\n\t\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\t\tstartID = document.getElementById(\"start\").value;\r\n\t\t\tif (startID != null && startID != \"\")\r\n\t\t\t{\r\n\t\t\t\tstartTD = document.getElementById(startID);\r\n\t\t\t\tstartCol= startTD.cellIndex;\r\n\t\t\t\tstartRow = startTD.parentNode.rowIndex;\r\n\r\n\t\t\t\tvar endCol= selectedCell.cellIndex;\r\n\t\t\t\tvar endRow = selectedCell.parentNode.rowIndex;\r\n\r\n\t\t\t\tif (endRow < startRow || (endRow == startRow && endCol < startCol))\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.getElementById(\"start\").value = selectedCell.id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tendElem = document.getElementById(\"end\");\r\n\t\t\tendElem.value = selectedCell.id;\r\n\r\n\t\t\toperation = document.getElementById(\"operation\");\r\n\t\t\toperation.value = null;\r\n\r\n\t\t\tform.submit();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert( \"Sorry, you selected a date outside of the valid menu range.\\nPlease select a date between the two arrows.\" );\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\talert(\"Please select an end day by clicking on a day in calendar\");\r\n\t}\r\n}\r\n\r\nfunction onClearFillWindow()\r\n{\r\n\tserializeNewSessions();\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\tendElem = document.getElementById(\"end\");\r\n\tendElem.value = null;\r\n\r\n\tstartElem = document.getElementById(\"start\");\r\n\tstartElem.value = null;\r\n\r\n\toperation = document.getElementById(\"operation\");\r\n\toperation.value = null;\r\n\r\n\tform.submit();\r\n}\r\n\r\nfunction onEditClick(id)\r\n{\r\n\twindow.location = \"./main.php?page=admin_edit_session&session=\" + id + \"&back=main.php?page=admin_publish_sessions\";\r\n}\r\n\r\nfunction onSessionClick(id)\r\n{\r\n\twindow.location = \"./main.php?page=admin_main&session=\" + id;\r\n}\r\n\r\nfunction saveItems()\r\n{\r\n\titems_string = getNewItemsInSelection();\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\tdocument.getElementById(\"item_ids\").value = items_string;\r\n\t\tdocument.getElementById(\"operation\").value = 'save';\r\n\t\tform.submit();\r\n\r\n\t\tvar submitDiv = document.getElementById(\"saveButton\");\r\n\t\tsubmitDiv.style.display = 'none';\r\n\t}\r\n}\r\n\r\nfunction publishItems()\r\n{\r\n\titems_string = getNewItemsInSelection();\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tdocument.getElementById(\"item_ids\").value = items_string;\r\n\t}\r\n\r\n\tdocument.getElementById(\"operation\").value = 'publish';\r\n\tform.submit();\r\n\r\n\tvar submitDiv = document.getElementById(\"publishButton\");\r\n\tsubmitDiv.style.display = 'none';\r\n}\r\n\r\nfunction onDeleteClick(obj)\r\n{\r\n\ttheSpan = obj.parentNode;\r\n\ttheCell = theSpan.parentNode;\r\n\r\n\ttheCell.removeChild(theSpan);\r\n\r\n}"],"mappings":"AAAA,SAASA,8BAGT,CAEA,SAASC,yBAERC,aAAe,GAEfC,KAAOC,SAASC,eAAe,kBAC/BC,UAAYF,SAASC,eAAe,SAEpC,IAAIE,EAAYD,UAAUE,MAC1B,GAAiB,MAAbD,GAAkC,IAAbA,EACxB,IAAIE,EAAYL,SAASC,eAAeE,GAGzCG,QAAUN,SAASC,eAAe,OAClC,IAAIM,EAAUD,QAAQF,MAEtB,GAAe,MAAXG,GAA8B,IAAXA,EACtB,IAAIC,EAAUR,SAASC,eAAeM,GAGvC,GAAe,MAAXC,GAAgC,MAAbH,EAGtB,OADAI,MAAO,2BACAX,aAOR,GAJe,MAAXU,IAAiBA,EAAUH,GAEd,MAAbA,IAAmBA,EAAYG,GAE/BE,SAAU,CAEb,IADD,IAAIC,GAAM,EACAC,EAAI,EAAGA,EAAIP,EAAUQ,WAAWC,MAAMC,OAAQH,IACjDP,IAAcA,EAAUQ,WAAWC,MAAMF,KAC3CD,EAAKC,IAGE,GAAPD,GAAUF,MAAM,8DAErBO,EAAWL,CACX,MACC,IAAIK,EAAUX,EAAUY,UAGzB,IAAIC,EAAWb,EAAUQ,WAAWM,SAEpC,GAAIT,SAAU,CACdC,GAAM,EACL,IAASC,EAAI,EAAGA,EAAIJ,EAAQK,WAAWC,MAAMC,OAAQH,IAC/CJ,IAAYA,EAAQK,WAAWC,MAAMF,KACvCD,EAAKC,IAGE,GAAPD,GAAUF,MAAM,8DAErBW,EAAST,CACT,MACC,IAAIS,EAAQZ,EAAQS,UAGrB,IAAII,EAASb,EAAQK,WAAWM,SAIhC,IAFArB,aAAe,GAEVwB,EAAIJ,EAAUI,GAAKD,EAAQC,IAM/B,IAJIA,GAAKJ,EAAUK,aAAeP,EAAiBO,aAAe,EAE9DD,GAAKD,EAAQG,WAAaJ,EAAeI,WAAa,EAErDC,EAAIF,aAAcE,GAAKD,WAAYC,IAIvC,GAFAC,SAAS1B,SAASC,eAAe0B,cAAcC,KAAKN,GAAGR,MAAMW,GAEzDC,SAIH,IAFAG,OAASH,SAASI,qBAAqB,OAElClB,EAAG,EAAGA,EAAIiB,OAAOd,OAAQH,IAGzBiB,OAAOE,KAAKnB,GAAGoB,GAAK,IAEvBlC,cAAiB+B,OAAOE,KAAKnB,GAAGoB,GAAK,IAAMN,SAASM,GAAK,IAAOH,OAAOE,KAAKnB,GAAGqB,KAAO,KAO3F,OAAOnC,aAAaoC,OAAO,EAAGpC,aAAaiB,OAAS,EACrD,CAEA,SAASoB,uBAKR,IAFArC,aAAe,GAEVwB,EAAI,EAAGA,GAAK,EAAGA,IAEnB,IAAKG,EAAI,EAAGA,GAAK,EAAGA,IAInB,GAFAC,SAAS1B,SAASC,eAAe0B,cAAcC,KAAKN,GAAGR,MAAMW,GAEzDC,SAIH,IAFAG,OAASH,SAASI,qBAAqB,OAElClB,EAAG,EAAGA,EAAIiB,OAAOd,OAAQH,IAEzBiB,OAAOE,KAAKnB,GAAGoB,GAAK,IAEvBlC,cAAiB+B,OAAOE,KAAKnB,GAAGoB,GAAK,IAAMN,SAASM,GAAK,IAAOH,OAAOE,KAAKnB,GAAGqB,KAAO,KAOvE,IAAhBnC,eAEHC,KAAOC,SAASC,eAAe,kBAC/BmC,SAAWpC,SAASC,eAAe,YACnCmC,SAAShC,MAAQN,aAAaoC,OAAO,EAAGpC,aAAaiB,OAAS,GAEhE,CAEA,SAASsB,WAAWL,EAAIM,GAIvB,OAFAC,IAAMvC,SAASC,eAAe+B,GAEvBM,GAEN,KAAK,EAEJ,YADAC,IAAIC,IAAMC,KAAKC,YAAc,gCAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,kCAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,gCAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,mCAGhC,CAEA,SAASC,aAAaX,EAAIM,GAIzB,OAFAC,IAAMvC,SAASC,eAAe+B,GAEvBM,GAEN,KAAK,EAEJ,YADAC,IAAIC,IAAMC,KAAKC,YAAc,6BAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,+BAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,6BAE9B,KAAK,EAEJ,YADAH,IAAIC,IAAMC,KAAKC,YAAc,gCAGhC,CAEA,SAASE,uBAER,GAAIC,aAEH,GAAKA,aAAaC,aAAc,gBAiC/BrC,MAAO,iHAhCR,CAMC,GALA0B,uBAEApC,KAAOC,SAASC,eAAe,kBAE/B8C,MAAQ/C,SAASC,eAAe,OAAOG,MAC1B,MAAT2C,OAA0B,IAATA,MACrB,CACCC,MAAQhD,SAASC,eAAe8C,OAChC3B,OAAQ4B,MAAM/B,UACdI,OAAS2B,MAAMnC,WAAWM,SAE1B,IAAIH,EAAU6B,aAAa5B,UACvBC,EAAW2B,aAAahC,WAAWM,UAEnCE,OAASH,GAAaG,QAAUH,GAAYE,OAASJ,KAExDhB,SAASC,eAAe,OAAOG,MAAQyC,aAAab,GAGtD,CAEA9B,UAAYF,SAASC,eAAe,SACpCC,UAAUE,MAAQyC,aAAab,GAE/BiB,UAAYjD,SAASC,eAAe,aACpCgD,UAAU7C,MAAQ,KAElBL,KAAKmD,QACN,MAQAzC,MAAM,6DAER,CAEA,SAAS0C,qBAER,GAAIN,aAEH,GAAKA,aAAaC,aAAc,gBA+B/BrC,MAAO,iHA/B2C,CAMlD,GALA0B,uBAEApC,KAAOC,SAASC,eAAe,kBAE/BmD,QAAUpD,SAASC,eAAe,SAASG,MAC5B,MAAXgD,SAA8B,IAAXA,QACvB,CACCC,QAAUrD,SAASC,eAAemD,SAClCpC,SAAUqC,QAAQpC,UAClBC,SAAWmC,QAAQxC,WAAWM,SAE9B,IAAIC,EAAQyB,aAAa5B,UACrBI,EAASwB,aAAahC,WAAWM,UAEjCE,EAASH,UAAaG,GAAUH,UAAYE,EAASJ,YAExDhB,SAASC,eAAe,SAASG,MAAQyC,aAAab,GAExD,CAEA1B,QAAUN,SAASC,eAAe,OAClCK,QAAQF,MAAQyC,aAAab,GAE7BiB,UAAYjD,SAASC,eAAe,aACpCgD,UAAU7C,MAAQ,KAElBL,KAAKmD,QACN,MAQAzC,MAAM,4DAER,CAEA,SAAS6C,oBAERnB,uBAEApC,KAAOC,SAASC,eAAe,kBAE/BK,QAAUN,SAASC,eAAe,OAClCK,QAAQF,MAAQ,KAEhBF,UAAYF,SAASC,eAAe,SACpCC,UAAUE,MAAQ,KAElB6C,UAAYjD,SAASC,eAAe,aACpCgD,UAAU7C,MAAQ,KAElBL,KAAKmD,QACN,CAEA,SAASK,YAAYvB,GAEpBwB,OAAOC,SAAW,8CAAgDzB,EAAK,4CACxE,CAEA,SAAS0B,eAAe1B,GAEvBwB,OAAOC,SAAW,sCAAwCzB,CAC3D,CAEA,SAAS2B,aAER7D,aAAeD,yBAEK,IAAhBC,gBAEHC,KAAOC,SAASC,eAAe,kBAE/BD,SAASC,eAAe,YAAYG,MAAQN,aAC5CE,SAASC,eAAe,aAAaG,MAAQ,OAC7CL,KAAKmD,SAEWlD,SAASC,eAAe,cAC9B2D,MAAMC,QAAU,OAE5B,CAEA,SAASC,eAERhE,aAAeD,yBAEfE,KAAOC,SAASC,eAAe,kBAEX,IAAhBH,eAEHE,SAASC,eAAe,YAAYG,MAAQN,cAG7CE,SAASC,eAAe,aAAaG,MAAQ,UAC7CL,KAAKmD,SAEWlD,SAASC,eAAe,iBAC9B2D,MAAMC,QAAU,MAC3B,CAEA,SAASE,cAAcC,GAEtBC,QAAUD,EAAInD,WACdqD,QAAUD,QAAQpD,WAElBqD,QAAQC,YAAYF,QAErB"}