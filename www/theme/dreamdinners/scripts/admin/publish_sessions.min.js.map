{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["publish_sessions.js"],"sourcesContent":["function admin_publish_sessions_init()\r\n{\r\n\r\n}\r\n\r\nfunction getNewItemsInSelection()\r\n{\r\n\titems_string = \"\";\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\tstartElem = document.getElementById(\"start\");\r\n\r\n\tvar startDate = startElem.value;\r\n\tif (startDate != null && startDate != \"\") {\r\n\t\tvar startCell = document.getElementById(startDate);\r\n\t}\r\n\r\n\tendElem = document.getElementById(\"end\");\r\n\tvar endDate = endElem.value;\r\n\r\n\tif (endDate != null && endDate != \"\") {\r\n\t\tvar endCell = document.getElementById(endDate);\r\n\t}\r\n\r\n\tif (endCell == null && startCell == null)\r\n\t{\r\n\t\talert (\"Please set a Date Range\");\r\n\t\treturn items_string;\r\n\t}\r\n\r\n\tif (endCell == null){endCell = startCell;}\r\n\r\n\tif (startCell == null){startCell = endCell;}\r\n\r\n\tif (isSafari) {\r\n\tvar ci = -1;\r\n\t for (var i = 0; i < startCell.parentNode.cells.length; i++) {\r\n\t   if (startCell === startCell.parentNode.cells[i]) {\r\n\t     ci = i;\r\n\t   }\r\n\t }\r\n\t if (ci == -1){alert(\"Problem: acessing cells. Please notify Dream dinners staff\"); // this should never happen\r\n}\r\n\tstartCol = ci;\r\n\t} else  {\r\n\t\tvar startCol= startCell.cellIndex;\r\n\t}\r\n\r\n\tvar startRow = startCell.parentNode.rowIndex;\r\n\r\n\tif (isSafari) {\r\n\tci = -1;\r\n\t for (var i = 0; i < endCell.parentNode.cells.length; i++) {\r\n\t   if (endCell === endCell.parentNode.cells[i]) {\r\n\t     ci = i;\r\n\t   }\r\n\t }\r\n\t if (ci == -1){alert(\"Problem: acessing cells. Please notify Dream dinners staff\"); // this should never happen\r\n}\r\n\tendCol = ci;\r\n\t} else  {\r\n\t\tvar endCol= endCell.cellIndex;\r\n\t}\r\n\r\n\tvar endRow = endCell.parentNode.rowIndex;\r\n\r\n\titems_string = \"\";\r\n\r\n\tfor (y = startRow; y <= endRow; y++)\r\n\t{\r\n\t\tif (y == startRow){tempStartCol = startCol;} else {tempStartCol = 0;}\r\n\r\n\t\tif (y == endRow){tempEndCol = endCol;} else {tempEndCol = 6;}\r\n\r\n\t\tfor (x = tempStartCol; x <= tempEndCol; x++)\r\n\t\t{\r\n\t\t\tthisCell=document.getElementById(calendarName).rows[y].cells[x];\r\n\r\n\t\t\tif (thisCell)\r\n\t\t\t{\r\n\t\t\t\timages = thisCell.getElementsByTagName(\"img\");\r\n\r\n\t\t\t\tfor (i= 0; i < images.length; i++)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tif (images.item(i).id < 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titems_string += (images.item(i).id + \"^\" + thisCell.id + \"^\" +  images.item(i).name + \"|\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn items_string.substr(0, items_string.length - 1);\r\n}\r\n\r\nfunction serializeNewSessions()\r\n{\r\n\t// send all the new sessions back to the server\r\n\titems_string = \"\";\r\n\r\n\tfor (y = 2; y <= 8; y++)\r\n\t{\r\n\t\tfor (x = 0; x <= 6; x++)\r\n\t\t{\r\n\t\t\tthisCell=document.getElementById(calendarName).rows[y].cells[x];\r\n\r\n\t\t\tif (thisCell)\r\n\t\t\t{\r\n\t\t\t\timages = thisCell.getElementsByTagName(\"img\");\r\n\r\n\t\t\t\tfor (i= 0; i < images.length; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (images.item(i).id < 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titems_string += (images.item(i).id + \"^\" + thisCell.id + \"^\" +  images.item(i).name + \"|\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tform = document.getElementById(\"fillWindowForm\");\r\n\t\titem_ids = document.getElementById(\"item_ids\");\r\n\t\titem_ids.value = items_string.substr(0, items_string.length - 1);\r\n\t}\r\n}\r\n\r\nfunction hiliteIcon(id, index)\r\n{\r\n\timg = document.getElementById(id);\r\n\r\n\tswitch(index)\r\n\t{\r\n\t\tcase 1:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_pub_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 2:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_saved_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 3:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_new_hl.png';\r\n\t\t\treturn;\r\n\t\tcase 4:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_closed_hl.png';\r\n\t\t\treturn;\r\n\t}\r\n}\r\n\r\nfunction unHiliteIcon(id, index)\r\n{\r\n\timg = document.getElementById(id);\r\n\r\n\tswitch(index)\r\n\t{\r\n\t\tcase 1:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_pub.png';\r\n\t\t\treturn;\r\n\t\tcase 2:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_saved.png';\r\n\t\t\treturn;\r\n\t\tcase 3:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_new.png';\r\n\t\t\treturn;\r\n\t\tcase 4:\r\n\t\t\timg.src = PATH.image_admin + '/calendar/session_closed.png';\r\n\t\t\treturn;\r\n\t}\r\n}\r\n\r\nfunction onSetFillWindowStart()\r\n{\r\n\tif (selectedCell)\r\n\t{\r\n\t\tif( !selectedCell.getAttribute( 'validForMenu' ) )\r\n\t\t{\r\n\t\t\tserializeNewSessions();\r\n\r\n\t\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\t\tendID = document.getElementById(\"end\").value;\r\n\t\t\tif (endID != null && endID != \"\")\r\n\t\t\t{\r\n\t\t\t\tendTD = document.getElementById(endID);\r\n\t\t\t\tendCol= endTD.cellIndex;\r\n\t\t\t\tendRow = endTD.parentNode.rowIndex;\r\n\r\n\t\t\t\tvar startCol= selectedCell.cellIndex;\r\n\t\t\t\tvar startRow = selectedCell.parentNode.rowIndex;\r\n\r\n\t\t\t\tif (endRow < startRow || (endRow == startRow && endCol < startCol))\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.getElementById(\"end\").value = selectedCell.id;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstartElem = document.getElementById(\"start\");\r\n\t\t\tstartElem.value = selectedCell.id;\r\n\r\n\t\t\toperation = document.getElementById(\"operation\");\r\n\t\t\toperation.value = null;\r\n\r\n\t\t\tform.submit();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert( \"Sorry, you selected a date outside of the valid menu range.\\nPlease select a date between the two arrows.\" );\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\talert(\"Please select a start day by clicking on a day in calendar\");\r\n\t}\r\n}\r\n\r\nfunction onSetFillWindowEnd()\r\n{\r\n\tif (selectedCell)\r\n\t{\r\n\t\tif( !selectedCell.getAttribute( 'validForMenu' ) ) {\r\n\t\t\tserializeNewSessions();\r\n\r\n\t\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\t\tstartID = document.getElementById(\"start\").value;\r\n\t\t\tif (startID != null && startID != \"\")\r\n\t\t\t{\r\n\t\t\t\tstartTD = document.getElementById(startID);\r\n\t\t\t\tstartCol= startTD.cellIndex;\r\n\t\t\t\tstartRow = startTD.parentNode.rowIndex;\r\n\r\n\t\t\t\tvar endCol= selectedCell.cellIndex;\r\n\t\t\t\tvar endRow = selectedCell.parentNode.rowIndex;\r\n\r\n\t\t\t\tif (endRow < startRow || (endRow == startRow && endCol < startCol))\r\n\t\t\t\t{\r\n\t\t\t\t\tdocument.getElementById(\"start\").value = selectedCell.id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tendElem = document.getElementById(\"end\");\r\n\t\t\tendElem.value = selectedCell.id;\r\n\r\n\t\t\toperation = document.getElementById(\"operation\");\r\n\t\t\toperation.value = null;\r\n\r\n\t\t\tform.submit();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\talert( \"Sorry, you selected a date outside of the valid menu range.\\nPlease select a date between the two arrows.\" );\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\talert(\"Please select an end day by clicking on a day in calendar\");\r\n\t}\r\n}\r\n\r\nfunction onClearFillWindow()\r\n{\r\n\tserializeNewSessions();\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\tendElem = document.getElementById(\"end\");\r\n\tendElem.value = null;\r\n\r\n\tstartElem = document.getElementById(\"start\");\r\n\tstartElem.value = null;\r\n\r\n\toperation = document.getElementById(\"operation\");\r\n\toperation.value = null;\r\n\r\n\tform.submit();\r\n}\r\n\r\nfunction onEditClick(id)\r\n{\r\n\twindow.location = \"./main.php?page=admin_edit_session&session=\" + id + \"&back=main.php?page=admin_publish_sessions\";\r\n}\r\n\r\nfunction onSessionClick(id)\r\n{\r\n\twindow.location = \"./main.php?page=admin_main&session=\" + id;\r\n}\r\n\r\nfunction saveItems()\r\n{\r\n\titems_string = getNewItemsInSelection();\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\t\tdocument.getElementById(\"item_ids\").value = items_string;\r\n\t\tdocument.getElementById(\"operation\").value = 'save';\r\n\t\tform.submit();\r\n\r\n\t\tvar submitDiv = document.getElementById(\"saveButton\");\r\n\t\tsubmitDiv.style.display = 'none';\r\n\t}\r\n}\r\n\r\nfunction publishItems()\r\n{\r\n\titems_string = getNewItemsInSelection();\r\n\r\n\tform = document.getElementById(\"fillWindowForm\");\r\n\r\n\tif (items_string != \"\")\r\n\t{\r\n\t\tdocument.getElementById(\"item_ids\").value = items_string;\r\n\t}\r\n\r\n\tdocument.getElementById(\"operation\").value = 'publish';\r\n\tform.submit();\r\n\r\n\tvar submitDiv = document.getElementById(\"publishButton\");\r\n\tsubmitDiv.style.display = 'none';\r\n}\r\n\r\nfunction onDeleteClick(obj)\r\n{\r\n\ttheSpan = obj.parentNode;\r\n\ttheCell = theSpan.parentNode;\r\n\r\n\ttheCell.removeChild(theSpan);\r\n\r\n}"],"names":["admin_publish_sessions_init","getNewItemsInSelection","items_string","form","document","getElementById","startElem","startDate","value","startCell","endElem","endDate","endCell","alert","isSafari","ci","i","parentNode","cells","length","startCol","cellIndex","startRow","rowIndex","endCol","endRow","y","tempStartCol","tempEndCol","x","thisCell","calendarName","rows","images","getElementsByTagName","item","id","name","substr","serializeNewSessions","item_ids","hiliteIcon","index","img","src","PATH","image_admin","unHiliteIcon","onSetFillWindowStart","selectedCell","getAttribute","endID","endTD","operation","submit","onSetFillWindowEnd","startID","startTD","onClearFillWindow","onEditClick","window","location","onSessionClick","saveItems","submitDiv","style","display","publishItems","onDeleteClick","obj","theSpan","theCell","removeChild"],"mappings":"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"}