function admin_global_init(){data_tooltips_init();help_system_init();fadmin_idle_timeout();menu_bar_init();handle_inline_guest_search();handle_helpdesk();handle_tabbed_content();handle_accordion_content();$(document).ajaxStart(function(){AJAX_IN_PROCESS=true;$(".img_throbber_circle").show()});$(document).ajaxStop(function(){AJAX_IN_PROCESS=false;$(".img_throbber_circle").hide()});$(document).ajaxSuccess(function(e,t,a){data_tooltips_init();handle_inline_guest_search()})}function click_dd_message_button(e,a){var t=$("#"+e).parent();var i=false;t.find("[type=button]").each(function(){var e=$(this).find("span").html();if(e==a){$(this).click();return}var t=$(this).html();if(t==a){$(this).click()}})}function onNBCreateSingleSession(){var e=document.getElementById("menus");var t="";if(e){var a=document.getElementById("menus").value;t="&menu="+a}if(typeof selectedCell!="undefined"&&selectedCell!=null){cellName=selectedCell.id;bounce("main.php?page=admin_create_session&selectedCell="+cellName)}else{bounce("main.php?page=admin_create_session"+t)}}function data_tooltips_init(){if(!IS_TOUCH_SCREEN_DEVICE){if($.fn.qtip){$("[data-tooltip]").qtip({content:{attr:"data-tooltip"},position:{my:"bottom left",at:"top left",viewport:$(window),adjust:{method:"shift",y:parseInt(0,10)||0,x:parseInt(10,10)||0}},style:{classes:"ui-tooltip-dreamdinners_tt qtip-shadow"}})}}}function hostessDreamTasteOrder(e,t,a){create_and_submit_form({action:"main.php?page=admin_order_mgr&user="+a,input:{session:e,request:"savedTasteOrder",sessionText:t}})}function handle_tabbed_content(){if($(".tabbed-content").length==0){return}window.tabbed_content={};$(".tabbed-content").each(function(r){if($(this).data("tabid")){if($(this).data("tabid")in tabbed_content){dd_console_log("data-tabid for tabbed-content must be unique.")}else{r=$(this).data("tabid")}}var e=tabbed_content[r]=this;tabbed_content[r].tab_clicks={};var d=$(e).find(".tabs");var l=$(e).find(".tabs-content");$(d).find("[data-tabid]").each(function(){var n=$(this).data("tabid");if($(this).hasClass("close")){var e="";if($(this).hasClass("confirm")){e=" confirm"}$(this).append('<span class="close'+e+'" data-tooltip="Close">X</span>').find(".close").on("click",function(e){e.stopPropagation();var t=this;if($(t).hasClass("confirm")&&!$(t).hasClass("noconfirm")){dd_message({title:"Confirm",message:"Are you sure you wish to close this tab?",confirm:function(){$(t).parent().addClass("hidden");$(t).parent().parent().children().not(".hidden, .disabled").first().trigger("click")},cancel:function(){}})}else{$(t).removeClass("noconfirm");$(t).parent().addClass("hidden");$(t).parent().parent().children().not(".hidden, .disabled").first().trigger("click")}})}if($(this).hasClass("selected")){selected_tab=this;$(l).find('[data-tabid="'+n+'"]').addClass("selected")}if(!$(this).hasClass("content")){$(l).find('[data-tabid="'+n+'"]').addClass("content")}tabbed_content[r].tab_clicks[n]=this;$(this).on("click",function(){if($(this).hasClass("selected")){return}if($(this).hasClass("disabled")){return}var a=false;$(d).find("[data-tabid]").each(function(){if($(this).hasClass("selected")){if($(this).data("deselect_callback")){var e=$(this).data("deselect_callback");var t=window[e];if(t!=undefined){if(!t(this)){a=true;return false}}}$(this).removeClass("selected")}});if(a){return false}if($(this).data("link")){bounce($(this).data("link"));return}$(l).find("[data-tabid]").each(function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}});$(d).find('[data-tabid="'+n+'"]').addClass("selected");$(l).find('[data-tabid="'+n+'"]').addClass("selected");if($(this).data("callback")){var e=$(this).data("callback");var t=window[e];if(t!=undefined){t(this)}}if($(this).data("urlpush")===undefined||$(this).data("urlpush")==="true"){if(getQueryVariable("tabs")){var i=getQueryVariable("tabs").split(",");var s=[];var o=[];$.each(i,function(e,t){var a=t.split(".");if(a[0]==r){s.push(a[0]+"."+n)}else{s.push(a[0]+"."+a[1])}o[a[0]]=true});if(o[r]===undefined){s.push(r+"."+n)}new_query_string=setQueryString("tabs",s.toString());historyPush({url:new_query_string})}else{new_query_string=setQueryString("tabs",r+"."+n);historyPush({url:new_query_string})}}})})});if(getQueryVariable("tabs")){var e=getQueryVariable("tabs").split(",");$.each(e,function(e,t){var a=t.split(".");if(a[0]!==undefined&&a[1]!==undefined){if(!$(tabbed_content[a[0]].tab_clicks[a[1]]).hasClass("hidden")){$(tabbed_content[a[0]].tab_clicks[a[1]]).click().mouseleave()}}})}}function handle_accordion_content(){if($(".accordion-content").length==0){return}window.accordion_content={};$(".accordion-content").each(function(r){if($(this).data("tabid")){if($(this).data("tabid")in accordion_content){dd_console_log("data-tabid for accordion-content must be unique.")}else{r=$(this).data("tabid")}}var e=accordion_content[r]=this;accordion_content[r].tab_clicks={};var d=$(e).find(".tabs");$(d).find("[data-tabid]").each(function(){var n=$(this).data("tabid");if($(this).hasClass("active")){selected_tab=this;$(this).next().slideDown()}accordion_content[r].tab_clicks[n]=this;$(this).on("click",function(){if($(this).hasClass("active")||$(this).hasClass("disabled")){return}var a=false;$(d).find("[data-tabid]").each(function(){if($(this).hasClass("active")){if($(this).data("deselect_callback")){var e=$(this).data("deselect_callback");var t=window[e];if(t!=undefined){if(!t(this)){a=true;return false}}}$(this).removeClass("active")}});if(a){return false}if($(this).data("link")){bounce($(this).data("link"));return}$(d).find("[data-tabidcontent]").each(function(){if($(this).hasClass("active")){$(this).hide();$(this).removeClass("active")}});$(d).find('[data-tabid="'+n+'"]').addClass("active");$(d).find('[data-tabidcontent="'+n+'Content"]').addClass("active").slideDown();if($(this).data("callback")){var e=$(this).data("callback");var t=window[e];if(t!=undefined){t(this)}}if($(this).data("urlpush")===undefined||$(this).data("urlpush")==="true"){if(getQueryVariable("atabs")){var i=getQueryVariable("atabs").split(",");var s=[];var o=[];$.each(i,function(e,t){var a=t.split(".");if(a[0]==r){s.push(a[0]+"."+n)}else{s.push(a[0]+"."+a[1])}o[a[0]]=true});if(o[r]===undefined){s.push(r+"."+n)}new_query_string=setQueryString("atabs",s.toString());historyPush({url:new_query_string})}else{new_query_string=setQueryString("atabs",r+"."+n);historyPush({url:new_query_string})}}})})});if(getQueryVariable("atabs")){var e=getQueryVariable("atabs").split(",");$.each(e,function(e,t){var a=t.split(".");if(a[0]!==undefined&&a[1]!==undefined&&accordion_content){if(!$(accordion_content[a[0]].tab_clicks[a[1]]).hasClass("hidden")){$(accordion_content[a[0]].tab_clicks[a[1]]).click().mouseleave()}}})}}function hideStatusMessage(e){$("#"+e).slideUp()}function dd_message(e){var t={resizable:false,modal:true,hide_qtips:true,div_id:"dd_message"};$.extend(t,e);if(t.hide_qtips){if($.fn.qtip){$(".qtip.ui-tooltip").qtip("hide")}}if(t.type=="error_msg"){}if(!t.message){dd_message({message:"dd_message({message : 'requires message!' })"})}else{if(!t.buttons){t.buttons={}}if(e.confirm){t.buttons.Confirm=function(){if(e.canConfirm){if(e.canConfirm()){e.confirm();$(this).remove()}}else{e.confirm();$(this).remove()}}}if(e.cancel){t.buttons.Cancel=function(){e.cancel();$(this).remove()}}else if(e.confirm){t.buttons.Cancel=function(){$(this).remove()}}else if(!e.noOk){t.buttons.Ok=function(){if(e.closeCallback){e.closeCallback()}$(this).remove()}}}if($("#"+t.div_id).length==0){var a=$("<div></div>");a.attr("id",t.div_id);a.attr("style","display:none;");$(document.body).append(a)}$("#"+t.div_id).html(t.message);$("#"+t.div_id).dialog(t)}function handle_helpdesk(){if(!$("#helpdesk","#footerlinks").length){$("#footerlinks").append('<div id="helpdesk">Dream Dinners Support</div>')}$("#helpdesk, #helpdesk_footer_link, #helpdesk_button, .helpdesk-popup").on("click",function(e){e.preventDefault();var t=window.location.pathname+window.location.search;$.ajax({url:"ddproc.php",type:"POST",timeout:6e4,dataType:"json",data:{processor:"admin_helpdesk",op:"get_helpdesk",request_url:t},success:function(e){if(e.processor_success){var t=e.helpdesk_form;dd_message({title:"Dream Dinners Support",message:t,height:620,width:650,modal:false,div_id:"helpdesk_dd_message",noOk:true,open:function(e,t){$("#form_helpdesk input[name='subject']").focus()},buttons:{"Support Portal":function(){bounce("https://support.dreamdinners.com","_blank")},"Submit Ticket":function(){var e="";if($("#form_helpdesk input[name='subject']").val().trim().length==0){e="Subject<br />"}if($("#form_helpdesk textarea[name='description']").val().trim().length==0){e+="Description<br />"}if($("#form_helpdesk select[name='ticket_type']").val().trim().length==0){e+="Ticket Type<br />"}if(e.length>0){var t="Please Fill out the following fields:<br /><br />"+e;dd_message({title:"Input error",message:t});return false}var a=$("#helpdesk_dd_message")[0];var i=$("#form_helpdesk").serialize();var s=new FormData;s.append("op","submit_ticket");s.append("processor","admin_helpdesk");s.append("ticket_data",i);s.append("reporting_url",window.location.href);if(DEBUG_INFO){s.append("debugInfo",DEBUG_INFO)}$.ajax({url:"ddproc.php",type:"POST",timeout:6e4,cache:false,dataType:"json",contentType:false,processData:false,data:s,success:function(e){if(e.processor_success){$(a).remove()}else{dd_message({title:"Error",message:e.processor_message})}},error:function(e,t){dd_message({title:"Error",message:t})}})},Cancel:function(){$(this).remove()}}})}},error:function(e,t){dd_message({title:"Error",message:t})}})})}function handle_inline_guest_search(){$(document).on("click","[data-guestsearch]",function(e){if($("#ilgs_container").length){return}var o=$(this).data();delete o["qtip"];$.ajax({url:"ddproc.php",type:"POST",timeout:6e4,dataType:"json",data:{processor:"admin_guestSearch",op:"get_search_form",data:o},success:function(e){if(e.processor_success){var t=e.search_form;dd_message({title:"Guest Search",message:t,modal:false,div_id:"ilgs_container",height:300,width:600,closeOnEscape:false,noOk:true,close:function(){$("#ilgs_container").remove()},open:function(e,t){$("#ilgs_search_value").focus();var a=false;$(document).on("change","#ilgs_search_type",function(e){a=true;$("#ilgs_search_value").unmask();if($("#ilgs_search_type")=="phone"){$("#ilgs_search_value").mask("999-999-9999")}else{$(".telephone")}});$(document).on("keyup","#ilgs_search_value",function(e){if(e.which==13){$("#ilgs_search_go").trigger("click")}if(a==true){return}var t=$("#ilgs_search_value").val();if(!$.isNumeric(t)){$("#ilgs_search_type").val("lastname")}if($.isNumeric(t)){$("#ilgs_search_type").val("id")}if(t.indexOf("@")!=-1){$("#ilgs_search_type").val("email")}if(t.indexOf(" ")!=-1){$("#ilgs_search_type").val("firstlast")}});$(document).on("click","#ilgs_search_go",function(e){var t=$("#ilgs_search_type").val();var a=$("#ilgs_search_value").val();var i=$("#ilgs_search_all").prop("checked")?1:0;var s=$("#currentStore").val();$("#ilgs_results").slideUp();$.ajax({url:"ddproc.php?processor=admin_guestSearch",type:"POST",dataType:"json",data:{search_type:t,q:a,results_type:"inline_search",store:s?s:"none",filter:i,select_button_title:o.select_button_title},success:function(e){if(e.result_code==1){$("#ilgs_results").html(e.data).slideDown();$(document).on("click","[data-ilgs_result]",function(e){if(typeof window[o.select_function]==="function"){$.extend(this.dataset,o);window[o.select_function](this);$("#ilgs_container").remove()}else if(typeof o.select_function!==undefined&&o.select_function!==false){dd_console_log(o.select_function+"() specified in data-select_function, but not defined in javascript.")}else{bounce("main.php?page=admin_user_details&id="+$(this).data("user_id"))}})}else{dd_message({title:"Error",message:e.processor_message})}},error:function(e,t){dd_message({title:"Error",message:t})}})})}})}},error:function(e,t){response="Unexpected error";handle_dashboard_update()}})})}function menu_bar_init(){if($.fn.make_dropdown){$("#menubar > li").make_dropdown({timeout:250})}}function fadmin_idle_timeout(){if(!USER_LOGGEDIN||!$.cookie("DreamSite_TO")){return}TO=$.cookie("DreamSite_TO");fadmin_is_idle(true);$(document).idle(function(){if(!is_idle){fadmin_is_idle(true)}},function(){if(is_idle){fadmin_is_idle(false)}},{after:2e3})}function fadmin_is_idle(e){is_idle=e;ajax_login_in_view=false;warning_time=12e4;var t=new Date;var a=new Date;var i=TO;if(!e){i=60}var s=i*60*1e3;t.setTime(t.getTime()+s);a.setTime(t.getTime()+s+1e3);if(!e){dd_console_log("Not Idle "+s);$.doTimeout("alert_timeout_timer");$.doTimeout("toast_timeout_warning");if(dd_toast_id_close("toast_timeout_warning")){dd_toast({message:"Activity has canceled the logout."})}}else{dd_console_log("Idle "+s);if(USER_LOGGEDIN&&!ajax_login_in_view){warning_milliseconds=s/2;if(s>warning_time){warning_milliseconds=s-warning_time}$.doTimeout("toast_timeout_warning",warning_milliseconds,function(){dd_toast({message:"You will soon be logged out due to inactivity. Activity will cancel the logout.",delay:false,toast_id:"toast_timeout_warning",sound:false})});$.doTimeout("alert_timeout_timer",s,function(){do_alert_timeout()})}}if(USER_LOGGEDIN){$.cookie("DreamSite_Timer",true,{expires:t,domain:COOKIE.domain,secure:true});$.cookie(COOKIE.dd_sc_name,$.cookie(COOKIE.dd_sc_name),{expires:a,domain:COOKIE.domain,secure:true})}}function do_alert_timeout(){if($.cookie("DreamSite_Timer")){$.doTimeout("alert_timeout_timer",3e3,function(){do_alert_timeout()})}else{alert_timeout()}}function dd_toast(e){var t={delay:4e3,message:false,toast_id:false,position:"topright",css_class:false,sound:false,xclose:false};$.extend(t,e);if(typeof toast_obj==="undefined"){toast_obj={}}var a=".dd_toast_container."+t.position;if(t.toast_id){dd_toast_id_close(t.toast_id,true)}if(t.message){if(!$(a).length){$('<div class="dd_toast_container '+t.position+'"></div>').appendTo("body")}if(t.toast_id){toast_obj[t.toast_id]=$('<div class="dd_toast"></div>').appendTo(a);toast=toast_obj[t.toast_id]}else{toast=$('<div class="dd_toast"></div>').appendTo(a)}if(t.css_class){$(toast).addClass(t.css_class)}$(toast).html(t.message);if(!t.delay||t.xclose==true){$('<div class="dd_toast_close">x</div>').on("click",function(){$(toast).stop().fadeOut("slow",function(){dd_toast_cleanup(toast)})}).css({cursor:"pointer"}).prependTo(toast)}if(t.xclose==false){$(toast).on("click",function(){$(this).stop().fadeOut("slow",function(){dd_toast_cleanup(this)})}).css({cursor:"pointer"})}if(t.sound){$('<embed src="'+PATH.script+'/customer/media/dd_toast_alert.mp3" hidden="true" autostart="true" loop="false"></embed>').appendTo(toast)}$(toast).fadeIn("fast",function(){if(t.delay){$(this).delay(t.delay).fadeOut("slow",function(){dd_toast_cleanup(this)})}})}}function dd_toast_id_close(e,t){if(typeof toast_obj!=="undefined"&&typeof toast_obj[e]!=="undefined"){if(t==true){dd_toast_cleanup($(toast_obj[e]));delete toast_obj[e]}else{$(toast_obj[e]).stop().fadeOut("slow",function(){dd_toast_cleanup(this);delete toast_obj[e]})}return true}return false}function dd_toast_exists(e){if(typeof toast_obj!=="undefined"&&typeof toast_obj[e]!=="undefined"){return true}return false}function dd_toast_cleanup(e){$(e).remove();$(".dd_toast_container").each(function(){if($(this).is(":empty")){$(this).remove()}})}function alert_timeout(){USER_LOGGEDIN=false;ajax_login_in_view=true;dd_toast_id_close("toast_timeout_warning");$("[data-fadmin_perm]").each(function(){if($(this).is(":visible")){$(this).attr("data-hide_on_logout",true).hide()}});date=new Date;date.setDate(date.getDate()-1);var a=$.cookie(COOKIE.dd_sc_name);$.cookie(COOKIE.dd_sc_name,false,{expires:date,domain:COOKIE.domain});$.ajax({url:"ddproc.php",type:"POST",timeout:6e4,dataType:"json",data:{processor:"login",op:"get_login_form"},success:function(e){if(e.processor_success){var t=e.login_form;dd_message({title:"Session has expired due to inactivity",message:t,height:300,width:300,div_id:"to_login_div",closeOnEscape:false,noOk:true,open:function(e,t){var a=$(this).dialog("option","buttons");var i=a.Accept;$(this).parent().find(".ui-dialog-titlebar-close").hide();$("#fadmin_password_login").focus();$("#fadmin_password_login").keyup(function(e){if(e.keyCode==$.ui.keyCode.ENTER){i()}});$(".ui-widget-overlay").css({background:'#462200 url("'+PATH.image_admin+'/fadmin_background.jpg")',opacity:"1",filter:"none"})},buttons:{Accept:function(){var t=$("#to_login_div")[0];$("#to_login_div").find("#error_message").html("");$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"login",primary_email_login:$("#to_login_div").find("#fadmin_primary_email_login").val(),password_login:$("#to_login_div").find("#fadmin_password_login").val(),nobo:1,submit_login:1,remember_login:1,last_session_id:a},success:function(e){if(e.processor_message){$("#to_login_div").find("#error_message").html(e.processor_message)}if(e.processor_success){if(e.user_type=="CUSTOMER"){bounce("/")}else{$(t).remove();ajax_login_in_view=false;USER_LOGGEDIN=true;$("#fadmin_username").html(e.firstname+" "+e.lastname);$("#fadmin_usertype").html(e.user_type_text);$("[data-fadmin_perm][data-hide_on_logout]").each(function(){perm_array=$(this).data("fadmin_perm").split(",");if(~$.inArray(e.user_type,perm_array)){$(this).removeProp("data-hide_on_logout").show()}});$.cookie("DreamSite_Timer",true,{expires:1,domain:COOKIE.domain,secure:true});fadmin_is_idle(false)}}},error:function(e,t){response="Unexpected error"}})},Cancel:function(){window.location.reload()}}})}},error:function(e,t){response="Unexpected error";handle_dashboard_update()}})}function displayModalWaitDialog(e,t){var a='<span style="font-weight:bold;">'+t+"</span>&nbsp;&nbsp;";a+='<img src="'+PATH.image+'/style/throbber_circle.gif" class="img_valign" alt="Processing" />';dd_message({title:"Processing",message:a,noOk:true,closeOnEscape:false,dialogClass:"noclose",modal:true,width:500,height:90,resizable:false,div_id:e})}function set_platepoints_progress_bar(t,e){if(!e){$("#pp_progressbar").progressbar({value:t,change:function(){$("#pp_progresslabel").text(t+"%")}})}else{$.doTimeout("platepoints_progress",2,function(){var e=$("#pp_progressbar").progressbar("option","value");if(isNaN(e)){e=0}if(e<50){$("#pp_progresslabel").addClass("dark")}else{$("#pp_progresslabel").removeClass("dark")}if(t>e){increase=true;value_count=e+1}else{increase=false;value_count=e-1}if(increase){if(value_count>t){return false}else{$("#pp_progressbar").progressbar({value:value_count,change:function(){$("#pp_progresslabel").text($("#pp_progressbar").progressbar("value")+"%")}});return true}}else{if(value_count<t){return false}else{$("#pp_progressbar").progressbar({value:value_count,change:function(){$("#pp_progresslabel").text($("#pp_progressbar").progressbar("value")+"%")}});return true}}})}}function help_system_init(){$("[data-help]").each(function(){$(this).addClass("help_enabled");var e=$(this).attr("data-help");var t=e.split("-");var a=ddHelpData;for(var i=0;i<t.length;i++){a=a[t[i]]}if($.fn.qtip&&typeof a!="undefined"){$(this).qtip({show:{solo:true},content:{text:"<div class='help_tip_title'>"+a.title+"</div><div class='help_tip_text'>"+a.help_text+"</div><div class='help_tip_tech_text'>"+a.tech_text+"</div>"},position:{my:"bottom left",at:"top left",viewport:$(window),adjust:{method:"flip",y:parseInt(0,10)||0,x:parseInt(10,10)||0}},style:{classes:"ui-tooltip-dreamdinners_tt ui-tooltip-shadow"}})}})}function NewWindowScroll(e,t,a,i){var s=screen.width?Math.floor((screen.width-a)/2):0;var o=screen.height?Math.floor((screen.height-i)/2):0;var n="height="+i+",width="+a+",top="+o+",left="+s+",status=no,toolbar=no,scrollbars=1,resizable=1";window.open(e,t,n)}$(function(){$(document).on("click","#menu-toggle",function(e){e.preventDefault();$("#wrapper").toggleClass("toggled")});$(document).on("focus","input[type=number]",function(e){$(this).on("wheel.disableScroll",function(e){e.preventDefault()})});$(document).on("blur","input[type=number]",function(e){$(this).off("wheel.disableScroll")});$(document).on("click","[data-confirm-nav]",function(e){e.preventDefault();var t=this.href;var a=$(this).data("confirm-nav");bootbox.confirm({message:a,callback:function(e){if(e){window.location=t}}})});$(document).on("click","[data-multi_store_select_id], [data-multi_store_select_filter]",function(e){e.preventDefault();if($(this).hasClass("disabled")){return}if($(this).data("multi_store_select_filter")){switch($(this).data("multi_store_select_filter")){case"all":$("#multi_store_select_form input[type=checkbox]").prop("checked",true);break;case"none":$("#multi_store_select_form input[type=checkbox]").prop("checked",false);break;case"active-all":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="1"]').prop("checked",true);break;case"active-corporate":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="1"][data-franchise_id="220"]').prop("checked",true);break;case"active-non-corporate":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="1"][data-franchise_id!="220"]').prop("checked",true);break;case"inactive-all":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="0"]').prop("checked",true);break;case"inactive-corporate":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="0"][data-franchise_id="220"]').prop("checked",true);break;case"inactive-non-corporate":$('#multi_store_select_form [data-store_type="FRANCHISE"][data-active="0"][data-franchise_id!="220"]').prop("checked",true);break;case"dist-all":$('#multi_store_select_form [data-store_type="DISTRIBUTION_CENTER"]').prop("checked",true);break;case"dist-none":$('#multi_store_select_form [data-store_type="DISTRIBUTION_CENTER"]').prop("checked",false);break}return}let i=$(this).data("multi_store_select_id");let t=$(this);let a=$("#"+i).val();$(t).addClass("disabled");$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_helpers",op:"multi_store_select",store_id:a},success:function(e){if(e.processor_success){bootbox.confirm({message:e.html,scrollable:true,callback:function(e){if(e){let e=$("#multi_store_select_form");let t=e.serializeArray();let a=[];$.each(t,function(e,t){a.push(t.value)});$("#"+i).val(a.join());$("#"+i+"-count").text(t.length)}$(t).removeClass("disabled")}})}},error:function(e,t){t="Unexpected error"}})});$(document).on("click","[data-user_id_pp_tooltip]",function(e){e.preventDefault();var a=$(this).data("user_id_pp_tooltip");$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_fadmin_home",op:"platepoints_tooltip",user_id:a},success:function(e,t){if(e.processor_success){bootbox.dialog({message:e.tooltip_html,buttons:{manage:{label:"Manage",className:"btn-success",callback:function(){bounce("/main.php?page=admin_user_plate_points&id="+a+"&back="+back_path())}},close:{label:"Close",className:"btn-success"}}})}},error:function(e,t){response="Unexpected error"}})});$(document).on("click",".link-dinner-details",function(e){e.preventDefault();var t=$(this).data("menu_id");var a=$(this).data("menu_item_id");var i=$(this).data("store_id");var s=$(this).prop("target");$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"menu_item",op:"find_item",menu_id:t,menu_item_id:a,store_id:i,detailed:true},success:function(e){if(e.processor_success){bootbox.dialog({message:e.html,size:"large",buttons:{"Full details":function(){bounce("main.php?page=item&recipe="+e.recipe_id+"&ov_menu="+e.menu_id,s)},cancel:{label:"Close"}}})}else{dd_message({title:"Error",message:e.processor_message})}},error:function(e,t){response="Unexpected error"}})});$(document).on("click",".backoffice_change_store:not(.disabled)",function(e){e.preventDefault();let a={back:back_path(),dialog:null};a.dialog=bootbox.dialog({message:'<p><i class="fa fa-spin fa-spinner"></i> Loading store selector...</p>',size:"large",centerVertical:true,closeButton:false,buttons:{ok:{label:"Select store",className:"btn-primary backoffice_change_store-confirm disabled",callback:function(){let e=$("#change_store-selector").val();let t=$("#change_store-selector option:selected").text();a.dialog.find(".bootbox-body").html('<p><i class="fa fa-spin fa-spinner"></i> Loading '+t+"</p>");a.dialog.find(".modal-footer > .backoffice_change_store-confirm").addClass("disabled");$.ajax({url:"ddproc.php",type:"POST",dataType:"json",timeout:6e4,data:{processor:"admin_helpers",op:"store_selector",do:"selector_select",store:e,back:a.back},success:function(e){if(e.processor_success){bounce(decodeURIComponent(a.back))}else{a.dialog.find(".bootbox-body").html("<p>"+e.processor_message+"</p>")}},error:function(e,t){a.dialog.find(".bootbox-body").html("<p>Unexpected error: "+t+"</p>")}});return false}},cancel:{label:"Cancel",className:"btn-danger",callback:function(){return true}}},onShow:function(e){$.ajax({url:"ddproc.php",type:"POST",dataType:"json",timeout:6e4,data:{processor:"admin_helpers",op:"store_selector",do:"selector_get"},success:function(e){if(e.processor_success){a.dialog.find(".bootbox-body").html(e.form);a.dialog.find(".modal-footer > .backoffice_change_store-confirm").removeClass("disabled")}else{a.dialog.find(".bootbox-body").html("<p>"+e.processor_message+"</p>")}},error:function(e,t){a.dialog.find(".bootbox-body").html("<p>Unexpected error: "+t+"</p>")}})}});$(a.dialog).on("change","#change_store-selector",function(e){$(".backoffice_change_store-confirm").trigger("click")})});if(getQueryVariable("tab")){var e=getQueryVariable("tab");$("#"+e+"-tab").tab("show")}$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){e.target;e.relatedTarget;if($(e.target).data("urlpush")!==undefined&&$(e.target).data("urlpush")===true){if($(e.target).data("target")!==undefined){var t=$(e.target).data("target")}else{var t=$(e.target).attr("href")}var a=$(t).attr("id");new_query_string=setQueryString("tab",a);historyPush({url:new_query_string})}})});
//# sourceMappingURL=admin_global.min.js.map