{"version":3,"file":"emergency_main.min.js","names":["selected_session_id","view_session","manualSearchTypeChange","manualOrderSearchTypeChange","init_go_to_today","suppress_fastlane_labels","main_init","handle_agenda_click","handle_agenda_month_select","handle_session_tools","handle_go_to_today","handle_guest_search","handle_order_search","handle_preselection","handle_order_details_table","init_looping_timers","start_dashboard_snapshot_timer","start_unix_expiry_timer","register_booking_click_handlers","handle_booking_row_click","handle_booking_no_show","handle_platepoints_gifts","handle_food_testing_recipe","handle_pp_opted_out","handle_delayed_payment_tc","$","each","this","on","e","preventDefault","booking_id","data","order_id","hide","show","animate","scrollTop","offset","top","stop","ajax","url","type","timeout","dataType","processor","op","success","json","processor_success","html","order_details_table","getQueryVariable","update_page_url","store_id","STORE_DETAILS","id","user_id","USER_DETAILS","error","objAJAXRequest","strError","response","dd_message","title","message","level","gift_id","modal","confirm","status","dd_toast","giftDisplayString","doTimeout","handle_dashboard_update","unixtime","Math","round","Date","getTime","filter","hasClass","addClass","set_selected_date","new_date","new_date_parts","split","old_date_parts","selected_date","new_year_month","old_year_month","length","is","dashboard_date","dash_date","dashboard_metrics","removeClass","help_system_init","selected_agenda_month","val","doasync","async","agenda_date","session_info","date","scrollToTarget","lang","en","tc","terms_and_conditions","delayed_payment","noOk","buttons","Agree","remove","set_user_pref","Decline","delayed_payment_decline","window","booking_query","abort","PATH","image_admin","session_id","order_details","selected_menu_id","menu_id","session_start_dtf_ymd","update_session_tool_links","session_start_dtf_verbose_date","attention","session_start_dtf_time_only","session_details","publish_state_button_text","session_publish_state","booked_count","remaining_slots","remaining_intro_slots","booking_details","trigger","bounce","back_path","resend_dream_taste_notification","date_info","date_dtf_verbose_date","date_details","scrollTo","hover","page_url","historyPush","prop","bounce_to","state","checked","bid","selector_elem","survey_name","text","survey_id","survey_size","Confirm","Cancel","handle_guest_account_notes","do_op","guest_note","get_user_pref","textarea_elem","css","margin","width","height","guest_preferences","value","strip_tags","nl2br","handle_admin_carryover_notes","button_obj","hide_carryover_notes","do","note","user_data_value","handle_admin_order_notes","unique_id","buttonName","admin_note","handle_reschedule_button","cursor","create_and_submit_form","method","action","input","original_session_id","menus","back_address","handle_cancel_order","handle_delete_saved_order","location","href","doRefresh","processor_message","closeOnEscape","Refresh","validateKey","evt","charCode","keyCode","which","returnValue","validateAmount","obj","limit","isNaN","open","paymentList","order_notes","trim","div_id","event","ui","parent","find","OK","removeQueryVariable","totalStorage","new_state","open_close_submit","toggle","toggleClass","detect_order_search_type","page","search_type","all_stores","q","back","detect_guest_search_type","isNumeric","indexOf","go_to_today","date_select","get_todays_date","slice","undefined","todays_date","confirm_order_attended","points_this_order","fn","target","callback","elem","target_top","position","target_bottom","elem_top","elem_bottom","onAfter","jQuery"],"sourceRoot":"js/src/dreamdinners/admin","sources":["emergency_main.js"],"sourcesContent":["var selected_session_id, view_session, manualSearchTypeChange, manualOrderSearchTypeChange;\nvar init_go_to_today = false;\nvar suppress_fastlane_labels = false;\n\nfunction main_init()\n{\n\thandle_agenda_click();\n\n\thandle_agenda_month_select();\n\n\thandle_session_tools();\n\n\thandle_go_to_today();\n\n\thandle_guest_search();\n\n\thandle_order_search();\n\n\thandle_preselection();\n\n\thandle_order_details_table();\n\n\tinit_looping_timers();\n}\n\nfunction init_looping_timers()\n{\n\t// refreshes dashboard snapshot\n\tstart_dashboard_snapshot_timer();\n\n\t// greys out agenda days and session as the expire\n\tstart_unix_expiry_timer();\n}\n\nfunction register_booking_click_handlers()\n{\n\t// make it so you can highlight a guest row on click\n\thandle_booking_row_click();\n\n\t// register guest click handlers\n\t// no show checkbox\n\thandle_booking_no_show();\n\n\t// handle platepoints gift tools\n\thandle_platepoints_gifts();\n\n\t// handle food testing recipe assignment\n\thandle_food_testing_recipe();\n\n\t// handle opted out users\n\thandle_pp_opted_out();\n\n\t// handle showing order details\n\thandle_order_details_table();\n\n\t// handle delayed payment tc\n\thandle_delayed_payment_tc();\n}\n\nfunction handle_order_details_table()\n{\n\t$('[data-view_order_details]').each(function ()\n\t{\n\n\t\t// handle view order details\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\te.preventDefault();\n\n\t\t\tvar booking_id = $(this).data('booking_id');\n\t\t\tvar order_id = $(this).data('order_id');\n\n\t\t\t// hide existing open order\n\t\t\t$('.order_details_tbody').hide();\n\n\t\t\t// show this order\n\t\t\t$('#order_details_tbody_id_' + booking_id).show();\n\n\t\t\t// scroll to guest details\n\t\t\t$('html, body').animate({\n\n\t\t\t\tscrollTop: $('#guest_details_tbody_id_' + booking_id).offset().top - 40\n\n\t\t\t}, 500);\n\n\t\t\t// cancel scroll if user manually interrupts the scroll\n\t\t\t$('html, body').on('scroll mousedown DOMMouseScroll mousewheel keyup', function (e)\n\t\t\t{\n\n\t\t\t\t$('html, body').stop();\n\n\t\t\t});\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 60000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_fadmin_home_order_details',\n\t\t\t\t\top: 'order_details',\n\t\t\t\t\torder_id: order_id,\n\t\t\t\t\tbooking_id: booking_id\n\t\t\t\t},\n\t\t\t\tsuccess: function (json)\n\t\t\t\t{\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('#order_details_table_div_id_' + json.booking_id).html(json.order_details_table);\n\n\t\t\t\t\t\tif (getQueryVariable('session'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tupdate_page_url('?session=' + getQueryVariable('session') + '&order=' + json.order_id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (getQueryVariable('day'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tupdate_page_url('?day=' + getQueryVariable('day') + '&order=' + json.order_id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// get order history\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\n\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\top: 'get_history',\n\t\t\t\t\t\t\t\tuser_id: USER_DETAILS.id,\n\t\t\t\t\t\t\t\torder_id: order_id\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#order_history_div_id_' + json.booking_id).html(json.html);\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t\t// handle closing of order details\n\t\t$('.close_order_details_table').on('click', function (e)\n\t\t{\n\n\t\t\t$('#order_details_tbody_id_' + $(this).data('booking_id')).hide();\n\n\t\t\tif (getQueryVariable('session'))\n\t\t\t{\n\t\t\t\tupdate_page_url('?session=' + getQueryVariable('session'));\n\t\t\t}\n\t\t\telse if (getQueryVariable('day'))\n\t\t\t{\n\t\t\t\tupdate_page_url('?day=' + getQueryVariable('day'));\n\t\t\t}\n\n\t\t});\n\n\t});\n}\n\nfunction handle_platepoints_gifts()\n{\n\t$('[data-pp_gift_reward]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tuser_id = $(this).data('user_id');\n\t\t\tlevel = $(this).data('level');\n\t\t\tgift_id = $(this).data('gift_id');\n\n\t\t\tdd_message({\n\t\t\t\ttitle: 'Mark received confirmation',\n\t\t\t\tmessage: 'Are you sure you wish to mark the gift as received?',\n\t\t\t\tmodal: true,\n\t\t\t\tconfirm: function ()\n\t\t\t\t{\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tprocessor: 'plate_points_processor',\n\t\t\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\t\t\top: 'mark_gift_received',\n\t\t\t\t\t\t\tlevel: level,\n\t\t\t\t\t\t\tgift_id: gift_id\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function (json, status)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('[data-pp_gift_reward_div=' + json.user_id + ']').hide();\n\n\t\t\t\t\t\t\t\tdd_toast({'message': 'The guest has received their current level gift: ' + json.giftDisplayString});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\tmessage: 'There was a problem marking the gift as received.'\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n\n}\n\nfunction start_dashboard_snapshot_timer()\n{\n\t// cancel existing timer if there is one\n\t$.doTimeout('dashboard_snapshot_timer');\n\n\t// check every 2 minutes for dashboard updates\n\t$.doTimeout('dashboard_snapshot_timer', 120000, function ()\n\t{\n\n\t\thandle_dashboard_update();\n\n\t\treturn true;\n\n\t});\n\n\t// call it immediately\n\t// $.doTimeout('dashboard_snapshot_timer', true );\n}\nfunction start_unix_expiry_timer()\n{\n\t// cancel existing timer if there is one\n\t$.doTimeout('unix_expiry_timer');\n\n\t// check every minute and set agenda display is_past based on session/day expiry\n\t$.doTimeout('unix_expiry_timer', 60000, function ()\n\t{\n\n\t\tvar unixtime = Math.round(new Date().getTime() / 1000);\n\n\t\t$('[data-unix_expiry]').filter(function ()\n\t\t{\n\n\t\t\treturn $(this).data('unix_expiry') < unixtime && !$(this).hasClass('is_past');\n\n\t\t}).addClass('is_past');\n\n\t\treturn true;\n\n\t});\n\n\t// call it immediately\n\t$.doTimeout('unix_expiry_timer', true);\n}\n\nfunction set_selected_date(new_date)\n{\n\tnew_date_parts = new_date.split(\"-\");\n\told_date_parts = selected_date.split(\"-\");\n\n\tnew_year_month = new_date_parts[0] + '-' + new_date_parts[1];\n\told_year_month = old_date_parts[0] + '-' + old_date_parts[1];\n\n\tselected_date = new_date;\n\n\tif (new_year_month != old_year_month)\n\t{\n\t\thandle_dashboard_update();\n\t\treturn true;\n\t}\n\telse\n\t{\n\t\treturn false;\n\t}\n}\n\nfunction handle_dashboard_update()\n{\n\tif ($('#dashboard_snapshot_table_div').length && $('#dashboard_snapshot_container').is(\":visible\"))\n\t{\n\t\t// short timeout to prevent processing message from showing for normal cached load times\n\t\t$.doTimeout('dashboard_processing_timer', 1000, function ()\n\t\t{\n\n\t\t\t$('#dashboard_processing').show();\n\t\t\t$('#dashboard_snapshot_table').addClass('processing');\n\n\t\t});\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 60000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\top: 'dashboard_details',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\tdashboard_date: selected_date\n\t\t\t},\n\t\t\tsuccess: function (json)\n\t\t\t{\n\t\t\t\tif (json.processor_success)\n\t\t\t\t{\n\t\t\t\t\t$.doTimeout('dashboard_processing_timer');\n\t\t\t\t\t$('#ds_title_date').html(json.dash_date);\n\n\t\t\t\t\t$('#dashboard_snapshot_table_div').html(json.dashboard_metrics);\n\n\t\t\t\t\t$('#dashboard_snapshot_table').removeClass('processing');\n\t\t\t\t\t$('#dashboard_processing').hide();\n\t\t\t\t\thelp_system_init();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t{\n\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\thandle_dashboard_update();\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction handle_agenda_month_select()\n{\n\t$('#month_selector').on('change', function (e)\n\t{\n\n\t\tselected_agenda_month = $('#month_selector').val();\n\n\t\tdoasync = true;\n\t\tif (init_go_to_today)\n\t\t{\n\t\t\tdoasync = false;\n\t\t}\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\tasync: doasync,\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\top: 'agenda_details',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\tagenda_date: selected_agenda_month\n\t\t\t},\n\t\t\tsuccess: function (json)\n\t\t\t{\n\t\t\t\tif (json.processor_success)\n\t\t\t\t{\n\t\t\t\t\t$('#session_selector').html(json.session_info);\n\n\t\t\t\t\thandle_agenda_click();\n\n\t\t\t\t\tif (!init_go_to_today)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('#day_' + json.date).scrollToTarget($('#session_selector'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t{\n\t\t\t\tresponse = 'Unexpected error';\n\t\t\t}\n\t\t});\n\n\t});\n}\n\nfunction handle_delayed_payment_tc()\n{\n\t$('[data-delayed_payment_tc]').on('click', function (e)\n\t{\n\n\t\tvar user_id = $(this).data('delayed_payment_tc');\n\n\t\tdd_message({\n\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\tmessage: lang.en.tc.delayed_payment,\n\t\t\tmodal: true,\n\t\t\tnoOk: true,\n\t\t\tbuttons: {\n\t\t\t\t'Agree': function ()\n\t\t\t\t{\n\n\t\t\t\t\t$(this).remove();\n\n\t\t\t\t\t$('[data-delayed_payment_tc=\"' + user_id + '\"]').hide();\n\n\t\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 1, user_id);\n\n\t\t\t\t},\n\t\t\t\t'Decline': function ()\n\t\t\t\t{\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\t\t\t\tmessage: lang.en.tc.delayed_payment_decline\n\t\t\t\t\t});\n\n\t\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 0, user_id);\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t});\n}\n\nfunction handle_agenda_click()\n{\n\t$('#session_selection li').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tif (typeof window.booking_query != 'undefined')\n\t\t\t{\n\t\t\t\twindow.booking_query.abort();\n\t\t\t}\n\n\t\t\t$('.selected').removeClass('selected');\n\n\t\t\t$(this).addClass('selected');\n\t\t\t// cancel timeout\n\t\t\t$.doTimeout('booked_guests_table_timer');\n\n\t\t\t// if fetching guests takes longer than 1 second, show a loading message\n\t\t\t$.doTimeout('booked_guests_table_timer', 1000, function ()\n\t\t\t{\n\n\t\t\t\t$('#booked_guests_table').html('<img src=\"' + PATH.image_admin + '/style/throbber_circle.gif\" class=\"img_valign img_throbber_circle\" data-tooltip=\"Processing\" alt=\"Processing\" style=\"display: inline;\" /> Loading...');\n\n\t\t\t});\n\n\t\t\tif ($(this).data('session_id'))\n\t\t\t{\n\t\t\t\tview_session = true;\n\n\t\t\t\tselected_session_id = $(this).data('session_id');\n\n\t\t\t\twindow.booking_query = $.ajax({\n\t\t\t\t\turl: '/processor',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\ttimeout: 120000,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\t\top: 'session_details',\n\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\tsession_id: selected_session_id\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// if getting order details, show it after\n\t\t\t\t\t\t\tvar order_details = false;\n\t\t\t\t\t\t\t// only check if not switching between day and session view\n\t\t\t\t\t\t\tif (!getQueryVariable('day'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\torder_details = getQueryVariable('order');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// cancel timer\n\t\t\t\t\t\t\t$.doTimeout('booked_guests_table_timer');\n\t\t\t\t\t\t\tupdate_page_url('?session=' + json.session_info.id);\n\n\t\t\t\t\t\t\tselected_menu_id = json.session_info.menu_id;\n\t\t\t\t\t\t\tset_selected_date(json.session_info.session_start_dtf_ymd);\n\n\t\t\t\t\t\t\t// update session tools\n\t\t\t\t\t\t\tupdate_session_tool_links();\n\n\t\t\t\t\t\t\t// update title\n\t\t\t\t\t\t\t$('#selected_day').html(json.session_info.session_start_dtf_verbose_date);\n\t\t\t\t\t\t\t$('#selected_date_link').attention();\n\n\t\t\t\t\t\t\t// show title time\n\t\t\t\t\t\t\t$('#selected_session').html(' - ' + json.session_info.session_start_dtf_time_only);\n\t\t\t\t\t\t\t$('#selected_session').show();\n\n\t\t\t\t\t\t\t// Hide Day Details\n\t\t\t\t\t\t\t$('#day_details_container').hide();\n\n\t\t\t\t\t\t\t// fill session details container\n\t\t\t\t\t\t\t$('#session_details_table_div').html(json.session_details);\n\n\t\t\t\t\t\t\tvar publish_state_button_text = json.session_info.session_publish_state == 'PUBLISHED' ? 'Close Session' : 'Open Session';\n\t\t\t\t\t\t\t$('#sd_publish_state').data('session_publish_state', json.session_info.session_publish_state).html(publish_state_button_text);\n\t\t\t\t\t\t\t// update agenda display with new details in-case the state has changed since last load\n\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.attending').html(json.session_info.booked_count);\n\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.remaining').html(json.session_info.remaining_slots + '/' + (json.session_info.remaining_intro_slots > 0 ? json.session_info.remaining_intro_slots : 0));\n\n\t\t\t\t\t\t\tif (json.session_info.session_publish_state == 'PUBLISHED')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.time').removeClass('closed');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.time').addClass('closed');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// show session details container\n\t\t\t\t\t\t\t$('#session_details_container').show();\n\n\t\t\t\t\t\t\t// show guest list\n\t\t\t\t\t\t\t$('#booked_guests_table').html(json.booking_details);\n\n\t\t\t\t\t\t\t// register click handlers\n\t\t\t\t\t\t\tregister_booking_click_handlers();\n\n\t\t\t\t\t\t\t// show order details\n\t\t\t\t\t\t\tif (order_details)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('[data-view_order_details][data-order_id=\"' + order_details + '\"]').trigger('click');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// dream taste buttons\n\t\t\t\t\t\t\t$('#sd_invitation_pdf').on('click', function (e)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tbounce('/my-events?taste_event_pdf=' + selected_session_id + '&back=' + back_path(), '_blank');\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// fundraiser buttons\n\t\t\t\t\t\t\t$('#sd_fundraiser_invitation_pdf').on('click', function (e)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tbounce('/rsvp-fundraiser?event_pdf=' + selected_session_id + '&back=' + back_path(), '_blank');\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t$('#sd_resend_hostess_email').on('click', function (e)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tresend_dream_taste_notification();\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (strError != 'abort')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\tmessage: 'An unexpected error has occurred, error message: ' + strError + '. If you continue to experience this issue please contact support.'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tview_session = false;\n\n\t\t\t\tset_selected_date($(this).data('date'));\n\t\t\t\tselected_menu_id = $(this).data('menu_id');\n\n\t\t\t\twindow.booking_query = $.ajax({\n\t\t\t\t\turl: '/processor',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\ttimeout: 120000,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\t\top: 'date_details',\n\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\tdate: selected_date\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// if getting order details, show it after\n\t\t\t\t\t\t\tvar order_details = false;\n\t\t\t\t\t\t\t// only check if not switching between day and session view\n\t\t\t\t\t\t\tif (!getQueryVariable('session'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\torder_details = getQueryVariable('order');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// cancel timer\n\t\t\t\t\t\t\t$.doTimeout('booked_guests_table_timer');\n\t\t\t\t\t\t\tupdate_page_url('?day=' + selected_date);\n\n\t\t\t\t\t\t\t// update session tools\n\t\t\t\t\t\t\tupdate_session_tool_links();\n\n\t\t\t\t\t\t\t// update title\n\t\t\t\t\t\t\t$('#selected_day').html(json.date_info.date_dtf_verbose_date);\n\t\t\t\t\t\t\t$('#selected_date_link').attention();\n\n\t\t\t\t\t\t\t// Hide session specific details\n\t\t\t\t\t\t\t$('#session_details_container, #selected_session').hide();\n\n\t\t\t\t\t\t\t// show guest list\n\t\t\t\t\t\t\tif (json.booking_details.length)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#booked_guests_table').html(json.booking_details);\n\t\t\t\t\t\t\t\t// fill date details container\n\t\t\t\t\t\t\t\t$('#day_details_table_div').html(json.date_details);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#booked_guests_table').html('<div class=\"no_day_sessions\">No sessions for this day.</div>');\n\t\t\t\t\t\t\t\t// fill date details container\n\t\t\t\t\t\t\t\t$('#day_details_table_div').html('<div class=\"no_day_sessions\">No sessions for this day.</div>');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// show day details container\n\t\t\t\t\t\t\t$('#day_details_container').show();\n\n\t\t\t\t\t\t\t// register click handlers\n\t\t\t\t\t\t\tregister_booking_click_handlers();\n\n\t\t\t\t\t\t\t// show order details\n\t\t\t\t\t\t\tif (order_details)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('[data-view_order_details][data-order_id=\"' + order_details + '\"]').trigger('click');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// clicking session time will link to that session\n\t\t\t\t\t\t\t$('[id^=\"gd_title-\"]').on('click', function (e)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t$('#session-' + $(this).data('session_id')).scrollToTarget($('#session_selector'));\n\n\t\t\t\t\t\t\t\t$.scrollTo($('body'), 100);\n\n\t\t\t\t\t\t\t}).hover(function ()\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t$(this).addClass('hover');\n\n\t\t\t\t\t\t\t}, function ()\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t$(this).removeClass('hover');\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (strError != 'abort')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\tmessage: 'An unexpected error has occurred, error message: ' + strError + '. If you continue to experience this issue please contact support.'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t});\n\n\t});\n}\n\nfunction update_page_url(page_url)\n{\n\t// update url\n\thistoryPush({url: page_url});\n\t// update title link\n\t$('#selected_date_link').prop('href', page_url);\n}\n\nfunction handle_pp_opted_out()\n{\n\t$('.pp_opted_out').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\te.preventDefault();\n\n\t\t\tvar bounce_to = $(this).prop('href');\n\n\t\t\tdd_message({\n\t\t\t\ttitle: 'Guest has opted out',\n\t\t\t\tmessage: 'The guest has previously opted out, are you sure you wish to continue?',\n\t\t\t\tmodal: true,\n\t\t\t\tconfirm: function ()\n\t\t\t\t{\n\n\t\t\t\t\tbounce(bounce_to);\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\nfunction resend_dream_taste_notification()\n{\n\tdd_message({\n\t\ttitle: 'Send notice confirmation',\n\t\tmessage: 'Are you sure you wish to resend the host email notification?',\n\t\tmodal: true,\n\t\tconfirm: function ()\n\t\t{\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\top: 'resend_dream_taste_email',\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\tsession_id: selected_session_id\n\t\t\t\t},\n\t\t\t\tsuccess: function (json)\n\t\t\t\t{\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Send notice confirmation',\n\t\t\t\t\t\t\tmessage: 'Email notification has been resent to the session host.'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n\nfunction handle_booking_no_show()\n{\n\t$('[id^=\"gd_noshow-\"]').each(function (e)\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tvar state = this.checked ? 'yes' : 'no';\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_no_show_state',\n\t\t\t\t\tbid: $(this).data('booking_id'),\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\tstate: state\n\t\t\t\t},\n\t\t\t\tsuccess: function (json)\n\t\t\t\t{\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tresponse = 'Unexpected error';\n\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t});\n}\n\nfunction handle_food_testing_recipe()\n{\n\t$('[id^=\"food_testing-\"]').each(function (e)\n\t{\n\n\t\t$(this).on('change', function (e)\n\t\t{\n\n\t\t\tvar selector_elem = $(this);\n\t\t\tvar user_id = $(this).data('user_id');\n\t\t\tvar session_id = $(this).data('session_id');\n\t\t\tvar menu_id = $(this).data('menu_id');\n\t\t\tvar survey_name = $('option:selected', $(this)).text();\n\t\t\tvar survey_id = $(this).val().split(\"-\")[0];\n\t\t\tvar survey_size = $(this).val().split(\"-\")[1];\n\n\t\t\tif ($(this).val() == '0')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdd_message({\n\t\t\t\ttitle: 'Confirm',\n\t\t\t\tmessage: 'Are you sure you wish to assign <span style=\"font-weight: bold;\">' + survey_name + '</span> to this guest? The testing item is <span style=\"font-weight: bold;\">not</span> editable once assigend and the guest will immediately receive an email upon confirmation which will include testing instructions.',\n\t\t\t\tnoOk: true,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: {\n\t\t\t\t\t'Confirm': function ()\n\t\t\t\t\t{\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\t\t\t\top: 'assign_test_recipe',\n\t\t\t\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\t\t\t\tsession_id: session_id,\n\t\t\t\t\t\t\t\tmenu_id: menu_id,\n\t\t\t\t\t\t\t\tsurvey_id: survey_id,\n\t\t\t\t\t\t\t\tsurvey_size: survey_size\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$('[data-food_testing_select_user_id=\"' + json.user_id + '\"]').text(survey_name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(this).remove();\n\n\t\t\t\t\t},\n\t\t\t\t\t'Cancel': function ()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t$(selector_elem).val(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\nfunction handle_guest_account_notes()\n{\n\t$('[id^=\"gd_guest_account_note_button-\"]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tbooking_id = $(this).data('booking_id');\n\t\t\tuser_id = $(this).data('user_id');\n\t\t\tdo_op = 'get';\n\t\t\tguest_note = '';\n\n\t\t\tif ($(this).data('edit_mode') == true)\n\t\t\t{\n\t\t\t\tdo_op = 'save';\n\n\t\t\t\tguest_note = $('#gd_guest_account_note-' + booking_id + ' > textarea').val();\n\t\t\t}\n\n\t\t\tif (do_op == 'get')\n\t\t\t{\n\t\t\t\tget_user_pref('USER_ACCOUNT_NOTE', user_id, function (json)\n\t\t\t\t{\n\n\t\t\t\t\tvar textarea_elem = $('<textarea></textarea>').css({\n\t\t\t\t\t\t'margin': '0px',\n\t\t\t\t\t\t'width': '570px',\n\t\t\t\t\t\t'height': '80px'\n\t\t\t\t\t}).val((json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value ? json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value : \"\")).on('keyup', function (e)\n\t\t\t\t\t{\n\n\t\t\t\t\t\tif ($(this).val() != strip_tags($(this).val()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).val(strip_tags($(this).val()));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t\t$('#gd_guest_account_note-' + booking_id).addClass('guest_note_edit').html(textarea_elem);\n\n\t\t\t\t\t$('#gd_guest_account_note_button-' + booking_id).data('edit_mode', true).html('Save Note');\n\n\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).show();\n\n\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).data('user_data_value', (json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value ? json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value : \"\")).on('click', function (e)\n\t\t\t\t\t{\n\n\t\t\t\t\t\t$('#gd_guest_account_note-' + $(this).data('booking_id')).removeClass('guest_note_edit').html($(this).data('user_data_value'));\n\n\t\t\t\t\t\t$('#gd_guest_account_note_button-' + $(this).data('booking_id')).data('edit_mode', false).html('Account Notes');\n\n\t\t\t\t\t\t$(this).hide();\n\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Confirm',\n\t\t\t\t\tmessage: \"This note is viewable and editable by the guest in their preferences. Are you sure you wish to modify the guest's account note?\",\n\t\t\t\t\tnoOk: true,\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t'Confirm': function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).remove();\n\n\t\t\t\t\t\t\tset_user_pref('USER_ACCOUNT_NOTE', guest_note, user_id);\n\n\t\t\t\t\t\t\t$('#gd_guest_account_note-' + booking_id).removeClass('guest_note_edit').html(nl2br(guest_note));\n\n\t\t\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).hide();\n\n\t\t\t\t\t\t\t$('#gd_guest_account_note_button-' + booking_id).data('edit_mode', false).html('Account Notes');\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Cancel': function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\n\t});\n}\n\nfunction handle_admin_carryover_notes()\n{\n\t// handle button for stores that have hidden carryover notes\n\t$('[id^=\"gd_show_guest_note-\"]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tvar booking_id = $(this).data('booking_id');\n\n\t\t\tvar button_obj = this;\n\n\t\t\t$(button_obj).hide();\n\n\t\t\t$('#gd_guest_note-' + booking_id).show();\n\n\t\t\t$.doTimeout('show_guest_note_timer-' + booking_id, 10000, function ()\n\t\t\t{\n\n\t\t\t\t$(button_obj).show();\n\n\t\t\t\t$('#gd_guest_note-' + booking_id).hide();\n\n\t\t\t});\n\n\t\t});\n\n\t});\n\n\t$('[id^=\"gd_guest_note_button-\"]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\thide_carryover_notes = $(this).data('hide_carryover_notes');\n\n\t\t\tbooking_id = $(this).data('booking_id');\n\t\t\tuser_id = $(this).data('user_id');\n\t\t\tdo_op = 'get';\n\t\t\tguest_note = '';\n\n\t\t\tif ($(this).data('edit_mode') == true)\n\t\t\t{\n\t\t\t\tdo_op = 'save';\n\n\t\t\t\tguest_note = $('#gd_guest_note-' + booking_id + ' > textarea').val();\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\top: 'guest_carryover_note',\n\t\t\t\t\t'do': do_op,\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\tnote: guest_note\n\t\t\t\t},\n\t\t\t\tsuccess: function (json)\n\t\t\t\t{\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (do_op == 'get')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\n\t\t\t\t\t\t\t$.doTimeout('show_guest_note_timer-' + booking_id); //cancel timer\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).show(); // show notes\n\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).hide(); // hide button\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).addClass('guest_note_edit').html('<textarea style=\"margin: 0px; width: 570px; height: 80px;\">' + (json.guest_note.user_data_value ? json.guest_note.user_data_value : \"\") + '</textarea>');\n\n\t\t\t\t\t\t\t$('#gd_guest_note_button-' + booking_id).data('edit_mode', true).html('Save Note');\n\n\t\t\t\t\t\t\t$('#gd_guest_note_cancel_button-' + booking_id).data('user_data_value', (json.guest_note.user_data_value ? json.guest_note.user_data_value : \"\")).on('click', function (e)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\n\t\t\t\t\t\t\t\tif ($(this).data('hide_carryover_notes') === 1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).hide(); // hide notes\n\t\t\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).show(); // hide button\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$('#gd_guest_note-' + $(this).data('booking_id')).removeClass('guest_note_edit').html($(this).data('user_data_value'));\n\n\t\t\t\t\t\t\t\t$('#gd_guest_note_button-' + $(this).data('booking_id')).data('edit_mode', false).html('Admin Carryover');\n\n\t\t\t\t\t\t\t\t$(this).hide();\n\n\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\n\t\t\t\t\t\t\tif (hide_carryover_notes === 1 && json.guest_note.user_data_value)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).hide(); // hide notes\n\t\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).show(); // hide button\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).removeClass('guest_note_edit').html(nl2br(json.guest_note.user_data_value));\n\n\t\t\t\t\t\t\t$('#gd_guest_note_cancel_button-' + booking_id).hide();\n\n\t\t\t\t\t\t\t$('#gd_guest_note_button-' + booking_id).data('edit_mode', false).html('Admin Carryover');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\n\nfunction handle_admin_order_notes()\n{\n\t$('[id^=\"gd_admin_note_button-\"]').each(function () {\n\n\t\t$(this).on('click', function (e) {\n\n\t\t\tlet unique_id = $(this).data('uid');\n\t\t\tif(typeof unique_id == 'undefined' || unique_id == null || unique_id == ''){\n\t\t\t\tunique_id = '';\n\t\t\t}else{\n\t\t\t\tunique_id += '-';\n\t\t\t}\n\t\t\tlet buttonName = $(this).data('button_name');\n\t\t\tif(typeof buttonName == 'undefined' || buttonName == null || buttonName == ''){\n\t\t\t\tbuttonName = 'Admin Order Note';\n\t\t\t}\n\t\t\tbooking_id = $(this).data('booking_id');\n\t\t\torder_id = $(this).data('order_id');\n\t\t\tuser_id = $(this).data('user_id');\n\t\t\tdo_op = 'get';\n\t\t\tadmin_note = '';\n\n\t\t\tif ($(this).data('edit_mode') == true)\n\t\t\t{\n\t\t\t\tdo_op = 'save';\n\n\t\t\t\tadmin_note = $('#gd_admin_note-' + unique_id + booking_id + ' > textarea').val();\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\top: 'order_admin_note',\n\t\t\t\t\t'do': do_op,\n\t\t\t\t\torder_id: order_id,\n\t\t\t\t\tnote: admin_note\n\t\t\t\t},\n\t\t\t\tsuccess: function (json) {\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (do_op == 'get')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + booking_id).addClass('admin_note_edit').html('<textarea class=\"form-control\">' + (json.admin_note ? json.admin_note : \"\") + '</textarea>');\n\n\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + booking_id).data('edit_mode', true).html('Save Note');\n\n\t\t\t\t\t\t\t$('#gd_admin_note_cancel_button-' + unique_id + booking_id).data('admin_note_value', (json.admin_note ? json.admin_note : \"\")).on('click', function (e) {\n\n\t\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + $(this).data('booking_id')).removeClass('admin_note_edit').html($(this).data('admin_note_value'));\n\n\t\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + $(this).data('booking_id')).data('edit_mode', false).html(buttonName);\n\n\t\t\t\t\t\t\t\t$(this).hide();\n\n\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + booking_id).removeClass('admin_note_edit').html(nl2br(json.admin_note));\n\n\t\t\t\t\t\t\t$('.multi-populate-admin-note').each(function () {\n\t\t\t\t\t\t\t\t$(this).html(nl2br(json.admin_note));\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t$('#gd_admin_note_cancel_button-' + unique_id + booking_id).hide();\n\n\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + booking_id).data('edit_mode', false).html(buttonName);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\nfunction handle_reschedule_button()\n{\n\t$('[id^=\"gd_reschedule-\"]').each(function ()\n\t{\n\n\t\t$(this).css({'cursor': 'pointer'}).on('click', function (e)\n\t\t{\n\n\t\t\tcreate_and_submit_form({\n\t\t\t\tmethod: 'post',\n\t\t\t\taction: '/backoffice/reschedule',\n\t\t\t\tinput: ({\n\t\t\t\t\t'session_id': $(this).data('session_id'),\n\t\t\t\t\t'original_session_id': $(this).data('session_id'),\n\t\t\t\t\t'store_id': $(this).data('store_id'),\n\t\t\t\t\t'menus': $(this).data('menu_id'),\n\t\t\t\t\t'menu_id': $(this).data('menu_id'),\n\t\t\t\t\t'order_id': $(this).data('order_id'),\n\t\t\t\t\t'back_address': back_path()\n\t\t\t\t})\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\nfunction handle_booking_row_click()\n{\n\thandle_guest_account_notes();\n\n\thandle_admin_carryover_notes();\n\n\thandle_admin_order_notes();\n\n\thandle_reschedule_button();\n\n\t$('#booked_guests_table tbody.guest').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tif ($(this).hasClass('select_guest'))\n\t\t\t{\n\t\t\t\t$('.select_guest').removeClass('select_guest');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('.select_guest').removeClass('select_guest');\n\n\t\t\t\t$('#guest_details_tbody_id_' + $(this).data('booking_id')).addClass('select_guest');\n\t\t\t\t$('#order_details_tbody_id_' + $(this).data('booking_id')).addClass('select_guest');\n\t\t\t}\n\t\t\t$('[id^=\"gd_guest_menu-\"]').hide();\n\n\t\t\t$('#gd_guest_menu-' + $(this).data('user_id')).show();\n\n\t\t});\n\n\t});\n\n\t$('[id^=\"gd_guest-\"]').each(function ()\n\t{\n\n\t\tvar booking_id = $(this).data('booking_id');\n\n\t\t/*\n\t\t * Handle touch events under development\n\t\t * Aug 29, 2014\n\t\t * -- Ryan\n\t\t * ------------------- this -----VVV is a problem\n\t\t $('#gd_guest-' + booking_id +', #gd_guest_menu-' + booking_id).on({\n\t\t touchstart: function(e) {\n\n\t\t e.preventDefault();\n\n\t\t if ($('#gd_guest_menu-' + booking_id).is(':visible'))\n\t\t {\n\t\t $('#gd_guest_menu-' + booking_id).hide();\n\t\t }\n\t\t else\n\t\t {\n\t\t $('#gd_guest_menu-' + booking_id).show();\n\t\t }\n\n\t\t },\n\t\t touchend: function(e) {\n\n\t\t e.preventDefault();\n\n\t\t },\n\t\t mouseenter: function(e) {\n\n\t\t // cancel timeout\n\t\t $.doTimeout('guest_menu_timer_hide-' + booking_id);\n\n\t\t // short timeout to prevent menus from popping up when moused over\n\t\t $.doTimeout( 'guest_menu_timer_show-' + booking_id, 100, function() {\n\n\t\t $('#gd_guest_menu-' + booking_id).show();\n\n\t\t });\n\n\t\t },\n\t\t mouseleave: function(e) {\n\n\t\t // cancel timeout\n\t\t $.doTimeout('guest_menu_timer_show-' + booking_id);\n\n\t\t // short timeout to prevent menus from disappearing when moused away\n\t\t $.doTimeout( 'guest_menu_timer_hide-' + booking_id, 150, function() {\n\n\t\t $('#gd_guest_menu-' + booking_id).hide();\n\n\t\t });\n\n\t\t }\n\t\t });\n\t\t */\n\n\t\t$('#gd_guest-' + booking_id + ', #gd_guest_menu-' + booking_id).hover(function ()\n\t\t{\n\n\t\t\t// cancel timeout\n\t\t\t$.doTimeout('guest_menu_timer_hide-' + booking_id);\n\n\t\t\t// short timeout to prevent menus from popping up when moused over\n\t\t\t$.doTimeout('guest_menu_timer_show-' + booking_id, 100, function ()\n\t\t\t{\n\n\t\t\t\t$('#gd_guest_menu-' + booking_id).show();\n\n\t\t\t});\n\n\t\t}, function ()\n\t\t{\n\n\t\t\t// cancel timeout\n\t\t\t$.doTimeout('guest_menu_timer_show-' + booking_id);\n\n\t\t\t// short timeout to prevent menus from disappearing when moused away\n\t\t\t$.doTimeout('guest_menu_timer_hide-' + booking_id, 150, function ()\n\t\t\t{\n\n\t\t\t\t$('#gd_guest_menu-' + booking_id).hide();\n\n\t\t\t});\n\n\t\t});\n\n\t});\n\n\thandle_cancel_order();\n\thandle_delete_saved_order();\n}\n\nfunction handle_delete_saved_order()\n{\n\t$('[id^=\"gd_delete_order-\"]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tvar session_id = $(this).data('session_id');\n\t\t\tvar order_id = $(this).data('order_id');\n\t\t\tvar store_id = $(this).data('store_id');\n\t\t\tvar user_id = $(this).data('user_id');\n\t\t\tvar bounce_to = $(this).data('bounce');\n\n\t\t\tdd_message({\n\t\t\t\ttitle: 'Confirm Delete Saved Order',\n\t\t\t\tmessage: \"Are you sure you want to delete this saved order?\",\n\t\t\t\tconfirm: function ()\n\t\t\t\t{\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\n\t\t\t\t\t\t\tstore_id: store_id,\n\t\t\t\t\t\t\top: 'delete_saved_order',\n\t\t\t\t\t\t\tsession_id: session_id,\n\t\t\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\t\t\torder_id: order_id\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (typeof bounce_to == 'undefined' || bounce_to == \"\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tbounce_to = window.location.href;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbounce(bounce_to);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tif (json.doRefresh == true)\n\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\ttitle: 'Problem Deleting Saved Order',\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message,\n\t\t\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\n\t\t\t\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t\t\t\t'Refresh': function ()\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t\t\t\t\tbounce(window.location.href);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\n\t});\n\n}\n\nfunction validateKey(evt)\n{\n\tevt = (evt) ? evt : ((event) ? event : null);\n\tif (evt)\n\t{\n\t\tvar charCode = (evt.charCode || evt.charCode == 0) ? evt.charCode : ((evt.keyCode) ? evt.keyCode : evt.which);\n\n\t\tif (charCode > 13 && (charCode < 48 || charCode > 57))\n\t\t{\n\t\t\t//alert(\"Only whole numbers are allowed.\");\n\t\t\tif (charCode == 46)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (evt.returnValue)\n\t\t\t{\n\t\t\t\tevt.returnValue = false;\n\t\t\t}\n\t\t\telse if (evt.preventDefault)\n\t\t\t{\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction validateAmount(obj, limit)\n{\n\tif (isNaN(obj.value))\n\t{\n\t\tobj.value = 0.00;\n\t}\n\n\tif (obj.value > limit)\n\t{\n\t\tobj.value = limit;\n\t}\n}\n\nfunction handle_cancel_order()\n{\n\t$('[id^=\"gd_cancel_order-\"]').each(function ()\n\t{\n\n\t\t$(this).on('click', function (e)\n\t\t{\n\n\t\t\tvar booking_id = $(this).data('booking_id');\n\t\t\tvar session_id = $(this).data('session_id');\n\t\t\tvar order_id = $(this).data('order_id');\n\t\t\tvar store_id = $(this).data('store_id');\n\t\t\tvar user_id = $(this).data('user_id');\n\t\t\tvar bounce_to = $(this).data('bounce');\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\n\t\t\t\t\top: 'cancel_preflight',\n\t\t\t\t\tstore_id: store_id,\n\t\t\t\t\tsession_id: session_id,\n\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\torder_id: order_id\n\t\t\t\t},\n\t\t\t\tsuccess: function (json, status)\n\t\t\t\t{\n\t\t\t\t\tif (json.processor_success && json.data)\n\t\t\t\t\t{\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Cancel Order?',\n\t\t\t\t\t\t\tmessage: json.data,\n\t\t\t\t\t\t\twidth: 700,\n\t\t\t\t\t\t\theight: 400,\n\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\topen: function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$(\"#order_admin_notes_cancel\").on('keyup', function (e)\n\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\tif ($(this).val() != strip_tags($(this).val()))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t$(this).val(strip_tags($(this).val()));\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tconfirm: function (json, status)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\tvar paymentList = {};\n\t\t\t\t\t\t\t\t$(\"#cancel_parent :input\").each(function ()\n\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\tpaymentList[this.id] = $(this).val();\n\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tvar order_notes = $(\"#order_admin_notes_cancel\").val().trim();\n\n\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\ttitle: 'Cancelling order',\n\t\t\t\t\t\t\t\t\tmessage: '<img src=\"' + PATH.image_admin + '/style/throbber_circle.gif\" class=\"img_valign\" alt=\"Processing\" /> Processing order cancellation...',\n\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\n\t\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\n\t\t\t\t\t\t\t\t\topen: function (event, ui)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\n\t\t\t\t\t\t\t\t\t\top: 'cancel',\n\t\t\t\t\t\t\t\t\t\tstore_id: store_id,\n\t\t\t\t\t\t\t\t\t\tsession_id: session_id,\n\t\t\t\t\t\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\t\t\t\t\t\torder_id: order_id,\n\t\t\t\t\t\t\t\t\t\tpaymentList: paymentList,\n\t\t\t\t\t\t\t\t\t\torder_notes: order_notes\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Order was Canceled',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.data,\n\t\t\t\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\n\t\t\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\n\t\t\t\t\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\t\t\t\t\t\topen: function (event, ui)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"OK\": function ()\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (typeof bounce_to != 'undefined')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbounce(bounce_to);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbounce(removeQueryVariable('order', window.location.href));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\tmessage: response\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t});\n\n\t});\n}\n\nfunction handle_session_tools()\n{\n\t// session tool suppress fastlane cookie\n\tif ($.totalStorage('suppress_fastlane_labels') != null)\n\t{\n\t\tsuppress_fastlane_labels = $.totalStorage('suppress_fastlane_labels');\n\t\t$('#suppress_fastlane_labels').prop('checked', !suppress_fastlane_labels);\n\n\t}\n\n\t// session tool suppress fastlane click\n\t$('#suppress_fastlane_labels').on('click', function (e)\n\t{\n\n\t\tif ($(this).is(':checked'))\n\t\t{\n\t\t\t$.totalStorage('suppress_fastlane_labels', false);\n\t\t\tsuppress_fastlane_labels = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$.totalStorage('suppress_fastlane_labels', true);\n\t\t\tsuppress_fastlane_labels = true;\n\t\t}\n\n\t\tupdate_session_tool_links();\n\n\t});\n\t// Dashboard Snapshot\n\t$('#ds_goal_tracking').on('click', function (e)\n\t{\n\n\t\tbounce('/backoffice/reports_goal_management_v2?date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path());\n\n\t});\n\n\t$('#ds_trending').on('click', function (e)\n\t{\n\n\t\tbounce('/backoffice/reports_trending_menu_based?date=' + selected_date + '&store=' + STORE_DETAILS.id + '&back=' + back_path());\n\n\t});\n\n\t$('#ds_dashboard').on('click', function (e)\n\t{\n\n\t\tbounce('/backoffice/dashboard-menu-based?override_month=' + selected_date + '&store=' + STORE_DETAILS.id + '&back=' + back_path());\n\n\t});\n\n\t// Session Controls\n\t$('#sd_edit_session').on('click', function (e)\n\t{\n\n\t\tif (view_session == true)\n\t\t{\n\t\t\tbounce('/backoffice/edit-session?session=' + selected_session_id + '&back=' + back_path());\n\t\t}\n\n\t});\n\t// Session Controls\n\t$('#sd_email_session').on('click', function (e)\n\t{\n\n\t\tif (view_session == true)\n\t\t{\n\t\t\tbounce('/backoffice/email?session=' + selected_session_id + '&back=' + back_path());\n\t\t}\n\n\t});\n\n\t$('#sd_publish_state').on('click', function (e)\n\t{\n\n\t\tif (view_session == true)\n\t\t{\n\t\t\tstate = $(this).data('session_publish_state');\n\n\t\t\tif (state == 'PUBLISHED')\n\t\t\t{\n\t\t\t\tnew_state = 'Close';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnew_state = 'Open';\n\t\t\t}\n\n\t\t\tdd_message({\n\t\t\t\ttitle: new_state + ' session confirmation',\n\t\t\t\tmessage: 'Are you sure you wish to <span style=\"font-weight: bold;\">' + new_state + '</span> this session?',\n\t\t\t\tmodal: true,\n\t\t\t\tconfirm: function ()\n\t\t\t\t{\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\n\t\t\t\t\t\t\top: 'session_publish_state',\n\t\t\t\t\t\t\tsession_id: selected_session_id,\n\t\t\t\t\t\t\topen_close_submit: new_state\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function (json)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id).scrollToTarget($('#session_selector'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t});\n\t// Session Controls\n\t$('#sd_session_meta').on('click', function (e)\n\t{\n\n\t\t$('.session_meta').toggle();\n\n\t\t$('#session_details_text').toggleClass('session_details_text');\n\n\t});\n\n\t// Day Controls\n\t$('#dd_create_session').on('click', function (e)\n\t{\n\n\t\tif (view_session != true)\n\t\t{\n\t\t\tbounce('/backoffice/create-session?date=' + selected_date + '&menu=' + selected_menu_id + '&back=' + back_path());\n\t\t}\n\n\t});\n\n}\n\nfunction update_session_tool_links()\n{\n\tif (view_session == true)\n\t{\n\t\t$('#st_customer_receipt').prop('href', '/backoffice/order-details-view-all?customer_print_view=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_franchise_receipt').prop('href', '/backoffice/order-details-view-all?session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_entree_summary').prop('href', '/backoffice/reports_select_multi_session?query_submit=1&report_id=2&printer=1&pickSession=2&session_id=' + selected_session_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_side_dish_report').prop('href', '/backoffice/order-details-view-all?issidedish=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_fast_lane_report').prop('href', '/backoffice/order-details-view-all?ispreassembled=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_dream_rewards').prop('href', '/backoffice/reports_dream_rewards_for_session?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_future_orders').prop('href', '/backoffice/order-details-view-all_future?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_session_goal_sheet_print').prop('href', '/backoffice/reports_goal_tracking?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&print=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_session_goal_sheet_xls').prop('href', '/backoffice/reports_goal_tracking?export=xlsx&hideheaders=true&csvfilename=SessionGoalSheet&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&back=' + back_path());\n\t\t$('#st_print_labels').prop('href', '/backoffice/reports_customer_menu_item_labels?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_labels_w_breaks').prop('href', '/backoffice/reports_customer_menu_item_labels?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&break=1&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_labels_by_dinner').prop('href', '/backoffice/reports_customer_menu_item_labels?session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&order_by=dinner&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_enrollment_forms').prop('href', '/backoffice/user_plate_points?session_id=' + selected_session_id + '&print_sessions_forms=true').prop('target', '_blank');\n\t\t$('#st_plate_points_status_and_rewards_report').prop('href', '/backoffice/reports_points_status_and_rewards?session_id=' + selected_session_id + '&back=' + back_path());\n\t\t$('#st_customer_menu_core').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_current').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&cur=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_freezer').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&freezer=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_nutrition').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&nutrition=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_freezer').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_freezer_nutrition').prop('href', '/backoffice/session-tools-printing?do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&nutrition=true&back=' + back_path()).prop('target', '_blank');\n\t}\n\telse\n\t{\n\t\t$('#st_customer_receipt').prop('href', '/backoffice/order-details-view-all_multi?customer_print_view=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_franchise_receipt').prop('href', '/backoffice/order-details-view-all_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_entree_summary').prop('href', '/backoffice/reports_select_multi_session?query_submit=1&report_date=' + selected_date + '&report_id=1&printer=1&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_side_dish_report').prop('href', '/backoffice/order-details-view-all_multi?issidedish=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_fast_lane_report').prop('href', '/backoffice/order-details-view-all_multi?ispreassembled=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_dream_rewards').prop('href', '/backoffice/reports_dream_rewards_for_session_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_future_orders').prop('href', '/backoffice/order-details-view-all_future_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_session_goal_sheet_print').prop('href', '/backoffice/reports_goal_tracking?multi_session=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&print=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_session_goal_sheet_xls').prop('href', '/backoffice/reports_goal_tracking?export=xlsx&hideheaders=true&csvfilename=SessionGoalSheetSummary&multi_session=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&back=' + back_path());\n\t\t$('#st_print_labels').prop('href', '/backoffice/reports_customer_menu_item_labels_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_labels_w_breaks').prop('href', '/backoffice/reports_customer_menu_item_labels_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&break=1&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_labels_by_dinner').prop('href', '/backoffice/reports_customer_menu_item_labels_multi?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&order_by=dinner&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\n\t\t$('#st_print_enrollment_forms').prop('href', '/backoffice/user_plate_points?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&print_days_forms=true').prop('target', '_blank');\n\t\t$('#st_plate_points_status_and_rewards_report').prop('href', '/backoffice/reports_points_status_and_rewards?report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path());\n\t\t$('#st_customer_menu_core').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_current').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&cur=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_freezer').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&freezer=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_nutrition').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&nutrition=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_freezer').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&back=' + back_path()).prop('target', '_blank');\n\t\t$('#st_customer_menu_core_freezer_nutrition').prop('href', '/backoffice/session-tools-printing?do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&nutrition=true&back=' + back_path()).prop('target', '_blank');\n\t}\n\n\t$('#st_finishing_touch_pick_sheet').prop('href', '/backoffice/finishing-touch-printable-form?store_id=' + STORE_DETAILS.id + '&menu_id=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n\t$('#st_print_generic_labels').prop('href', '/backoffice/reports_customer_menu_item_labels?store_id=' + STORE_DETAILS.id + '&interface=1&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\n}\n\nfunction handle_order_search()\n{\n\t$('#os_search_go').on('click', function (e)\n\t{\n\n\t\tvar order_id = $('#os_search_value').val().trim();\n\n\t\tbounce('/backoffice/order-mgr-thankyou?order=' + order_id);\n\n\t});\n\n\t$('#os_search_type').on('change', function (e)\n\t{\n\n\t\tmanualOrderSearchTypeChange = true;\n\n\t});\n\n\t$('#os_search_value').on('keyup', function (e)\n\t{\n\n\t\tif (e.which == 13)\n\t\t{\n\t\t\t$('#os_search_go').trigger('click');\n\t\t}\n\n\t\tdetect_order_search_type();\n\n\t});\n\n}\n\nfunction handle_guest_search()\n{\n\t$('#gs_search_go').on('click', function (e)\n\t{\n\n\t\tcreate_and_submit_form({\n\t\t\tmethod: 'get',\n\t\t\taction: '/',\n\t\t\tinput: ({\n\t\t\t\t'page': 'admin_list_users',\n\t\t\t\t'search_type': $('#gs_search_type').val(),\n\t\t\t\t'all_stores': ($('#gs_search_all').is(':checked') ? 1 : 0),\n\t\t\t\t'q': $('#gs_search_value').val(),\n\t\t\t\t'back': back_path()\n\t\t\t})\n\t\t});\n\n\t});\n\n\t$('#gs_search_type').on('change', function (e)\n\t{\n\n\t\tmanualSearchTypeChange = true;\n\n\t});\n\n\t$('#gs_search_value').on('keyup', function (e)\n\t{\n\n\t\tif (e.which == 13)\n\t\t{\n\t\t\t$('#gs_search_go').trigger('click');\n\t\t}\n\n\t\tdetect_guest_search_type();\n\n\t});\n\n}\n\nfunction detect_order_search_type()\n{\n\t// user manually changed search type, don't automatically change it\n\tif (manualOrderSearchTypeChange == true)\n\t{\n\t\treturn;\n\t}\n\n\tvar value = $('#os_search_value').val();\n\n\t// not numeric entry, start with last name\n\tif (!$.isNumeric(value))\n\t{\n\t\t$('#os_search_type').val('confirmation');\n\t}\n\n\t// numeric entry, probably guest id\n\tif ($.isNumeric(value))\n\t{\n\t\t$('#os_search_type').val('id');\n\t}\n\n}\n\nfunction detect_guest_search_type()\n{\n\t// user manually changed search type, don't automatically change it\n\tif (manualSearchTypeChange == true)\n\t{\n\t\treturn;\n\t}\n\n\tvar value = $('#gs_search_value').val();\n\n\t// not numeric entry, start with last name\n\tif (!$.isNumeric(value))\n\t{\n\t\t$('#gs_search_type').val('lastname');\n\t}\n\n\t// numeric entry, probably guest id\n\tif ($.isNumeric(value))\n\t{\n\t\t$('#gs_search_type').val('id');\n\t}\n\n\t// has @ symbol, probably email\n\tif (value.indexOf(\"@\") != -1)\n\t{\n\t\t$('#gs_search_type').val('email');\n\t}\n\n\t// has space, probably first and last name\n\tif (value.indexOf(\" \") != -1)\n\t{\n\t\t$('#gs_search_type').val('firstlast');\n\t}\n}\n\nfunction handle_go_to_today()\n{\n\t$('#go_to_today').on('click', function (e)\n\t{\n\n\t\tgo_to_today();\n\n\t});\n}\n\nfunction go_to_today()\n{\n\tinit_go_to_today = true;\n\n\tdate_select = get_todays_date().slice(0, -3);\n\n\tif (selected_agenda_month != undefined && selected_agenda_month != date_select)\n\t{\n\t\tlet val = $(\"#month_selector option[data-menu_month='\"+date_select+\"']\").val();\n\t\t$('#month_selector').val(val).trigger('change');\n\t}\n\n\t$('.selected').removeClass('selected');\n\n\tvar todays_date = get_todays_date();\n\n\t$('#day_' + todays_date).scrollToTarget($('#session_selector')).addClass('selected');\n\n\tinit_go_to_today = false;\n}\n\nfunction handle_preselection()\n{\n\tif (getQueryVariable('session') && $('#session-' + getQueryVariable('session')).length)\n\t{\n\t\t$('#session-' + getQueryVariable('session')).scrollToTarget($('#session_selector'));\n\t}\n\telse if (getQueryVariable('day') && $('#day_' + getQueryVariable('day')).length)\n\t{\n\t\t$('#day_' + getQueryVariable('day')).scrollToTarget($('#session_selector'));\n\t}\n\telse\n\t{\n\t\tgo_to_today();\n\t}\n}\n\nfunction confirm_order_attended(user_id, order_id)\n{\n\t$.ajax({\n\t\turl: '/processor',\n\t\ttype: 'POST',\n\t\ttimeout: 20000,\n\t\tdataType: 'json',\n\t\tdata: {\n\t\t\tprocessor: 'plate_points_processor',\n\t\t\tuser_id: user_id,\n\t\t\top: 'confirm_order',\n\t\t\torder_id: order_id\n\t\t},\n\t\tsuccess: function (json)\n\t\t{\n\t\t\tif (json.processor_success)\n\t\t\t{\n\t\t\t\t$(\"[id^=pp_co_\" + user_id + \"_\" + order_id + \"]\").html(json.points_this_order);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t});\n\n\t\t\t}\n\t\t},\n\t\terror: function (objAJAXRequest, strError)\n\t\t{\n\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t}\n\n\t});\n}\n\n// jquery plugins\n(function ($)\n{\n\n\t//create jquery scrollToTarget method\n\t$.fn.scrollToTarget = function (target, callback)\n\t{\n\t\tvar elem = $(this);\n\n\t\tif (elem.length)\n\t\t{\n\t\t\tvar target_top = $(target).position().top;\n\t\t\tvar target_bottom = target_top + $(target).height();\n\n\t\t\tvar elem_top = $(elem).position().top;\n\t\t\tvar elem_bottom = elem_top + $(elem).height();\n\n\t\t\t// only scroll if element is out of bounds\n\t\t\tif ((elem_top > target_top && elem_bottom < target_bottom) || (elem_top < target_top && elem_bottom > target_bottom))\n\t\t\t{\n\t\t\t\telem.trigger('click');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttarget.scrollTo(\n\t\t\t\t\tthis,\n\t\t\t\t\t800,\n\t\t\t\t\t{\n\t\t\t\t\t\toffset: -25,\n\t\t\t\t\t\tonAfter: function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telem.trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn elem;\n\t};\n\n})(jQuery);"],"mappings":"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"}