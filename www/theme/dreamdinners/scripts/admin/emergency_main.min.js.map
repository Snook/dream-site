{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["emergency_main.js"],"sourcesContent":["var selected_session_id, view_session, manualSearchTypeChange, manualOrderSearchTypeChange;\r\nvar init_go_to_today = false;\r\nvar suppress_fastlane_labels = false;\r\n\r\nfunction main_init()\r\n{\r\n\thandle_agenda_click();\r\n\r\n\thandle_agenda_month_select();\r\n\r\n\thandle_session_tools();\r\n\r\n\thandle_go_to_today();\r\n\r\n\thandle_guest_search();\r\n\r\n\thandle_order_search();\r\n\r\n\thandle_preselection();\r\n\r\n\thandle_order_details_table();\r\n\r\n\tinit_looping_timers();\r\n}\r\n\r\nfunction init_looping_timers()\r\n{\r\n\t// refreshes dashboard snapshot\r\n\tstart_dashboard_snapshot_timer();\r\n\r\n\t// greys out agenda days and session as the expire\r\n\tstart_unix_expiry_timer();\r\n}\r\n\r\nfunction register_booking_click_handlers()\r\n{\r\n\t// make it so you can highlight a guest row on click\r\n\thandle_booking_row_click();\r\n\r\n\t// register guest click handlers\r\n\t// no show checkbox\r\n\thandle_booking_no_show();\r\n\r\n\t// handle platepoints gift tools\r\n\thandle_platepoints_gifts();\r\n\r\n\t// handle food testing recipe assignment\r\n\thandle_food_testing_recipe();\r\n\r\n\t// handle opted out users\r\n\thandle_pp_opted_out();\r\n\r\n\t// handle showing order details\r\n\thandle_order_details_table();\r\n\r\n\t// handle delayed payment tc\r\n\thandle_delayed_payment_tc();\r\n}\r\n\r\nfunction handle_order_details_table()\r\n{\r\n\t$('[data-view_order_details]').each(function ()\r\n\t{\r\n\r\n\t\t// handle view order details\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tvar booking_id = $(this).data('booking_id');\r\n\t\t\tvar order_id = $(this).data('order_id');\r\n\r\n\t\t\t// hide existing open order\r\n\t\t\t$('.order_details_tbody').hide();\r\n\r\n\t\t\t// show this order\r\n\t\t\t$('#order_details_tbody_id_' + booking_id).show();\r\n\r\n\t\t\t// scroll to guest details\r\n\t\t\t$('html, body').animate({\r\n\r\n\t\t\t\tscrollTop: $('#guest_details_tbody_id_' + booking_id).offset().top - 40\r\n\r\n\t\t\t}, 500);\r\n\r\n\t\t\t// cancel scroll if user manually interrupts the scroll\r\n\t\t\t$('html, body').on('scroll mousedown DOMMouseScroll mousewheel keyup', function (e)\r\n\t\t\t{\r\n\r\n\t\t\t\t$('html, body').stop();\r\n\r\n\t\t\t});\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 60000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_fadmin_home_order_details',\r\n\t\t\t\t\top: 'order_details',\r\n\t\t\t\t\torder_id: order_id,\r\n\t\t\t\t\tbooking_id: booking_id\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('#order_details_table_div_id_' + json.booking_id).html(json.order_details_table);\r\n\r\n\t\t\t\t\t\tif (getQueryVariable('session'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&session=' + getQueryVariable('session') + '&order=' + json.order_id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (getQueryVariable('day'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&day=' + getQueryVariable('day') + '&order=' + json.order_id);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// get order history\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\r\n\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\t\t\t\top: 'get_history',\r\n\t\t\t\t\t\t\t\tuser_id: USER_DETAILS.id,\r\n\t\t\t\t\t\t\t\torder_id: order_id\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#order_history_div_id_' + json.booking_id).html(json.html);\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t// handle closing of order details\r\n\t\t$('.close_order_details_table').on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\t$('#order_details_tbody_id_' + $(this).data('booking_id')).hide();\r\n\r\n\t\t\tif (getQueryVariable('session'))\r\n\t\t\t{\r\n\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&session=' + getQueryVariable('session'));\r\n\t\t\t}\r\n\t\t\telse if (getQueryVariable('day'))\r\n\t\t\t{\r\n\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&day=' + getQueryVariable('day'));\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_platepoints_gifts()\r\n{\r\n\t$('[data-pp_gift_reward]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tuser_id = $(this).data('user_id');\r\n\t\t\tlevel = $(this).data('level');\r\n\t\t\tgift_id = $(this).data('gift_id');\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Mark received confirmation',\r\n\t\t\t\tmessage: 'Are you sure you wish to mark the gift as received?',\r\n\t\t\t\tmodal: true,\r\n\t\t\t\tconfirm: function ()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'plate_points_processor',\r\n\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\top: 'mark_gift_received',\r\n\t\t\t\t\t\t\tlevel: level,\r\n\t\t\t\t\t\t\tgift_id: gift_id\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json, status)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-pp_gift_reward_div=' + json.user_id + ']').hide();\r\n\r\n\t\t\t\t\t\t\t\tdd_toast({'message': 'The guest has received their current level gift: ' + json.giftDisplayString});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\tmessage: 'There was a problem marking the gift as received.'\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction start_dashboard_snapshot_timer()\r\n{\r\n\t// cancel existing timer if there is one\r\n\t$.doTimeout('dashboard_snapshot_timer');\r\n\r\n\t// check every 2 minutes for dashboard updates\r\n\t$.doTimeout('dashboard_snapshot_timer', 120000, function ()\r\n\t{\r\n\r\n\t\thandle_dashboard_update();\r\n\r\n\t\treturn true;\r\n\r\n\t});\r\n\r\n\t// call it immediately\r\n\t// $.doTimeout('dashboard_snapshot_timer', true );\r\n}\r\nfunction start_unix_expiry_timer()\r\n{\r\n\t// cancel existing timer if there is one\r\n\t$.doTimeout('unix_expiry_timer');\r\n\r\n\t// check every minute and set agenda display is_past based on session/day expiry\r\n\t$.doTimeout('unix_expiry_timer', 60000, function ()\r\n\t{\r\n\r\n\t\tvar unixtime = Math.round(new Date().getTime() / 1000);\r\n\r\n\t\t$('[data-unix_expiry]').filter(function ()\r\n\t\t{\r\n\r\n\t\t\treturn $(this).data('unix_expiry') < unixtime && !$(this).hasClass('is_past');\r\n\r\n\t\t}).addClass('is_past');\r\n\r\n\t\treturn true;\r\n\r\n\t});\r\n\r\n\t// call it immediately\r\n\t$.doTimeout('unix_expiry_timer', true);\r\n}\r\n\r\nfunction set_selected_date(new_date)\r\n{\r\n\tnew_date_parts = new_date.split(\"-\");\r\n\told_date_parts = selected_date.split(\"-\");\r\n\r\n\tnew_year_month = new_date_parts[0] + '-' + new_date_parts[1];\r\n\told_year_month = old_date_parts[0] + '-' + old_date_parts[1];\r\n\r\n\tselected_date = new_date;\r\n\r\n\tif (new_year_month != old_year_month)\r\n\t{\r\n\t\thandle_dashboard_update();\r\n\t\treturn true;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction handle_dashboard_update()\r\n{\r\n\tif ($('#dashboard_snapshot_table_div').length && $('#dashboard_snapshot_container').is(\":visible\"))\r\n\t{\r\n\t\t// short timeout to prevent processing message from showing for normal cached load times\r\n\t\t$.doTimeout('dashboard_processing_timer', 1000, function ()\r\n\t\t{\r\n\r\n\t\t\t$('#dashboard_processing').show();\r\n\t\t\t$('#dashboard_snapshot_table').addClass('processing');\r\n\r\n\t\t});\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 60000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\top: 'dashboard_details',\r\n\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\tdashboard_date: selected_date\r\n\t\t\t},\r\n\t\t\tsuccess: function (json)\r\n\t\t\t{\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.doTimeout('dashboard_processing_timer');\r\n\t\t\t\t\t$('#ds_title_date').html(json.dash_date);\r\n\r\n\t\t\t\t\t$('#dashboard_snapshot_table_div').html(json.dashboard_metrics);\r\n\r\n\t\t\t\t\t$('#dashboard_snapshot_table').removeClass('processing');\r\n\t\t\t\t\t$('#dashboard_processing').hide();\r\n\t\t\t\t\thelp_system_init();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t{\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\thandle_dashboard_update();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction handle_agenda_month_select()\r\n{\r\n\t$('#month_selector').on('change', function (e)\r\n\t{\r\n\r\n\t\tselected_agenda_month = $('#month_selector').val();\r\n\r\n\t\tdoasync = true;\r\n\t\tif (init_go_to_today)\r\n\t\t{\r\n\t\t\tdoasync = false;\r\n\t\t}\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\tasync: doasync,\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\top: 'agenda_details',\r\n\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\tagenda_date: selected_agenda_month\r\n\t\t\t},\r\n\t\t\tsuccess: function (json)\r\n\t\t\t{\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#session_selector').html(json.session_info);\r\n\r\n\t\t\t\t\thandle_agenda_click();\r\n\r\n\t\t\t\t\tif (!init_go_to_today)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('#day_' + json.date).scrollToTarget($('#session_selector'));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t{\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_delayed_payment_tc()\r\n{\r\n\t$('[data-delayed_payment_tc]').on('click', function (e)\r\n\t{\r\n\r\n\t\tvar user_id = $(this).data('delayed_payment_tc');\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: lang.en.tc.terms_and_conditions,\r\n\t\t\tmessage: lang.en.tc.delayed_payment,\r\n\t\t\tmodal: true,\r\n\t\t\tnoOk: true,\r\n\t\t\tbuttons: {\r\n\t\t\t\t'Agree': function ()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t$('[data-delayed_payment_tc=\"' + user_id + '\"]').hide();\r\n\r\n\t\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 1, user_id);\r\n\r\n\t\t\t\t},\r\n\t\t\t\t'Decline': function ()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\r\n\t\t\t\t\t\tmessage: lang.en.tc.delayed_payment_decline\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 0, user_id);\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_agenda_click()\r\n{\r\n\t$('#session_selection li').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tif (typeof window.booking_query != 'undefined')\r\n\t\t\t{\r\n\t\t\t\twindow.booking_query.abort();\r\n\t\t\t}\r\n\r\n\t\t\t$('.selected').removeClass('selected');\r\n\r\n\t\t\t$(this).addClass('selected');\r\n\t\t\t// cancel timeout\r\n\t\t\t$.doTimeout('booked_guests_table_timer');\r\n\r\n\t\t\t// if fetching guests takes longer than 1 second, show a loading message\r\n\t\t\t$.doTimeout('booked_guests_table_timer', 1000, function ()\r\n\t\t\t{\r\n\r\n\t\t\t\t$('#booked_guests_table').html('<img src=\"' + PATH.image_admin + '/style/throbber_circle.gif\" class=\"img_valign img_throbber_circle\" data-tooltip=\"Processing\" alt=\"Processing\" style=\"display: inline;\" /> Loading...');\r\n\r\n\t\t\t});\r\n\r\n\t\t\tif ($(this).data('session_id'))\r\n\t\t\t{\r\n\t\t\t\tview_session = true;\r\n\r\n\t\t\t\tselected_session_id = $(this).data('session_id');\r\n\r\n\t\t\t\twindow.booking_query = $.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 120000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\t\top: 'session_details',\r\n\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\t\tsession_id: selected_session_id\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// if getting order details, show it after\r\n\t\t\t\t\t\t\tvar order_details = false;\r\n\t\t\t\t\t\t\t// only check if not switching between day and session view\r\n\t\t\t\t\t\t\tif (!getQueryVariable('day'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\torder_details = getQueryVariable('order');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// cancel timer\r\n\t\t\t\t\t\t\t$.doTimeout('booked_guests_table_timer');\r\n\t\t\t\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&session=' + json.session_info.id);\r\n\r\n\t\t\t\t\t\t\tselected_menu_id = json.session_info.menu_id;\r\n\t\t\t\t\t\t\tset_selected_date(json.session_info.session_start_dtf_ymd);\r\n\r\n\t\t\t\t\t\t\t// update session tools\r\n\t\t\t\t\t\t\tupdate_session_tool_links();\r\n\r\n\t\t\t\t\t\t\t// update title\r\n\t\t\t\t\t\t\t$('#selected_day').html(json.session_info.session_start_dtf_verbose_date);\r\n\t\t\t\t\t\t\t$('#selected_date_link').attention();\r\n\r\n\t\t\t\t\t\t\t// show title time\r\n\t\t\t\t\t\t\t$('#selected_session').html(' - ' + json.session_info.session_start_dtf_time_only);\r\n\t\t\t\t\t\t\t$('#selected_session').show();\r\n\r\n\t\t\t\t\t\t\t// Hide Day Details\r\n\t\t\t\t\t\t\t$('#day_details_container').hide();\r\n\r\n\t\t\t\t\t\t\t// fill session details container\r\n\t\t\t\t\t\t\t$('#session_details_table_div').html(json.session_details);\r\n\r\n\t\t\t\t\t\t\tvar publish_state_button_text = json.session_info.session_publish_state == 'PUBLISHED' ? 'Close Session' : 'Open Session';\r\n\t\t\t\t\t\t\t$('#sd_publish_state').data('session_publish_state', json.session_info.session_publish_state).html(publish_state_button_text);\r\n\t\t\t\t\t\t\t// update agenda display with new details in-case the state has changed since last load\r\n\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.attending').html(json.session_info.booked_count);\r\n\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.remaining').html(json.session_info.remaining_slots + '/' + (json.session_info.remaining_intro_slots > 0 ? json.session_info.remaining_intro_slots : 0));\r\n\r\n\t\t\t\t\t\t\tif (json.session_info.session_publish_state == 'PUBLISHED')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.time').removeClass('closed');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id + ' > span.time').addClass('closed');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// show session details container\r\n\t\t\t\t\t\t\t$('#session_details_container').show();\r\n\r\n\t\t\t\t\t\t\t// show guest list\r\n\t\t\t\t\t\t\t$('#booked_guests_table').html(json.booking_details);\r\n\r\n\t\t\t\t\t\t\t// register click handlers\r\n\t\t\t\t\t\t\tregister_booking_click_handlers();\r\n\r\n\t\t\t\t\t\t\t// show order details\r\n\t\t\t\t\t\t\tif (order_details)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-view_order_details][data-order_id=\"' + order_details + '\"]').trigger('click');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// dream taste buttons\r\n\t\t\t\t\t\t\t$('#sd_invitation_pdf').on('click', function (e)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tbounce('main.php?page=my_events&taste_event_pdf=' + selected_session_id + '&back=' + back_path(), '_blank');\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// fundraiser buttons\r\n\t\t\t\t\t\t\t$('#sd_fundraiser_invitation_pdf').on('click', function (e)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tbounce('main.php?page=rsvp_fundraiser&event_pdf=' + selected_session_id + '&back=' + back_path(), '_blank');\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$('#sd_resend_hostess_email').on('click', function (e)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tresend_dream_taste_notification();\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (strError != 'abort')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: 'An unexpected error has occurred, error message: ' + strError + '. If you continue to experience this issue please contact support.'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tview_session = false;\r\n\r\n\t\t\t\tset_selected_date($(this).data('date'));\r\n\t\t\t\tselected_menu_id = $(this).data('menu_id');\r\n\r\n\t\t\t\twindow.booking_query = $.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 120000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\t\top: 'date_details',\r\n\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\t\tdate: selected_date\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// if getting order details, show it after\r\n\t\t\t\t\t\t\tvar order_details = false;\r\n\t\t\t\t\t\t\t// only check if not switching between day and session view\r\n\t\t\t\t\t\t\tif (!getQueryVariable('session'))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\torder_details = getQueryVariable('order');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// cancel timer\r\n\t\t\t\t\t\t\t$.doTimeout('booked_guests_table_timer');\r\n\t\t\t\t\t\t\tupdate_page_url('main.php?page=' + getQueryVariable('page') + '&day=' + selected_date);\r\n\r\n\t\t\t\t\t\t\t// update session tools\r\n\t\t\t\t\t\t\tupdate_session_tool_links();\r\n\r\n\t\t\t\t\t\t\t// update title\r\n\t\t\t\t\t\t\t$('#selected_day').html(json.date_info.date_dtf_verbose_date);\r\n\t\t\t\t\t\t\t$('#selected_date_link').attention();\r\n\r\n\t\t\t\t\t\t\t// Hide session specific details\r\n\t\t\t\t\t\t\t$('#session_details_container, #selected_session').hide();\r\n\r\n\t\t\t\t\t\t\t// show guest list\r\n\t\t\t\t\t\t\tif (json.booking_details.length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#booked_guests_table').html(json.booking_details);\r\n\t\t\t\t\t\t\t\t// fill date details container\r\n\t\t\t\t\t\t\t\t$('#day_details_table_div').html(json.date_details);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#booked_guests_table').html('<div class=\"no_day_sessions\">No sessions for this day.</div>');\r\n\t\t\t\t\t\t\t\t// fill date details container\r\n\t\t\t\t\t\t\t\t$('#day_details_table_div').html('<div class=\"no_day_sessions\">No sessions for this day.</div>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// show day details container\r\n\t\t\t\t\t\t\t$('#day_details_container').show();\r\n\r\n\t\t\t\t\t\t\t// register click handlers\r\n\t\t\t\t\t\t\tregister_booking_click_handlers();\r\n\r\n\t\t\t\t\t\t\t// show order details\r\n\t\t\t\t\t\t\tif (order_details)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-view_order_details][data-order_id=\"' + order_details + '\"]').trigger('click');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// clicking session time will link to that session\r\n\t\t\t\t\t\t\t$('[id^=\"gd_title-\"]').on('click', function (e)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t$('#session-' + $(this).data('session_id')).scrollToTarget($('#session_selector'));\r\n\r\n\t\t\t\t\t\t\t\t$.scrollTo($('body'), 100);\r\n\r\n\t\t\t\t\t\t\t}).hover(function ()\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t$(this).addClass('hover');\r\n\r\n\t\t\t\t\t\t\t}, function ()\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t$(this).removeClass('hover');\r\n\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (strError != 'abort')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: 'An unexpected error has occurred, error message: ' + strError + '. If you continue to experience this issue please contact support.'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction update_page_url(page_url)\r\n{\r\n\t// update url\r\n\thistoryPush({url: page_url});\r\n\t// update title link\r\n\t$('#selected_date_link').prop('href', page_url);\r\n}\r\n\r\nfunction handle_pp_opted_out()\r\n{\r\n\t$('.pp_opted_out').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tvar bounce_to = $(this).prop('href');\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Guest has opted out',\r\n\t\t\t\tmessage: 'The guest has previously opted out, are you sure you wish to continue?',\r\n\t\t\t\tmodal: true,\r\n\t\t\t\tconfirm: function ()\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tbounce(bounce_to);\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction resend_dream_taste_notification()\r\n{\r\n\tdd_message({\r\n\t\ttitle: 'Send notice confirmation',\r\n\t\tmessage: 'Are you sure you wish to resend the host email notification?',\r\n\t\tmodal: true,\r\n\t\tconfirm: function ()\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\top: 'resend_dream_taste_email',\r\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\tsession_id: selected_session_id\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Send notice confirmation',\r\n\t\t\t\t\t\t\tmessage: 'Email notification has been resent to the session host.'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction handle_booking_no_show()\r\n{\r\n\t$('[id^=\"gd_noshow-\"]').each(function (e)\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tvar state = this.checked ? 'yes' : 'no';\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_no_show_state',\r\n\t\t\t\t\tbid: $(this).data('booking_id'),\r\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\tstate: state\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_food_testing_recipe()\r\n{\r\n\t$('[id^=\"food_testing-\"]').each(function (e)\r\n\t{\r\n\r\n\t\t$(this).on('change', function (e)\r\n\t\t{\r\n\r\n\t\t\tvar selector_elem = $(this);\r\n\t\t\tvar user_id = $(this).data('user_id');\r\n\t\t\tvar session_id = $(this).data('session_id');\r\n\t\t\tvar menu_id = $(this).data('menu_id');\r\n\t\t\tvar survey_name = $('option:selected', $(this)).text();\r\n\t\t\tvar survey_id = $(this).val().split(\"-\")[0];\r\n\t\t\tvar survey_size = $(this).val().split(\"-\")[1];\r\n\r\n\t\t\tif ($(this).val() == '0')\r\n\t\t\t{\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Confirm',\r\n\t\t\t\tmessage: 'Are you sure you wish to assign <span style=\"font-weight: bold;\">' + survey_name + '</span> to this guest? The testing item is <span style=\"font-weight: bold;\">not</span> editable once assigend and the guest will immediately receive an email upon confirmation which will include testing instructions.',\r\n\t\t\t\tnoOk: true,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\t'Confirm': function ()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\t\t\t\top: 'assign_test_recipe',\r\n\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\t\t\tsurvey_id: survey_id,\r\n\t\t\t\t\t\t\t\tsurvey_size: survey_size\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('[data-food_testing_select_user_id=\"' + json.user_id + '\"]').text(survey_name);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'Cancel': function ()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t$(selector_elem).val(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_guest_account_notes()\r\n{\r\n\t$('[id^=\"gd_guest_account_note_button-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tbooking_id = $(this).data('booking_id');\r\n\t\t\tuser_id = $(this).data('user_id');\r\n\t\t\tdo_op = 'get';\r\n\t\t\tguest_note = '';\r\n\r\n\t\t\tif ($(this).data('edit_mode') == true)\r\n\t\t\t{\r\n\t\t\t\tdo_op = 'save';\r\n\r\n\t\t\t\tguest_note = $('#gd_guest_account_note-' + booking_id + ' > textarea').val();\r\n\t\t\t}\r\n\r\n\t\t\tif (do_op == 'get')\r\n\t\t\t{\r\n\t\t\t\tget_user_pref('USER_ACCOUNT_NOTE', user_id, function (json)\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tvar textarea_elem = $('<textarea></textarea>').css({\r\n\t\t\t\t\t\t'margin': '0px',\r\n\t\t\t\t\t\t'width': '570px',\r\n\t\t\t\t\t\t'height': '80px'\r\n\t\t\t\t\t}).val((json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value ? json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value : \"\")).on('keyup', function (e)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$('#gd_guest_account_note-' + booking_id).addClass('guest_note_edit').html(textarea_elem);\r\n\r\n\t\t\t\t\t$('#gd_guest_account_note_button-' + booking_id).data('edit_mode', true).html('Save Note');\r\n\r\n\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).show();\r\n\r\n\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).data('user_data_value', (json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value ? json.guest_preferences[user_id]['USER_ACCOUNT_NOTE'].value : \"\")).on('click', function (e)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t$('#gd_guest_account_note-' + $(this).data('booking_id')).removeClass('guest_note_edit').html($(this).data('user_data_value'));\r\n\r\n\t\t\t\t\t\t$('#gd_guest_account_note_button-' + $(this).data('booking_id')).data('edit_mode', false).html('Account Notes');\r\n\r\n\t\t\t\t\t\t$(this).hide();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Confirm',\r\n\t\t\t\t\tmessage: \"This note is viewable and editable by the guest in their preferences. Are you sure you wish to modify the guest's account note?\",\r\n\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\tmodal: true,\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t'Confirm': function ()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t\tset_user_pref('USER_ACCOUNT_NOTE', guest_note, user_id);\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_account_note-' + booking_id).removeClass('guest_note_edit').html(nl2br(guest_note));\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_account_note_cancel_button-' + booking_id).hide();\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_account_note_button-' + booking_id).data('edit_mode', false).html('Account Notes');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'Cancel': function ()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_admin_carryover_notes()\r\n{\r\n\t// handle button for stores that have hidden carryover notes\r\n\t$('[id^=\"gd_show_guest_note-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tvar booking_id = $(this).data('booking_id');\r\n\r\n\t\t\tvar button_obj = this;\r\n\r\n\t\t\t$(button_obj).hide();\r\n\r\n\t\t\t$('#gd_guest_note-' + booking_id).show();\r\n\r\n\t\t\t$.doTimeout('show_guest_note_timer-' + booking_id, 10000, function ()\r\n\t\t\t{\r\n\r\n\t\t\t\t$(button_obj).show();\r\n\r\n\t\t\t\t$('#gd_guest_note-' + booking_id).hide();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$('[id^=\"gd_guest_note_button-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\thide_carryover_notes = $(this).data('hide_carryover_notes');\r\n\r\n\t\t\tbooking_id = $(this).data('booking_id');\r\n\t\t\tuser_id = $(this).data('user_id');\r\n\t\t\tdo_op = 'get';\r\n\t\t\tguest_note = '';\r\n\r\n\t\t\tif ($(this).data('edit_mode') == true)\r\n\t\t\t{\r\n\t\t\t\tdo_op = 'save';\r\n\r\n\t\t\t\tguest_note = $('#gd_guest_note-' + booking_id + ' > textarea').val();\r\n\t\t\t}\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\top: 'guest_carryover_note',\r\n\t\t\t\t\t'do': do_op,\r\n\t\t\t\t\tstore_id: STORE_DETAILS.id,\r\n\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\tnote: guest_note\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (do_op == 'get')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\r\n\t\t\t\t\t\t\t$.doTimeout('show_guest_note_timer-' + booking_id); //cancel timer\r\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).show(); // show notes\r\n\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).hide(); // hide button\r\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).addClass('guest_note_edit').html('<textarea style=\"margin: 0px; width: 570px; height: 80px;\">' + (json.guest_note.user_data_value ? json.guest_note.user_data_value : \"\") + '</textarea>');\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_note_button-' + booking_id).data('edit_mode', true).html('Save Note');\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_note_cancel_button-' + booking_id).data('user_data_value', (json.guest_note.user_data_value ? json.guest_note.user_data_value : \"\")).on('click', function (e)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\r\n\t\t\t\t\t\t\t\tif ($(this).data('hide_carryover_notes') === 1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).hide(); // hide notes\r\n\t\t\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).show(); // hide button\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t$('#gd_guest_note-' + $(this).data('booking_id')).removeClass('guest_note_edit').html($(this).data('user_data_value'));\r\n\r\n\t\t\t\t\t\t\t\t$('#gd_guest_note_button-' + $(this).data('booking_id')).data('edit_mode', false).html('Admin Carryover');\r\n\r\n\t\t\t\t\t\t\t\t$(this).hide();\r\n\r\n\t\t\t\t\t\t\t}).show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t// handle button for stores that have hidden carryover notes\r\n\t\t\t\t\t\t\tif (hide_carryover_notes === 1 && json.guest_note.user_data_value)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).hide(); // hide notes\r\n\t\t\t\t\t\t\t\t$('#gd_show_guest_note-' + booking_id).show(); // hide button\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$('#gd_guest_note-' + booking_id).removeClass('guest_note_edit').html(nl2br(json.guest_note.user_data_value));\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_note_cancel_button-' + booking_id).hide();\r\n\r\n\t\t\t\t\t\t\t$('#gd_guest_note_button-' + booking_id).data('edit_mode', false).html('Admin Carryover');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\n\r\nfunction handle_admin_order_notes()\r\n{\r\n\t$('[id^=\"gd_admin_note_button-\"]').each(function () {\r\n\r\n\t\t$(this).on('click', function (e) {\r\n\r\n\t\t\tlet unique_id = $(this).data('uid');\r\n\t\t\tif(typeof unique_id == 'undefined' || unique_id == null || unique_id == ''){\r\n\t\t\t\tunique_id = '';\r\n\t\t\t}else{\r\n\t\t\t\tunique_id += '-';\r\n\t\t\t}\r\n\t\t\tlet buttonName = $(this).data('button_name');\r\n\t\t\tif(typeof buttonName == 'undefined' || buttonName == null || buttonName == ''){\r\n\t\t\t\tbuttonName = 'Admin Order Note';\r\n\t\t\t}\r\n\t\t\tbooking_id = $(this).data('booking_id');\r\n\t\t\torder_id = $(this).data('order_id');\r\n\t\t\tuser_id = $(this).data('user_id');\r\n\t\t\tdo_op = 'get';\r\n\t\t\tadmin_note = '';\r\n\r\n\t\t\tif ($(this).data('edit_mode') == true)\r\n\t\t\t{\r\n\t\t\t\tdo_op = 'save';\r\n\r\n\t\t\t\tadmin_note = $('#gd_admin_note-' + unique_id + booking_id + ' > textarea').val();\r\n\t\t\t}\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\top: 'order_admin_note',\r\n\t\t\t\t\t'do': do_op,\r\n\t\t\t\t\torder_id: order_id,\r\n\t\t\t\t\tnote: admin_note\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (do_op == 'get')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + booking_id).addClass('admin_note_edit').html('<textarea class=\"form-control\">' + (json.admin_note ? json.admin_note : \"\") + '</textarea>');\r\n\r\n\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + booking_id).data('edit_mode', true).html('Save Note');\r\n\r\n\t\t\t\t\t\t\t$('#gd_admin_note_cancel_button-' + unique_id + booking_id).data('admin_note_value', (json.admin_note ? json.admin_note : \"\")).on('click', function (e) {\r\n\r\n\t\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + $(this).data('booking_id')).removeClass('admin_note_edit').html($(this).data('admin_note_value'));\r\n\r\n\t\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + $(this).data('booking_id')).data('edit_mode', false).html(buttonName);\r\n\r\n\t\t\t\t\t\t\t\t$(this).hide();\r\n\r\n\t\t\t\t\t\t\t}).show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('#gd_admin_note-' + unique_id + booking_id).removeClass('admin_note_edit').html(nl2br(json.admin_note));\r\n\r\n\t\t\t\t\t\t\t$('.multi-populate-admin-note').each(function () {\r\n\t\t\t\t\t\t\t\t$(this).html(nl2br(json.admin_note));\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$('#gd_admin_note_cancel_button-' + unique_id + booking_id).hide();\r\n\r\n\t\t\t\t\t\t\t$('#gd_admin_note_button-' + unique_id + booking_id).data('edit_mode', false).html(buttonName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_reschedule_button()\r\n{\r\n\t$('[id^=\"gd_reschedule-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).css({'cursor': 'pointer'}).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tcreate_and_submit_form({\r\n\t\t\t\tmethod: 'post',\r\n\t\t\t\taction: 'main.php?page=admin_reschedule',\r\n\t\t\t\tinput: ({\r\n\t\t\t\t\t'session_id': $(this).data('session_id'),\r\n\t\t\t\t\t'original_session_id': $(this).data('session_id'),\r\n\t\t\t\t\t'store_id': $(this).data('store_id'),\r\n\t\t\t\t\t'menus': $(this).data('menu_id'),\r\n\t\t\t\t\t'menu_id': $(this).data('menu_id'),\r\n\t\t\t\t\t'order_id': $(this).data('order_id'),\r\n\t\t\t\t\t'back_address': back_path()\r\n\t\t\t\t})\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_booking_row_click()\r\n{\r\n\thandle_guest_account_notes();\r\n\r\n\thandle_admin_carryover_notes();\r\n\r\n\thandle_admin_order_notes();\r\n\r\n\thandle_reschedule_button();\r\n\r\n\t$('#booked_guests_table tbody.guest').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tif ($(this).hasClass('select_guest'))\r\n\t\t\t{\r\n\t\t\t\t$('.select_guest').removeClass('select_guest');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.select_guest').removeClass('select_guest');\r\n\r\n\t\t\t\t$('#guest_details_tbody_id_' + $(this).data('booking_id')).addClass('select_guest');\r\n\t\t\t\t$('#order_details_tbody_id_' + $(this).data('booking_id')).addClass('select_guest');\r\n\t\t\t}\r\n\t\t\t$('[id^=\"gd_guest_menu-\"]').hide();\r\n\r\n\t\t\t$('#gd_guest_menu-' + $(this).data('user_id')).show();\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$('[id^=\"gd_guest-\"]').each(function ()\r\n\t{\r\n\r\n\t\tvar booking_id = $(this).data('booking_id');\r\n\r\n\t\t/*\r\n\t\t * Handle touch events under development\r\n\t\t * Aug 29, 2014\r\n\t\t * -- Ryan\r\n\t\t * ------------------- this -----VVV is a problem\r\n\t\t $('#gd_guest-' + booking_id +', #gd_guest_menu-' + booking_id).on({\r\n\t\t touchstart: function(e) {\r\n\r\n\t\t e.preventDefault();\r\n\r\n\t\t if ($('#gd_guest_menu-' + booking_id).is(':visible'))\r\n\t\t {\r\n\t\t $('#gd_guest_menu-' + booking_id).hide();\r\n\t\t }\r\n\t\t else\r\n\t\t {\r\n\t\t $('#gd_guest_menu-' + booking_id).show();\r\n\t\t }\r\n\r\n\t\t },\r\n\t\t touchend: function(e) {\r\n\r\n\t\t e.preventDefault();\r\n\r\n\t\t },\r\n\t\t mouseenter: function(e) {\r\n\r\n\t\t // cancel timeout\r\n\t\t $.doTimeout('guest_menu_timer_hide-' + booking_id);\r\n\r\n\t\t // short timeout to prevent menus from popping up when moused over\r\n\t\t $.doTimeout( 'guest_menu_timer_show-' + booking_id, 100, function() {\r\n\r\n\t\t $('#gd_guest_menu-' + booking_id).show();\r\n\r\n\t\t });\r\n\r\n\t\t },\r\n\t\t mouseleave: function(e) {\r\n\r\n\t\t // cancel timeout\r\n\t\t $.doTimeout('guest_menu_timer_show-' + booking_id);\r\n\r\n\t\t // short timeout to prevent menus from disappearing when moused away\r\n\t\t $.doTimeout( 'guest_menu_timer_hide-' + booking_id, 150, function() {\r\n\r\n\t\t $('#gd_guest_menu-' + booking_id).hide();\r\n\r\n\t\t });\r\n\r\n\t\t }\r\n\t\t });\r\n\t\t */\r\n\r\n\t\t$('#gd_guest-' + booking_id + ', #gd_guest_menu-' + booking_id).hover(function ()\r\n\t\t{\r\n\r\n\t\t\t// cancel timeout\r\n\t\t\t$.doTimeout('guest_menu_timer_hide-' + booking_id);\r\n\r\n\t\t\t// short timeout to prevent menus from popping up when moused over\r\n\t\t\t$.doTimeout('guest_menu_timer_show-' + booking_id, 100, function ()\r\n\t\t\t{\r\n\r\n\t\t\t\t$('#gd_guest_menu-' + booking_id).show();\r\n\r\n\t\t\t});\r\n\r\n\t\t}, function ()\r\n\t\t{\r\n\r\n\t\t\t// cancel timeout\r\n\t\t\t$.doTimeout('guest_menu_timer_show-' + booking_id);\r\n\r\n\t\t\t// short timeout to prevent menus from disappearing when moused away\r\n\t\t\t$.doTimeout('guest_menu_timer_hide-' + booking_id, 150, function ()\r\n\t\t\t{\r\n\r\n\t\t\t\t$('#gd_guest_menu-' + booking_id).hide();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\thandle_cancel_order();\r\n\thandle_delete_saved_order();\r\n}\r\n\r\nfunction handle_delete_saved_order()\r\n{\r\n\t$('[id^=\"gd_delete_order-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tvar session_id = $(this).data('session_id');\r\n\t\t\tvar order_id = $(this).data('order_id');\r\n\t\t\tvar store_id = $(this).data('store_id');\r\n\t\t\tvar user_id = $(this).data('user_id');\r\n\t\t\tvar bounce_to = $(this).data('bounce');\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Confirm Delete Saved Order',\r\n\t\t\t\tmessage: \"Are you sure you want to delete this saved order?\",\r\n\t\t\t\tconfirm: function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\r\n\t\t\t\t\t\t\tstore_id: store_id,\r\n\t\t\t\t\t\t\top: 'delete_saved_order',\r\n\t\t\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\torder_id: order_id\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (typeof bounce_to == 'undefined' || bounce_to == \"\")\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tbounce_to = window.location.href;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tbounce(bounce_to);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tif (json.doRefresh == true)\r\n\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Problem Deleting Saved Order',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message,\r\n\t\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\t'Refresh': function ()\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\tbounce(window.location.href);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction validateKey(evt)\r\n{\r\n\tevt = (evt) ? evt : ((event) ? event : null);\r\n\tif (evt)\r\n\t{\r\n\t\tvar charCode = (evt.charCode || evt.charCode == 0) ? evt.charCode : ((evt.keyCode) ? evt.keyCode : evt.which);\r\n\r\n\t\tif (charCode > 13 && (charCode < 48 || charCode > 57))\r\n\t\t{\r\n\t\t\t//alert(\"Only whole numbers are allowed.\");\r\n\t\t\tif (charCode == 46)\r\n\t\t\t{\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif (evt.returnValue)\r\n\t\t\t{\r\n\t\t\t\tevt.returnValue = false;\r\n\t\t\t}\r\n\t\t\telse if (evt.preventDefault)\r\n\t\t\t{\r\n\t\t\t\tevt.preventDefault();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction validateAmount(obj, limit)\r\n{\r\n\tif (isNaN(obj.value))\r\n\t{\r\n\t\tobj.value = 0.00;\r\n\t}\r\n\r\n\tif (obj.value > limit)\r\n\t{\r\n\t\tobj.value = limit;\r\n\t}\r\n}\r\n\r\nfunction handle_cancel_order()\r\n{\r\n\t$('[id^=\"gd_cancel_order-\"]').each(function ()\r\n\t{\r\n\r\n\t\t$(this).on('click', function (e)\r\n\t\t{\r\n\r\n\t\t\tvar booking_id = $(this).data('booking_id');\r\n\t\t\tvar session_id = $(this).data('session_id');\r\n\t\t\tvar order_id = $(this).data('order_id');\r\n\t\t\tvar store_id = $(this).data('store_id');\r\n\t\t\tvar user_id = $(this).data('user_id');\r\n\t\t\tvar bounce_to = $(this).data('bounce');\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\r\n\t\t\t\t\top: 'cancel_preflight',\r\n\t\t\t\t\tstore_id: store_id,\r\n\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\torder_id: order_id\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json, status)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.processor_success && json.data)\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Cancel Order?',\r\n\t\t\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\t\t\twidth: 700,\r\n\t\t\t\t\t\t\theight: 400,\r\n\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\topen: function ()\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(\"#order_admin_notes_cancel\").on('keyup', function (e)\r\n\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tconfirm: function (json, status)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tvar paymentList = {};\r\n\t\t\t\t\t\t\t\t$(\"#cancel_parent :input\").each(function ()\r\n\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\tpaymentList[this.id] = $(this).val();\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tvar order_notes = $(\"#order_admin_notes_cancel\").val().trim();\r\n\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Cancelling order',\r\n\t\t\t\t\t\t\t\t\tmessage: '<img src=\"' + PATH.image_admin + '/style/throbber_circle.gif\" class=\"img_valign\" alt=\"Processing\" /> Processing order cancellation...',\r\n\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\r\n\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\t\topen: function (event, ui)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_order_mgr_processor',\r\n\t\t\t\t\t\t\t\t\t\top: 'cancel',\r\n\t\t\t\t\t\t\t\t\t\tstore_id: store_id,\r\n\t\t\t\t\t\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\t\t\torder_id: order_id,\r\n\t\t\t\t\t\t\t\t\t\tpaymentList: paymentList,\r\n\t\t\t\t\t\t\t\t\t\torder_notes: order_notes\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Order was Canceled',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\r\n\t\t\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\topen: function (event, ui)\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"OK\": function ()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (typeof bounce_to != 'undefined')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbounce(bounce_to);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbounce(removeQueryVariable('order', window.location.href));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_session_tools()\r\n{\r\n\t// session tool suppress fastlane cookie\r\n\tif ($.totalStorage('suppress_fastlane_labels') != null)\r\n\t{\r\n\t\tsuppress_fastlane_labels = $.totalStorage('suppress_fastlane_labels');\r\n\t\t$('#suppress_fastlane_labels').prop('checked', !suppress_fastlane_labels);\r\n\r\n\t}\r\n\r\n\t// session tool suppress fastlane click\r\n\t$('#suppress_fastlane_labels').on('click', function (e)\r\n\t{\r\n\r\n\t\tif ($(this).is(':checked'))\r\n\t\t{\r\n\t\t\t$.totalStorage('suppress_fastlane_labels', false);\r\n\t\t\tsuppress_fastlane_labels = false;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.totalStorage('suppress_fastlane_labels', true);\r\n\t\t\tsuppress_fastlane_labels = true;\r\n\t\t}\r\n\r\n\t\tupdate_session_tool_links();\r\n\r\n\t});\r\n\t// Dashboard Snapshot\r\n\t$('#ds_goal_tracking').on('click', function (e)\r\n\t{\r\n\r\n\t\tbounce('main.php?page=admin_reports_goal_management_v2&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path());\r\n\r\n\t});\r\n\r\n\t$('#ds_trending').on('click', function (e)\r\n\t{\r\n\r\n\t\tbounce('main.php?page=admin_reports_trending_menu_based&date=' + selected_date + '&store=' + STORE_DETAILS.id + '&back=' + back_path());\r\n\r\n\t});\r\n\r\n\t$('#ds_dashboard').on('click', function (e)\r\n\t{\r\n\r\n\t\tbounce('main.php?page=admin_dashboard_menu_based&override_month=' + selected_date + '&store=' + STORE_DETAILS.id + '&back=' + back_path());\r\n\r\n\t});\r\n\r\n\t// Session Controls\r\n\t$('#sd_edit_session').on('click', function (e)\r\n\t{\r\n\r\n\t\tif (view_session == true)\r\n\t\t{\r\n\t\t\tbounce('main.php?page=admin_edit_session&session=' + selected_session_id + '&back=' + back_path());\r\n\t\t}\r\n\r\n\t});\r\n\t// Session Controls\r\n\t$('#sd_email_session').on('click', function (e)\r\n\t{\r\n\r\n\t\tif (view_session == true)\r\n\t\t{\r\n\t\t\tbounce('main.php?page=admin_email&session=' + selected_session_id + '&back=' + back_path());\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t$('#sd_publish_state').on('click', function (e)\r\n\t{\r\n\r\n\t\tif (view_session == true)\r\n\t\t{\r\n\t\t\tstate = $(this).data('session_publish_state');\r\n\r\n\t\t\tif (state == 'PUBLISHED')\r\n\t\t\t{\r\n\t\t\t\tnew_state = 'Close';\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tnew_state = 'Open';\r\n\t\t\t}\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: new_state + ' session confirmation',\r\n\t\t\t\tmessage: 'Are you sure you wish to <span style=\"font-weight: bold;\">' + new_state + '</span> this session?',\r\n\t\t\t\tmodal: true,\r\n\t\t\t\tconfirm: function ()\r\n\t\t\t\t{\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\t\t\t\top: 'session_publish_state',\r\n\t\t\t\t\t\t\tsession_id: selected_session_id,\r\n\t\t\t\t\t\t\topen_close_submit: new_state\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t$('#session-' + selected_session_id).scrollToTarget($('#session_selector'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t});\r\n\t// Session Controls\r\n\t$('#sd_session_meta').on('click', function (e)\r\n\t{\r\n\r\n\t\t$('.session_meta').toggle();\r\n\r\n\t\t$('#session_details_text').toggleClass('session_details_text');\r\n\r\n\t});\r\n\r\n\t// Day Controls\r\n\t$('#dd_create_session').on('click', function (e)\r\n\t{\r\n\r\n\t\tif (view_session != true)\r\n\t\t{\r\n\t\t\tbounce('main.php?page=admin_create_session&date=' + selected_date + '&menu=' + selected_menu_id + '&back=' + back_path());\r\n\t\t}\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction update_session_tool_links()\r\n{\r\n\tif (view_session == true)\r\n\t{\r\n\t\t$('#st_customer_receipt').prop('href', 'main.php?page=admin_order_details_view_all&customer_print_view=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_franchise_receipt').prop('href', 'main.php?page=admin_order_details_view_all&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_entree_summary').prop('href', 'main.php?page=admin_reports_select_multi_session&query_submit=1&report_id=2&printer=1&pickSession=2&session_id=' + selected_session_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_side_dish_report').prop('href', 'main.php?page=admin_order_details_view_all&issidedish=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_fast_lane_report').prop('href', 'main.php?page=admin_order_details_view_all&ispreassembled=1&session_id=' + selected_session_id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_dream_rewards').prop('href', 'main.php?page=admin_reports_dream_rewards_for_session&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_future_orders').prop('href', 'main.php?page=admin_order_details_view_all_future&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_session_goal_sheet_print').prop('href', 'main.php?page=admin_reports_goal_tracking&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&print=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_session_goal_sheet_xls').prop('href', 'main.php?page=admin_reports_goal_tracking&export=xlsx&hideheaders=true&csvfilename=SessionGoalSheet&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&back=' + back_path());\r\n\t\t$('#st_print_labels').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_labels_w_breaks').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&break=1&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_labels_by_dinner').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels&session_id=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&order_by=dinner&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_enrollment_forms').prop('href', 'main.php?page=admin_user_plate_points&session_id=' + selected_session_id + '&print_sessions_forms=true').prop('target', '_blank');\r\n\t\t$('#st_plate_points_status_and_rewards_report').prop('href', 'main.php?page=admin_reports_points_status_and_rewards&session_id=' + selected_session_id + '&back=' + back_path());\r\n\t\t$('#st_customer_menu_core').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_current').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&cur=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_freezer').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&freezer=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_nutrition').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&nutrition=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_freezer').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_freezer_nutrition').prop('href', 'main.php?page=admin_session_tools_printing&do=print&session=' + selected_session_id + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&nutrition=true&back=' + back_path()).prop('target', '_blank');\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$('#st_customer_receipt').prop('href', 'main.php?page=admin_order_details_view_all_multi&customer_print_view=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_franchise_receipt').prop('href', 'main.php?page=admin_order_details_view_all_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_entree_summary').prop('href', 'main.php?page=admin_reports_select_multi_session&query_submit=1&report_date=' + selected_date + '&report_id=1&printer=1&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_side_dish_report').prop('href', 'main.php?page=admin_order_details_view_all_multi&issidedish=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_fast_lane_report').prop('href', 'main.php?page=admin_order_details_view_all_multi&ispreassembled=1&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_dream_rewards').prop('href', 'main.php?page=admin_reports_dream_rewards_for_session_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_future_orders').prop('href', 'main.php?page=admin_order_details_view_all_future_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_session_goal_sheet_print').prop('href', 'main.php?page=admin_reports_goal_tracking&multi_session=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&print=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_session_goal_sheet_xls').prop('href', 'main.php?page=admin_reports_goal_tracking&export=xlsx&hideheaders=true&csvfilename=SessionGoalSheetSummary&multi_session=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&report_submit=true&back=' + back_path());\r\n\t\t$('#st_print_labels').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_labels_w_breaks').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&back=' + back_path() + '&break=1&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_labels_by_dinner').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels_multi&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&menuid=' + selected_menu_id + '&order_by=dinner&back=' + back_path() + '&suppressFastlane=' + suppress_fastlane_labels).prop('target', '_blank');\r\n\t\t$('#st_print_enrollment_forms').prop('href', 'main.php?page=admin_user_plate_points&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&print_days_forms=true').prop('target', '_blank');\r\n\t\t$('#st_plate_points_status_and_rewards_report').prop('href', 'main.php?page=admin_reports_points_status_and_rewards&report_date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&back=' + back_path());\r\n\t\t$('#st_customer_menu_core').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_current').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&cur=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_freezer').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&freezer=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_nutrition').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&nutrition=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_freezer').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&back=' + back_path()).prop('target', '_blank');\r\n\t\t$('#st_customer_menu_core_freezer_nutrition').prop('href', 'main.php?page=admin_session_tools_printing&do=print&date=' + selected_date + '&store_id=' + STORE_DETAILS.id + '&core=true&freezer=true&nutrition=true&back=' + back_path()).prop('target', '_blank');\r\n\t}\r\n\r\n\t$('#st_finishing_touch_pick_sheet').prop('href', 'main.php?page=admin_finishing_touch_printable_form&store_id=' + STORE_DETAILS.id + '&menu_id=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n\t$('#st_print_generic_labels').prop('href', 'main.php?page=admin_reports_customer_menu_item_labels&store_id=' + STORE_DETAILS.id + '&interface=1&menuid=' + selected_menu_id + '&back=' + back_path()).prop('target', '_blank');\r\n}\r\n\r\nfunction handle_order_search()\r\n{\r\n\t$('#os_search_go').on('click', function (e)\r\n\t{\r\n\r\n\t\tvar order_id = $('#os_search_value').val().trim();\r\n\r\n\t\tbounce('main.php?page=admin_order_details&order=' + order_id);\r\n\r\n\t});\r\n\r\n\t$('#os_search_type').on('change', function (e)\r\n\t{\r\n\r\n\t\tmanualOrderSearchTypeChange = true;\r\n\r\n\t});\r\n\r\n\t$('#os_search_value').on('keyup', function (e)\r\n\t{\r\n\r\n\t\tif (e.which == 13)\r\n\t\t{\r\n\t\t\t$('#os_search_go').trigger('click');\r\n\t\t}\r\n\r\n\t\tdetect_order_search_type();\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction handle_guest_search()\r\n{\r\n\t$('#gs_search_go').on('click', function (e)\r\n\t{\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\tmethod: 'get',\r\n\t\t\taction: 'main.php',\r\n\t\t\tinput: ({\r\n\t\t\t\t'page': 'admin_list_users',\r\n\t\t\t\t'search_type': $('#gs_search_type').val(),\r\n\t\t\t\t'all_stores': ($('#gs_search_all').is(':checked') ? 1 : 0),\r\n\t\t\t\t'q': $('#gs_search_value').val(),\r\n\t\t\t\t'back': back_path()\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$('#gs_search_type').on('change', function (e)\r\n\t{\r\n\r\n\t\tmanualSearchTypeChange = true;\r\n\r\n\t});\r\n\r\n\t$('#gs_search_value').on('keyup', function (e)\r\n\t{\r\n\r\n\t\tif (e.which == 13)\r\n\t\t{\r\n\t\t\t$('#gs_search_go').trigger('click');\r\n\t\t}\r\n\r\n\t\tdetect_guest_search_type();\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction detect_order_search_type()\r\n{\r\n\t// user manually changed search type, don't automatically change it\r\n\tif (manualOrderSearchTypeChange == true)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar value = $('#os_search_value').val();\r\n\r\n\t// not numeric entry, start with last name\r\n\tif (!$.isNumeric(value))\r\n\t{\r\n\t\t$('#os_search_type').val('confirmation');\r\n\t}\r\n\r\n\t// numeric entry, probably guest id\r\n\tif ($.isNumeric(value))\r\n\t{\r\n\t\t$('#os_search_type').val('id');\r\n\t}\r\n\r\n}\r\n\r\nfunction detect_guest_search_type()\r\n{\r\n\t// user manually changed search type, don't automatically change it\r\n\tif (manualSearchTypeChange == true)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar value = $('#gs_search_value').val();\r\n\r\n\t// not numeric entry, start with last name\r\n\tif (!$.isNumeric(value))\r\n\t{\r\n\t\t$('#gs_search_type').val('lastname');\r\n\t}\r\n\r\n\t// numeric entry, probably guest id\r\n\tif ($.isNumeric(value))\r\n\t{\r\n\t\t$('#gs_search_type').val('id');\r\n\t}\r\n\r\n\t// has @ symbol, probably email\r\n\tif (value.indexOf(\"@\") != -1)\r\n\t{\r\n\t\t$('#gs_search_type').val('email');\r\n\t}\r\n\r\n\t// has space, probably first and last name\r\n\tif (value.indexOf(\" \") != -1)\r\n\t{\r\n\t\t$('#gs_search_type').val('firstlast');\r\n\t}\r\n}\r\n\r\nfunction handle_go_to_today()\r\n{\r\n\t$('#go_to_today').on('click', function (e)\r\n\t{\r\n\r\n\t\tgo_to_today();\r\n\r\n\t});\r\n}\r\n\r\nfunction go_to_today()\r\n{\r\n\tinit_go_to_today = true;\r\n\r\n\tdate_select = get_todays_date().slice(0, -3);\r\n\r\n\tif (selected_agenda_month != undefined && selected_agenda_month != date_select)\r\n\t{\r\n\t\tlet val = $(\"#month_selector option[data-menu_month='\"+date_select+\"']\").val();\r\n\t\t$('#month_selector').val(val).trigger('change');\r\n\t}\r\n\r\n\t$('.selected').removeClass('selected');\r\n\r\n\tvar todays_date = get_todays_date();\r\n\r\n\t$('#day_' + todays_date).scrollToTarget($('#session_selector')).addClass('selected');\r\n\r\n\tinit_go_to_today = false;\r\n}\r\n\r\nfunction handle_preselection()\r\n{\r\n\tif (getQueryVariable('session') && $('#session-' + getQueryVariable('session')).length)\r\n\t{\r\n\t\t$('#session-' + getQueryVariable('session')).scrollToTarget($('#session_selector'));\r\n\t}\r\n\telse if (getQueryVariable('day') && $('#day_' + getQueryVariable('day')).length)\r\n\t{\r\n\t\t$('#day_' + getQueryVariable('day')).scrollToTarget($('#session_selector'));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tgo_to_today();\r\n\t}\r\n}\r\n\r\nfunction confirm_order_attended(user_id, order_id)\r\n{\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'plate_points_processor',\r\n\t\t\tuser_id: user_id,\r\n\t\t\top: 'confirm_order',\r\n\t\t\torder_id: order_id\r\n\t\t},\r\n\t\tsuccess: function (json)\r\n\t\t{\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\t$(\"[id^=pp_co_\" + user_id + \"_\" + order_id + \"]\").html(json.points_this_order);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError)\r\n\t\t{\r\n\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\n// jquery plugins\r\n(function ($)\r\n{\r\n\r\n\t//create jquery scrollToTarget method\r\n\t$.fn.scrollToTarget = function (target, callback)\r\n\t{\r\n\t\tvar elem = $(this);\r\n\r\n\t\tif (elem.length)\r\n\t\t{\r\n\t\t\tvar target_top = $(target).position().top;\r\n\t\t\tvar target_bottom = target_top + $(target).height();\r\n\r\n\t\t\tvar elem_top = $(elem).position().top;\r\n\t\t\tvar elem_bottom = elem_top + $(elem).height();\r\n\r\n\t\t\t// only scroll if element is out of bounds\r\n\t\t\tif ((elem_top > target_top && elem_bottom < target_bottom) || (elem_top < target_top && elem_bottom > target_bottom))\r\n\t\t\t{\r\n\t\t\t\telem.trigger('click');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttarget.scrollTo(\r\n\t\t\t\t\tthis,\r\n\t\t\t\t\t800,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toffset: -25,\r\n\t\t\t\t\t\teasing: 'easeOutBack',\r\n\t\t\t\t\t\tonAfter: function ()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\telem.trigger('click');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn elem;\r\n\t};\r\n\r\n})(jQuery);"],"names":["selected_session_id","view_session","manualSearchTypeChange","manualOrderSearchTypeChange","init_go_to_today","suppress_fastlane_labels","main_init","handle_agenda_click","handle_agenda_month_select","handle_session_tools","handle_go_to_today","handle_guest_search","handle_order_search","handle_preselection","handle_order_details_table","init_looping_timers","start_dashboard_snapshot_timer","start_unix_expiry_timer","register_booking_click_handlers","handle_booking_row_click","handle_booking_no_show","handle_platepoints_gifts","handle_food_testing_recipe","handle_pp_opted_out","handle_delayed_payment_tc","$","each","this","on","e","preventDefault","booking_id","data","order_id","hide","show","animate","scrollTop","offset","top","stop","ajax","url","type","timeout","dataType","processor","op","success","json","processor_success","html","order_details_table","getQueryVariable","update_page_url","store_id","STORE_DETAILS","id","user_id","USER_DETAILS","error","objAJAXRequest","strError","response","dd_message","title","message","level","gift_id","modal","confirm","status","dd_toast","giftDisplayString","doTimeout","handle_dashboard_update","unixtime","Math","round","Date","getTime","filter","hasClass","addClass","set_selected_date","new_date","new_date_parts","split","old_date_parts","selected_date","new_year_month","old_year_month","length","is","dashboard_date","dash_date","dashboard_metrics","removeClass","help_system_init","selected_agenda_month","val","doasync","async","agenda_date","session_info","date","scrollToTarget","lang","en","tc","terms_and_conditions","delayed_payment","noOk","buttons","Agree","remove","set_user_pref","Decline","delayed_payment_decline","window","booking_query","abort","PATH","image_admin","session_id","order_details","selected_menu_id","menu_id","session_start_dtf_ymd","update_session_tool_links","session_start_dtf_verbose_date","attention","session_start_dtf_time_only","session_details","publish_state_button_text","session_publish_state","booked_count","remaining_slots","remaining_intro_slots","booking_details","trigger","bounce","back_path","resend_dream_taste_notification","date_info","date_dtf_verbose_date","date_details","scrollTo","hover","page_url","historyPush","prop","bounce_to","state","checked","bid","selector_elem","survey_name","text","survey_id","survey_size","Confirm","Cancel","handle_guest_account_notes","do_op","guest_note","get_user_pref","textarea_elem","css","margin","width","height","guest_preferences","value","strip_tags","nl2br","handle_admin_carryover_notes","button_obj","hide_carryover_notes","do","note","user_data_value","handle_admin_order_notes","let","unique_id","buttonName","admin_note","handle_reschedule_button","cursor","create_and_submit_form","method","action","input","original_session_id","menus","back_address","handle_cancel_order","handle_delete_saved_order","location","href","doRefresh","processor_message","closeOnEscape","Refresh","validateKey","evt","event","charCode","keyCode","which","returnValue","validateAmount","obj","limit","isNaN","open","paymentList","order_notes","trim","div_id","ui","parent","find","OK","removeQueryVariable","totalStorage","new_state","open_close_submit","toggle","toggleClass","detect_order_search_type","page","search_type","all_stores","q","back","detect_guest_search_type","isNumeric","indexOf","go_to_today","date_select","get_todays_date","slice","undefined","todays_date","confirm_order_attended","points_this_order","fn","target","callback","elem","target_top","position","target_bottom","elem_top","elem_bottom","easing","onAfter","jQuery"],"mappings":"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"}