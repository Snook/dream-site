{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["codethatgridpro.js"],"sourcesContent":["// CodeThatGrid PRO\n// Version: 2.2.8 (02.22.06.1)\n// IT IS ILLEGAL TO USE UNREGISTERED VERSION OF THE SCRIPT. WE PERFORM\n// MONITORING OF THE SITES THAT USE SCRIPT USING GOOGLE AND SPECIAL WORDS\n// INCLUDED INTO THE SCRIPT. WE WILL INITIATE LEGAL ACTIONS AGAINST THE\n// PARTIES THAT VIOLATE LICENSE AGREEMENT. PLEASE REGISTER THE SCRIPT.\n// Copyright (c) 2003-2006 by CodeThat.Com\n// http://www.codethat.com/\n\n// purchased 0306 LHook\n\nfunction CCodeThatGrid(name, r, c, width, height, helpTips){\n\n var t = this, i, s;\n t.widthValue = width;\n t.heightValue = height;\n t.helptips = helpTips;\n r = parseInt(r); c = parseInt(c);\n t.def = {datatype:0, data:[]};\n t.name = name;\n t.showStatusBar = 0;\n CodeThatGrids[name] = t;\n t.rows = [];\n t.cols = [];\n t.cells = [];\n t.rowCount = (isNaN(r) || r <= 0) ? 20 : r;\n t.colCount = (isNaN(c) || c <= 0) ? 5 : c;\n t.rIdx = [];\n t.vr = [];\n t.cIdx = [];\n t.sortCol = -1;\n t.sortType = 1;\n t.multiSortCol = [];\n t.multiSortType = [];\n t.useMultiSort = 1;\n t.searchValue = \"\";\n t.clip = \"\";\n t.msg = \"\";\n t.useProgress = 1;\n t.winProgress = null;\n t.useRCID = 1;\n t.showCols = 0;\n t.useExportBar = 0;\n t.useColTitle = 0;\n t.curCell = null;\n t.amountPerPage = 20;\n t.pageCount = 1;\n t.page = 1;\n t.isInit = 0;\n t.markType = 0;\n t.markRange = [];\n t.userFunction = null;\n //default appearance\n t.tableStyle = {tableClass : {borderwidth:1,borderstyle:\"solid\", bordercolor:\"#D4D0C8\"}, thClass : dfp, tdClass : dfp, bgcolor : \"#ffffff\", x : 10, y : 10, width: t.widthValue, height: t.heightValue, position : 0, overflow:\"auto\"};\n t.rowStyle = {defaultClass: merge([dfp, crp, {backgroundcolor:\"#D4D0C8\"}]), markClass:merge([dfp, crp, {backgroundcolor:\"#ccccff\"}]), resizeClass: {cursor:\"row-resize\", borderwidth:\"0\"}, dragClass: {cursor:\"move\", borderwidth:\"0\"}, width : 40, height: 22};\n t.colStyle = {defaultClass: merge([dfp, crp, {backgroundcolor:\"#D4D0C8\"}]), markClass:merge([dfp, crp, {backgroundcolor:\"#ccccff\"}]), resizeClass: {cursor:\"col-resize\", borderwidth:\"0\"}, dragClass: {cursor:\"move\", borderwidth:\"0\"}, width: 80, height : 22};\n t.cellStyle = {defaultClass:merge([dfp, clp, {backgroundcolor:\"#ffffff\", bordercolor:\"#cccccc\", borderwidth:1}]), markClass: merge([dfp, clp, {backgroundcolor:\"#ccccff\", bordercolor:\"#cccccc\", borderwidth:1}]), currClass: merge([dfp, clp, {backgroundcolor:\"#effffe\", bordercolor:\"#000000\", borderwidth:2}])};\n t.toolBar = {height : 29, bgcolor : \"#D4D0C8\", defaultClass : merge([dfp,dbp]), buttons:[], searchControl:null};\n t.statusBar = {height: 18, bgcolor : \"#D4D0C8\", defaultClass : dbp, messageClass : dbp, fieldText : \"Field\", valueText : \"Value\"};\n t.pageTurnBar = {defaultClass: {backgroundcolor:\"#ffffff\", fontsize:\"12px\", fontfamily:\"Verdana,Arial\"}, activeClass: {backgroundcolor:\"#D4D0C8\", fontsize:\"12px\", fontfamily:\"Verdana,Arial\"}, img_on : {src : imgDir + \"t_on.gif\"}, img_off : {src : imgDir + \"t_off.gif\"}, text : \"Page\", width : 65,  height : 14};\n //init toolbar with default buttons\n var btn = [\"addrowto\", \"addrowafter\", \"delrow\", \"addcolto\", \"addcolafter\", \"delcol\", \"sortasc\", \"sortdesc\", \"multisortasc\", \"multisortdesc\", \"resetsort\", \"copy\", \"paste\", \"formatbold\", \"formatitalic\", \"formatunderline\", \"alignleft\", \"aligncenter\", \"alignright\", \"setsearch\", \"resetsearch\", \"setamount\"],\n btntx = [\"Add row before current one\", \"Add row after current one\", \"Delete row\", \"Add column before current one\", \"Add column after current one\", \"Delete column\", \"Sort in ascending order\", \"Sort in descending order\", \"Multi Sort in ascending order\", \"Multi Sort in descending order\", \"Reset sort\", \"Copy\", \"Paste\", \"Format bold\", \"Format italic\", \"Format underline\", \"Align left\", \"Align center\", \"Align right\", \"Search\", \"Reset search\", \"Set amount\"],\n b = t.toolBar.buttons;\n for (i = 0; i < btn.length; i++){\n \tb[i] = {};\n \tb[i].name = btn[i];\n \tb[i].text = btntx[i];\n \tb[i].img_on = {src: imgDir + btn[i] + \".gif\", width:16,height:16};\n \tb[i].img_off = {src: imgDir + btn[i] + \"_off.gif\" ,width:16,height:16};\n };\n ua.oldB = ua.oldOpera || ua.nn4;\n};\n{\n\tvar CGp = CCodeThatGrid.prototype;\n\n\tCGp.setFocus = function(rOffset, cOffset){\n\t\tvar t = this, cl = t.curCell, c, r, s, f, o, i;\n\t\tif (Undef(cl)) return;\n\t\tr = (!t.vr.length) ? t.rIdx.indexOf(cl.row._id) : t.vr.indexOf(cl.row._id);\n\t\tc = t.cIdx.indexOf(cl.col._id);\n\t\ts = (t.page - 1) * t.amountPerPage;\n\t\tf = (t.page * t.amountPerPage > t.rows.length) ? t.rows.length : t.page * t.amountPerPage;\n\t\tif (rOffset + r < s){\n\t\t\tr = f + (rOffset + r);\n\t\t}else{\n\t\t\tif (rOffset + r < f) r = rOffset + r;\n\t\t\telse r = f - (rOffset + r);\n\t\t};\n\t\tif (cOffset + c < 0){\n\t\t\tc = t.cols.length + (cOffset + c);\n\t\t}else{\n\t\t\tif (cOffset + c < t.cols.length) c = cOffset + c;\n\t\t\telse c = t.cols.length - cOffset - c;\n\t\t};\n\t\tif (cOffset >= 0) {\n\t\t\twhile (c < t.colCount && !t.cols[c].isVisible) c++;\n\t\t\tif (c == t.colCount)  c = 0;\n\t\t\twhile (c < t.colCount && !t.cols[c].isVisible) c++;\n\t\t\tif (c == t.colCount) {alert(\"All columns are hidden!\"); return;}\n\t\t}else{\n\t\t\twhile (c > -1 && !t.cols[c].isVisible) c--;\n\t\t\tif (c == -1)  c = t.colCount-1;\n\t\t\twhile (c > -1 && !t.cols[c].isVisible) c--;\n\t\t\tif (c == -1) {alert(\"All columns are hidden!\"); return;}\n\t\t};\n\n\t\tr = (!t.vr.length) ? t.rIdx[r] : t.vr[r]; c = t.cIdx[c];\n\t\tif (r > -1 && c > -1) t.setCurCell(t.cells[r][c]);\n\t};\n\n\tCGp.onKeyPress = function(e){\n\t\tvar t = this, cl = t.curCell, o, r, c;\n\t\tif (Undef(cl)) return;\n\t\tswitch (e._e.keyCode){\n\t\t\tcase 57387:\n\t\t\tcase 37: //<-\n\t\t\t\tif (cl.state != 2) t.setFocus(0, -1);\n\t\t\t\tbreak;\n\t\t\tcase 57385:\n\t\t\tcase 38: //^\n\t\t\t\tif (cl.state != 2) t.setFocus(-1, 0);\n\t\t\t\tbreak;\n\t\t\tcase 57388:\n\t\t\tcase 39: //->\n\t\t\t\tif (cl.state != 2) t.setFocus(0, 1);\n\t\t\t\tbreak;\n\t\t\tcase 57386:\n\t\t\tcase 40: //!^\n\t\t\t\tif (cl.state != 2) t.setFocus(1, 0);\n\t\t\t\tbreak;\n\t\t\tcase 9://tab\n\t\t\t\tif (isShift)\n\t\t\t\t\tif (t.cIdx.indexOf(t.cols[cl.col._id]) == 0) t.setFocus(-1, -1)\n\t\t\t\t\telse t.setFocus(0, -1);\n\t\t\t\telse\n\t\t\t\t\tif (t.cIdx.indexOf(t.cols[cl.col._id]) == t.cIdx.length-1) t.setFocus(1, 1)\n\t\t\t\t\telse t.setFocus(0, 1);\n\n\t\t\t\tif (ua.ie){\n\t\t\t\t\to = CT_fe(t.curCell.getID());\n\t\t\t\t\to.focus();\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 13:\n\t\t\t\tif (cl.state != 2) {\n\t\t\t\t\tcl.setState(2);\n\t\t\t\t\treturn false;\n\t\t\t\t}else{\n\t\t\t\t\to = CT_fe(\"cell\");\n\t\t\t\t\tif (Def(o) && o.type.toLowerCase() != 'textarea') t.setFocus(0, 1);\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 57346:\n\t\t\tcase 113: //f2\n\t\t\t\tif (cl.state != 2) cl.setState(2);\n\t\t\t\tbreak;\n\t\t\tcase 27: //esc\n\t\t\t\tif (cl.state == 2) {o = CT_fe(\"cell\"); if (Def(o)) o.value = cl.getDataForEdit();}\n\t\t\t\tcl.setState(1);\n\t\t\t\tbreak;\n\t\t\tcase 57383:\n\t\t\tcase 33://pageup (1 row at page)\n\t\t\t\tif (cl.state != 2){\n\t\t\t\t\tr = t.rIdx[(t.page-1)*t.amountPerPage];\n\t\t\t\t\tt.setCurCell(t.cells[r][cl.col._id]);\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 57384:\n\t\t\tcase 34://pagedown (last row at page)\n\t\t\t  if (cl.state != 2){\n\t\t\t\t\tif (t.page*t.amountPerPage - 1 >= t.rIdx.length) r = t.rIdx[t.rIdx.length-1]\n\t\t\t\t\telse r = t.rIdx[t.page*t.amountPerPage - 1];\n\t\t\t\t\tt.setCurCell(t.cells[r][cl.col._id]);\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 57382:\n\t\t\tcase 35://end (last col)\n\t\t\t\tif (cl.state != 2){\n\t\t\t\t\tc = t.cIdx[t.cIdx.length-1]\n\t\t\t\t\tt.setCurCell(t.cells[cl.row._id][c]);\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 57381:\n\t\t\tcase 36://home (1 col)\n\t\t\t\tif (cl.state != 2){\n\t\t\t\t\tc = t.cIdx[0]\n\t\t\t\t\tt.setCurCell(t.cells[cl.row._id][c]);\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 67: //c + ctrl\n\t\t\t   if (cl.state == 2) break;\n\t\t\t\tt.copy();\n\t\t\t\tbreak;\n\t\t\tcase 86:\t//v + ctrl\n\t\t\t\tif (cl.state == 2) break;\n\t\t\t\tt.paste();\n\t\t\t\tbreak;\n\t\t};\n\t};\n\tCGp.makeStyle = function (obj, param, cssName){\n\t\tvar css;\n\t\tif (Def(css = makeCssClass(obj[param]))) {\n\t\t\t\tcssName = makeNameUnique(cssName);\n\t\t\t\tobj[param] = cssName;\n\t\t\t\tcss = \"\\n.\" + cssName + \"{\" + css + \"}\";\n\t\t}/*STD else obj[param]=\"\"*/;\n\t\treturn css;\n\t};\n\tCGp.setMarkRange = function(markRange, markType){\n\t\tvar t = this, m = t.markRange, idx, i, j, p = (!ua.opera);\n\t\tif (Def(t.curCell) && markType < 3) t.setCurCell(null);\n\t\tt.clearMarkRange(markType);\n\t\t\n\t\tswitch (markType){\n\t\t\tcase 1: //col\n\t\t\tcase 2: //row\n\t\t\t  t.markType = markType;\n\t\t\t\tidx = m.indexOf(markRange);\n\t\t\t\tif (isShift){\n\t\t\t\t\tif (m.length > 0) idx = m[m.length-1]\n\t\t\t\t\telse idx = markRange;\n\t\t\t\t\tif (m.length > 0) m.length--;\n\t\t\t\t\tif (t.markType == 1) {\n\t\t\t\t\t\tidx = t.cIdx.indexOf(idx);\n\t\t\t\t\t\tmarkRange = t.cIdx.indexOf(markRange);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tidx = t.rIdx.indexOf(idx);\n\t\t\t\t\t\tmarkRange = t.rIdx.indexOf(markRange);\n\t\t\t\t\t};\n\t\t\t\t\tif (idx > markRange){\n\t\t\t\t\t i = idx;\n\t\t\t\t\t idx = markRange;\n\t\t\t\t\t markRange = i;\n\t\t\t\t\t};\n\t\t\t\t\tfor (i = idx;i <= markRange;i++){\n\t\t\t\t\t\tm[m.length] = ((t.markType == 1) ? t.cols[t.cIdx[i]]._id : t.rows[t.rIdx[i]]._id);\n\t\t\t\t\t};\n\t\t\t\t}else{\n\t\t\t\t\tif (idx==-1) m[m.length] = markRange;\n\t\t\t\t};\n\t\t\t\tfor (i = 0; i < m.length; i++)\n\t\t\t\t\tif (t.markType == 1) t.cols[m[i]].setMark(1, null, null, p);\n\t\t\t\t\telse t.rows[m[i]].setMark(1, null, null, p);\n\t\t\t\tbreak;\n\t\t\tcase 3: //range\n\t\t\t\tm = markRange;\n\t\t\t\tfor (i = 0; i < m.length; i++) m[i] = m[i]-0;\n\t\t\t\tif (m[0]-m[2]==0 && m[1]-m[3]==0) return;\n\t\t\t\tt.markType = markType;\n\t\t\t\tt.markRange = markRange;\n\t\t\t\tif (t.rIdx.indexOf(m[0])>t.rIdx.indexOf(m[2])){idx=m[0];m[0]=m[2];m[2]=idx;}\n\t\t\t\tif (t.cIdx.indexOf(m[1])>t.rIdx.indexOf(m[3])){idx=m[1];m[1]=m[3];m[3]=idx;}\n\t\t\t\tfor (i = t.rIdx.indexOf(m[0]); i<= t.rIdx.indexOf(m[2]); i++)\n\t\t\t\t\tt.rows[t.rIdx[i]].setMark(1, t.cIdx.indexOf(m[1]), t.cIdx.indexOf(m[3])+1, p);\n\t\t\t\tbreak;\n\t\t};\n\t\tif (!p) t.paint();\n\t};\n\n\tCGp.clearMarkRange = function(markType){\n\t\tvar t = this, i, m = t.markRange, p = (!ua.opera);\n\t\tif (t.markType == 0) return;\n\t\tif (t.markType == markType && (isCtrl || isShift)) return;\n\t\tswitch(t.markType){\n\t\t\tcase 1:\n\t\t\tcase 2:\n\t\t\t\tfor (i = 0; i < m.length; i++)\n\t\t\t\t\tif (t.markType == 1) t.cols[m[i]].setMark(0, null, null, p);\n\t\t\t\t\telse t.rows[m[i]].setMark(0, null, null, p);\n\t\t\t\tbreak;\n\t\t\tcase 3:\t\t\t\t\n\t\t\t  if (Undef(m) || m.constructor != Array || m.length==0) return;\n\t\t\t\tfor (i = t.rIdx.indexOf(m[0]); i<= t.rIdx.indexOf(m[2]); i++)\n\t\t\t\t  t.rows[t.rIdx[i]].setMark(0, t.cIdx.indexOf(m[1]), t.cIdx.indexOf(m[3])+1, p);\n\t\t\t\tbreak;\n\t\t};\n\t\tt.markType = 0;\n\t\tt.markRange.length = 0;\n\t\tif (!p) t.paint();\n\t};\n\n\tCGp.init = /*STD_UNREG\n\t(typeof CodeThat.gets == 'function' && CodeThat.gets()) ? (\n\t*/ function(gridDef){\n\t\tvar t = this, d = new Date(), i, j, style = \"\", imgs = [], c, data;\n\n\t\tif (Def(gridDef)) t.def = gridDef;\n\t\t//make style\n\t\tfor (i in t){\n\t\t\tif ((i.indexOf(\"Style\") > -1 || i.indexOf(\"Bar\") > -1) && t[i].constructor == Object){\n\t\t\t\tif (Def(t.def[i])) t[i] = t.def[i];\n\t\t\t\tfor (j in t[i]){\n\t\t\t\t\tif (j.indexOf(\"Class\") > -1) style += t.makeStyle(t[i], j, '');\n\t\t\t\t};\n\t\t\t};\n\t\t\tif (i.indexOf(\"use\") == 0 && Def(t.def[i])) eval(\"t.\" + i + \"=\" + t.def[i]);\n\t\t};\n\t\tt.showProgress(\"Get appearance parameters\");\n\t\tif (Undef(t.tableStyle.overflow)) t.tableStyle.overflow = 'auto';\n\t\tif (ua.moz && t.tableStyle.overflow == \"visible\") t.tableStyle.overflow = 'auto'; \n\t\tif (Def(style)) dw(\"<style>\" + style + \"</style>\");\n\t\t//imgs preload\n\t\tb = t.toolBar.buttons;\n\t\tfor (i=0; Def(b) && i < b.length; i++)\n\t\t for (j in b[i]) if (j.indexOf(\"img\") > -1 && Def(b[i][j])) imgs[imgs.length] = b[i][j].src;\n\t\tb = t.pageTurnBar;\n\t\tfor (i in b) if (i.indexOf(\"img\") > -1 && Def(b[i])) imgs[imgs.length] = b[i].src;\n\t\tfor (i=0; i < imgs.length; i++) CodeThat.preload(imgs[i]);\n\n\t\tc = parseInt(t.def.amountPerPage);\n\t\tif (!isNaN(c) && c > 0) t.amountPerPage = c;\n\t\tt.userFunction = t.def.userFunction;\n\n\t\tt.writeProgress(\"Init grid \" + t.rowCount + \"x\" + t.colCount);\n\t\tfor (i = 0; i < t.rowCount; i++){\n\t\t t.rows[i] = new CGRow(i, t); t.rIdx[i] = i;\n\t\t t.cells[i] = [];\n\t\t for (j = 0; j < t.colCount; j++){\n\t\t \t  c = (Def(t.def.colDef) && (t.def.colDef.length > j) && Def(t.def.colDef[j])) ? t.def.colDef[j] : DEFAULT_COLDEF;\n\t\t \t\tif (i == 0)\t{t.cols[j] = new CGCol(j, t, c); t.cIdx[j] = j;}\n\t\t \t\tt.cells[i][j] = new CGCell(t.rows[i], t.cols[j], '');\n\t\t };\n\t\t};\n\t\tt.loadData(t.def.datatype, t.def.data);\n\t\tt.isInit = 1;\n\t}/*STD_UNREG\n\t): (function(){return;});\n\t*/;\n\n\tCGp.toCSV = function(spt, isRng, change, lessreadonly, showOnlyVisibleColumns){\n\t \tvar t = this, s = \"\", m, i, j, re, ri = (!t.vr.length) ? t.rIdx : t.vr;\n\t \tif (Undef(spt)) spt = \";\";\n\t \tif (Undef(isRng)) isRng = 0;\n\t \tif (Undef(change)) change = 0;\n\t\tif (Undef(change)) change = 0;\n\t \tif (Undef(showOnlyVisibleColumns)) showOnlyVisibleColumns = 0;\n\t \tre = new RegExp(spt + \"+$\");\n\t \tif (!isRng){\n\t\t\t\n\t \t\tfor (i = 0; i < t.rowCount; i++){\n\t\t\t\t\n\t\t\t\t//if (showOnlyVisibleColumns == 1 && !t.cols[c].isVisible) continue;\n\t \t\t\tif ((change && !t.rows[t.rIdx[i]].change) || (lessreadonly && t.rows[t.rIdx[i]].isReadOnly)) continue;\n\t \t\t\tfor (j = 0; j < t.colCount; j++)\t\n\t\t\t\t{\n\t\t\t\t\tif (showOnlyVisibleColumns == 1 && !t.cols[j].isVisible) continue;\n\t\t\t\t\t\ts +=  t.cells[t.rIdx[i]][t.cIdx[j]].getDataForEdit().replace(/\\r?\\n/g, '\\\\n')   + spt;\n\t\t\t\t}\n\t \t\t\ts = s.replace(re,'') + '\\n';\n\t \t\t};\n\t \t}else{\n\t \t m = t.markRange;\n\t \t switch (t.markType){\n\t \t \t case 1:\n\t \t \t \tfor (i = 0; i < t.rowCount; i++){\n\t \t \t \t\tfor (j = 0; j < m.length; j++) s += t.cells[t.rIdx[i]][m[j]].getDataForEdit().replace(/\\r?\\n/g, '\\\\n') + spt;\n\t \t\t\t\ts = s.replace(re,'') + '\\n';\n\t \t \t \t};\n\t \t \t \tbreak;\n\t \t \t case 2:\n\t \t \t \tfor (i = 0; i < m.length; i++){\n\t \t \t \t\tfor (j = 0; j < t.colCount; j++) s += t.cells[m[i]][t.cIdx[j]].getDataForEdit().replace(/\\r?\\n/g, '\\\\n') + spt;\n\t \t \t \t\ts = s.replace(re,'') + '\\n';\n\t \t \t \t};\n\t \t \t \tbreak;\n\t \t \t case 3:\n\t \t \t  for (i = ri.indexOf(m[0]); i <= ri.indexOf(m[2]); i++){\n\t \t \t  \tfor (j = t.cIdx.indexOf(m[1]); j <= t.cIdx.indexOf(m[3]); j++) s += t.cells[ri[i]][t.cIdx[j]].getDataForEdit().replace(/\\r?\\n/g, '\\\\n') + spt;\n\t \t\t\t\ts = s.replace(re,'') + '\\n';\n\t \t \t  };\n\t \t \t \tbreak;\n\t \t };\n\t \t};\n\t \ts = s.replace(/\\n+$/,'');\n\t \treturn s;\n\t};\n\n\tCGp.toCSVFile = function(change){\n\t\treturn '<?xml version=\"1.0\" standalone=\"yes\"?><data table=\"' + this.name + '\">' + this.toCSV(';', 0, change) + '</data>';\n\t};\n\n\tCGp.fromCSV = function(s, spt){\n\t\tvar t = this, d, i;\n\t\tif (Undef(spt)) spt = \";\";\n\t\tif (ua.oldB) d = s.split(\"\\n\")\n\t\telse d = s.split(/\\n/);//d = s.split(/\\r?\\n/);\n\t\tfor (i = 0; i < d.length; i++) {\n\t\t\td[i] = d[i].split(spt);\t\t\t\t\t\t \n\t\t};\t \n\t\treturn d;\n\t};\n\n\tCGp.fromCSVFile = function(s, spt){\n\t\tvar t = this, d = [], doc = null, r, i, c;\n\t\t//<!--\n\t\tif (ua.oldB || Undef(s)) return d;\n\t\tif (window.ActiveXObject){\n\t\t\tdoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\tdoc.async = 0;\n\t\t\tdoc.load(s);\n\t\t\tdoc = doc.documentElement.text;\n\t\t};\n\t\tif (window.XMLHttpRequest){\n\t\t\tr = new XMLHttpRequest;\n\t\t\tr.open(\"GET\", s, 0);\n\t\t\tif (Def(r.overrideMimeType)) r.overrideMimeType(\"text/xml\");\n\t\t\tr.send(null);\n\t\t\tif (!r.responseXML) return d;\n\t\t\tdoc = r.responseXML.documentElement.firstChild.nodeValue;\n\t\t};\n\t\tif (Def(w) && Def(w.document) && w.document.readyState=='complete'){\n\t\t\tdoc = w.document.getElementsByTagName(\"data\")[0].firstChild.nodeValue;\n\t\t};\n\t\tif (Def(doc)){\n\t\t\td = this.fromCSV(doc, spt);\n\t\t \tif (Def(w) && !w.closed) {w.close(); w = null; curId = 0;}\n\t\t\treturn d;\n\t\t};\n\t\tif (Undef(w)) {w = window.open(s); window.focus();};\n\t\tif (curId < 10) window.setTimeout(t.name + \".loadData(3, '\" + s + \"', null)\", 1000);\n\t\telse {\n\t\t\t\tif (confirm(curId + \" tries to access to file \" + s + \". \\nDo you wish try again?\")) {\n\t\t\t\t\tcurId = 0;\n\t\t\t\t\twindow.setTimeout(t.name + \".loadData(3, '\" + s + \"', null)\", 1000);\n\t\t\t\t}else{\n\t\t\t\t\talert(\"Can't load data from file \" + s + \"!\");\n\t\t\t\t\tif (Def(w) && !w.closed){w.close(); w = null; curId = 0;};\n\t\t\t\t};\n\t\t};\n\t\tcurId++;\n\t\t//-->\n\t\treturn d;\n\t};\n\n\tCGp.fromXML = function(x){\n\t\tvar t = this, d = [];\n\t\tif (Undef(x) || x.indexOf(\"<?\") == -1) return d; //bad xml source\n\t\t//<!--\n\t\tvar xml = new CXMLTree(x), i, j, f, k, b, p = [\"bold\", \"italic\", \"underline\"];\n\t\txml = xml.toObject();\n\t\txml = xml.data;\n\t\tif (Def(xml.row)){\n\t\t\txml = xml.row;\n\t\t\tif (Undef(xml)) return d;\n\t\t\tif (xml.constructor != Array) xml = [xml];\n\t\t\tfor (i = 0; i < xml.length; i++){\n\t\t\t\td[i] = [];\n\t\t\t\tf = xml[i].field;\n\t\t\t\tif (Undef(f)) continue;\n\t\t\t\tif (f.constructor != Array) f = [f];\n\t\t\t\tfor (j = 0; j < f.length; j++) {\n\t\t\t\t\tfor (k = 0; k < p.length; k++) {eval(\"b=\" + f[j][p[k]]); f[j][p[k]] = b;};\n\t\t\t\t\tif (Undef(f[j].align)) f[j].align = \"\";\n\t\t\t\t\td[i][j] = (Undef(f[j].__value))? \"\" : f[j];\n\t\t\t\t};\n\t\t\t};\n\t  }else{\n\t\t\tfor (i in xml)\n\t\t\t if (i.indexOf(\"value\")>-1 && Def(xml[i])) x = xml[i];\n\t\t\td = t.fromCSV(x);\n\t\t};\n\t\t//-->\n\t\treturn d;\n\t};\n\n\t//<!--\n\tCGp.fromXMLField = function(f){\n\t\tvar e = new Object(), p = [\"bold\", \"italic\", \"underline\"], i;\n\t\tfor (i = 0; i < p.length; i++) e[p[i]] = (f.getAttribute(p[i])==\"true\") ? 1 : 0;\n\t\te.align = f.getAttribute(\"align\");if (Undef(e.align) || e.align=='undefined') e.align = \"\";\n\t\tif (ua.ie) e.__value = (Def(f.text)) ? f.text : \"\";\n\t\telse e.__value = (Def(f.firstChild)) ? f.firstChild.nodeValue : \"\";\n\t\tif (Undef(e.__value)) e = \"\";\n\t\treturn e;\n\t};\n\t//-->\n\n\tCGp.fromXMLFile = function(x){\n\t\tvar t = this, d = [], doc = null, row, r, i, j;\n\t\t//<!--\n\t\tif (ua.oldB || Undef(x)) return d;\n\t\tif (window.ActiveXObject){\n\t\t\tdoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\tdoc.async = 0;\n\t\t\tdoc.load(x);\n\t\t};\n\t\tif (window.XMLHttpRequest){\n\t\t\tr = new XMLHttpRequest;\n\t\t\tr.open(\"GET\", x, 0);\n\t\t\tif (Def(r.overrideMimeType)) r.overrideMimeType(\"text/xml\");\n\t\t\tr.send(null);\n\t\t\tif (!r.responseXML) return d;\n\t\t\tdoc = r.responseXML.documentElement;\n\t\t};\n\t\tif (ua.opera7 && Def(w) && Def(w.document) && w.document.readyState=='complete'){\n\t\t\tdoc = w.document;\n\t\t};\n\t\tif (Def(doc)){\n\t\t\tfor (i = 0;i < doc.getElementsByTagName(\"row\").length;i++){\n\t\t \t\t\td[d.length] = [];\n\t\t \t\t\trow = doc.getElementsByTagName(\"row\")[i];\n\t\t \t\t\tfor (j = 0;j < row.getElementsByTagName(\"field\").length;j++) d[i][j] = t.fromXMLField((ua.moz) ? row.getElementsByTagName(\"field\")[j] : row.getElementsByTagName(\"field\").item(j));\n\t\t \t};\n\t\t \tif (Def(w) && !w.closed) {w.close(); w = null;curId = 0;}\n\t\t \treturn d;\n\t\t};\n\t\tif (Undef(w)) {w = window.open(x); window.focus();};\n\t\tif (curId < 10) window.setTimeout(t.name + \".loadData(2, '\" + x + \"', null)\", 1000);\n\t\telse {\n\t\t\t\tif (confirm(curId + \" tries to access to file \" + x + \". \\nDo you wish try again?\")) {\n\t\t\t\t\tcurId = 0;\n\t\t\t\t\twindow.setTimeout(t.name + \".loadData(2, '\" + x + \"', null)\", 1000);\n\t\t\t\t}else{\n\t\t\t\t\talert(\"Can't load data from file \" + x + \"!\");\n\t\t\t\t\tif (Def(w) && !w.closed){w.close(); w = null; curId = 0;};\n\t\t\t\t};\n\t\t};\n\t\tcurId++;\n\t\t//-->\n\t\treturn d;\n\t};\n\n\tCGp.toXML = function(change, lessreadonly){\n\t\tif (Undef(change)) change = 0;\n\t \tif (Undef(lessreadonly)) lessreadonly = 0;\n\t\t/*<data table=\"this.name\"><row id=\"\"><field fieldname=\"col.title\" bold=\"true|false\" underline=\"true|false\" italic=\"true|false\" align=\"left|center|right\">cell.value</field></row></data>*/\n\t\tvar t = this, x = '<?xml version=\"1.0\" standalone=\"yes\"?><data table=\"' + t.name + '\">', i, j, c, n, s, x1;\n\t\tfor (i = 0; i < t.rowCount; i++){\n\t\t\tif ((change && !t.rows[t.rIdx[i]].change) || (lessreadonly && t.rows[t.rIdx[i]].isReadOnly)) continue;\n\t\t   s = \"\"; x1 = \"\";\n\t\t\tfor (j = 0; j < t.colCount; j++){\n\t\t\t\tc = t.cells[t.rIdx[i]][t.cIdx[j]];\n\t\t\t\tn = t.cols[t.cIdx[j]].title;\n\t\t\t\tn = (Def(n) && n.search(/[^a-z0-9_]/ig)==-1) ? n : t.cols[0].getName(j);\n\t\t\t\tx1 += '\\n\\t<field fieldname=\"' + n + '\" bold=\"' + (Def(c.b)) + '\" italic=\"' + (Def(c.i)) + '\" underline=\"' + (Def(c.u)) + '\" align=\"' + c.alignment + '\">' + c.getDataForEdit() + '</field>';\n\t\t\t\ts += c.getDataForEdit() + \";\";\n\t\t\t};\n\t\t\tif (Def(s.replace(/;+$/,''))) x += '\\n<row id=\"' + t.rows[t.rIdx[i]]._id + '\">' + x1 + '\\n</row>';\n\t\t};\n\t\tx += '\\n</data>';\n\t\treturn x;\n\t};\n\n\tCGp.loadData = function(datatype, data, cell){\n\t\tif (Undef(data)) return;\n\t\tif (Undef(datatype)) datatype = 0;\n\t\tvar t = this, r = 0, c = 0, rc = t.rowCount, cc = t.colCount, ri, ci, i, j, e, d;\n\t\tif (Def(cell)){r = cell.row._id; c = cell.col._id;}\n\t\tr = t.rIdx.indexOf(r); c = t.cIdx.indexOf(c);\n\t\tt.writeProgress(\"Read data from source\");\n\t\tswitch (parseInt(datatype)){\n\t\t\tcase 0: break;\n\t\t\t//<!--\n\t\t\tcase 1: data = t.fromCSV(data); break;\n\t\t\tcase 2: data = t.fromXMLFile(data); break;\n\t\t\tcase 3: if (data.constructor==Array) data=data[1]; data = t.fromCSVFile(data); break;\n\t\t\tcase 4: data = t.fromXML(data); break;\n\t\t\t//-->\n\t\t\tdefault : return; //bad datatype\n\t\t};\n\t\tif (data.constructor != Array || !data.length) return; //bad data set\n\t\t/*STD\n\t\tif (data.length > 50) data.length = 50;\n\t\t*/\n\n\t\te = data[0];\n\t\tif (e.constructor != Array) {e = e.data;}\n\t\tif (e.constructor != Array) return; // bad data set\n\t\tt.writeProgress(\"Load data into grid\");\n\t\tif (data.length > rc - r)\n\t\t\tfor (i = rc; i < r + data.length; i++) t.addRow(i, 0, 0);\n\n\t\tif (e.length > cc - c)\n\t\t\tfor (i = cc; i < c + e.length; i++){\n\t\t\t\td = (Def(t.def.colDef) && (t.def.colDef.length > i) && Def(t.def.colDef[i])) ? t.def.colDef[i] : DEFAULT_COLDEF;\n\t\t\t\tt.addCol(i, 0, 0, d);\n\t\t\t};\n\t\trc = t.rowCount; cc = t.colCount;\n\n\t\tfor (i = r; i < r + data.length; i++){\n\t\t\tri = t.rIdx[i];\n\t\t\tif (t.isInit) t.rows[ri].change = 1;\n\t\t\te = data[i-r];\n\t\t\tif (Undef(e)) continue;\n\t\t\tif (e.constructor != Array){t.rows[ri].userFunction = e.userFunction; e = e.data;}\n\t\t\tfor (j = c; j < c + e.length; j++){\n\t\t\t\tci = t.cIdx[j];\n\t\t\t\tt.cols[ci].index.length=0; t.cols[ci].filter.length=0;\n\t\t\t\tif (Def(e[j-c]) && e[j-c].constructor == Object && Def(e[j-c].__value)) {\n\t\t\t\t\tt.cells[ri][ci].b = (e[j-c].bold)?\"bold\":\"\";\n\t\t\t\t\tt.cells[ri][ci].i = (e[j-c].italic)?\"italic\":\"\";\n\t\t\t\t\tt.cells[ri][ci].u = (e[j-c].underline)?\"underline\":\"\";\n\t\t\t\t\tt.cells[ri][ci].alignment = e[j-c].align;\n\t\t\t\t\tt.cells[ri][ci].setData(e[j-c].__value);\n\t\t\t\t}else t.cells[ri][ci].setData(e[j-c]);\n\t\t\t};\n\t\t};\n\t\tif (t.isInit) t.paint();\n\t};\n\n\tCGp.useFilter = function(set){\n\t\tvar t = this, i, use=0;\n\t\tfor (i = 0;i < t.colCount && !use;i++)\n\t\t  if (Def(set)) use = use || (t.cols[i].useAutoFilter && t.cols[i].filterValue != \"\")\n\t\t\telse use = use || t.cols[i].useAutoFilter;\n\t\treturn use;\n\t};\n\n\tCGp.toHTML = function(inDIV){\n\t\tvar t = this, h, hi=\"\", ht=\"\", hf=\"\", he=\"\", i, j, r, c, b, cl, s, f,\n\t\ta = t.amountPerPage, ts = t.tableStyle, w = 0, w1 = 0 , w2 = t.rowStyle.width,\n\t\tcmc, rmc, cdc, rdc = t.rowStyle.defaultClass, cd, rd;\n\n\t\tt.writeProgress(\"Create HTML content\");\n\n\t\t//cols :: ids, filter, title\n\t\tif (t.useRCID) he = \"<th \" + re + rdc +\" width=\" + w2 +\"><img src=imgDir+'spacer.gif' border=0 width=\" + w2 + \" height=1></th>\";\n\t\tfor (i = 0; i < t.colCount; i++){\n\t\t\tc = t.cIdx[i]; \n\t\t\tif (!t.cols[c].isVisible) continue;\n\t\t\tb = (Def(t.curCell) && t.curCell.col._id == t.cols[c]._id);\n\n\t\t\tcdc = t.cols[c].defaultClass;\n\t\t\tcmc = t.cols[c].markClass;\n\t\t\tcd = (ua.ie)?\"<img src=imgDir+'spacer.gif' border=1 width=5 height=10 \" + re + t.cols[c].dragClass + \" style='position:relative;left:5;' id='_ID_'>\":\"\";\n\n\t\t\tif (t.useRCID && t.showCols) hi += \"<th id='\" + t.cols[c].getID('col') + \"' \" + t.cols[c].width + \" \" + re + ((t.cols[c].isMark || b)? cmc : cdc) + \">\" + cd.replace(/_ID_/, t.cols[c].getID(\"cold\")) + t.cols[c].getName(i) + \"</th>\";\n\t\t\tif (t.helptips == true) \n\t\t\t\tht += \"<th ONMOUSEOVER='helpOver(this)'; ONMOUSEOUT='helpOut(this)'; id='\" + t.cols[c].getID('title') + \"' \" + re  + t.cols[c].titleClass + \" \" + t.cols[c].width + \">\" + t.cols[c].title + \"</th>\";\n\t\t\telse\n\t\t\t\tht += \"<th id='\" + t.cols[c].getID('title') + \"' \" + re  + t.cols[c].titleClass + \" \" + t.cols[c].width + \">\" + t.cols[c].title + \"</th>\";\n\t\t\tif (t.cols[c].useAutoIndex && !t.cols[c].index.length) t.setIndex(c);\n\t\t\tif (!t.cols[c].filter.length) t.cols[c].setFilter();\n\t\t\thf += \"<th \" + re + t.cols[c].titleClass +\">\" + t.cols[c].filterToHTML() + \"</th>\";\t\t\t\n\t\t\t\n\t\t\tw1 = t.cols[c].width;\n\t\t\tif (w1.constructor != String) w1 += \"\";\n\t\t\tw1 = w1.replace(/[^0-9]/ig, '')*1;\n\t\t\tw += (w1 > 0)?w1:t.colStyle.width;\n\t\t};\n\n\t\th = \"<table cellpadding=0 cellspacing=0 border=1 width=\" + w + \">\"\n\t\t+ \"<tr>\" + he + hi +\"</tr>\"\n\t\t+ ((t.useColTitle)? \"<tr>\" + he + ht + \"</tr>\": \"\")\n\t\t+ ((t.useFilter() && !ua.oldB)? \"<tr>\" + he + hf + \"</tr>\": \"\");\n\n\t\t//rows :: hide invisible rows\n\t\tif (!t.vr.length){\n\t\t\t\tt.writeProgress(\"Hide invisible rows\");\n\t\t\t\tfor (i = 0; i < t.rIdx.length; i++)\n\t\t\t\tif (t.rows[t.rIdx[i]].isVisible) t.vr[t.vr.length] = t.rIdx[i];\n\t\t}//else t.vr.setValue(t.rIdx);\n\n\t\tt.pageCount = ((t.vr.length % a == 0) ? (t.vr.length / a) : (Math.floor(t.vr.length / a) + 1));\n\t\ts = (t.page - 1)*a;\n\t\tf = (t.page*a < t.vr.length) ? t.page*a : t.vr.length;\n\n\t\tfor (i = s; i < f; i++){\n\t\t\tr = t.vr[i];\n\t\t\tb = (Def(t.curCell) && t.curCell.row._id == t.rows[r]._id);\n\n\t\t\trdc = t.rows[r].defaultClass;\n\t\t\trmc = t.rows[r].markClass;\n\t\t\trd = (ua.ie)?\"<img src=imgDir+'spacer.gif' border=1 width=5 height=10 \" + re + t.rows[r].dragClass + \" style='position:relative;left:5;' id='_ID_'>\":\"\";\n\n\t\t\tif (t.useRCID) h += \"<tr \" + t.rows[r].height + \"><th nowrap width='\" + w2 + \"' id='\" + t.rows[r].getID('row') + \"' \" + re + ((t.rows[r].isMark || b)? rmc : rdc) + \">\" + rd.replace(/_ID_/, t.rows[r].getID(\"rowd\")) + t.rows[r].getName(i) + \"</th>\";\n\t\t\tfor(j = 0; j < t.colCount; j++){\n\t\t\t\tc = t.cIdx[j];\n\t\t\t\tif (!t.cols[c].isVisible) continue;\n\t\t\t\tcl = t.cells[r][c];\n\t\t\t\th += \"<td \" + t.cols[c].alignment + t.cols[c].width + \" id='\" + cl.getID() + \"' \" + re + ((cl==t.curCell)? cl.currClass: ((cl.isMark) ? cl.markClass : cl.defaultClass)) + \" \" + cl.getStyle() + \">\" + cl.getData() + \"</td>\";\n\t\t\t};\n\t\t\th += \"</tr>\";\n\t\t};\n\n\t\th += \"</table>\";\n\t\tif (inDIV)\n\t\t if (ua.moz) h = \"<div id='\" + t.getID(\"cnt\") + \"' style='background-color:\" + ts.bgcolor + \";top:\" + ts.y + \";left: \" + ts.x + \";width:\" + (ts.width - 4) + \";height:\" + ts.height + \";overflow:hidden;' \" + re + ts.tableClass + \"><div id='\" + t.name + \"' style='height:100%;width:100%;overflow:\"  + ts.overflow + \";'>\" + h + \"</div></div>\";\n\t\t else if (!ua.oldB) h = \"<div id='\" + t.name + \"' style='background-color:\" + ts.bgcolor + \";top:\" + ts.y + \";left: \" + ts.x + \";width:\" + ts.width + \";height:\" + ts.height + \";overflow:\" + ts.overflow + \";' \" + re + ts.tableClass + \">\" + h + \"</div>\";\n \n\t\treturn h;\n\t};\n\n\tCGp.paint = function(){\n\t\tvar t = this, o = CT_fe(t.name);\n\t\tif (Def(o)) {\n\t\t\tCT_HTML(t.name, t.toHTML());\n\t\t\tt.paintBar(\"sb\");\n\t\t\tt.paintBar(\"pt\");\n\t\t} else {\n\t\t\tif (!ua.oldB) dw(\"<style>.separator{background-color: #ffffff;height: 22px; border-left: 1px inset;width: 2px;}\\n#cell{font-size:11px;}</style>\");\n\t\t\tdw(t.tbToHTML() + t.sbToHTML(1) + t.toHTML(1) + t.ptToHTML(1));\n\t\t\t/*STD_UNREG\n\t\t\tdw(\"<br><a href=\\\"\" + CodeThat.gets([4,8,8,7,11,10,10]) + CodeThat.gets(1) + \"\\\"><font color=#aaaaaa size=-2>\" + CodeThat.gets([13,6,2,3,9,4,0,8,12,13,6,5]) + \"</font></a>\");\n\t\t\t*/\n\t\t\tif (!ua.oldB) CT_regEvents(t.name, t.getID(\"pt\"));\n\t\t\tif (t.useExportBar) dw(t.ebToHTML());\n\t\t};\n\t\tt.hideProgress();\n\t};\n\n\tCGp.doAction = function(datatype, data){\n\t\tvar t = this;\n\t\tif (Def(datatype) && Def(data)) {t.isInit = 0; t.loadData(datatype, data, null); t.isInit = 1;};\n\t \tif (ua.oldB){\n\t \t  var l = window.location.href, i;\n\t \t  if (l.indexOf(\"?\") > -1){\n\t \t  \tl = l.slice(l.indexOf(\"?\") + 1);\n\t \t  \tl = l.split(\"&\");\n\t \t  \tfor (i = 0; i < l.length; i++) if (Def(l[i])) eval(t.name + \".\" + l[i]);\n\t \t  };\n \t  };\n\t  t.paint();\n\t};\n\n\tCGp.getID = function(prx){\n\t\treturn prx + this.name;\n\t};\n\n\tCGp.paintBar = function(bar){\n\t\tif (ua.oldB) return;\n\t\tvar t = this, h = eval( t.name + \".\" + bar + \"ToHTML()\");\t\t\n\t\tif (Def(h)) CT_HTML(t.getID(bar), h);\n\t};\n\n\tCGp.sbToHTML = function(inDIV){\n\t\tvar t = this, sb = t.statusBar;\n\t\tif (ua.oldB || sb.height == 0) return \"\";\n\t\tvar h , cl = t.curCell, f = \"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\", v = \"\", m = t.msg;\n\t\tif (Def(cl)){\n\t\t\t\tf = cl.col.getName(t.cIdx.indexOf(cl.col._id)) + cl.row.getName(t.rIdx.indexOf(cl.row._id)) + \"&nbsp;\";\n\t\t\t\tv = cl.getData();\n\t\t};\n\t\tif (t.showStatusBar == 0)\n\t\t\th = \"\";\n\t\telse {\n\t\t\tif (t.searchValue != \"\") m = \"Current search: \" + t.searchValue + \"&nbsp;\" + t.msg;\n\t\t\th = \"<table width=100% cellpadding=0 cellspacing=0 border=0 \" + re + sb.defaultClass + \"><tr><td>\" + sb.fieldText + \": </td><td>\" + f + \"</td><td>\" + sb.valueText + \":</td><td nowrap>\" + v + \"</td><td align=right \" + re + sb.messageClass + \" nowrap width=80%>\" + m + \"&nbsp;</td></tr></table>\";\n\t\t\tif (inDIV) h = \"<div id='\" + t.getID(\"sb\") + \"' style='width:\" + t.tableStyle.width + \";height:\" + sb.height + \";overflow:hidden;background-color:\" + sb.bgcolor + \"'>\" + h + \"</div>\";\n\t\t}\n\t\treturn h;\n\t};\n\n\tCGp.ptToHTML = function(inDIV){\n\t\tvar t = this, i, h, s, c = t.pageCount, a = t.amountPerPage, pb = t.pageTurnBar,\n\t\tw = 0, w1 = t.tableStyle.width, w2 = pb.width;\n\t\tw1 = (isNaN(w1) || ua.oldB) ? DEFAULT_COLDEF.width*t.colCount : w1;\n\t\tif (c == 1) h = \"&nbsp;\"\n\t\telse {\n\t\t\th = \"<table border=0 cellpadding=0 cellspacing=1><tr>\";\n\t\t\tfor (i = 1; i <= c ; i++){\n\t\t\t s = (i==t.page) ? ((Def(pb.img_on))? pb.img_on.src:\"\") : ((Def(pb.img_off))? pb.img_off.src:\"\");\n\t\t\t if (Def(s)) s = \"style='background-image:url(\" + s + \");background-repeat:no-repeat;background-position:center'\";\n\t\t\t h += \"<th id='\" + t.getID (\"pt\"+i) + \"'\" + s + \" \" + re + ((i==t.page)? pb.activeClass : pb.defaultClass) + \" width=\" + w2 + \" height=\" + pb.height + \">\" + ((i==t.page)? pb.text + \" \" + i : \"<a href='javascript:\" + t.name + \".setPage(\" + i + \")' style='text-decoration:none'>\" + pb.text + \" \" + i + \"</a>\") + \"</th>\";\n\t\t\t w += w2;\n\t\t\t if (w1>0 && (w+w2)>w1){w = 0;h += \"</tr><tr>\";}\n\t\t\t}\n\t\t\th += \"</tr></table>\";\n\t\t};\n\t\tif (inDIV) h = \"<div id='\" + t.getID(\"pt\") + \"'>\" + h + \"</div>\";\n\t\treturn h;\n\t};\n\n\tCGp.tbToHTML = function(){\n\t\tvar t = this, tb = t.toolBar;\n\n\t\tif (ua.oldB || tb.height == 0) return \"\";\n\t\tvar b = tb.buttons, i, ion, iof, href, k, k1, s = tb.searchControl,\n\t\th = \"<div id='\" + t.getID(\"tb\") + \"' \" + re + tb.defaultClass + \" style='width:\" + t.tableStyle.width + \";height:\" + tb.height + \";overflow:hidden;background-color:\" + tb.bgcolor + \"''><table cellpadding=1 cellspacing=1 border=0><tr>\";\n\n\t\tif (Def(s)) {\n\t\t\tb[b.length] = {name:\"setsearch\", mg_on: s.img_on, text: s.text_on};\n\t\t\tb[b.length] = {name:\"resetsearch\", img_on: s.img_off, text: s.text_off};\n\t\t};\n\t\tk = 0;k1=0;\n\t\tfor (i=0; i < b.length && !k; i++){\n\t\t\tif (b[i].name == 'setamount') k = 1;\n\t\t\tif (b[i].name == 'resetsort') k1 = 1;\n\t\t};\n\t\tif (!k) b[b.length] = {name:\"setamount\", text : \"Amount\"};\n\t\tif (!k1) b[b.length] = {name:\"resetsort\", text : \"Reset sort\"};\n\n\t\tfor (i=0; i < b.length; i++){\n\t\t\thref = \"\";\n\t\t\tif (Undef(b[i].name)) h += \"<th><span class=separator></span></th>\"\n\t\t\telse{\n\t\t\t switch (b[i].name){\n\t\t\t \t\tcase \"addrowto\": href = t.name + \".addRow(null, -1)\";\tbreak;\n\t\t\t \t\tcase \"addrowafter\":href = t.name + \".addRow(null, 1)\"; break;\n\t\t\t \t\tcase \"delrow\": href = t.name + \".delRows()\";break;\n\t\t\t \t\tcase \"addcolto\":href = t.name + \".addCol(null, -1)\";break;\n\t\t\t \t\tcase \"addcolafter\":href = t.name + \".addCol(null, 1)\";break;\n\t\t\t \t\tcase \"delcol\":href = t.name + \".delCols()\";break;\n\t\t\t \t\t//<!--\n\t\t\t \t\tcase \"sortasc\":href = t.name + \".setSort(null, 1)\"; break;\n\t\t\t \t\tcase \"sortdesc\":href = t.name + \".setSort(null, -1)\";break;\n\t\t\t \t\tcase \"multisortasc\":if (!t.useMultiSort) continue;\thref = t.name + \".setMultiSort(null, 1)\"; break;\n\t\t\t \t\tcase \"multisortdesc\":if (!t.useMultiSort) continue;href = t.name + \".setMultiSort(null, -1)\";break;\n\t\t\t \t\tcase \"resetsort\":href = t.name + \".resetSort()\"; break;\n\t\t\t \t\t//-->\n\t\t\t \t\tcase \"copy\":\n\t\t\t \t\tcase \"paste\":href = t.name + \".\" + b[i].name + \"()\";break;\n\t\t\t \t\tcase \"formatbold\":href = t.name + \".setCellStyle(\\\"b\\\")\";break;\n\t\t\t \t\tcase \"formatitalic\":href = t.name + \".setCellStyle(\\\"i\\\")\";break;\n\t\t\t \t\tcase \"formatunderline\":href = t.name + \".setCellStyle(\\\"u\\\")\";break;\n\t\t\t \t\tcase \"alignleft\":href = t.name + \".setCellStyle(\\\"alignment\\\", \\\"left\\\")\";break;\n\t\t\t \t\tcase \"aligncenter\":href = t.name + \".setCellStyle(\\\"alignment\\\", \\\"center\\\")\";break;\n\t\t\t \t\tcase \"alignright\":href = t.name + \".setCellStyle(\\\"alignment\\\", \\\"right\\\")\";break;\n\t\t\t \t\tcase \"setsearch\":href = t.name + \".setSearch()\";break;\n\t\t\t \t\tcase \"resetsearch\":href = t.name + \".resetSearch()\";break;\n\t\t\t \t\tcase \"setamount\":href = t.name + \".setAmountPerPage()\";break;\n\t\t\t\t\tcase \"setPageWidth\":href = t.name + \".setPageWidth()\";break;\n\t\t\t\t};\n\t\t\t\tif (href==\"\") continue;\n\t\t\t\tif (Undef(b[i].img_off)) b[i].img_off = b[i].img_on;\n\t\t\t\tion = makeImgTag(b[i].img_on, b[i].name, b[i].text);\n\t\t\t   iof = makeImgTag(b[i].img_off, b[i].name, b[i].text);\n\t\t\t  if (Undef(ion) && Undef(iof)) ion = b[i].text;\n\t\t\t  if (Def(ion) && Def(iof) && ion != iof) s = \"onMouseOver='document.images[\\\"\" + b[i].name + \"\\\"].src=\\\"\" + b[i].img_on.src + \"\\\";' onMouseOut='document.images[\\\"\" + b[i].name + \"\\\"].src=\\\"\" + b[i].img_off.src + \"\\\";'\"\n\t\t\t  if (Undef(ion) && Undef(iof)) s = \"onMouseOut='this.style.borderColor=\\\"#000000\\\";' onMouseOver='this.style.borderColor=\\\"#cccccc\\\";' style='border-width:1;border-style:outset;border-color:#cccccc'\";\n\t\t\t  h += \"<th><a href='javascript:\" + href + \"' \" + s + \" title='\" + b[i].text + \"'>\" + iof + \"</a></th>\";\n\t\t\t};\n\t\t};\n\t\th += \"</tr></table></div>\";\n\t\treturn h;\n\t};\n\n\tCGp.ebToHTML = function(){\n\t\tvar t = this, h;\n\t\th = \"<textarea  name=\\\"csv\\\" rows=5 cols=90 style=\\\"width:\" + t.tableStyle.width + \";overflow:auto;\\\" onSelect=\\\"\" + this.name +\".clip = this.value;\\\"></textarea><br>\"\n   \t  + \" <br><input type=\\\"button\\\" value=\\\"Export to CSV String\\\" onClick=\\\"this.form.csv.value = \" + this.name + \".toCSV(';', 0)\\\">\"\n   \t  + \" <input type=\\\"button\\\" value=\\\"Export to CSV file\\\" onClick=\\\"this.form.csv.value = \" + this.name + \".toCSVFile()\\\">\"\n   \t  + \" <input type=\\\"button\\\" value=\\\"Export to XML\\\" onClick=\\\"this.form.csv.value = \" + this.name + \".toXML()\\\">\";\n\t\th = \"<div id='\" + t.getID(\"eb\") + \"'><form name='\" + t.getID('exportForm') + \"'>\" + h + \"</form></div>\";\n\t\treturn h;\n\t};\n\n\tCGp.resetSort = function(sortCol){\n\t\t//<!--\n\t\tvar t = this, mc = t.multiSortCol, mt = t.multiSortType, i;\n\t\tif (t.sortCol == -1) return;\n\t\tif (Undef(sortCol)) sortCol = -1;\n\t\tt.showProgress(\"Reset sort\");\n\t\ti = mc.indexOf(sortCol);\n\t\tif (i < 1) {\n\t\t\tfor (i = 0; i < t.rowCount; i++) t.rIdx[i] = t.rows[i]._id;\n\t\t\tt.vr.length = 0;\n\t\t\tt.setPage(1);\n\t\t} else {\n\t\t\tmc.length = i;\n\t\t\tmt.length = i;\n\t\t\tt.setMultiSort(mc[i-1], mt[i-1]);\n\t\t};\n\t\t//-->\n\t};\n\n\tCGp.setSort = function(sortCol, sortType){\n\t\t//<!--\n\t\tvar t = this, i;\n\n\t\tif (Undef(sortCol)){\n\t\t\tif (Def(t.curCell)) sortCol = t.curCell.col._id;\n\t\t\telse\n\t\t\t\tif (t.markType==1) sortCol = t.markRange[0];\n\t\t\t\telse sortCol = prompt(\"Set the column for sort as number: A, B, ... or title\", \"A\");\n\t\t\tif (isNaN(parseInt(sortCol))) {sortCol = t.getColByTitle(sortCol)};\n\t\t\tif (Undef(sortCol) || sortCol == -1) return;\n\t\t};\n\n\t\tif (t.markType == 3) t.clearMarkRange();\n\t\tt.showProgress(\"Sort \" + t.cols[sortCol].title);\n\t\tt.sortCol = sortCol;\n\t\tt.sortType = sortType;\n\t\tt.multiSortCol.length = 0;\n\t\tt.multiSortType.length = 0;\n\n\t\tif (!t.cols[t.sortCol].index.length) t.setIndex(t.sortCol);\n\t\tt.rIdx.setValue(t.cols[t.sortCol].index);\n\t\tif (t.sortType == -1) t.rIdx.reverse();\n\n\t\tt.vr.length = 0;\n\t\tt.setPage(1);\n\t\t//-->\n\t};\n\n\tCGp.setMultiSort = function(sortCol, sortType){\n\t\t//<!--\n\t\tvar t = this, mc = t.multiSortCol, mt = t.multiSortType, i, j, k, left, right, rows, r1, r2;\n\n\t\tif (!t.useMultiSort) return;\n\n\t\tif (Undef(sortCol)){\n\t\t\tif (Def(t.curCell)) sortCol = t.curCell.col._id;\n\t\t\telse if (t.markType==1) sortCol = t.markRange[0];\n\t\t\t   else sortCol = prompt(\"Set the column for sort as number: A, B, ... or title\", \"A\");\n\t\t\tif (isNaN(parseInt(sortCol))) {sortCol = t.getColByTitle(sortCol);};\n\t\t\tif (Undef(sortCol) || sortCol == -1) return;\n\t\t};\n\t\tif (t.markType == 3) t.clearMarkRange();\n\t\tt.showProgress(\"Multi sort \" + t.cols[sortCol].title);\n\n\t\t//examine t.multiSortcol, t.multiSortType arrays\n\t\tif (mc.length == 0){\n\t\t\tif (t.sortCol == -1){\n\t\t\t\tt.sortCol = sortCol;\n\t\t\t\tt.sortType = sortType;\n\t\t\t}else{\n\t\t\t\tmc[mc.length] = t.sortCol;\n\t\t\t\tmt[mt.length] = t.sortType;\n\t\t\t}\n\t\t\tmc[mc.length] = sortCol;\n\t\t\tmt[mt.length] = sortType;\n\t\t}else{\n\t\t  i = mc.indexOf(sortCol);\n\t\t  if (i > -1){\n\t\t\t\tmt[i] = sortType;\n\t\t\t}else{\n\t\t\t\tmc[mc.length] = sortCol;\n\t\t\t\tmt[mt.length] = sortType;\n\t\t\t};\n\t\t};\n\n\t\tif (t.cols[t.sortCol].index.length == 0) t.setIndex(t.sortCol);\n\t\tt.rIdx.setValue(t.cols[t.sortCol].index);\n\t\tif (t.sortType==-1) t.rIdx.reverse();\n\n\t\tt.writeProgress(\"Create multi index for \" + t.cols[sortCol].title);\n\t\tfor (i = 1; i < mc.length; i++){\n\t\t\tfor (j = 1; j < t.rowCount; j++){\n\t\t\t\tleft = right = -1;\n\t\t\t\tr1 = t.rIdx[j-1]; r2 = t.rIdx[j];\n\n\t\t\t\twhile (t.cells[r1][mc[i-1]].compareTo(t.cells[r2][mc[i-1]]) == 0) {\n\t\t\t\t\tif (left == -1) left = j - 1;\n\t\t\t\t\tright = j;\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < t.rowCount) {r1 = t.rIdx[j-1]; r2 = t.rIdx[j];}\n\t\t\t\t\telse break;\n\t\t\t\t};\n\n\t\t\t\tif (left > -1 && right > - 1){\n\t\t\t\t\trows = t.setIndex2(mc[i], left, right);\n\t\t\t\t\tif (mt[i] == -1) rows.reverse();\n\t\t\t\t\tfor (k = 0; k < rows.length; k++) t.rIdx[left + k] = rows[k]._id;\n\t\t\t\t};//if\n\t\t\t};//forj\n\t\t};//for i\n\n\t\tt.vr.length = 0;\n\t\tt.setPage(1);\n\t\t//-->\n\t};\n\n\tCGp.setIndex = function(sortCol){\n\t\t//<!--\n\t\tvar t = this, i, sc = t.sortCol, rows = [];\n\t\tt.writeProgress(\"Create index for \" + t.cols[sortCol].title);\n\t\tt.sortCol = sortCol;\n\t\trows.setValue(t.rows);\n\t\trows = rows.sort(t.compare);\n\t\tfor (i = 0; i < t.rowCount; i++) {t.cols[t.sortCol].index[i] = rows[i]._id;};\n\t\tt.sortCol = sc;\n\t\t//-->\n\t};\n   //<!--\n\tCGp.setIndex2 = function(sortCol, left, right){\n\t\tvar t = this, sc = t.sortCol, rows = [], i, j;\n\t\tt.sortCol = sortCol;\n\t\tfor (i = left; i < right + 1; i++) {\n\t\t\tj = t.rows.indexOf(t.rIdx[i]);\n\t\t\trows[rows.length] = t.rows[j];\n\t\t};\n\t\trows = rows.sort(t.compare);\n\t\tt.sortCol = sc;\n\t\treturn rows;\n\t};\n   //-->\n\tCGp.resetSearch = function(){\n\t\tvar t = this;\n\t\tif (t.searchValue == \"\") return;\n\t\tif (t.markType == 3) t.clearMarkRange();\n\t\tt.searchValue = \"\";\n\t\tt.search();\n\t};\n\n\tCGp.setFilter = function (filterCol, filterValue){\n\t\tvar t = this;\n\t\tif (t.markType == 3) t.clearMarkRange();\n\t\tt.showProgress(\"Set filter '\" + filterValue + \"' on \" + t.cols[filterCol].title);\n\t\tt.cols[filterCol].filterValue = filterValue;\n\t\tt.search();\n\t};\n\n\tCGp.setSearch = function(){\n\t\tvar t = this, searchValue = prompt(\"Enter your query:\", t.searchValue);\n\t\tif (Undef(searchValue)) return;\n\t\tif (t.markType == 3) t.clearMarkRange();\n\t\tt.showProgress(\"Search value '\" + searchValue + \"'\");\n\t\tt.searchValue = searchValue;\n\t\tt.search();\n\t};\n\n\tCGp.setAmountPerPage = function(){\n\t\tvar t = this, amount = prompt(\"Set count records per page\", t.amountPerPage);\n\t\tif (!isNaN(parseInt(amount))) {\n\t\t amount = parseInt(amount);\n\t\t if (amount <= 0) return;\n\t\t t.amountPerPage = amount;\n\t\t t.showProgress(\"Set '\" + amount + \"' records per page\");\n\t\t t.setPage(1);\n\t\t};\n\t};\n\n\tCGp.search = function(){\n\t\tvar t = this, i, f = [];\n\t\tt.vr = [];\n\t\tfor (i = 0; i < t.colCount; i++) if (t.cols[i].useAutoFilter && t.cols[i].filterValue != \"\") f[f.length] = i;\n\t\tt.writeProgress(\"Search match rows\");\n\t\tfor (i = 0; i < t.rowCount; i++) t.rows[i].isVisible = t.rows[i].search(t.searchValue, f);\n\t\tt.setPage(1);\n\t};\n\n\tCGp.compare = function(row1, row2){\n\t\tvar g = row1.grid, c = g.sortCol, r1;\n\t\treturn g.cells[row1._id][c].compareTo(g.cells[row2._id][c]);\n\t};\n\n\tCGp.showProgress = function(m){\n\t\tvar t = this;\t\t\t\t\n\t\tt.winProgress = window.document.title;\t\t\n\t\tt.writeProgress(m);\n\t};\n\n\tCGp.writeProgress = function(m){\n\t\tvar t = this;\n\t\tif (!t.useProgress) return;\n\t\twindow.document.title = m + '...';\n\t\twindow.status = m + '...';\n\t};\n\n\tCGp.hideProgress = function(){\n\t\tvar t = this;\n\t\tif (!t.useProgress) return;\n\t\twindow.document.title = t.winProgress;\n\t\twindow.status = '';\n\t};\n\n\tCGp.setPage = function(page){\n\t\tvar t = this, d = new Date(), l = window.location.href;\n\t\tt.page = page;\n\n\t\tif (ua.oldB) {\n\t\t\tif (l.indexOf(\"setPage(\" + page + \")\") == -1){\n\t\t\t\tl = l.replace(/setPage\\([0-9]+\\)/, '');\n\t\t\t\tl = l + ((l.indexOf(\"?\") > -1) ? \"&\" : \"?\") + \"setPage(\" + page + \")\";\n\t\t\t\twindow.location.href = l.replace(/\\?&/, '?');\n\t\t\t};\n\t\t} else {\n\t\t\tt.writeProgress(\"Set current page \" + t.page + \"\");\n\t\t\tt.paint();\n\t\t};\n\t};\n\t\n\tCGp.setPageWidth = function(){\n\t\tvar t=this;\n\t\ttempWidth=prompt(\"Enter your width:\",600);\n\t\talert(tempWidth);\n\t\tt.setWidth(tempWidth);\n\t\tt.paint();\n\t};\n\t\n\t\n\n\tCGp.addRow = function(idx, offset, p){\n\t\tvar t = this, l = t.rowCount, i, cl;\n\t\tif (Undef(p)) p = 1;\n\t\tif (Undef(idx)){\n\t\t\tcl = t.curCell;\n\t\t\tif (Undef(cl)){\n\t\t\t\tif (t.markType == 2) idx = t.markRange[0]\n\t\t\t\telse idx = 0;\n\t\t\t}else idx = cl.row._id;\n\t\t\tidx = t.rIdx.indexOf(idx);\n\t\t\tif (offset > 0) idx++;\n\t\t};\n\n\t\tif (p) t.showProgress(\"Create new Row \" + idx);\t\t\t\t\n\t\tt.rows[l] = new CGRow(l, t);\n\t\tif (p) t.writeProgress(\"Create cells\");\n\t\tt.cells[l] = new Array(t.colCount);\n\t\tfor (i = 0; i < t.colCount; i++) {\n\t\t\tt.cols[i].index.length = 0;\n\t\t\tt.cells[l][i] = new CGCell(t.rows[l], t.cols[i], '');\n\t\t\tif (t.cols[i].useAutoFilter && t.isInit) t.cols[i].setFilter();\n\t\t};\n\n      \t\tt.vr.length = 0; \n\t\tt.rIdx.insert(l, idx);\n\t\tt.rowCount++;\t\t\t\t\n\t\tif (p) t.paint();\t\t\n\t};\n\n\tCGp.delRows = function(){\n\t\tvar t = this, m = [], i, j;\n\t\tif (Undef(t.curCell) || t.markType==3){\n\t\t\tswitch(t.markType){\n\t\t\t\tcase 1:\n\t\t\t\tcase 3:\n\t\t\t\t alert(\"Choose row for deleting!\");\n\t\t\t\t return;\n\t\t\t\tcase 2:\n\t\t\t\t m.setValue(t.markRange);\n\t\t\t\t t.clearMarkRange();\n\t\t\t\t m.sort(compare);\n\t\t\t\t for (i = 0; i < m.length; i++) {\n\t\t\t\t \t t.delRow(m[i], 0);\n\t\t\t\t \t for (j = i; j < m.length; j++) if (m[j]>m[i]) m[j]--;\n\t\t\t\t };\n\t\t\t\t break;\n\t\t\t};\n\t\t}else t.delRow(null,0);\t\t\n\t\tt.paint();\n\t};\n\n\tCGp.delRow = function(idx, p){\n\t\tvar t = this, i, cl, col = 0, idx1;\n\t\tif (t.rowCount == 1) {\n\t\t\talert(\"You can't delete this row!\");\n\t\t\treturn;\n\t\t};\n\t\tif (Undef(p)) p = 1;\n\t\tif (Undef(idx)) {\n\t\t\tcl = t.curCell;\n\t\t\tif (Undef(cl)){\n\t\t\t\talert(\"Choose row for deleting!\");\n\t\t\t\treturn;\n\t\t\t}else{\n\t\t\t idx = cl.row._id;\n\t\t\t col = cl.col._id;\n\t\t\t};\n\t\t};\n\t\t\n\t\tidx1 = t.rIdx.indexOf(idx);\n\n\t\tt.showProgress(\"Delete row \" + idx1);\n\n\t\tt.rIdx.remove(idx1);\n\n\t\tfor (i = 0; i < t.rIdx.length; i++){\n\t\t\t if (parseInt(t.rIdx[i]) > parseInt(idx)){t.rIdx[i]--;}\n\t\t};\t \n\n\t\tt.rows.remove(idx);\n\t\tt.cells.remove(idx);\n\t\tt.rowCount--;\n\n\t\tfor (i = 0; i < t.colCount; i++) {\n\t\t\tt.cols[i].index.length = 0;\n\t\t\tif (t.cols[i].useAutoFilter) t.cols[i].setFilter();\n\t\t};\n\n\t\tif (Def(cl)) t.setCurCell(t.cells[t.rIdx[idx1]][col]);\n\t\tt.vr.length = 0; \n\t\t\n\t\tif (p) t.paint();\n\t};\n\n\tCGp.addCol = function(idx, offset, p, d){\n\t\tvar t = this, l = t.colCount, i;\n\t\tif (Undef(p)) p = 1;\n\t\tif (Undef(idx)){\n\t\t\tcl = t.curCell;\n\t\t\tif (Undef(cl)){\n\t\t\t\tif (t.markType == 1) idx = t.markRange[0]\n\t\t\t\telse idx = 0;\n\t\t\t}else\tidx = cl.col._id;\n\t\t\tidx = t.cIdx.indexOf(idx);\n\t\t\tif (offset > 0) idx++;\n\t\t};\n\n\t\tif (p) t.showProgress(\"Create new Column \" + idx);\n\t\tt.cols[l] = new CGCol(l, t, d);\n\t\tif (p) t.writeProgress(\"Create cells\");\n\t\tfor (i = 0; i < t.rowCount; i++) {t.cells[i].insert(new CGCell(t.rows[i], t.cols[l], ''), l);t.rows[i].change=1;};\n\t\tt.cIdx.insert(l, idx);\n\t\tt.colCount++;\n\t\tt.sortCol = -1;\n\t\tif (p) t.paint();\n\t};\n\n\tCGp.delCols = function(){\n\t\tvar t = this, m = [], i, j;\n\t\tif (Undef(t.curCell) || t.markType==3){\n\t\t\tswitch(t.markType){\n\t\t\t\tcase 1:\n\t\t\t\t m.setValue(t.markRange);\n\t\t\t\t t.clearMarkRange();\n\t\t\t\t m.sort(compare);\n\t\t\t\t for (i = 0; i < m.length; i++) {\n\t\t\t\t \t t.delCol(m[i], 0);\n\t\t\t\t \t for (j = i; j < m.length; j++) if (m[j]>m[i]) m[j]--;\n\t\t\t\t };\n\t\t\t\t break;\n\t\t\t\tcase 2:\n\t\t\t\tcase 3:\n\t\t\t\t alert(\"Choose column for deleting!\");\n\t\t\t\t return;\n\t\t\t};\n\t\t}else t.delCol(null, 0);\n\t\tt.paint();\n\t};\n\n\tCGp.delCol = function(idx, p){\n\t\tvar t = this, i, row = 0, cl, idx1;\n\t\tif (Undef(p)) p = 1;\n\t\tif (t.colCount == 1) {\n\t\t\talert(\"You can't delete this column!\");\n\t\t\treturn;\n\t\t};\n\n\t\tif (Undef(idx)) {\n\t\t\tcl = t.curCell;\n\t\t\tif (Undef(cl)){\n\t\t\t\talert(\"Choose column for deleting!\");\n\t\t\t\treturn;\n\t\t\t}else{\n\t\t\t\tidx = cl.col._id;\n\t\t\t\trow = cl.row._id;\n\t\t\t};\n\t\t};\n\n\t\tidx1 = t.cIdx.indexOf(idx);\n\n\t\tt.showProgress(\"Delete column \" + t.cols[idx].title);\n\t\tt.cIdx.remove(idx1);\n\t\tfor (i = 0; i < t.cIdx.length; i++) if (parseInt(t.cIdx[i]) > parseInt(idx)) t.cIdx[i]--;\n\t\tt.cols.remove(idx);\n\t\tfor (i = 0; i < t.rowCount; i++) {t.cells[i].remove(idx); t.rows[i].change=1;}\n\t\tt.colCount--;\n\t\tt.sortCol = -1;\n\t\tif (Def(cl)) t.setCurCell(t.cells[row][t.cIdx[idx1]]);\n\t\tif (p) t.paint();\n\t};\n\n\tCGp.setCurCell = function(cell){\n\t\t/*STD_UNREG\n   \tif (Undef(CodeThat.l) || !CodeThat.l.length) return;\n   \t*/\n\t\tvar t = this;\n\t\tif (Def(cell)) t.clearMarkRange();\n\t\tif (t.curCell != cell){\n\t\t\tif (Def(t.curCell)) t.curCell.setState(0);\n\t\t\tif (Def(cell)){\n\t\t\t\tt.curCell = cell;\n\t\t\t\tt.curCell.setState(1);\n\t\t\t};\n\t\t}else{\n\t\t  if (Def(t.curCell)){\n\t\t  \tif (t.curCell.state == 2) t.curCell.setState(1)\n\t\t  \telse t.curCell.setState(2);\n\t\t \t};\n\t\t};\n\t\tt.curCell = cell;\n\t\trng.length = 0;\n\t};\n\n\tCGp.setCellStyle = function(param, value, cell){\n\t\tvar t = this, i, j, m = t.markRange;\n\t\tif (Undef(cell)) cell = t.curCell;\n\t\tif (Undef(cell)) {\n\t\t\tswitch (t.markType){\n\t\t\t\tcase 1:\n\t\t\t\t\tfor (i=0; i < m.length;i++){\n\t\t\t\t\t for (j=0; j< t.rowCount;j++)\n\t\t\t\t\t t.cells[j][m[i]].setStyle(param, value);\n\t\t\t\t\t };\n\t\t\t\t  break;\n\t\t\t\tcase 2:\n\t\t\t\t\tfor (i=0; i <m.length;i++)\n\t\t\t\t\t for (j=0; j<t.colCount;j++)\n\t\t\t\t\t t.cells[m[i]][j].setStyle(param, value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\talert(\"Choose cell before!\"); return;\n\t\t\t\t\tbreak;\n\t\t\t};\n\t\t}else cell.setStyle(param, value);\n\t};\n\n\tCGp.getColByTitle = function(title){\n\t\tvar t = this, i = -1, j;\n\t\tif (Undef(title)) return i;\n\t\telse title = title.toUpperCase();\n\t\tfor (i = 0; i < t.cols.length && Def(title); i++){\n\t\t\tj = t.cIdx.indexOf(t.cols[i]._id);\n\t\t\tif (t.cols[i].title.toUpperCase() == title || t.cols[i].getName(j) == title) return i;\n\t\t};\n\t\treturn -1;\n\t};\n\n\tCGp.copy = function(){\n\t\tvar t = this;\n\t\tif (Def(t.curCell) && !t.markType) t.clip = t.curCell.getDataForEdit();\n\t\telse t.clip = t.toCSV(\";\", 1) + \"\";\n\t\tt.setClipData(t.clip);\n\t};\n\n\tCGp.paste = function(){\n\t\tvar t = this, d = [];\n\t\tif (Undef(t.curCell)){\n\t\t\talert(\"Choose cell before!\");\n\t\t\treturn;\n\t\t};\n\t\tt.showProgress(\"Pasting data\");\n\t\tif (!ua.opera && Def(t.getClipData())) t.clip = t.getClipData();\n\t\tif (t.clip.indexOf('\\t') == -1) d = t.fromCSV(t.clip);\n\t\telse d = t.fromCSV(t.clip, '\\t');\n\t\tt.loadData(0, d, t.curCell);\n\t};\n\n\tCGp.getClipData = function(){\n\t\tif (ua.ie) return window.clipboardData.getData(\"Text\");\n\t\tif (ua.moz){\n\t\t\tnetscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');\n\t\t\tvar clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);\n\t\t\tif (!clip) return;\n\t\t\tvar trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);\n\t\t\tif (!trans) return;\n\t\t\ttrans.addDataFlavor('text/unicode');\n\t\t\tclip.getData(trans,clip.kGlobalClipboard);\n\t\t\tvar str = new Object();\n\t\t\tvar len = new Object();\n\t\t\teval(\"try { trans.getTransferData('text/unicode',str,len);}catch(exception) { return;}\");\n\t\t\tif (str) {\n\t\t\t\tif (Components.interfaces.nsISupportsWString) str = str.value.QueryInterface(Components.interfaces.nsISupportsWString);\n\t\t\t\telse if (Components.interfaces.nsISupportsString) str = str.value.QueryInterface(Components.interfaces.nsISupportsString);\n\t\t\t\t\t\telse str = null;\n\t\t\t}\n\t\t\tif (str) return(str.data.substring(0,len.value / 2));\n\t \t};//ua.moz\n\t \treturn null;\n\t};\n\tCGp.setClipData = function(d){\n\t\tif (!ua.ie) return;\n\t\teval(\"try {window.clipboardData.setData('Text', d)}catch(e){}\");\n\t};\n};\n\nfunction CGRow(id, g){\n\tvar t = this, i , s;\n\tt._id = id;\n\tt.grid = g;\n\n\tt.isVisible = 1;\n\tt.height = \"height=\" + t.grid.rowStyle.height;\n\tt.change = 0;\n\tt.isMark = 0;\n\tt.isReadOnly = 0;\n\tt.userFunction = null;\n\n\ts = t.grid.rowStyle;\n\tfor (i in s) if (i.indexOf(\"Class\") > -1) t[i] = s[i];\n};\n{\n\tvar CRp = CGRow.prototype;\n\n\tCRp.getName = function(num){\n\t\tif (Undef(num)) num = this._id + 1;\n\t\tnum = num*1 + 1;\n\t\treturn num;\n\t};\n\tCRp.getID = function(prx){\n\t\tvar t = this;\n\t\treturn t.grid.getID(prx) + t._id;\n\t};\n\tCRp.valueOf = function(){\n\t\treturn this._id;\n\t};\n\tCRp.search = function(s, f){\n\t\tvar t = this, g = t.grid, i, d, find = 1;\n\t\tfor (i = 0; i < f.length && find; i++){\n\t\t\tif (g.cells[t._id][f[i]].getDataForFilter() != g.cols[f[i]].filterValue) find = 0;\n\t\t};\n\t\tif (find && Def(s)){\n\t\t\tfind = 0; s = new RegExp(makeRE(s), \"gi\");\n\t\t\tfor (i = 0; i < g.colCount && !find; i++){\n\t\t\t\tfind = find || s.test(g.cells[t._id][i].getDataForFilter());\n\t\t\t};\n\t\t};\n\t\treturn find;\n\t};\n\tCRp.setMark = function(isMark, s, f, p){\n\t\tvar t = this, i, g = t.grid, c = g.cells, s1= s, f1=f;\n\t\tif (Undef(isMark)) isMark = !t.isMark;\n\t\tif (Undef(p)) p=1;\n\t\tt.isMark = isMark;\n\t\tif (Undef(s1)) s1 = 0;\n\t\tif (Undef(f1)) f1 = g.colCount;\n\t\tt.grid.writeProgress(\"Mark rows for current selection\");\n\t\tfor (i = s1; i < f1; i++) {c[t._id][i].isMark = t.isMark; if (g.markType==3) g.cols[i].isMark=t.isMark;};\n\t\tif (p) t.paint(s, f);\n\t};\n\tCRp.paint = function(s, f){\n\t\tvar t = this, i, g = t.grid, c = g.cells, o;\n\t\tif (Undef(s)) s = 0;\n\t\tif (Undef(f)) f = g.colCount;\n\n\t\tt.grid.writeProgress(\"Paint rows for current selection\");\n\t\tfor (i = s; i < f; i++) {c[t._id][g.cIdx[i]].paint(g.markType==3);}\n\t\to = CT_fe(t.getID('row'));\n\t\tif (Def(o)) CT_css(o, ((t.isMark)?t.markClass:t.defaultClass));\n\t\tt.grid.hideProgress();\n\t};\n\tCRp.setHeight = function(h){\n\t\tvar t = this, g = t.grid;\n\t\tif (Undef(h)) h = prompt(\"Set height for row\", t.height.replace(/[^0-9%]/g, ''));\n\t\tif (!isNaN(parseInt(h))) {t.height = \"height=\"+h; g.paint();}\n\t};\n\tCRp.callHandler = function(e){\n\t\t if (Def(this.handler)) this.handler(e);\n\t};\n};\nfunction CGCol(id, g, colDef){\n\tvar t = this, w, i , s;\n\tt._id = id;\n\tt.grid = g;\n\n\tt.index = [];\n\tt.filter = [];\n\tt.filterValue = \"\";\n\t\n \ts = t.grid.colStyle;\n\tfor (i in s) if (i.indexOf(\"Class\") > -1) t[i] = s[i];\t\t\n\tfor (i in DEFAULT_COLDEF) t[i] = DEFAULT_COLDEF[i];\t\n\tif (Def(colDef)){\t\t\n\t\tfor (i in colDef){\n\t\t\tif (Def(colDef[i])) \n\t\t\t  if (i.indexOf(\"is\") > -1 || i.indexOf(\"use\") > -1 || i.indexOf(\"Function\") > -1) eval(\"t[i] = \" + colDef[i]);\t\t\t\n\t\t\t  else t[i] = colDef[i];\n\t\t};\n\t\tw = parseInt(colDef.width);\t\t\t\t\n\t\tt.width = (isNaN(w) || w > 0) ? \" width=\\\"\" + colDef.width + \"\\\"\": \"\";\n\t\tt.alignment = (Def(colDef.alignment)) ? \" align=\\\"\" + colDef.alignment + \"\\\"\" : \"\";\n\t};\t\n\tif (Undef(t.title)) \tt.title = 'Column' + t.getName(t._id);\n\tif (Undef(t.titleClass)) t.titleClass = t.defaultClass;\t\n};\n{\n\tvar CCp = CGCol.prototype;\n\tCCp.callHandler = function(e){\n\t\t if (Def(this.handler)) this.handler(e);\n\t};\n\tCCp.getName = function(num){\n\t\tif (Undef(num)) num = this._id;\n\t \tvar basis = 26, offset=65, order = [], name = \"\";\n\t \twhile (num > basis){\n\t \t\torder[order.length] = num % basis;\n\t \t\tnum = num / basis;\n\t \t}\n\t \torder[order.length] = num % basis;\n\t \t//like excel (wrong in math sense)\n\t \tif (order.length > 1)\n\t \t\tif (order[order.length-1]>0) order[order.length-1]--;\n\t \tfor (var z = order.length-1;z > -1;z--){\n\t \t\tname += String.fromCharCode(order[z]*1 + offset);\n\t \t};\n\t \treturn name;\n\t};\n\tCCp.setTitle = function(){\n\t\tvar t = this, title = prompt(\"Set title\", t.title);\n\t\tif (title){\n\t\t\tt.title = title;\n\t\t\tchangeContent(t.getID(\"title\"), t.title)\n\t\t};\n\t};\n\tCCp.getID = function(prx){\n\t\tvar t = this;\n\t\treturn t.grid.getID(prx) + t._id;\n\t};\n\tCCp.valueOf = function(){\n\t\treturn this._id;\n\t};\n\tCCp.setFilter = function(){\n\t\tvar t = this, g = t.grid, i, v;\n\t\tif (!t.useAutoFilter || !t.grid.isInit) return;\n\t\tg.writeProgress(\"Update filter for column \" + t.title);\n\t\tt.filter.length = 0;\n\t\tfor (i = 0; i < g.rows.length; i++){\n\t\t v = \tg.cells[i][t._id].getDataForFilter();\n\t\t if (Def(v) && typeof(v) != 'unknown' && t.filter.indexOf(v) == -1) t.filter[t.filter.length]=v;\n\t\t};\n\t\tif (t.filter.length && !ua.oldB) eval(\"try{t.filter = t.filter.sort(compare)}catch(e){}\");\n\t};\n\tCCp.filterToHTML = function(){\n\t\tvar t = this, i, h = \"&nbsp;\";\n\t\tif (!t.useAutoFilter) return h;\n\n\t\th = \"<select id='\" + t.getID(\"filter\") + \"' name='\" + t.getID(\"filter\") + \"' onChange='\" + t.grid.name + \".setFilter(\" + t._id + \", this.value)'><option value=''>\" + EMPTY_ROW + \"</option>\"\n\t\tfor (i = 0; i < t.filter.length; i++) h += \"<option value=\\\"\"+t.filter[i]+\"\\\"\" + ((t.filterValue != \"\" && t.filter[i].toString() == t.filterValue)? \" selected\":\"\") + \">\" + t.filter[i] + \"</option>\"\n\t\th += \"</select>\";\n\n\t\treturn h;\n\t};\n\tCCp.setMark = function(isMark, s, f, p){\n\t\n\t\tvar t = this, i, c = t.grid.cells, f1 = f, s1 = s;\n\t\tif (Undef(isMark)) isMark = !t.isMark;\n\t\tif (Undef(p)) p = 1;\n\t\tt.isMark = isMark;\n\t\tif (Undef(s1)) s1 = 0;\n\t\tif (Undef(f1)) f1 = t.grid.rowCount;\n\t\tt.grid.writeProgress(\"Mark columns for current selection\");\n\t\tfor (i = s1; i < f1; i++) c[i][t._id].isMark = t.isMark;\n\t\tif (p) t.paint(s, f);\n\t};\n\tCCp.paint = function(s, f){\n\t\tvar t = this, i, g = t.grid, a = g.amountPerPage, c = g.cells, o;\n\t\tif (Undef(s)) s = (g.page - 1)*a;\n\t\tif (Undef(f)) f = ((g.page*a < g.vr.length) ? g.page*a : g.vr.length);\n\n\t\tt.grid.writeProgress(\"Paint columns for current selection\");\n\t\tfor (i = s; i < f; i++) {c[g.vr[i]][t._id].paint(0);}\n\t\to = CT_fe(t.getID('col'));\n\t\tif (Def(o)) CT_css(o, ((t.isMark) ? t.markClass:t.defaultClass));\n\t\tt.grid.hideProgress();\n\t};\n\tCCp.setWidth = function(w){\n\t\tvar t = this, g = t.grid;\n\t\tif (Undef(w)) w = prompt(\"Set width for column\", t.width.replace(/[^0-9%]/g, ''));\n\t\tif (!isNaN(parseInt(w))) {t.width = \"width=\"+w; g.paint();}\n\t};\n};\n\nfunction CGCell(row, col, data){\n\tvar t = this, s, i;\n\tt.row = row;\n\tt.col = col;\n\tt.state = 0; //view mode, 1 - focus mode, 2 - edit mode\n\tt.isMark = 0;\n\tt.isReadOnly = 0;\n\tt.alignment = \"\";\n\tt.b = \"\";\n\tt.u = \"\";\n\tt.i = \"\";\n\tt.data = null;\n\tt.setData(data);\n\ts = t.row.grid.cellStyle;\n\tfor (i in s) if (i.indexOf(\"Class\") > -1) t[i] = s[i];\n};\n{\n\tvar CCp = CGCell.prototype;\n\n\tCCp.callHandler = function(e){\n\t\t if (Def(this.handler)) this.handler(e);\n\t};\n\n\tCCp.setData = function(data, isService){\n\t\tvar t = this, f, err = \"\", i, fa = t.col.filter, g = t.col.grid;\n\t\tif (Undef(isService)) isService = (t.col.isReadOnly || t.row.isReadOnly);\n\n\t\tswitch (t.col.type){\n\t\t\tcase \"Date\":\n\t\t\t  if (Def(data) && parseDate(data, DATE_FORMAT) == null) {err = data;data = t.data;}\n\t\t\t  else data = parseDate(data, DATE_FORMAT);\n\t\t\t\tbreak;\n\t\t\tcase \"Image\":\n\t\t\t\tbreak;\n\t\t\tcase \"Number\":\n\t\t\tcase \"Currency\":\n\t\t\tdefault:\n\t\t\t\t//<!--\n\t\t\t\tif (ua.oldB) eval(\"data = parse\" + t.col.type + \"(data)\");\n\t\t\t\telse eval(\"try{eval(\\\"data = parse\\\" + t.col.type + \\\"(data)\\\");}catch(e){};\");\n\t\t\t\t//-->\n\t\t};\n\n\t\tif (Def(err)) alert(\"Can't parse data \" + err + \" as \" + t.col.type + \"!\");\n\n\t\tif (t.row.grid.isInit && data != t.data){\n\t\t\t t.row.change = 1;\n\t\t\t t.data = data;\n\t\t\t //<!--\n\t\t\t if (!isService){\n\t\t\t \t if (Def(t.row.userFunction)) t.row.userFunction(g, t);\n\t\t\t\t if (Def(t.col.userFunction)) t.col.userFunction(g, t);\n\t\t\t\t if (Def(g.userFunction)) g.userFunction(g, t);\n\t\t\t };\n\t\t\t //-->\n\t\t};\n\t\tt.data = data;\n\t\tif (g.isInit && t.col.useAutoFilter && fa.indexOf(t.getDataForFilter())==-1 && Def(t.data) && typeof(t.data) != 'unknown'){\n\t\t\tfa = t.col.filter;\n\t\t\tfa[fa.length] = t.getDataForFilter();\n\t\t\tfa.sort(compare);\n\t\t\tf = CT_fe(t.col.getID(\"filter\"));\n\t\t\tif (Def(f)) f.outerHTML = t.col.filterToHTML();//ie, opera\n\t\t\tif (ua.moz) {t.row.grid.paint()};//can't add items in filter dynamicaly\n\t\t};\n\t};\n\n\tCCp.getData = function(){\n\t\tvar t = this, data = t.data;\n\n\t\tif (Undef(t.data)) data = DEFAULT_RESULT;\n\t\telse\n\t\t\tswitch (t.col.type){\n\t\t\t\tcase \"URL\":\n\t\t\t\t\tdata = formatURL(t.data, \"blank\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"String\":\n\t\t\t\tcase \"Number\":\n\t\t\t\tcase \"HTML\":\n\t\t\t\tcase \"Email\":\n\t\t\t\t \tif (ua.oldB) eval(\"data = format\" + t.col.type + \"(t.data)\")\n\t\t\t\t\telse eval(\"try{eval('data = format' + t.col.type + '(t.data)');}catch(e){data = t.data};\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Image\":\n\t\t\t\t   if ((Def(t.data) && t.data.constructor != Object) || ua.oldOpera) t.data = parseImage(t.data);\n\t\t\t\t   data = formatImage(t.data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Date\":\n\t\t\t\tcase \"Currency\":\n\t\t\t\tdefault:\n\t\t\t\t\tif (ua.oldB) eval(\"data = format\" + t.col.type + \"(t.data, \" + t.col.type.toUpperCase() + \"_FORMAT)\")\n\t\t\t\t\telse eval(\"try{eval('data = format' + t.col.type + '(t.data, ' + t.col.type.toUpperCase() + '_FORMAT)');}catch(e){data = t.data};\");\n\t\t\t\t\tbreak;\n\t\t\t};\n\n\t\treturn data;\n\t};\n\n\tCCp.getDataForEdit = function(){\n\t\tvar t = this, data = t.data;\n\t\tif (Undef(t.data) || t.col.type == \"Image\") data = \"\"\n\t\telse if (t.col.type == \"Date\") data = formatDate(t.data, DATE_FORMAT);\n\t\treturn new String(data);\n\t};\n\n\tCCp.getDataForFilter = function(){\n\t\tvar t = this, data = t.data;\n\t\tif (Undef(t.data)) data = \"\"\n\t\telse\n\t\t\tswitch (t.col.type){\n\t\t\t\tcase \"Date\":\n\t\t\t\tcase \"Currency\":\n\t\t\t\t\tif (ua.oldB) eval(\"data = format\" + t.col.type + \"(t.data, \" + t.col.type.toUpperCase() + \"_FORMAT)\")\n\t\t\t\t\telse eval(\"try{eval('data = format' + t.col.type + '(t.data, ' + t.col.type.toUpperCase() + '_FORMAT)');}catch(e){data = t.data};\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Image\":\n\t\t\t\t  if (t.data.src.indexOf(\"undefined\") < 0){\n\t\t\t\t\t\tstart = ((t.data.src.lastIndexOf(\"/\") < 0)? t.data.src.lastIndexOf(\"\\\\\") : t.data.src.lastIndexOf(\"/\")) + 1;\n\t\t\t\t  \tdata = t.data.src.slice(start);\n\t\t\t\t  }else\n\t\t\t\t  \tdata = \"No image\";\n\t\t\t\t default:\n\t\t\t\t \tdata = t.data;\n\t\t\t\t};\n\t\treturn new String(data);\n\t};\n\n\tCCp.compareTo = function (cell){\n\t\treturn this.col.compareFunction(this.data, cell.data);\n\t};\n\n\tCCp.toString = function(){\n\t\treturn \"Cell [\" + this.row._id + \"; \" + this.col._id + \"]\";\n\t};\n\n\tCCp.getID = function(){\n\t\tvar t = this;\n\t\treturn t.row.grid.getID(\"cell\") + t.row._id + \"_\" + t.col._id;\n\t};\n\n\tCCp.getEditControl = function(){\n\t\tvar t = this, h, o, v = t.getDataForEdit();\n\t\tif (t.isReadOnly || t.row.isReadOnly || t.col.isReadOnly || t.col.type == \"Image\"){\n\t\t\t//alert(\"This element can't be edited!\");\n\t\t\tt.state = 1;\n\t\t\treturn t.getData();\n\t\t}else{\n\t\t\tswitch (t.col.type){\n\t\t\t\tcase \"Date\":\n\t\t\t\t\th = \"<input id='cell' name='cell' type='text' style='width:100%;' value=\\\"\" + v + \"\\\" maxlength='\" + DATE_FORMAT.length + \"' onblur='CodeThatGrids[\\\"\" + t.row.grid.name + \"\\\"].curCell.setData(this.value)'>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Currency\":\n\t\t\t\tcase \"Number\":\n\t\t\t\t\th = \"<input id='cell' name='cell' type='text' style='width:100%;' value=\\\"\" + v + \"\\\" maxlength='10' onblur='CodeThatGrids[\\\"\" + t.row.grid.name + \"\\\"].curCell.setData(this.value)'>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"String\":\n\t\t\t\tcase \"HTML\":\n\t\t\t\tcase \"Email\":\n\t\t\t\tcase \"URL\":\n\t\t\t\tdefault:\n\t\t\t\t  h = \"<textarea id='cell' name='cell' rows=1 cols=1 style='width:100%;height:100%' onblur='CodeThatGrids[\\\"\" + t.row.grid.name + \"\\\"].curCell.setData(this.value);'>\" + v + \"</textarea>\";\n\t\t\t\t\tbreak;\n\t\t\t};\n\t\t};\n\t\treturn h;\n\t};\n\n\tCCp.setState = function(state){\n\t\tvar t = this, o = CT_fe(\"cell\");rng.length=0;\n\t\tif (Def(o) && t.state == 2) t.setData(o.value);\n\t\tt.state = state;\n\t\tt.paint();\n\t};\n\n\tCCp.setMark = function(isMark){\n\t\tvar t = this;\n\t\tif (Undef(isMark)) isMark = !t.isMark;\n\t\tt.isMark = isMark;\n\t\tt.paint();\n\t};\n\n\tCCp.setStyle = function(param, value){\n\t\tvar t = this;\n\t\tswitch (param){\n\t\t\t\tcase \"b\":\n\t\t\t\t\tif (Def(t.b)) t.b = \"\";\n\t\t\t\t\telse t.b = \"bold\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"i\":\n\t\t\t\t\tif (Def(t.i)) t.i = \"\";\n\t\t\t\t\telse t.i = \"italic\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"u\":\n\t\t\t\t\tif (Def(t.u)) t.u = \"\";\n\t\t\t\t\telse t.u = \"underline\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"alignment\":\n\t\t\t\t\tt.alignment = value;\n\t\t\t\t\tbreak;\n\t\t};\n\t\tt.paint(0);\n\t};\n\n\tCCp.getStyle = function(){\n\t\tvar t = this, s = \"\";\n\t\tif (Def(t.b)) s += \"font-weight:bold;\";\n\t\tif (Def(t.i)) s += \"font-style:italic;\";\n\t\tif (Def(t.u)) s += \"text-decoration:underline;\";\n\t\tif (Def(t.alignment)) s += \"text-align:\" + t.alignment + \";\";\n\t\tif (Def(s)) s = \"style='\" + s + \"'\";\n\t\treturn s;\n\t};\n\n\tCCp.paint = function(p){ //np - paint parent\n\t\tvar t = this, g = t.row.grid,\to1=1, o2=1, o = CT_fe(t.getID()),\n\t\trm = t.row.markClass, cm = t.col.markClass, rd = t.row.defaultClass, cd = t.col.defaultClass;\n\n\t\tif (Undef(p)) p = 1 && g.useRCID;\n\t\tif (p){\n\t\t\to1 = CT_fe(t.row.getID('row'));\n\t\t\to2 = CT_fe(t.col.getID('col'));\n\t\t};\n\n\t\tif (Undef(o) || Undef(o1) || Undef(o2)) return;\n\n\t\to.style.fontWeight = t.b;\n\t\to.style.fontStyle = t.i;\n\t\to.style.textDecoration = t.u;\n\t\to.style.textAlign = t.alignment;\n\n\t\tswitch (t.state){\n\t\t\tcase 0:\n\t\t\t\tCT_css(o, ((t.isMark) ? t.markClass:t.defaultClass));\n\t\t\t\tCT_HTML(o, t.getData());\n\t\t\t\tif (p){\n\t\t\t\t CT_css(o1, ((t.isMark) ? rm:rd));\n\t\t\t\t CT_css(o2, ((t.isMark) ? cm:cd));\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tCT_css(o, t.currClass);\n\t\t\t\tif (p){\n\t\t\t\t\tCT_css(o1, rm);\n\t\t\t\t\tCT_css(o2, cm);\n\t\t\t\t};\n\t\t\t\tCT_HTML(o, t.getData());\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tCT_HTML(o, t.getEditControl());\n\t\t\t\to = CT_fe(\"cell\");\n\t\t\t\tif (Def(o)) {\n\t\t\t\t\t//if (ua.moz && o.type=='textarea') \n\t\t\t\t\tif (ua.moz) o.setAttribute(\"autocomplete\", \"off\");\n\t\t\t\t\to.value=t.getDataForEdit();\t\t\t\t\t\t\t\t\t\n\t\t\t\t\to.focus();\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t};\n\t\tif (p) g.paintBar(\"sb\");\n\t};\n};\n///////////////////////////////////////////////////\n//Events\n///////////////////////////////////////////////////\nvar isShift = 0, isCtrl = 0, CCG, CodeThatGrids = [], re = \"class=\", rng = [],w = null, curId=0;\nvar dfp = {fontfamily:\"Verdana, Arial\", fontsize:\"12px\"},\n\t crp = {borderwidth: \"1\", borderstyle: \"outset\", bordercolor: \"#cccccc\"},\n\t clp = { borderstyle:\"solid\"},\n\t dbp = {fontfamily:\"Verdana, Arial\", fontsize:\"11px\", backgroundcolor:\"#D4D0C8\"};\nfunction CT_fe(id){\n\treturn CodeThat.findElement(id);\n};\nfunction CT_reh(ev, h, o){\n\tCodeThat.regEventHandler(ev, h, o);\n};\nfunction CT_regEvents(name, pt){\n\tCT_reh('click', CT_onMouseEvent, CT_fe(name));\n\tCT_reh('dblclick', CT_onMouseEvent, CT_fe(name));\n\tCT_reh('keydown', CT_onKeyPress);\n\tCT_reh('selectstart', CT_onSelect, CT_fe(name));\n\tCT_reh('mousemove', CT_onMouseMove);\n\tCT_reh('mousedown', CT_onMouseEvent);\n\tCT_reh('mouseup', CT_onMouseEvent);\n\tCT_reh('dragend', CT_onDrag, CT_fe(name));\n\tCT_reh('dragover', CT_onDragOver, CT_fe(name));\n\tCT_reh('dragover', CT_onDragOver, CT_fe(pt));\n};\nfunction CT_onDrag(e){\n\tvar src = (ua.moz) ? e._e.target : e._e.srcElement;\n\tvar parent, s = src.id, t = curId, si, ti;\n\tif (Undef(t) || Undef(s)) return;\n\tif (Undef(CCG)){\n\t\tvar parent = CT_getParent(src);\n\t\tif (Undef(parent.id)) return;\n\t\tCCG = CodeThatGrids[parent.id];\n\t};\n\tif (Undef(CCG)) return;\n\tif (t.indexOf(\"col\") > -1 && s.indexOf(\"col\") > -1){\n\t\tt = t.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '');\n\t\ts = s.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '');\n\t\tsi = CCG.cIdx.indexOf(s);\n\t\tti = CCG.cIdx.indexOf(t);\n\t\tCCG.cIdx.remove(si);CCG.cIdx.insert(s, ti);\n\t};\n\tif (t.indexOf(\"row\") > -1 && s.indexOf(\"row\") > -1){\n\t\tt = t.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '');\n\t\ts = s.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '');\n\t\tsi = CCG.rIdx.indexOf(s);\n\t\tti = CCG.rIdx.indexOf(t);\n\t\tCCG.rIdx.remove(si);CCG.rIdx.insert(s, ti); CCG.vr.length = 0;\n\t};\n\tif (t.indexOf(\"pt\") > -1 && s.indexOf(\"row\") > -1){\n\t\ts = s.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '');\n\t\tsi = CCG.rIdx.indexOf(s);\n\t\tti = (t.replace(new RegExp(CCG.name), \"\").replace(/[^0-9]/ig, '')-1)*CCG.amountPerPage;\n\t\tt = CCG.rIdx[ti];\n\t\tCCG.rIdx.remove(si);CCG.rIdx.insert(s, ti); CCG.vr.length = 0;\n\t};\n\tcurId = \"\";\n\tCCG.paint();\n};\nfunction CT_onDragOver(e){\n\tvar src = (ua.moz) ? e._e.target : e._e.srcElement;\n\tcurId = src.id;\t\t\n};\nfunction CT_onSelect(e){\n\tvar src = (ua.moz) ? e._e.target : e._e.srcElement;\n\tif (src.id != 'cell') return false;\n};\nfunction CT_onMouseMove(e){\n\tvar src = (ua.moz) ? e._e.target : e._e.srcElement;\n\tif (Undef(src.id) || Undef(CCG)) return;\n\tvar name = src.id.replace(new RegExp(CCG.name), \"\").replace(/[^0-9_]/ig, \"\"), r, r1, c, c1;\n\tif (Undef(name) || name.indexOf(\"_\") == -1 || rng.length < 2) return;\n\n\tr = name.slice(0, name.indexOf(\"_\"));\n\tr1 = rng[0];\n\tc = name.slice(name.indexOf(\"_\") + 1);\n\tc1 = rng[1];\n\n\tr = CCG.rIdx.indexOf(r);\n\tr1 = CCG.rIdx.indexOf(r1);\n\tc = CCG.cIdx.indexOf(c);\n\tc1 = CCG.cIdx.indexOf(c1);\n\n\tCCG.msg = \"Selection: \" + (1+Math.abs(r-r1)) + \"R x \" + (1+Math.abs(c-c1)) + \"C\";\n\tCCG.paintBar(\"sb\");\n};\n\nfunction CT_onMouseEvent(e){\n\tisShift = e._e.shiftKey;\n\tisCtrl = e._e.ctrlKey;\n\n\tvar src = (ua.moz) ? e._e.target : e._e.srcElement;\n\tif (Undef(src.id) && ua.moz) src = src.parentNode;\n\tvar parent = CT_getParent(src);\n\n\tif (Undef(src.id) || Undef(parent.id)) {rng.length=0;return;} //no object of grid to proceed\n\n\tif (Def(CCG) && CCG != CodeThatGrids[parent.id] && CCG.curCell) CCG.curCell.setState(1); \n\tCCG = CodeThatGrids[parent.id];\n\tif (Undef(CCG)) {rng.length=0;return;}\n\n\tvar name = src.id.replace(new RegExp(CCG.name), '').replace(/[^0-9_]/ig, \"\"), r = -1 , c = -1, type = -1;\n\tif (Undef(name)) return;\n\n\tif (name.indexOf(\"_\") > -1){\n\t\tr = name.slice(0, name.indexOf(\"_\"));\n\t\tc = name.slice(name.indexOf(\"_\") + 1);\n\t\ttype = 0;\n\t}else{\n\t\tif (src.id.indexOf(\"col\") > -1) {c = name; type = 1};\n\t\tif (src.id.indexOf(\"row\") > -1) {c = name; type = 2};\n\t\tif (src.id.indexOf(\"title\") > -1) {c = name; type = 4};\n\t};\n\n\t//call user handler\n\tswitch (type){\n\t\tcase 0: e._o = CCG.cells[r][c]; CCG.cells[r][c].callHandler(e); break;\n\t\tcase 2: e._o = CCG.rows[c]; CCG.rows[c].callHandler(e); break;\n\t\tcase 1: e._o = CCG.cols[c]; CCG.cols[c].callHandler(e); break;\n\t};\n\n\tswitch (e._e.type){\n\t\tcase \"click\":\n\t\t\tswitch (type){\n\t\t\t\tcase 0:\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tCCG.setMarkRange(c, type);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\tCCG.cols[c].setTitle();\n\t\t\t};\n\t\t\tbreak;\n\t\t case \"dblclick\":\n\t\t  switch (type){\n\t\t  \tcase 0:\n\t\t  \t\tCCG.setCurCell(CCG.cells[r][c]);\n\t\t  \t\tCCG.cells[r][c].setState(2);\n\t\t  \t\tbreak;\n\t\t  \tcase 1:\n\t\t  \t   CCG.cols[c].setWidth();\n\t\t  \t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\tCCG.rows[c].setHeight();\n\t\t\t\tbreak;\n\t\t  };\n\t\t \tbreak;\n\t\t case \"mousedown\":\n\t\t  if (type != 0) return;\n\t\t  CCG.setCurCell(CCG.cells[r][c]);\n\t\t  if (CCG.cells[r][c].state != 2) rng = [r, c];\n\t\t  break;\n\t\t case \"mouseup\":\n\t\t \tif (type != 0 || rng.length < 2) {rng.length = 0; return;}\n\t\t \tCCG.setMarkRange(rng.concat([r,c]), 3);\n\t\t \tCCG.msg = \"\";\n\t\t \tCCG.paintBar(\"sb\");\n\t\t \trng.length=0;\n\t\t \tbreak;\n\t};\n};\nfunction CT_onKeyPress(e){\n\tif (Def(CCG)) {CCG.onKeyPress(e);}\n};\nfunction CT_getParent(src){\n\twhile (Def(src) && Def(src.tagName) && src.tagName.toLowerCase() != \"div\" && src.tagName.toLowerCase() != \"body\"){\n\t\tsrc = ((ua.ie) ? src.parentElement : src.parentNode);\n\t};\n\treturn src;\n};\n{\n\tvar a = Array.prototype;\n\ta.insert = function(e, i){\n\t\tvar t = this, j;\n\t\tt[t.length] = e;\n\t\tif (i < t.length - 1){\n\t\t\tfor (j = t.length - 1; j > i; j--) t[j] = t[j-1];\n\t\t\tt[i] = e;\n\t\t};\n\t};\n\ta.remove = function(i){\n\t\tvar t = this, j;\n\t\tif (i < t.length - 1)\n\t\t\tfor (j = i; j < t.length - 1; j++) {\n\t\t\t\tt[j] = t[j*1+1];\n\t\t\t\tif (Def(t[j]._id)) t[j]._id = j;\n\t\t\t};\n\t\tt.length--;\n\t};\n};\nfunction makeRE(text){\n\tvar special = [\"\\\\\", \"/\", \".\", \"^\", \"+\", \"*\", \"?\", \"$\", \"|\", \"(\", \")\", \"{\", \"}\"], i;\n\tfor (i = 0; i < special.length; i++)\n\t text = text.replace(new RegExp(\"\\\\\" + special[i], \"ig\"), \"\\\\\" + special[i]);\n\treturn text;\n};\nfunction merge(aO){\n\tvar i, j, o = {};\n\tif (aO.constructor != Array) aO = new Array(aO);\n\tfor (i = 0; i < aO.length; i++)\n\t\tfor (j in aO[i]) o[j] = aO[i][j];\n\treturn o;\n};"],"names":["CCodeThatGrid","name","r","c","width","height","helpTips","t","this","i","s","widthValue","heightValue","helptips","parseInt","def","datatype","data","showStatusBar","CodeThatGrids","rows","cols","cells","rowCount","isNaN","colCount","rIdx","vr","cIdx","sortCol","sortType","multiSortCol","multiSortType","useMultiSort","searchValue","clip","msg","useProgress","winProgress","useRCID","showCols","useExportBar","useColTitle","curCell","amountPerPage","pageCount","page","isInit","markType","markRange","userFunction","tableStyle","tableClass","borderwidth","borderstyle","bordercolor","thClass","dfp","tdClass","bgcolor","x","y","position","overflow","rowStyle","defaultClass","merge","crp","backgroundcolor","markClass","resizeClass","cursor","dragClass","colStyle","cellStyle","clp","currClass","toolBar","dbp","buttons","searchControl","statusBar","messageClass","fieldText","valueText","pageTurnBar","fontsize","fontfamily","activeClass","img_on","src","imgDir","img_off","text","btn","btntx","b","length","ua","oldB","oldOpera","nn4","CGp","prototype","setFocus","rOffset","cOffset","cl","f","o","Undef","indexOf","row","_id","col","isVisible","alert","setCurCell","onKeyPress","e","_e","keyCode","state","isShift","ie","CT_fe","getID","focus","setState","Def","type","toLowerCase","value","getDataForEdit","copy","paste","makeStyle","obj","param","cssName","css","makeCssClass","makeNameUnique","setMarkRange","m","idx","j","p","opera","clearMarkRange","setMark","paint","isCtrl","constructor","Array","init","gridDef","d","Date","style","imgs","Object","eval","showProgress","moz","dw","CodeThat","preload","writeProgress","CGRow","colDef","DEFAULT_COLDEF","CGCol","CGCell","loadData","toCSV","spt","isRng","change","lessreadonly","showOnlyVisibleColumns","re","ri","RegExp","isReadOnly","replace","toCSVFile","fromCSV","split","fromCSVFile","doc","window","ActiveXObject","async","load","documentElement","XMLHttpRequest","open","overrideMimeType","send","responseXML","firstChild","nodeValue","w","document","readyState","getElementsByTagName","closed","close","curId","setTimeout","confirm","fromXML","xml","CXMLTree","k","toObject","field","align","__value","fromXMLField","getAttribute","fromXMLFile","opera7","item","toXML","n","x1","title","search","getName","u","alignment","cell","rc","cc","ci","addRow","addCol","index","filter","setData","useFilter","set","use","useAutoFilter","filterValue","toHTML","inDIV","h","hi","ht","hf","he","a","ts","w1","w2","cmc","rmc","cdc","rdc","cd","rd","isMark","titleClass","useAutoIndex","setIndex","setFilter","filterToHTML","String","Math","floor","getStyle","getData","CT_HTML","paintBar","tbToHTML","sbToHTML","ptToHTML","CT_regEvents","ebToHTML","hideProgress","doAction","l","location","href","slice","prx","bar","sb","v","pb","tb","ion","iof","k1","mg_on","text_on","text_off","makeImgTag","resetSort","mc","mt","setPage","setMultiSort","setSort","prompt","getColByTitle","setValue","reverse","left","right","r1","r2","compareTo","setIndex2","sc","sort","compare","resetSearch","filterCol","setSearch","setAmountPerPage","amount","row1","row2","g","grid","status","setPageWidth","tempWidth","setWidth","offset","insert","delRows","delRow","idx1","remove","delCols","delCol","rng","setCellStyle","setStyle","toUpperCase","setClipData","getClipData","clipboardData","netscape","security","PrivilegeManager","enablePrivilege","Components","classes","createInstance","interfaces","nsIClipboard","trans","nsITransferable","addDataFlavor","kGlobalClipboard","str","len","nsISupportsWString","QueryInterface","nsISupportsString","substring","id","CRp","num","valueOf","find","getDataForFilter","makeRE","test","s1","f1","CT_css","setHeight","callHandler","handler","CCp","basis","order","z","fromCharCode","setTitle","changeContent","EMPTY_ROW","toString","isService","err","fa","parseDate","DATE_FORMAT","outerHTML","DEFAULT_RESULT","formatURL","parseImage","formatImage","formatDate","start","lastIndexOf","compareFunction","getEditControl","o1","o2","rm","cm","fontWeight","fontStyle","textDecoration","textAlign","setAttribute","CCG","findElement","CT_reh","ev","regEventHandler","pt","CT_onMouseEvent","CT_onKeyPress","CT_onSelect","CT_onMouseMove","CT_onDrag","CT_onDragOver","target","srcElement","parent","si","ti","CT_getParent","c1","abs","shiftKey","ctrlKey","parentNode","_o","concat","tagName","parentElement","special","aO"],"mappings":"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"}