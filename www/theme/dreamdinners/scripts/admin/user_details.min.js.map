{"version":3,"file":"user_details.min.js","names":["enrollInPlatePoints","user_id","bounce","viewPlatePoints","config","action","input","back","back_path","create_and_submit_form","printEnrollmentForm","markAccountDataRequestCompleteConfirm","dd_message","title","message","modal","confirm","deleteUserConfirm","unsetHomeStore","$","document","on","this","data","lang","en","tc","terms_and_conditions","delayed_payment","noOk","closeOnEscape","open","event","ui","parent","find","hide","buttons","Agree","remove","set_user_pref","json","html","date_updated","Decline","delayed_payment_decline","e","preventDefault","slideToggle","is","trigger","slideUp","attr","val","show","prop","checkValidity","number","method","selectedCategories","somethingChecked","each","removeClass","removeSpinner","match","ajax","url","type","timeout","dataType","processor","op","success","status","processor_success","processor_message","error","objAJAXRequest","strError","is_fadmin","new_number","newPrefsState","key","value"],"sourceRoot":"js/src/dreamdinners/admin","sources":["user_details.js"],"sourcesContent":["function enrollInPlatePoints(user_id)\n{\n\tbounce('/?page=admin_account&pp_enroll=1&id=' + user_id, false);\n}\n\nfunction viewPlatePoints(user_id)\n{\n\tvar config = {\n\t\taction: '/?page=admin_user_plate_points',\n\t\tinput: {\n\t\t\tuser_id: user_id,\n\t\t\tback: back_path()\n\n\t\t}\n\t};\n\n\tcreate_and_submit_form(config);\n}\n\nfunction printEnrollmentForm(user_id)\n{\n\t/*\n\tvar config = {\n\t\t\taction: '/?page=admin_user_plate_points',\n\t\t\tinput: {\n\t\t\t\tuser_id: user_id,\n\t\t\t\tback: back_path(),\n\t\t\t\tprint_enrollment_form: 'true'\n\n\t\t\t}\n\t\t};\n\tcreate_and_submit_form(config);\n\n\t*/\n\tbounce('/?page=admin_user_plate_points&user_id=' + user_id + '&print_enrollment_form=true', '_blank');\n}\n\nfunction markAccountDataRequestCompleteConfirm(user_id)\n{\n\tdd_message({\n\t\ttitle: 'Account Data Request Complete confirmation',\n\t\tmessage: 'Are you sure you want to mark the account data request as complete for this guest?',\n\t\tmodal: true,\n\t\tconfirm: function () {\n\n\t\t\tbounce('/?page=admin_user_details&id=' + user_id + '&action=confirmAccountInfoSent');\n\n\t\t}\n\t});\n}\n\nfunction deleteUserConfirm(user_id)\n{\n\tdd_message({\n\t\ttitle: 'Delete guest confirmation',\n\t\tmessage: 'Are you sure you want to delete this guest?',\n\t\tmodal: true,\n\t\tconfirm: function () {\n\n\t\t\tbounce('/?page=admin_user_details&id=' + user_id + '&action=delete');\n\n\t\t}\n\t});\n}\n\nfunction unsetHomeStore(user_id)\n{\n\tdd_message({\n\t\ttitle: 'Remove guest confirmation',\n\t\tmessage: 'Are you sure you want to remove this guests home store?',\n\t\tmodal: true,\n\t\tconfirm: function () {\n\n\t\t\tbounce('/?page=admin_user_details&id=' + user_id + '&action=unsethome');\n\n\t\t}\n\t});\n}\n\n$(document).on('click', '[data-delayed_payment_tc]', function () {\n\n\tvar user_id = $(this).data('delayed_payment_tc');\n\n\tdd_message({\n\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\tmessage: lang.en.tc.delayed_payment,\n\t\tmodal: true,\n\t\tnoOk: true,\n\t\tcloseOnEscape: false,\n\t\topen: function (event, ui) {\n\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t},\n\t\tbuttons: {\n\t\t\t\"Agree\": function () {\n\n\t\t\t\t$(this).remove();\n\n\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 1, user_id, function (json) {\n\n\t\t\t\t\t$('#tc_delayed_payment_status').html('Accepted - ' + json.date_updated);\n\n\t\t\t\t});\n\n\t\t\t},\n\t\t\t\"Decline\": function () {\n\n\t\t\t\tset_user_pref('TC_DELAYED_PAYMENT_AGREE', 0, user_id, function (json) {\n\n\t\t\t\t\t$('#tc_delayed_payment_status').html('Declined - ' + json.date_updated);\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\t\t\t\tmessage: lang.en.tc.delayed_payment_decline\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t}\n\t\t}\n\t});\n\n});\n\n$(document).on('click', \".toggle-update_mobile_number\", function (e) {\n\n\te.preventDefault();\n\n\t$(\"[data-sms_dlog_comp=true]\").slideToggle(function () {\n\n\t\tif ($(this).is(':hidden'))\n\t\t{\n\t\t\t$('form#add_mobile_number').trigger(\"reset\");\n\t\t\t$('#new_mobile_number_div').slideUp();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"[data-sms_pref=true]\").attr('disabled', false);\n\t\t}\n\n\t});\n\n});\n\n$(document).on('click', '[name=\"add_method\"]', function (e) {\n\n\tvar radioValue = $(\"input[name='add_method']:checked\").val();\n\n\tif (radioValue == 'new')\n\t{\n\t\t$(\"#new_mobile_number_div\").show();\n\t\t$('#new_mobile_number').prop('required', true);\n\t}\n\telse\n\t{\n\t\t$(\"#new_mobile_number_div\").hide();\n\t\t$('#new_mobile_number').prop('required', false);\n\t}\n\n});\n\n$(document).on('click', \"#cancel_number_update\", function (e) {\n\te.preventDefault();\n\t$(\"#add_or_change_SMS_number_div\").hide();\n\t$(\"#add_update_mobile_number\").attr(\"disabled\", false);\n\treturn false;\n});\n\n$(document).on('submit', '#add_mobile_number', function (e) {\n\n\te.preventDefault();\n\n\tif ($(this)['0'].checkValidity() !== false)\n\t{\n\t\tvar number = false;\n\t\tvar method = $(\"input[name='add_method']:checked\").val();\n\n\t\tvar selectedCategories = {};\n\t\tvar somethingChecked = false;\n\t\t$(\"[data-sms_pref=true]\").each(function () {\n\t\t\tif ($(this).is(\":checked\"))\n\t\t\t{\n\t\t\t\tsomethingChecked = true;\n\t\t\t\tselectedCategories[$(this).attr('id')] = 1;\n\t\t\t}\n\t\t});\n\n\t\tif (!somethingChecked && method != 'delete')\n\t\t{\n\n\t\t\t$(\"#add_mobile_number\").removeClass('was-validated');\n\t\t\t$('#confirm_number_update').removeSpinner();\n\n\t\t\tdd_message({\n\t\t\t\ttitle: \"Error\",\n\t\t\t\tmessage: \"Please opt into at least one type of message.\"\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (method == 'new')\n\t\t{\n\n\t\t\tvar phoneno = /^\\(?([0-9]{3})\\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;\n\t\t\tif ($(\"#new_mobile_number\").val().match(phoneno))\n\t\t\t{\n\t\t\t\tnumber = $(\"#new_mobile_number\").val();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\n\t\t\t\t$('#confirm_number_update').removeSpinner();\n\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: \"Error\",\n\t\t\t\t\tmessage: \"Please enter a valid phone number (xxx-xxx-xxxx).\"\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\t\telse if (method == 'delete')\n\t\t{\n\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 100000000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tuser_id: user_id,\n\t\t\t\t\tprocessor: 'account',\n\t\t\t\t\top: 'remove_cur_number'\n\t\t\t\t},\n\t\t\t\tsuccess: function (json, status) {\n\n\t\t\t\t\t$('#confirm_number_update').removeSpinner();\n\n\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t{\n\t\t\t\t\t\t$(\"#current_mobile_target\").html(\"Current Mobile number: \");\n\t\t\t\t\t\t$(\"[data-sms_pref=true]\").attr('disabled', 'disabled');\n\t\t\t\t\t\t$(\"[data-sms_pref=true]\").prop('checked', false);\n\t\t\t\t\t\t$(\"#add_update_mobile_number\").html(\"Add Mobile Number\");\n\t\t\t\t\t\t$(\"#add_update_mobile_number\").data('op', 'add');\n\n\t\t\t\t\t\t$(\"#add_or_change_SMS_number_div\").hide();\n\t\t\t\t\t\t$(\"#add_update_mobile_number\").attr(\"disabled\", false);\n\t\t\t\t\t\t$(\"#remove_mobile_number_div\").hide();\n\t\t\t\t\t\t$(\"[data-sms_dlog_comp=true]\").hide();\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: \"Success\",\n\t\t\t\t\t\t\tmessage: \"The SMS phone number has been removed. They will no longer receive text messages. (Note: It may take 60 minutes for the change to complete.)\"\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t// error when processing new number\n\t\t\t\t\t\t// leave dialog open\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: \"Error\",\n\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError) {\n\n\t\t\t\t\t$(\"#add_update_mobile_number\").removeSpinner();\n\t\t\t\t\t$(\"#add_update_mobile_number\").attr(\"disabled\", false);\n\n\t\t\t\t\t// low level error when processing new number\n\t\t\t\t\t// leave dialog open\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: \"Error\",\n\t\t\t\t\t\tmessage: \"Unexpected Error\"\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#add_update_mobile_number\").removeSpinner();\n\t\t\t$(\"#add_update_mobile_number\").attr(\"disabled\", false);\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 100000000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'account',\n\t\t\t\top: 'add_or_change_sms_number',\n\t\t\t\tmethod: method,\n\t\t\t\tnumber: number,\n\t\t\t\tselectedCategories: selectedCategories,\n\t\t\t\tuser_id: user_id,\n\t\t\t\tis_fadmin: true\n\t\t\t},\n\t\t\tsuccess: function (json, status) {\n\n\t\t\t\t$('#confirm_number_update').removeSpinner();\n\n\t\t\t\tif (json.processor_success)\n\t\t\t\t{\n\t\t\t\t\t$(\"#current_mobile_target\").html(\"Current Mobile number: \" + json.new_number);\n\t\t\t\t\t$(\"[data-sms_pref=true]\").attr('disabled', false);\n\t\t\t\t\t$(\"#add_update_mobile_number\").html(\"Update or Remove Mobile Number\");\n\t\t\t\t\t$(\"#add_update_mobile_number\").data('op', 'update');\n\t\t\t\t\t$(\"#remove_mobile_number_div\").show();\n\n\t\t\t\t\t$.each(json.newPrefsState, function (key, value) {\n\t\t\t\t\t\t$(\"#\" + key).attr('checked', value);\n\t\t\t\t\t});\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: \"Success\",\n\t\t\t\t\t\tmessage: \"The SMS phone number is updated.\"\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"[data-sms_dlog_comp=true]\").hide();\n\t\t\t\t\t$(\"#add_update_mobile_number\").attr(\"disabled\", false);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: \"Error\",\n\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: \"Error\",\n\t\t\t\t\tmessage: \"Unexpected Error\"\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn false;\n\n\t}\n\n});"],"mappings":"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"}