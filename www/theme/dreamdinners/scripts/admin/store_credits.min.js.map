{"version":3,"file":"store_credits.min.js","names":["process_pending_credit_now","user_id","credit_id","referred_user_id","store_id","$","ajax","url","type","timeout","dataType","data","processor","action","success","json","processor_success","replaceWith","html","window","calculateBalance","dd_message","title","message","processor_message","error","objAJAXRequest","strError","response","eo_process_pending_credit_now","client","remove","document","getElementById","rows","length","newSCTotal","val","prop","reportPaymentStatus","delete_store_credit","width","modal","confirm","notes","totalsName","formatAsMoney","after","cancel"],"sourceRoot":"js/src/dreamdinners/admin","sources":["store_credits.js"],"sourcesContent":["\r\nfunction process_pending_credit_now(user_id, credit_id, referred_user_id, store_id)\r\n{\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata : {\r\n\t\t\tprocessor: 'admin_store_credits',\r\n\t\t\taction:'process_now',\r\n\t\t\tuser_id: user_id,\r\n\t\t\treferred_user_id: referred_user_id,\r\n\t\t\tcredit_id: credit_id,\r\n\t\t\tstore_id: store_id\r\n\t\t},\r\n\t\tsuccess: function(json)\r\n\t\t{\r\n\t\t\tif(json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tvar rowName = 'pscr_' + credit_id;\r\n\r\n\t\t\t\t$('#' + rowName).replaceWith(json.html);\r\n\r\n\t\t\t\tif (window.calculateBalance && typeof(window.calculateBalance) == \"function\")\r\n\t\t\t\t{\r\n\t\t\t\t\tcalculateBalance();\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Processing Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\t\t\t}\r\n        },\r\n\t\terror: function(objAJAXRequest, strError)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: response = 'Unexpected error:' + strError\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n    return false;\r\n}\r\n\r\n\r\n// Order Editor is different enough to have it's own version\r\nfunction eo_process_pending_credit_now(user_id, credit_id, referred_user_id, store_id)\r\n{\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata : {\r\n\t\t\tprocessor: 'admin_store_credits',\r\n\t\t\taction:'process_now',\r\n\t\t\tuser_id: user_id,\r\n\t\t\treferred_user_id: referred_user_id,\r\n\t\t\tcredit_id: credit_id,\r\n\t\t\tstore_id: store_id,\r\n\t\t\tclient: 'order_editor'\r\n\t\t},\r\n\t\tsuccess: function(json)\r\n\t\t{\r\n\t\t\tif(json.processor_success)\r\n\t\t\t{\r\n\r\n\t\t\t\tvar rowName = 'pscr_' + credit_id;\r\n\t\t\t\t$('#' + rowName).remove();\r\n\r\n\t\t\t\tif (document.getElementById('pending_credits_table').rows.length == 2)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#pending_credits_table').remove();\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t$('#eoTotalStoreCredit').html(json.newSCTotal);\r\n\t\t\t\t$('#store_credits_amount').val(json.newSCTotal);\r\n\t\t\t\t$('#store_credits_amount').prop(\"disabled\", false);\r\n\t\t\t\t$('#use_store_credits').prop(\"checked\", true);\r\n\r\n\t\t\t\tif (window.reportPaymentStatus && typeof(window.reportPaymentStatus) == \"function\")\r\n\t\t\t\t{\r\n\t\t\t\t\treportPaymentStatus(false);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Processing Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\t\t\t}\r\n        },\r\n\t\terror: function(objAJAXRequest, strError)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: response = 'Unexpected error:' + strError\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n    return false;\r\n}\r\n\r\n\r\n\r\n\r\n//Order Editor is different enough to have it's own version\r\nfunction delete_store_credit(credit_id, user_id)\r\n{\r\n\r\n\tdd_message({\r\n\t\ttitle: 'Delete Store Credit',\r\n\t\twidth:400,\r\n\t\tmessage: '<b>Are you sure? This operation is undoable.</b><br />Enter an optional note:<br /><input id=\"delete_SC_notes\" type=\"text\" size=\"60\" maxsize=\"256\" />',\r\n\t\tmodal: true,\r\n\t\tconfirm: function() {\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata : {\r\n\t\t\t\t\tprocessor: 'admin_store_credits',\r\n\t\t\t\t\taction:'delete',\r\n\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\tcredit_id: credit_id,\r\n\t\t\t\t\tnotes: $('#delete_SC_notes').val()\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function(json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar rowName = 'scr_' + credit_id;\r\n\t\t\t\t\t\t$('#' + rowName).remove();\r\n\r\n\t\t\t\t\t\tvar totalsName = 'sctc_' + json.store_id;\r\n\t\t\t\t\t\t$('#' + totalsName).html(formatAsMoney(json.newSCTotal));\r\n\r\n\t\t\t\t\t\tif (document.getElementById('avail_credits_tbl').rows.length == 2)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('#avail_credits_header_row').after('<tr><td class=\"bgcolor_light\" colspan=\"8\" style=\"text-align:center;\"><i>There is no available store credit for this customer</i></td></tr>');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Processing Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t        },\r\n\t\t\t\terror: function(objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: response = 'Unexpected error:' + strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tcancel: function() {\r\n\t\t}\r\n\t});\r\n\r\n\r\n\r\n    return false;\r\n}"],"mappings":"AACA,SAASA,2BAA2BC,EAASC,EAAWC,EAAkBC,GA+CtE,OA5CHC,EAAEC,KAAK,CACNC,IAAK,aACLC,KAAM,OACNC,QAAS,IACTC,SAAU,OACVC,KAAO,CACNC,UAAW,sBACXC,OAAO,cACPZ,QAASA,EACTE,iBAAkBA,EAClBD,UAAWA,EACXE,SAAUA,GAEXU,QAAS,SAASC,GAEdA,EAAKC,mBAIPX,EAAE,KAFY,QAAUH,IAEPe,YAAYF,EAAKG,MAE9BC,OAAOC,kBAAuD,mBAA5BD,OAAuB,kBAE5DC,oBAMDC,WAAW,CACVC,MAAO,mBACPC,QAASR,EAAKS,mBAGX,EACNC,MAAO,SAASC,EAAgBC,GAE/BN,WAAW,CACVC,MAAO,QACPC,QAASK,SAAW,oBAAsBD,GAE5C,KAGS,CACX,CAIA,SAASE,8BAA8B5B,EAASC,EAAWC,EAAkBC,GA2DzE,OAxDHC,EAAEC,KAAK,CACNC,IAAK,aACLC,KAAM,OACNC,QAAS,IACTC,SAAU,OACVC,KAAO,CACNC,UAAW,sBACXC,OAAO,cACPZ,QAASA,EACTE,iBAAkBA,EAClBD,UAAWA,EACXE,SAAUA,EACV0B,OAAQ,gBAEThB,QAAS,SAASC,GAEdA,EAAKC,mBAIPX,EAAE,KADY,QAAUH,IACP6B,SAEmD,GAAhEC,SAASC,eAAe,yBAAyBC,KAAKC,QAEzD9B,EAAE,0BAA0B0B,SAI7B1B,EAAE,uBAAuBa,KAAKH,EAAKqB,YACnC/B,EAAE,yBAAyBgC,IAAItB,EAAKqB,YACpC/B,EAAE,yBAAyBiC,KAAK,YAAY,GAC5CjC,EAAE,sBAAsBiC,KAAK,WAAW,GAEpCnB,OAAOoB,qBAA6D,mBAA/BpB,OAA0B,qBAElEoB,qBAAoB,IAMrBlB,WAAW,CACVC,MAAO,mBACPC,QAASR,EAAKS,mBAGX,EACNC,MAAO,SAASC,EAAgBC,GAE/BN,WAAW,CACVC,MAAO,QACPC,QAASK,SAAW,oBAAsBD,GAE5C,KAGS,CACX,CAMA,SAASa,oBAAoBtC,EAAWD,GA4DpC,OAzDHoB,WAAW,CACVC,MAAO,sBACPmB,MAAM,IACNlB,QAAS,wJACTmB,OAAO,EACPC,QAAS,WACRtC,EAAEC,KAAK,CACNC,IAAK,aACLC,KAAM,OACNC,QAAS,IACTC,SAAU,OACVC,KAAO,CACNC,UAAW,sBACXC,OAAO,SACPZ,QAASA,EACTC,UAAWA,EACX0C,MAAOvC,EAAE,oBAAoBgC,OAE9BvB,QAAS,SAASC,GAEjB,GAAGA,EAAKC,kBACR,CAECX,EAAE,KADY,OAASH,IACN6B,SAEjB,IAAIc,EAAa,QAAU9B,EAAKX,SAChCC,EAAE,IAAMwC,GAAY3B,KAAK4B,cAAc/B,EAAKqB,aAEoB,GAA5DJ,SAASC,eAAe,qBAAqBC,KAAKC,QAErD9B,EAAE,6BAA6B0C,MAAM,6IAGvC,MAGC1B,WAAW,CACVC,MAAO,mBACPC,QAASR,EAAKS,mBAGX,EACNC,MAAO,SAASC,EAAgBC,GAE/BN,WAAW,CACVC,MAAO,QACPC,QAASK,SAAW,oBAAsBD,GAE5C,GAEF,EACAqB,OAAQ,WACR,KAKS,CACX"}