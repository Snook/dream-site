{"version":3,"file":"email.min.js","names":["email_init","handle_email_submit","handle_recipient_delete","$","submit","message","length","val","find","contents","html","dd_message","title","ext","split","pop","toLowerCase","inArray","phpVar","js_extensions","extensions","hide","show","addRecipient","guest","data","parent","before","prepend","data_tooltips_init","on","e","stopPropagation","user_id","this","remove","fn","qtip","emailCancel","bounce","page_back","resetAttachment","tinyeditor","TINY","editor","edit","id","width","height","cssclass","controlclass","rowclass","dividerclass","controls","footer","fonts","xhtml","cssfile","PATH","css","bodyid","footerclass","toggle","text","activetext","resize"],"sourceRoot":"js/src/dreamdinners/admin","sources":["email.js"],"sourcesContent":["function email_init()\n{\n\thandle_email_submit();\n\n\thandle_recipient_delete();\n\n\t//tinyeditor();\n}\n\nfunction handle_email_submit()\n{\n\t$('#email_form').submit(function() {\n\n\t\tmessage = '';\n\n\t\t// Check required elements\n\t\tif($('#sender_name').length && !$('#sender_name').val())\n\t\t{\n\t\t\tmessage += '<li>From Name</li>';\n\t\t}\n\t\tif(!$('#sender_email').val() && !$('#sender_email_dropdown').val())\n\t\t{\n\t\t\tmessage += '<li>From Email</li>';\n\t\t}\n\t\tif(!$('#recipient_list').find('.recipient').length)\n\t\t{\n\t\t\tmessage += '<li>Recipient</li>';\n\t\t}\n\t\tif(!$('#email_subject').val())\n\t\t{\n\t\t\tmessage += '<li>Subject</li>';\n\t\t}\n\n\t\t// put contents from tiny editor into textarea\n\t\tif($(\"iframe\").contents().find(\"#tinyeditor\").html())\n\t\t{\n\t\t\t$('#email_body').val($(\"iframe\").contents().find(\"#tinyeditor\").html());\n\t\t}\n\n\t\tif(!$('#email_body').val())\n\t\t{\n\t\t\tmessage += '<li>Message</li>';\n\t\t}\n\n\t\tif(message)\n\t\t{\n\t\t\tdd_message({ title: 'The following fields are required', message: '<ul>' + message + '</ul>' });\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check attachment\n\t\tif($('#email_attachment').val())\n\t\t{\n\t\t\tvar ext = $('#email_attachment').val().split('.').pop().toLowerCase();\n\t\t\tif($.inArray(ext, $.phpVar.js_extensions) == -1)\n\t\t\t{\n\t\t\t    dd_message({ title: 'Invalid file extension', message: 'Only ' + $.phpVar.extensions + ' allowed.' });\n\n\t\t\t    return false;\n\t\t\t}\n\t\t}\n\n\t\t$('#email_submit').hide();\n\t\t$('#processing_message').show();\n\t});\n}\n\nfunction addRecipient(guest)\n{\n\t// check if they already exist in the list\n\tif ($('.delete[data-user_id=\"' + $(guest).data('user_id') + '\"]').length)\n\t{\n\t\t$('.delete[data-user_id=\"' + $(guest).data('user_id') + '\"]').parent().parent().hide().show('pulsate');\n\n\t\treturn;\n\t}\n\n\t$('#recipient_list_end').before(\n\t\t$('<div class=\"recipient\"><span class=\"name\" data-tooltip=\"' + $(guest).data('primary_email') + '\">' + $(guest).data('firstname') + ' ' + $(guest).data('lastname') + ' <svg class=\"delete icon white icon-cancel-circle\" data-user_id=\"' + $(guest).data('user_id') + '\"><use xlink:href=\"#icon-cancel-circle\"></use></svg></span></div>').show('pulsate')\n\t);\n\n\t$('#email_form').prepend(\n\t\t$('<input type=\"hidden\" name=\"recipient[' + $(guest).data('user_id') + ']\" id=\"recipient[' + $(guest).data('user_id') + ']\" value=\"' + $(guest).data('user_id') + '\" />')\n\t);\n\n\tdata_tooltips_init();\n}\n\nfunction handle_recipient_delete()\n{\n\t$('#recipient_list').on('click', '.recipient', function (e) {\n\t\te.stopPropagation();\n\t});\n\n\t$('#recipient_list').on('click', '.delete', function (e) {\n\n\t\te.stopPropagation();\n\n\t\tvar user_id = $(this).data('user_id');\n\t\tvar parent = $(this).parent().parent();\n\n\t\t$('#recipient\\\\[' + user_id + '\\\\]').remove();\n\n\t\tif ($.fn.qtip)\n\t\t{\n\t\t\t$(this).parent().qtip('destroy');\n\t\t}\n\n\t\t$(parent).hide('puff', function() {\n\n\t\t\t$(parent).remove();\n\n\t\t});\n\n\t});\n}\n\nfunction emailCancel()\n{\n\tbounce($.phpVar.page_back);\n}\n\nfunction resetAttachment()\n{\n\t$('#email_attachment').val('');\n}\n\nfunction tinyeditor()\n{\n\tnew TINY.editor.edit('editor',{\n\t\tid:'email_body',\n\t\twidth:'100%',\n\t\theight:175,\n\t\tcssclass:'te',\n\t\tcontrolclass:'tecontrol',\n\t\trowclass:'teheader',\n\t\tdividerclass:'tedivider',\n\t\tcontrols:['bold','italic','underline','strikethrough','|','subscript','superscript','|',\n\t\t\t\t  'orderedlist','unorderedlist','|','outdent','indent','|','leftalign',\n\t\t\t\t  'centeralign','rightalign','blockjustify','|','unformat','|','undo','redo','n',\n\t\t\t\t  'font','size','style','|','image','hr','link','unlink','|','cut','copy','paste','print'],\n\t\tfooter:false,\n\t\tfonts:['Verdana','Arial','Georgia','Trebuchet MS'],\n\t\txhtml:true,\n\t\tcssfile: PATH.css + '/admin/tinyeditor.css',\n\t\tbodyid:'tinyeditor',\n\t\tfooterclass:'tefooter',\n\t\ttoggle:{text:'show source',activetext:'show wysiwyg',cssclass:'toggle'},\n\t\tresize:{cssclass:'resize'}\n\t});\n}"],"mappings":"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","ignoreList":[]}