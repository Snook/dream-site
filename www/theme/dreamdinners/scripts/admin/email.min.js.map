{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["email.js"],"sourcesContent":["function email_init()\r\n{\r\n\thandle_email_submit();\r\n\r\n\thandle_recipient_delete();\r\n\r\n\t//tinyeditor();\r\n}\r\n\r\nfunction handle_email_submit()\r\n{\r\n\t$('#email_form').submit(function() {\r\n\r\n\t\tmessage = '';\r\n\r\n\t\t// Check required elements\r\n\t\tif($('#sender_name').length && !$('#sender_name').val())\r\n\t\t{\r\n\t\t\tmessage += '<li>From Name</li>';\r\n\t\t}\r\n\t\tif(!$('#sender_email').val() && !$('#sender_email_dropdown').val())\r\n\t\t{\r\n\t\t\tmessage += '<li>From Email</li>';\r\n\t\t}\r\n\t\tif(!$('#recipient_list').find('.recipient').length)\r\n\t\t{\r\n\t\t\tmessage += '<li>Recipient</li>';\r\n\t\t}\r\n\t\tif(!$('#email_subject').val())\r\n\t\t{\r\n\t\t\tmessage += '<li>Subject</li>';\r\n\t\t}\r\n\r\n\t\t// put contents from tiny editor into textarea\r\n\t\tif($(\"iframe\").contents().find(\"#tinyeditor\").html())\r\n\t\t{\r\n\t\t\t$('#email_body').val($(\"iframe\").contents().find(\"#tinyeditor\").html());\r\n\t\t}\r\n\r\n\t\tif(!$('#email_body').val())\r\n\t\t{\r\n\t\t\tmessage += '<li>Message</li>';\r\n\t\t}\r\n\r\n\t\tif(message)\r\n\t\t{\r\n\t\t\tdd_message({ title: 'The following fields are required', message: '<ul>' + message + '</ul>' });\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Check attachment\r\n\t\tif($('#email_attachment').val())\r\n\t\t{\r\n\t\t\tvar ext = $('#email_attachment').val().split('.').pop().toLowerCase();\r\n\t\t\tif($.inArray(ext, $.phpVar.js_extensions) == -1)\r\n\t\t\t{\r\n\t\t\t    dd_message({ title: 'Invalid file extension', message: 'Only ' + $.phpVar.extensions + ' allowed.' });\r\n\r\n\t\t\t    return false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$('#email_submit').hide();\r\n\t\t$('#processing_message').show();\r\n\t});\r\n}\r\n\r\nfunction addRecipient(guest)\r\n{\r\n\t// check if they already exist in the list\r\n\tif ($('.delete[data-user_id=\"' + $(guest).data('user_id') + '\"]').length)\r\n\t{\r\n\t\t$('.delete[data-user_id=\"' + $(guest).data('user_id') + '\"]').parent().parent().hide().show('pulsate');\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\t$('#recipient_list_end').before(\r\n\t\t$('<div class=\"recipient\"><span class=\"name\" data-tooltip=\"' + $(guest).data('primary_email') + '\">' + $(guest).data('firstname') + ' ' + $(guest).data('lastname') + ' <svg class=\"delete icon white icon-cancel-circle\" data-user_id=\"' + $(guest).data('user_id') + '\"><use xlink:href=\"#icon-cancel-circle\"></use></svg></span></div>').show('pulsate')\r\n\t);\r\n\r\n\t$('#email_form').prepend(\r\n\t\t$('<input type=\"hidden\" name=\"recipient[' + $(guest).data('user_id') + ']\" id=\"recipient[' + $(guest).data('user_id') + ']\" value=\"' + $(guest).data('user_id') + '\" />')\r\n\t);\r\n\r\n\tdata_tooltips_init();\r\n}\r\n\r\nfunction handle_recipient_delete()\r\n{\r\n\t$('#recipient_list').on('click', '.recipient', function (e) {\r\n\t\te.stopPropagation();\r\n\t});\r\n\r\n\t$('#recipient_list').on('click', '.delete', function (e) {\r\n\r\n\t\te.stopPropagation();\r\n\r\n\t\tvar user_id = $(this).data('user_id');\r\n\t\tvar parent = $(this).parent().parent();\r\n\r\n\t\t$('#recipient\\\\[' + user_id + '\\\\]').remove();\r\n\r\n\t\tif ($.fn.qtip)\r\n\t\t{\r\n\t\t\t$(this).parent().qtip('destroy');\r\n\t\t}\r\n\r\n\t\t$(parent).hide('puff', function() {\r\n\r\n\t\t\t$(parent).remove();\r\n\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction emailCancel()\r\n{\r\n\tbounce($.phpVar.page_back);\r\n}\r\n\r\nfunction resetAttachment()\r\n{\r\n\t$('#email_attachment').val('');\r\n}\r\n\r\nfunction tinyeditor()\r\n{\r\n\tnew TINY.editor.edit('editor',{\r\n\t\tid:'email_body',\r\n\t\twidth:'100%',\r\n\t\theight:175,\r\n\t\tcssclass:'te',\r\n\t\tcontrolclass:'tecontrol',\r\n\t\trowclass:'teheader',\r\n\t\tdividerclass:'tedivider',\r\n\t\tcontrols:['bold','italic','underline','strikethrough','|','subscript','superscript','|',\r\n\t\t\t\t  'orderedlist','unorderedlist','|','outdent','indent','|','leftalign',\r\n\t\t\t\t  'centeralign','rightalign','blockjustify','|','unformat','|','undo','redo','n',\r\n\t\t\t\t  'font','size','style','|','image','hr','link','unlink','|','cut','copy','paste','print'],\r\n\t\tfooter:false,\r\n\t\tfonts:['Verdana','Arial','Georgia','Trebuchet MS'],\r\n\t\txhtml:true,\r\n\t\tcssfile: PATH.css + '/admin/tinyeditor.css',\r\n\t\tbodyid:'tinyeditor',\r\n\t\tfooterclass:'tefooter',\r\n\t\ttoggle:{text:'show source',activetext:'show wysiwyg',cssclass:'toggle'},\r\n\t\tresize:{cssclass:'resize'}\r\n\t});\r\n}"],"names":["email_init","handle_email_submit","handle_recipient_delete","$","submit","message","length","val","find","contents","html","dd_message","title","ext","split","pop","toLowerCase","inArray","phpVar","js_extensions","extensions","hide","show","addRecipient","guest","data","parent","before","prepend","data_tooltips_init","on","e","stopPropagation","user_id","this","remove","fn","qtip","emailCancel","bounce","page_back","resetAttachment","tinyeditor","TINY","editor","edit","id","width","height","cssclass","controlclass","rowclass","dividerclass","controls","footer","fonts","xhtml","cssfile","PATH","css","bodyid","footerclass","toggle","text","activetext","resize"],"mappings":"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"}