{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["dashboard.js"],"sourcesContent":["var isProcessingMetrics = false;\r\n\r\nfunction trending_report_init()\r\n{\r\n\t$('[id^=\"report_typedt\"]').on('click', function ()\r\n\t{\r\n\t\t$('#reports_trending_form').submit();\r\n\t});\r\n\r\n\t$('[id^=\"trade_area\"]').change(function ()\r\n\t{\r\n\r\n\t\t$(\"#report_typedt_stores_by_region\").attr('checked', 'checked');\r\n\r\n\t\tif ($(this).val() != 0)\r\n\t\t{\r\n\t\t\t$('#reports_trending_form').submit();\r\n\t\t}\r\n\t});\r\n\r\n\t$('[id^=\"store\"]').change(function ()\r\n\t{\r\n\r\n\t\t$(\"#report_typedt_single_store\").attr('checked', 'checked');\r\n\r\n\t\t$('#reports_trending_form').submit();\r\n\t});\r\n\r\n}\r\n\r\nfunction dashboard_init()\r\n{\r\n\tif (isHomeOfficeAccess)\r\n\t{\r\n\t\tinit_store_selector('dd_js_tree_dashboard');\r\n\r\n\t\tif (hasStoreData && $('#report_typedt_custom').is(\":checked\") && !didReturnCustomRollup)\r\n\t\t{\r\n\t\t\t$(\"#custom_store_select\").show();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(\"#custom_store_select\").hide();\r\n\t\t}\r\n\t}\r\n\r\n\t$('[id^=\"rank_met-\"]').on('click', function ()\r\n\t{\r\n\r\n\t\tvar metric = this.id.split(\"-\")[1];\r\n\t\tvar targetRow = \"tr_rank_met-\" + metric;\r\n\t\tvar targetCell = \"td_rank_met-\" + metric;\r\n\t\tvar disc_triangle = \"disc_rank_met-\" + metric;\r\n\r\n\t\tvar curMonth = $('#curMonthStr').val();\r\n\r\n\t\tif ($('#' + targetRow).is(':visible'))\r\n\t\t{\r\n\t\t\t$('#' + targetRow).slideUp('slow');\r\n\t\t\t$('#' + disc_triangle).addClass(\"disc_closed\");\r\n\t\t\t$('#' + disc_triangle).removeClass(\"disc_open\");\r\n\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php?processor=admin_top30',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\treport_type: 'menu_based',\t\t\t\t\t\r\n\t\t\t\t\tmetric_type: metric,\r\n\t\t\t\t\tmonth: curMonth\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('#' + targetCell).html(json.data);\r\n\t\t\t\t\t\t$('#' + targetRow).slideDown('slow');\r\n\r\n\t\t\t\t\t\t$('#' + disc_triangle).removeClass(\"disc_closed\");\r\n\t\t\t\t\t\t$('#' + disc_triangle).addClass(\"disc_open\");\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction menuChange(obj)\r\n{\r\n\t$(\"#store_array\").val(\"\");\r\n\t$(\"#custom_store_select\").hide();\r\n\t$(\"#custom_store_select_minimized\").hide();\r\n\r\n\t$('#dashboard_form').submit();\r\n\r\n}\r\n\r\nfunction runMultiStoreReport()\r\n{\r\n\r\n\tvar isSingleStore = $('#report_typedt_single_store').is(\":checked\");\r\n\r\n\tif (isSingleStore)\r\n\t{\r\n\t\t$('#dashboard_form').submit();\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar selectedStoreNodes = $('#store_selector').jstree(true).get_selected();\r\n\r\n\tvar postVal = new Array();\r\n\tvar count = 0;\r\n\r\n\tfor (var i = 0; i < selectedStoreNodes.length; ++i)\r\n\t{\r\n\t\tvar testNode = $('#store_selector').jstree(true).get_node(\"#\" + selectedStoreNodes[i]);\r\n\t\tif (testNode.state.hidden)\t\r\n\t\t{\r\n\t\t\t$('#store_selector').jstree(true).deselect_node(\"#\" + selectedStoreNodes[i]);\r\n\t\t\tcontinue;\r\n\t\t}\t\r\n\r\n\t\tif (selectedStoreNodes[i].indexOf(\"tree_store\") == 0)\r\n\t\t{\r\n\t\t\tvar thisID = selectedStoreNodes[i].split(\"-\");\r\n\t\t\tpostVal[count++] = thisID[1];\r\n\t\t}\r\n\t}\r\n\r\n\t$(\"#store_array\").val(postVal);\r\n\t$('#dashboard_form').submit();\r\n\r\n}\r\n\r\nfunction report_type_select(obj)\r\n{\r\n\tif ($(\"#report_typedt_single_store\").is(\":checked\") || $(\"#report_typedt_soft_launch\").is(\":checked\"))\r\n\t{\r\n\t\t$(\"#custom_store_select\").hide();\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$(\"#custom_store_select\").show();\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nfunction toggleMonth(mode)\r\n{\r\n\t// always force the month selector back to default\r\n\t$('#override_month').val(\"0\");\r\n\r\n\t$('#monthMode').val(mode);\r\n\t$('#dashboard_form').submit();\r\n}\r\n\r\nfunction handleMetricsUpdateComplete()\r\n{\r\n\t$('#dashboard_form').submit();\r\n}\r\n\r\nfunction processMetrics()\r\n{\r\n\r\n\tvar config = {\r\n\t\tresizable: false,\r\n\t\tmodal: true,\r\n\t\ttitle: \"Metrics Update!\",\r\n\t\tbeforeClose: function (event, ui)\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\t$('#busy_updating').dialog(config);\r\n\r\n\tisProcessingMetrics = true;\r\n\r\n\tvar sid = $(\"#store_id\").val();\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php?processor=admin_processMetrics',\r\n\t\ttype: 'POST',\r\n\t\tdataType: 'json',\r\n\t\ttimeout: 600000,\r\n\t\tdata: {\r\n\t\t\tstore_id: sid\r\n\t\t},\r\n\t\tsuccess: function (data)\r\n\t\t{\r\n\r\n\t\t\tisProcessingMetrics = false;\r\n\r\n\t\t\tif (data.result_code == 1)\r\n\t\t\t{\r\n\t\t\t\thandleMetricsUpdateComplete();\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError)\r\n\t\t{\r\n\t\t\tisProcessingMetrics = false;\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: strError\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\nfunction selectStoreTR(which)\r\n{\r\n\tif (which != \"\")\r\n\t{\r\n\t\t$('input:radio[name=report_type]:nth(0)').attr('checked', true);\r\n\t\t$('#reports_trending_form').submit();\r\n\t}\r\n}\r\n\r\nfunction selectStore(which)\r\n{\r\n\r\n\t/*\r\n\t * use new \"Run Report\" button instead of onChange\r\n\t *\r\n\t if (which != \"\")\r\n\t {\r\n\t $('input:radio[name=report_type]:nth(0)').attr('checked',true);\r\n\t $('#dashboard_form').submit();\r\n\t }\r\n\t */\r\n}\r\n\r\nfunction print_trending_report()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].target = \"_print\";\r\n\t$('#reports_trending_form')[0].action = act + \"&print=true\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].target = targ;\r\n\t$('#reports_trending_form')[0].action = act;\r\n\r\n}\r\n\r\n\r\nfunction export_trending_report_all_time()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx&tr_all_time=true\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].action = act;\r\n}\r\n\r\nfunction export_trending_report()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].action = act;\r\n\r\n}\r\n\r\nfunction export_order_list(menubased)\r\n{\r\n\r\n\tif (!$('#report_typedt_single_store').length || $('input:radio[name=report_type]:nth(0)').attr('checked'))\r\n\t{\r\n\t\tvar act = $('#dashboard_form')[0].action;\r\n\r\n\t\tif (menubased)\r\n\t\t{\r\n\t\t\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_menu_based&export=xlsx\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_new&export=xlsx\";\r\n\t\t}\r\n\r\n\t\t$('#dashboard_form').submit();\r\n\r\n\t\t$('#dashboard_form')[0].action = act;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Error',\r\n\t\t\tmessage: \"The order list can only be exported when viewing a single store\"\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction print_dashboard()\r\n{\r\n\tvar targ = $('#dashboard_form')[0].target;\r\n\tvar act = $('#dashboard_form')[0].action;\r\n\t$('#dashboard_form')[0].target = \"_print\";\r\n\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_menu_based&print=true\";\r\n\r\n\t$('#dashboard_form').submit();\r\n\r\n\t$('#dashboard_form')[0].target = targ;\r\n\t$('#dashboard_form')[0].action = act;\r\n}\r\n\r\n"],"names":["isProcessingMetrics","trending_report_init","$","on","submit","change","attr","this","val","dashboard_init","isHomeOfficeAccess","init_store_selector","hasStoreData","is","didReturnCustomRollup","show","hide","metric","id","split","targetRow","targetCell","disc_triangle","curMonth","slideUp","addClass","removeClass","ajax","url","type","dataType","data","report_type","metric_type","month","success","json","result_code","html","slideDown","dd_message","title","message","processor_message","error","objAJAXRequest","strError","menuChange","obj","runMultiStoreReport","isSingleStore","selectedStoreNodes","jstree","get_selected","postVal","Array","count","i","length","testNode","get_node","state","hidden","deselect_node","indexOf","thisID","report_type_select","toggleMonth","mode","handleMetricsUpdateComplete","processMetrics","config","resizable","modal","beforeClose","event","ui","dialog","sid","timeout","store_id","selectStoreTR","which","selectStore","print_trending_report","targ","target","act","action","export_trending_report_all_time","export_trending_report","export_order_list","menubased","print_dashboard"],"mappings":"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"}