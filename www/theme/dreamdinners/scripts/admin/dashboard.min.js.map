{"version":3,"names":["isProcessingMetrics","trending_report_init","$","on","submit","change","attr","this","val","dashboard_init","isHomeOfficeAccess","init_store_selector","hasStoreData","is","didReturnCustomRollup","show","hide","metric","id","split","targetRow","targetCell","disc_triangle","curMonth","slideUp","addClass","removeClass","ajax","url","type","dataType","data","report_type","metric_type","month","success","json","result_code","html","slideDown","dd_message","title","message","processor_message","error","objAJAXRequest","strError","menuChange","obj","runMultiStoreReport","selectedStoreNodes","jstree","get_selected","postVal","Array","count","i","length","get_node","state","hidden","deselect_node","indexOf","thisID","report_type_select","toggleMonth","mode","handleMetricsUpdateComplete","processMetrics","dialog","resizable","modal","beforeClose","event","ui","sid","timeout","store_id","selectStoreTR","which","selectStore","print_trending_report","targ","target","act","action","export_trending_report_all_time","export_trending_report","export_order_list","menubased","print_dashboard"],"sourceRoot":"js/src/admin","sources":["dashboard.js"],"sourcesContent":["var isProcessingMetrics = false;\r\n\r\nfunction trending_report_init()\r\n{\r\n\t$('[id^=\"report_typedt\"]').on('click', function ()\r\n\t{\r\n\t\t$('#reports_trending_form').submit();\r\n\t});\r\n\r\n\t$('[id^=\"trade_area\"]').change(function ()\r\n\t{\r\n\r\n\t\t$(\"#report_typedt_stores_by_region\").attr('checked', 'checked');\r\n\r\n\t\tif ($(this).val() != 0)\r\n\t\t{\r\n\t\t\t$('#reports_trending_form').submit();\r\n\t\t}\r\n\t});\r\n\r\n\t$('[id^=\"store\"]').change(function ()\r\n\t{\r\n\r\n\t\t$(\"#report_typedt_single_store\").attr('checked', 'checked');\r\n\r\n\t\t$('#reports_trending_form').submit();\r\n\t});\r\n\r\n}\r\n\r\nfunction dashboard_init()\r\n{\r\n\tif (isHomeOfficeAccess)\r\n\t{\r\n\t\tinit_store_selector('dd_js_tree_dashboard');\r\n\r\n\t\tif (hasStoreData && $('#report_typedt_custom').is(\":checked\") && !didReturnCustomRollup)\r\n\t\t{\r\n\t\t\t$(\"#custom_store_select\").show();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(\"#custom_store_select\").hide();\r\n\t\t}\r\n\t}\r\n\r\n\t$('[id^=\"rank_met-\"]').on('click', function ()\r\n\t{\r\n\r\n\t\tvar metric = this.id.split(\"-\")[1];\r\n\t\tvar targetRow = \"tr_rank_met-\" + metric;\r\n\t\tvar targetCell = \"td_rank_met-\" + metric;\r\n\t\tvar disc_triangle = \"disc_rank_met-\" + metric;\r\n\r\n\t\tvar curMonth = $('#curMonthStr').val();\r\n\r\n\t\tif ($('#' + targetRow).is(':visible'))\r\n\t\t{\r\n\t\t\t$('#' + targetRow).slideUp('slow');\r\n\t\t\t$('#' + disc_triangle).addClass(\"disc_closed\");\r\n\t\t\t$('#' + disc_triangle).removeClass(\"disc_open\");\r\n\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php?processor=admin_top30',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\treport_type: 'menu_based',\t\t\t\t\t\r\n\t\t\t\t\tmetric_type: metric,\r\n\t\t\t\t\tmonth: curMonth\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('#' + targetCell).html(json.data);\r\n\t\t\t\t\t\t$('#' + targetRow).slideDown('slow');\r\n\r\n\t\t\t\t\t\t$('#' + disc_triangle).removeClass(\"disc_closed\");\r\n\t\t\t\t\t\t$('#' + disc_triangle).addClass(\"disc_open\");\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError)\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction menuChange(obj)\r\n{\r\n\t$(\"#store_array\").val(\"\");\r\n\t$(\"#custom_store_select\").hide();\r\n\t$(\"#custom_store_select_minimized\").hide();\r\n\r\n\t$('#dashboard_form').submit();\r\n\r\n}\r\n\r\nfunction runMultiStoreReport()\r\n{\r\n\r\n\tvar isSingleStore = $('#report_typedt_single_store').is(\":checked\");\r\n\r\n\tif (isSingleStore)\r\n\t{\r\n\t\t$('#dashboard_form').submit();\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar selectedStoreNodes = $('#store_selector').jstree(true).get_selected();\r\n\r\n\tvar postVal = new Array();\r\n\tvar count = 0;\r\n\r\n\tfor (var i = 0; i < selectedStoreNodes.length; ++i)\r\n\t{\r\n\t\tvar testNode = $('#store_selector').jstree(true).get_node(\"#\" + selectedStoreNodes[i]);\r\n\t\tif (testNode.state.hidden)\t\r\n\t\t{\r\n\t\t\t$('#store_selector').jstree(true).deselect_node(\"#\" + selectedStoreNodes[i]);\r\n\t\t\tcontinue;\r\n\t\t}\t\r\n\r\n\t\tif (selectedStoreNodes[i].indexOf(\"tree_store\") == 0)\r\n\t\t{\r\n\t\t\tvar thisID = selectedStoreNodes[i].split(\"-\");\r\n\t\t\tpostVal[count++] = thisID[1];\r\n\t\t}\r\n\t}\r\n\r\n\t$(\"#store_array\").val(postVal);\r\n\t$('#dashboard_form').submit();\r\n\r\n}\r\n\r\nfunction report_type_select(obj)\r\n{\r\n\tif ($(\"#report_typedt_single_store\").is(\":checked\") || $(\"#report_typedt_soft_launch\").is(\":checked\"))\r\n\t{\r\n\t\t$(\"#custom_store_select\").hide();\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$(\"#custom_store_select\").show();\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nfunction toggleMonth(mode)\r\n{\r\n\t// always force the month selector back to default\r\n\t$('#override_month').val(\"0\");\r\n\r\n\t$('#monthMode').val(mode);\r\n\t$('#dashboard_form').submit();\r\n}\r\n\r\nfunction handleMetricsUpdateComplete()\r\n{\r\n\t$('#dashboard_form').submit();\r\n}\r\n\r\nfunction processMetrics()\r\n{\r\n\r\n\tvar config = {\r\n\t\tresizable: false,\r\n\t\tmodal: true,\r\n\t\ttitle: \"Metrics Update!\",\r\n\t\tbeforeClose: function (event, ui)\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\t$('#busy_updating').dialog(config);\r\n\r\n\tisProcessingMetrics = true;\r\n\r\n\tvar sid = $(\"#store_id\").val();\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php?processor=admin_processMetrics',\r\n\t\ttype: 'POST',\r\n\t\tdataType: 'json',\r\n\t\ttimeout: 600000,\r\n\t\tdata: {\r\n\t\t\tstore_id: sid\r\n\t\t},\r\n\t\tsuccess: function (data)\r\n\t\t{\r\n\r\n\t\t\tisProcessingMetrics = false;\r\n\r\n\t\t\tif (data.result_code == 1)\r\n\t\t\t{\r\n\t\t\t\thandleMetricsUpdateComplete();\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError)\r\n\t\t{\r\n\t\t\tisProcessingMetrics = false;\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: strError\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\nfunction selectStoreTR(which)\r\n{\r\n\tif (which != \"\")\r\n\t{\r\n\t\t$('input:radio[name=report_type]:nth(0)').attr('checked', true);\r\n\t\t$('#reports_trending_form').submit();\r\n\t}\r\n}\r\n\r\nfunction selectStore(which)\r\n{\r\n\r\n\t/*\r\n\t * use new \"Run Report\" button instead of onChange\r\n\t *\r\n\t if (which != \"\")\r\n\t {\r\n\t $('input:radio[name=report_type]:nth(0)').attr('checked',true);\r\n\t $('#dashboard_form').submit();\r\n\t }\r\n\t */\r\n}\r\n\r\nfunction print_trending_report()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].target = \"_print\";\r\n\t$('#reports_trending_form')[0].action = act + \"&print=true\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].target = targ;\r\n\t$('#reports_trending_form')[0].action = act;\r\n\r\n}\r\n\r\n\r\nfunction export_trending_report_all_time()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx&tr_all_time=true\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].action = act;\r\n}\r\n\r\nfunction export_trending_report()\r\n{\r\n\tvar targ = $('#reports_trending_form')[0].target;\r\n\tvar act = $('#reports_trending_form')[0].action;\r\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx\";\r\n\r\n\t$('#reports_trending_form').submit();\r\n\r\n\t$('#reports_trending_form')[0].action = act;\r\n\r\n}\r\n\r\nfunction export_order_list(menubased)\r\n{\r\n\r\n\tif (!$('#report_typedt_single_store').length || $('input:radio[name=report_type]:nth(0)').attr('checked'))\r\n\t{\r\n\t\tvar act = $('#dashboard_form')[0].action;\r\n\r\n\t\tif (menubased)\r\n\t\t{\r\n\t\t\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_menu_based&export=xlsx\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_new&export=xlsx\";\r\n\t\t}\r\n\r\n\t\t$('#dashboard_form').submit();\r\n\r\n\t\t$('#dashboard_form')[0].action = act;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Error',\r\n\t\t\tmessage: \"The order list can only be exported when viewing a single store\"\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction print_dashboard()\r\n{\r\n\tvar targ = $('#dashboard_form')[0].target;\r\n\tvar act = $('#dashboard_form')[0].action;\r\n\t$('#dashboard_form')[0].target = \"_print\";\r\n\t$('#dashboard_form')[0].action = \"main.php?page=admin_dashboard_menu_based&print=true\";\r\n\r\n\t$('#dashboard_form').submit();\r\n\r\n\t$('#dashboard_form')[0].target = targ;\r\n\t$('#dashboard_form')[0].action = act;\r\n}\r\n\r\n"],"mappings":"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"}