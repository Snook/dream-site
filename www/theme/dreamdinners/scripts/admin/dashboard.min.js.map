{"version":3,"file":"dashboard.min.js","names":["isProcessingMetrics","trending_report_init","$","on","submit","change","attr","this","val","dashboard_init","isHomeOfficeAccess","init_store_selector","hasStoreData","is","didReturnCustomRollup","show","hide","metric","id","split","targetRow","targetCell","disc_triangle","curMonth","slideUp","addClass","removeClass","ajax","url","type","dataType","data","report_type","metric_type","month","success","json","result_code","html","slideDown","dd_message","title","message","processor_message","error","objAJAXRequest","strError","menuChange","obj","runMultiStoreReport","selectedStoreNodes","jstree","get_selected","postVal","count","i","length","get_node","state","hidden","deselect_node","indexOf","thisID","report_type_select","toggleMonth","mode","handleMetricsUpdateComplete","processMetrics","dialog","resizable","modal","beforeClose","event","ui","sid","timeout","store_id","selectStoreTR","which","selectStore","print_trending_report","targ","target","act","action","export_trending_report_all_time","export_trending_report","export_order_list","menubased","print_dashboard"],"sourceRoot":"js/src/dreamdinners/admin","sources":["dashboard.js"],"sourcesContent":["var isProcessingMetrics = false;\n\nfunction trending_report_init()\n{\n\t$('[id^=\"report_typedt\"]').on('click', function ()\n\t{\n\t\t$('#reports_trending_form').submit();\n\t});\n\n\t$('[id^=\"trade_area\"]').change(function ()\n\t{\n\n\t\t$(\"#report_typedt_stores_by_region\").attr('checked', 'checked');\n\n\t\tif ($(this).val() != 0)\n\t\t{\n\t\t\t$('#reports_trending_form').submit();\n\t\t}\n\t});\n\n\t$('[id^=\"store\"]').change(function ()\n\t{\n\n\t\t$(\"#report_typedt_single_store\").attr('checked', 'checked');\n\n\t\t$('#reports_trending_form').submit();\n\t});\n\n}\n\nfunction dashboard_init()\n{\n\tif (isHomeOfficeAccess)\n\t{\n\t\tinit_store_selector('dd_js_tree_dashboard');\n\n\t\tif (hasStoreData && $('#report_typedt_custom').is(\":checked\") && !didReturnCustomRollup)\n\t\t{\n\t\t\t$(\"#custom_store_select\").show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#custom_store_select\").hide();\n\t\t}\n\t}\n\n\t$('[id^=\"rank_met-\"]').on('click', function ()\n\t{\n\n\t\tvar metric = this.id.split(\"-\")[1];\n\t\tvar targetRow = \"tr_rank_met-\" + metric;\n\t\tvar targetCell = \"td_rank_met-\" + metric;\n\t\tvar disc_triangle = \"disc_rank_met-\" + metric;\n\n\t\tvar curMonth = $('#curMonthStr').val();\n\n\t\tif ($('#' + targetRow).is(':visible'))\n\t\t{\n\t\t\t$('#' + targetRow).slideUp('slow');\n\t\t\t$('#' + disc_triangle).addClass(\"disc_closed\");\n\t\t\t$('#' + disc_triangle).removeClass(\"disc_open\");\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$.ajax({\n\t\t\t\turl: '/processor?processor=admin_top30',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\treport_type: 'menu_based',\n\t\t\t\t\tmetric_type: metric,\n\t\t\t\t\tmonth: curMonth\n\t\t\t\t},\n\t\t\t\tsuccess: function (json)\n\t\t\t\t{\n\t\t\t\t\tif (json.result_code == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('#' + targetCell).html(json.data);\n\t\t\t\t\t\t$('#' + targetRow).slideDown('slow');\n\n\t\t\t\t\t\t$('#' + disc_triangle).removeClass(\"disc_closed\");\n\t\t\t\t\t\t$('#' + disc_triangle).addClass(\"disc_open\");\n\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError)\n\t\t\t\t{\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\tmessage: strError\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t});\n}\n\nfunction menuChange(obj)\n{\n\t$(\"#store_array\").val(\"\");\n\t$(\"#custom_store_select\").hide();\n\t$(\"#custom_store_select_minimized\").hide();\n\n\t$('#dashboard_form').submit();\n\n}\n\nfunction runMultiStoreReport()\n{\n\n\tvar isSingleStore = $('#report_typedt_single_store').is(\":checked\");\n\n\tif (isSingleStore)\n\t{\n\t\t$('#dashboard_form').submit();\n\t\treturn;\n\t}\n\n\tvar selectedStoreNodes = $('#store_selector').jstree(true).get_selected();\n\n\tvar postVal = [];\n\tvar count = 0;\n\n\tfor (var i = 0; i < selectedStoreNodes.length; ++i)\n\t{\n\t\tvar testNode = $('#store_selector').jstree(true).get_node(\"#\" + selectedStoreNodes[i]);\n\t\tif (testNode.state.hidden)\n\t\t{\n\t\t\t$('#store_selector').jstree(true).deselect_node(\"#\" + selectedStoreNodes[i]);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (selectedStoreNodes[i].indexOf(\"tree_store\") == 0)\n\t\t{\n\t\t\tvar thisID = selectedStoreNodes[i].split(\"-\");\n\t\t\tpostVal[count++] = thisID[1];\n\t\t}\n\t}\n\n\t$(\"#store_array\").val(postVal);\n\t$('#dashboard_form').submit();\n\n}\n\nfunction report_type_select(obj)\n{\n\tif ($(\"#report_typedt_single_store\").is(\":checked\") || $(\"#report_typedt_soft_launch\").is(\":checked\") || $(\"#report_typedt_non_soft_launch\").is(\":checked\"))\n\t{\n\t\t$(\"#custom_store_select\").hide();\n\t}\n\telse\n\t{\n\t\t$(\"#custom_store_select\").show();\n\t}\n\treturn false;\n\n}\n\nfunction toggleMonth(mode)\n{\n\t// always force the month selector back to default\n\t$('#override_month').val(\"0\");\n\n\t$('#monthMode').val(mode);\n\t$('#dashboard_form').submit();\n}\n\nfunction handleMetricsUpdateComplete()\n{\n\t$('#dashboard_form').submit();\n}\n\nfunction processMetrics()\n{\n\n\tvar config = {\n\t\tresizable: false,\n\t\tmodal: true,\n\t\ttitle: \"Metrics Update!\",\n\t\tbeforeClose: function (event, ui)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\t$('#busy_updating').dialog(config);\n\n\tisProcessingMetrics = true;\n\n\tvar sid = $(\"#store_id\").val();\n\n\t$.ajax({\n\t\turl: '/processor?processor=admin_processMetrics',\n\t\ttype: 'POST',\n\t\tdataType: 'json',\n\t\ttimeout: 600000,\n\t\tdata: {\n\t\t\tstore_id: sid\n\t\t},\n\t\tsuccess: function (data)\n\t\t{\n\n\t\t\tisProcessingMetrics = false;\n\n\t\t\tif (data.result_code == 1)\n\t\t\t{\n\t\t\t\thandleMetricsUpdateComplete();\n\t\t\t}\n\t\t},\n\t\terror: function (objAJAXRequest, strError)\n\t\t{\n\t\t\tisProcessingMetrics = false;\n\t\t\tdd_message({\n\t\t\t\ttitle: 'Error',\n\t\t\t\tmessage: strError\n\t\t\t});\n\t\t}\n\t});\n\n}\n\nfunction selectStoreTR(which)\n{\n\tif (which != \"\")\n\t{\n\t\t$('input:radio[name=report_type]:nth(0)').attr('checked', true);\n\t\t$('#reports_trending_form').submit();\n\t}\n}\n\nfunction selectStore(which)\n{\n\n\t/*\n\t * use new \"Run Report\" button instead of onChange\n\t *\n\t if (which != \"\")\n\t {\n\t $('input:radio[name=report_type]:nth(0)').attr('checked',true);\n\t $('#dashboard_form').submit();\n\t }\n\t */\n}\n\nfunction print_trending_report()\n{\n\tvar targ = $('#reports_trending_form')[0].target;\n\tvar act = $('#reports_trending_form')[0].action;\n\t$('#reports_trending_form')[0].target = \"_print\";\n\t$('#reports_trending_form')[0].action = act + \"&print=true\";\n\n\t$('#reports_trending_form').submit();\n\n\t$('#reports_trending_form')[0].target = targ;\n\t$('#reports_trending_form')[0].action = act;\n\n}\n\n\nfunction export_trending_report_all_time()\n{\n\tvar targ = $('#reports_trending_form')[0].target;\n\tvar act = $('#reports_trending_form')[0].action;\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx&tr_all_time=true\";\n\n\t$('#reports_trending_form').submit();\n\n\t$('#reports_trending_form')[0].action = act;\n}\n\nfunction export_trending_report()\n{\n\tvar targ = $('#reports_trending_form')[0].target;\n\tvar act = $('#reports_trending_form')[0].action;\n\t$('#reports_trending_form')[0].action = act + \"&export=xlsx\";\n\n\t$('#reports_trending_form').submit();\n\n\t$('#reports_trending_form')[0].action = act;\n\n}\n\nfunction export_order_list(menubased)\n{\n\n\tif (!$('#report_typedt_single_store').length || $('input:radio[name=report_type]:nth(0)').attr('checked'))\n\t{\n\t\tvar act = $('#dashboard_form')[0].action;\n\n\t\tif (menubased)\n\t\t{\n\t\t\t$('#dashboard_form')[0].action = \"/backoffice/dashboard-menu-based?export=xlsx\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$('#dashboard_form')[0].action = \"/backoffice/dashboard-new?export=xlsx\";\n\t\t}\n\n\t\t$('#dashboard_form').submit();\n\n\t\t$('#dashboard_form')[0].action = act;\n\t}\n\telse\n\t{\n\t\tdd_message({\n\t\t\ttitle: 'Error',\n\t\t\tmessage: \"The order list can only be exported when viewing a single store\"\n\t\t});\n\t}\n\n}\n\nfunction print_dashboard()\n{\n\tvar targ = $('#dashboard_form')[0].target;\n\tvar act = $('#dashboard_form')[0].action;\n\t$('#dashboard_form')[0].target = \"_print\";\n\t$('#dashboard_form')[0].action = \"/backoffice/dashboard-menu-based?print=true\";\n\n\t$('#dashboard_form').submit();\n\n\t$('#dashboard_form')[0].target = targ;\n\t$('#dashboard_form')[0].action = act;\n}"],"mappings":"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"}