{"version":3,"file":"list_users.min.js","names":["manualSearchTypeChange","list_users_init","showHelpText","$","focus","bind","detectType","searchTypeChange","helpString","value","val","removeClass","unmask","addClass","mask","show","html","codes","target_prefix","scanPosition","charIndex","keyHandler2","evt","charCode","event","which","keyCode","String","fromCharCode","handleSwipeCompletion","endScanHandling","document","getElementById","style","display","length","prepareForCCSwipe","paymentNumber","onkeypress","receivedText","join","p","SwipeParserObj","surname","submit","isNumeric","indexOf","processorGuestSearch","searchtype","searchvalue","store_filter","prop","currentStore","ajax","url","type","dataType","data","search_type","q","results_type","store","filter","success","json","result_code","dd_message","title","message","processor_message","error","objAJAXRequest","strError","user_ref_action","user_referral_init","on","this","name","keypress","e","checkReferralSubmission","formElem","retVal","active_referral_email","modal","useGuestAccount","ref_id","email","id","isPending","isInPlatePoints","hide","foundReferralOption"],"sourceRoot":"js/src/dreamdinners/admin","sources":["list_users.js"],"sourcesContent":["var manualSearchTypeChange = false;\n\nfunction list_users_init()\n{\n\tshowHelpText();\n\t$('#q').focus();\n\t$('#q').bind('input', function() { detectType(); });\n}\n\nfunction searchTypeChange()\n{\n\tshowHelpText();\n\t$('#q').focus();\n\tmanualSearchTypeChange = true;\n}\n\nfunction showHelpText()\n{\n\tvar helpString = \"\";\n\tvar value = $('#search_type').val();\n\n\t$('#q').removeClass('telephone').unmask();\n\n\tswitch(value)\n\t{\n\t\tcase 'firstname':\n\t\t\thelpString = \"Enter full or partial first name\";\n\t\tbreak;\n\n\t\tcase 'lastname':\n\t\t\thelpString = \"Enter full or partial last name\";\n\t\tbreak;\n\n\t\tcase 'firstlast':\n\t\t\thelpString = \"Search Text Example: John Smith (Enter full or partial first and last name)\";\n\t\tbreak;\n\n\t\tcase 'email':\n\t\thelpString = \"Instruction Text: Enter full or partial email address\";\n\t\tbreak;\n\n\t\tcase 'phone':\n\t\t\thelpString = \"Instruction Text: Enter phone number in 555-555-5555 format\";\n\t\t\t$('#q').addClass('telephone');\n\t\t\t$('.telephone').mask('999-999-9999');\n\t\t\tbreak;\n\n\t\tcase 'id':\n\t\t\thelpString = \"Enter the exact Guest ID (No partial entries)\";\n\t\tbreak;\n\t}\n\n\t$('#search_help').show();\n\t$('#search_help').html(helpString);\n}\n\nvar codes = [];\nvar target_prefix = \"payment1_\";\nvar scanPosition = 0;\nvar charIndex = 0;\n\nfunction keyHandler2(evt)\n{\n\tevt = (evt) ? evt : event;\n\tvar charCode = (evt.charCode) ? evt.charCode : ((evt.which) ? evt.which : evt.keyCode);\n\n\tif(charCode == 13)\n\t{\n\t\treturn false;\n\t}\n\n\tcodes[charIndex++] = String.fromCharCode(charCode);\n\n\tif((String.fromCharCode(charCode) == '%') && (scanPosition == 0))\n\t{\n\t\tscanPosition = 1; //start of data\n\t}\n\telse if((String.fromCharCode(charCode) == 'B') && (scanPosition == 1))\n\t{\n\t\tscanPosition = 2; // start of track 1\n\t}\n\telse if((String.fromCharCode(charCode) == '?') && (scanPosition == 2))\n\t{\n\t\tscanPosition = 3;  // end of track 1\n\t}\n\telse if((String.fromCharCode(charCode) == '?') && (scanPosition == 3))\n\t{\n\t\tscanPosition = 0;  // end of track 2\n\t\tcharIndex = 0;\n\t\thandleSwipeCompletion();\n\t}\n}\n\nfunction endScanHandling()\n{\n\tdocument.getElementById('scanArea').style.display = \"none\";\n\tcodes.length = 0;\n\tscanPosition = 0;\n\tcharIndex = 0;\n\tdocument.getElementById('hidden_text_store').value= \"\";\n}\n\nfunction prepareForCCSwipe(paymentNumber)\n{\n\tdocument.onkeypress = keyHandler2;\n\tdocument.getElementById('scanArea').style.display = \"block\";\n\tdocument.getElementById('hidden_text_store').focus();\n\tdocument.getElementById('hidden_text_store').value= \"\";\n}\n\nfunction handleSwipeCompletion( )\n{\n\tvar receivedText = codes.join(\"\");\n\n\tvar p = new SwipeParserObj(receivedText);\n\n\tdocument.getElementById('q').value = p.surname;\n\n\tendScanHandling();\n\n\tdocument.getElementById('list_users_form').submit();\n}\n\nfunction detectType()\n{\n\t// user manually changed search type, don't automatically change it\n\tif (manualSearchTypeChange == true)\n\t{\n\t\treturn;\n\t}\n\n\tvar value = $('#q').val();\n\n\t// not numeric entry, start with last name\n\tif (!$.isNumeric(value))\n\t{\n\t\t$('#search_type').val('lastname');\n\t}\n\n\t// numeric entry, probably guest id\n\tif ($.isNumeric(value))\n\t{\n\t\t$('#search_type').val('id');\n\t}\n\n\t// has @ symbol, probably email\n\tif (value.indexOf(\"@\") != -1)\n\t{\n\t\t$('#search_type').val('email');\n\t}\n\n\t// has space, probably first and last name\n\tif (value.indexOf(\" \") != -1)\n\t{\n\t\t$('#search_type').val('firstlast');\n\t}\n\n\tshowHelpText();\n}\n\n// ------------------------------------ Processor Support\n\nfunction processorGuestSearch()\n{\n\n\tvar searchtype = $('#search_type').val();\n\tvar searchvalue = $('#q').val();\n\tvar store_filter = $('#all_stores').prop(\"checked\") ? 1 : 0;\n\tvar currentStore = $('#currentStore').val();\n\n\t$.ajax({\n\t\turl: 'ddproc.php?processor=admin_guestSearch',\n\t\ttype: 'POST',\n\t\tdataType : 'json',\n\t\tdata : {\n\t\t\tsearch_type: searchtype,\n\t\t\tq: searchvalue,\n\t\t\tresults_type:'compact_list',\n\t\t\tstore: (currentStore ? currentStore : 'none'),\n\t\t\tfilter: store_filter\n\t\t},\n\t\tsuccess: function(json)\n\t\t{\n\t\t\tif (json.result_code == 1)\n\t\t\t{\n\t\t\t\t$('#user_list_target').html(json.data);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdd_message({ title: 'Error', message: json.processor_message});\n\n\t\t\t}\n\t    },\n\t\terror: function(objAJAXRequest, strError)\n\t\t{\n\t\t\tdd_message({ title: 'Error', message: strError});\n\t\t}\n\t});\n}\n\n\nvar user_ref_action = \"none\";\n\nfunction user_referral_init()\n{\n\n\t$(\":submit\").on('click', function () { user_ref_action = this.name; });\n\n\t// If enter key is pressed on input handle zipcode search\n\t$(\"#q\").keypress(function(e) {\n\t\tif(e.which == 13)\n\t\t{\n\t\t\tprocessorGuestSearch();\n\t\t}\n\t});\n\n\n}\n\nfunction checkReferralSubmission(formElem)\n{\n\tvar retVal = true;\n\n\tif ($('#operation').val() == 'ineligible' && user_ref_action == 'submit_referral')\n\t{\n\t\tif (active_referral_email == $('#overrideReferral').val())\n\t\t{\n\t\t\tretVal = false;\n\t\t\tdd_message({\n\t\t\t\tmodal : true,\n\t\t\t\tmessage : 'The referral source is aleady set to this user account.'\n\t\t\t});\n\t\t}\n\n\t}\n\n\n\treturn retVal;\n}\n\n\nfunction useGuestAccount(ref_id, email, id, isPending, isInPlatePoints )\n{\n\t$('#ur_select_message').hide();\n\t$('#user_list_target').html(\"\");\n\t$('#customer_referral_result').html(email);\n\t$('#overrideReferral').val(email);\n\t$('#customer_referral_id').val(ref_id);\n\t$('#submit_referral').prop('disabled', false);\n\t$('#optionsDiv').show();\n\n\tvar foundReferralOption = false;\n\n\tif (isInPlatePoints)\n\t{\n\t\t$(\"span[data-reward_type='points']\").show();\n\t\t$(\"span[data-reward_type='credit']\").hide();\n\n\t}\n\telse\n\t{\n\t\t$(\"span[data-reward_type='points']\").hide();\n\t\t$(\"span[data-reward_type='credit']\").show();\n\t}\n\n\tif (isPending)\n\t{\n\t\tif ($('#pendingOptions').length)\n\t\t{\n\t\t\tfoundReferralOption = true;\n\n\t\t\t$('#pendingOptions').show();\n\t\t\tif ($('#leave_queued').length)\n\t\t\t\t$('#leave_queued').prop(\"checked\", true);\n\t\t}\n\n\t\tif ($('#nonpendingOptions').length)\n\t\t{\n\t\t\t$('#nonpendingOptions').hide();\n\n\t\t\tif ($('#queue_new').length)\n\t\t\t\t$('#queue_new').prop(\"checked\", false);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif ($('#pendingOptions').length)\n\t\t{\n\t\t\t$('#pendingOptions').hide();\n\t\t\tif ($('#leave_queued').length)\n\t\t\t\t$('#leave_queued').prop(\"checked\", false);\n\t\t}\n\n\t\tif ($('#nonpendingOptions').length)\n\t\t{\n\t\t\tfoundReferralOption = true;\n\t\t\t$('#nonpendingOptions').show();\n\t\t\tif ($('#queue_new').length)\n\t\t\t\t$('#queue_new').prop(\"checked\", true);\n\t\t}\n\t}\n\n\tif (!foundReferralOption)\n\t{\n\t\t$('#operation').val(\"referral_source_update_only\");\n\t}\n\n\n}\n"],"mappings":"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"}