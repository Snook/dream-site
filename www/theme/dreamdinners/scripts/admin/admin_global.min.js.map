{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["admin_global.js"],"sourcesContent":["function admin_global_init()\r\n{\r\n\t// load tooltips\r\n\tdata_tooltips_init();\r\n\r\n\thelp_system_init();\r\n\r\n\tfadmin_idle_timeout();\r\n\r\n\t// drop down menus in fadmin\r\n\tmenu_bar_init();\r\n\t// Auto load [page_name]_init() functions\r\n\r\n\thandle_inline_guest_search();\r\n\r\n\thandle_helpdesk();\r\n\r\n\thandle_tabbed_content();\r\n\r\n\thandle_accordion_content();\r\n\r\n\t// Show ajax processing indicator\r\n\t$(document).ajaxStart(function () {\r\n\r\n\t\tAJAX_IN_PROCESS = true;\r\n\r\n\t\t$('.img_throbber_circle').show();\r\n\r\n\t});\r\n\r\n\t// Stop ajax processing indicator\r\n\t$(document).ajaxStop(function () {\r\n\t\tAJAX_IN_PROCESS = false;\r\n\r\n\t\t$('.img_throbber_circle').hide();\r\n\r\n\t});\r\n\r\n\t// this monitors ajax requests so you can do something always with them\r\n\t$(document).ajaxSuccess(function (event, xhr, settings) {\r\n\r\n\t\t// load any data-tooltips that may have been returned in ajax content\r\n\t\tdata_tooltips_init();\r\n\r\n\t\thandle_inline_guest_search();\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction click_dd_message_button(div_id, button_title)\r\n{\r\n\tvar topDiv = $(\"#\" + div_id).parent();\r\n\tvar found = false;\r\n\ttopDiv.find(\"[type=button]\").each(function () {\r\n\t\tvar buttonText = $(this).find(\"span\").html();\r\n\t\tif (buttonText == button_title)\r\n\t\t{\r\n\t\t\t$(this).click();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar buttonTextAttempt2 = $(this).html();\r\n\t\tif (buttonTextAttempt2 == button_title)\r\n\t\t{\r\n\t\t\t$(this).click();\r\n\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction onNBCreateSingleSession()\r\n{\r\n\tvar menus_elem = document.getElementById(\"menus\");\r\n\r\n\tvar menus_clause = \"\";\r\n\tif (menus_elem)\r\n\t{\r\n\t\tvar menu_id = document.getElementById(\"menus\").value;\r\n\t\tmenus_clause = \"&menu=\" + menu_id;\r\n\t}\r\n\r\n\tif (typeof selectedCell != \"undefined\" && selectedCell != null)\r\n\t{\r\n\t\tcellName = selectedCell.id;\r\n\t\tbounce(\"main.php?page=admin_create_session&selectedCell=\" + cellName);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tbounce(\"main.php?page=admin_create_session\" + menus_clause);\r\n\t}\r\n}\r\n\r\nfunction data_tooltips_init()\r\n{\r\n\tif (!IS_TOUCH_SCREEN_DEVICE)\r\n\t{\r\n\t\t// Load tooltips\r\n\t\tif ($.fn.qtip)\r\n\t\t{\r\n\t\t\t$('[data-tooltip]').qtip({\r\n\t\t\t\tcontent: {\r\n\t\t\t\t\tattr: 'data-tooltip'\r\n\t\t\t\t},\r\n\t\t\t\tposition: {\r\n\t\t\t\t\tmy: 'bottom left',\r\n\t\t\t\t\tat: 'top left',\r\n\t\t\t\t\tviewport: $(window),\r\n\t\t\t\t\tadjust: {\r\n\t\t\t\t\t\tmethod: 'shift',\r\n\t\t\t\t\t\ty: parseInt(0, 10) || 0,\r\n\t\t\t\t\t\tx: parseInt(10, 10) || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tclasses: 'ui-tooltip-dreamdinners_tt qtip-shadow'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction hostessDreamTasteOrder(session_id, session_text, userid)\r\n{\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=admin_order_mgr&user=' + userid,\r\n\t\tinput: ({\r\n\t\t\t'session': session_id,\r\n\t\t\t'request': 'savedTasteOrder',\r\n\t\t\t'sessionText': session_text\r\n\t\t})\r\n\t});\r\n}\r\n\r\nfunction handle_tabbed_content()\r\n{\r\n\tif ($('.tabbed-content').length == 0)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\twindow.tabbed_content = {};\r\n\r\n\t$('.tabbed-content').each(function (count) {\r\n\r\n\t\tif ($(this).data('tabid'))\r\n\t\t{\r\n\t\t\tif ($(this).data('tabid') in tabbed_content)\r\n\t\t\t{\r\n\t\t\t\tdd_console_log('data-tabid for tabbed-content must be unique.');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcount = $(this).data('tabid');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// store tabb\r\n\t\tvar this_content = tabbed_content[count] = this;\r\n\r\n\t\ttabbed_content[count].tab_clicks = {};\r\n\r\n\t\tvar tabs = $(this_content).find('.tabs');\r\n\t\tvar tab_content = $(this_content).find('.tabs-content');\r\n\r\n\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\tvar tabid = $(this).data('tabid');\r\n\r\n\t\t\t// tab needs a close button\r\n\t\t\tif ($(this).hasClass('close'))\r\n\t\t\t{\r\n\t\t\t\tvar confirmClass = '';\r\n\r\n\t\t\t\tif ($(this).hasClass('confirm'))\r\n\t\t\t\t{\r\n\t\t\t\t\tconfirmClass = ' confirm';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(this).append('<span class=\"close' + confirmClass + '\" data-tooltip=\"Close\">X</span>').find('.close').on('click', function (e) {\r\n\r\n\t\t\t\t\t// keep the outer tab click even from firing\r\n\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t\t// assign this to var to use within dd_message\r\n\t\t\t\t\tvar this_close_button = this;\r\n\r\n\t\t\t\t\t// if the close button has a confirmation class then prompt\r\n\t\t\t\t\t// if it has class noconfirm skip to else, this is a one-time class to override confirm prompt\r\n\t\t\t\t\tif ($(this_close_button).hasClass('confirm') && !$(this_close_button).hasClass('noconfirm'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Confirm',\r\n\t\t\t\t\t\t\tmessage: 'Are you sure you wish to close this tab?',\r\n\t\t\t\t\t\t\tconfirm: function () {\r\n\t\t\t\t\t\t\t\t// hide the tab that is closing\r\n\t\t\t\t\t\t\t\t$(this_close_button).parent().addClass('hidden');\r\n\r\n\t\t\t\t\t\t\t\t// select the first available tab\r\n\t\t\t\t\t\t\t\t$(this_close_button).parent().parent().children().not('.hidden, .disabled').first().trigger('click');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: function () {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// has class noconfirm, remove it this is a one-time override\r\n\t\t\t\t\t\t$(this_close_button).removeClass('noconfirm');\r\n\r\n\t\t\t\t\t\t// hide the tab that is closing\r\n\t\t\t\t\t\t$(this_close_button).parent().addClass('hidden');\r\n\r\n\t\t\t\t\t\t// select the first available tab\r\n\t\t\t\t\t\t$(this_close_button).parent().parent().children().not('.hidden, .disabled').first().trigger('click');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// get the selected tab on load to select primary content\r\n\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t{\r\n\t\t\t\tselected_tab = this;\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\t\t\t}\r\n\r\n\t\t\t// add content class to content divs\r\n\t\t\tif (!$(this).hasClass('content'))\r\n\t\t\t{\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('content');\r\n\t\t\t}\r\n\r\n\t\t\t// store tab object to fire click events on\r\n\t\t\ttabbed_content[count].tab_clicks[tabid] = this;\r\n\r\n\t\t\t$(this).on('click', function () {\r\n\r\n\t\t\t\t// already selected, don't do anything\r\n\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// disabled, don't do anything\r\n\t\t\t\tif ($(this).hasClass('disabled'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar exit_early = false;\r\n\t\t\t\t// iterate over tabs to remove selected class from current selected tab\r\n\t\t\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\r\n\t\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t// handle optional callback on tab being de-selected\r\n\t\t\t\t\t\tif ($(this).data('deselect_callback'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar data_callback = $(this).data('deselect_callback');\r\n\t\t\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\t\t\tif (!callback(this))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\texit_early = true;\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(this).removeClass('selected');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (exit_early)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// handle optional link url\r\n\t\t\t\tif ($(this).data('link'))\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce($(this).data('link'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// iterate over content div to remove selected from current selected content\r\n\t\t\t\t$(tab_content).find('[data-tabid]').each(function () {\r\n\r\n\t\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).removeClass('selected');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// add selected class to clicked tab\r\n\t\t\t\t$(tabs).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\r\n\t\t\t\t// add selected class to clicked content\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\r\n\t\t\t\t// handle optional callback\r\n\t\t\t\tif ($(this).data('callback'))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar data_callback = $(this).data('callback');\r\n\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\tcallback(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// html5 update url history\r\n\t\t\t\tif ($(this).data('urlpush') === undefined || $(this).data('urlpush') === 'true')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (getQueryVariable('tabs'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tab_sections = getQueryVariable('tabs').split(',');\r\n\r\n\t\t\t\t\t\tvar new_query = [];\r\n\t\t\t\t\t\tvar new_query_tabs = [];\r\n\r\n\t\t\t\t\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\t\t\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\t\t\t\t\tif (view_tab[0] == count)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + tabid);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + view_tab[1]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnew_query_tabs[view_tab[0]] = true;\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (new_query_tabs[count] === undefined)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnew_query.push(count + '.' + tabid);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnew_query_string = setQueryString('tabs', new_query.toString());\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnew_query_string = setQueryString('tabs', count + '.' + tabid);\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// select tabs based on url variable\r\n\tif (getQueryVariable('tabs'))\r\n\t{\r\n\t\tvar tab_sections = getQueryVariable('tabs').split(',');\r\n\r\n\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\tif (view_tab[0] !== undefined && view_tab[1] !== undefined)\r\n\t\t\t{\r\n\t\t\t\tif (!$(tabbed_content[view_tab[0]].tab_clicks[view_tab[1]]).hasClass('hidden'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(tabbed_content[view_tab[0]].tab_clicks[view_tab[1]]).click().mouseleave();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction handle_accordion_content()\r\n{\r\n\tif ($('.accordion-content').length == 0)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\twindow.accordion_content = {};\r\n\r\n\t$('.accordion-content').each(function (count) {\r\n\t\tif ($(this).data('tabid'))\r\n\t\t{\r\n\t\t\tif ($(this).data('tabid') in accordion_content)\r\n\t\t\t{\r\n\t\t\t\tdd_console_log('data-tabid for accordion-content must be unique.');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcount = $(this).data('tabid');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// store tabb\r\n\t\tvar this_content = accordion_content[count] = this;\r\n\t\taccordion_content[count].tab_clicks = {};\r\n\t\tvar tabs = $(this_content).find('.tabs');\r\n\r\n\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\tvar tabid = $(this).data('tabid');\r\n\r\n\t\t\t// get the selected tab on load to select primary content\r\n\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t{\r\n\t\t\t\tselected_tab = this;\r\n\t\t\t\t$(this).next().slideDown();\r\n\t\t\t}\r\n\r\n\t\t\t// store tab object to fire click events on\r\n\t\t\taccordion_content[count].tab_clicks[tabid] = this;\r\n\r\n\t\t\t$(this).on('click', function () {\r\n\r\n\t\t\t\t// already selected, don't do anything\r\n\t\t\t\tif ($(this).hasClass('active') || $(this).hasClass('disabled'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar exit_early = false;\r\n\t\t\t\t// iterate over tabs to remove selected class from current selected tab\r\n\t\t\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// handle optional callback on tab being de-selected\r\n\t\t\t\t\t\tif ($(this).data('deselect_callback'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar data_callback = $(this).data('deselect_callback');\r\n\t\t\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\t\t\tif (!callback(this))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\texit_early = true;\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(this).removeClass('active');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (exit_early)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// handle optional link url\r\n\t\t\t\tif ($(this).data('link'))\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce($(this).data('link'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// iterate over content div to remove selected from current selected content\r\n\t\t\t\t$(tabs).find('[data-tabidcontent]').each(function () {\r\n\t\t\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).hide();\r\n\t\t\t\t\t\t$(this).removeClass('active');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// add selected class to clicked tab\r\n\t\t\t\t$(tabs).find('[data-tabid=\"' + tabid + '\"]').addClass('active');\r\n\r\n\t\t\t\t// add selected class to clicked content\r\n\t\t\t\t$(tabs).find('[data-tabidcontent=\"' + tabid + 'Content\"]').addClass('active').slideDown();\r\n\r\n\t\t\t\t// handle optional callback\r\n\t\t\t\tif ($(this).data('callback'))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar data_callback = $(this).data('callback');\r\n\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\tcallback(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// html5 update url history\r\n\t\t\t\tif ($(this).data('urlpush') === undefined || $(this).data('urlpush') === 'true')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (getQueryVariable('atabs'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tab_sections = getQueryVariable('atabs').split(',');\r\n\r\n\t\t\t\t\t\tvar new_query = [];\r\n\t\t\t\t\t\tvar new_query_tabs = [];\r\n\r\n\t\t\t\t\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\t\t\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\t\t\t\t\tif (view_tab[0] == count)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + tabid);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + view_tab[1]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnew_query_tabs[view_tab[0]] = true;\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (new_query_tabs[count] === undefined)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnew_query.push(count + '.' + tabid);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnew_query_string = setQueryString('atabs', new_query.toString());\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnew_query_string = setQueryString('atabs', count + '.' + tabid);\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\t// select tabs based on url variable\r\n\tif (getQueryVariable('atabs'))\r\n\t{\r\n\t\tvar tab_sections = getQueryVariable('atabs').split(',');\r\n\r\n\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\tif (view_tab[0] !== undefined && view_tab[1] !== undefined && accordion_content)\r\n\t\t\t{\r\n\t\t\t\tif (!$(accordion_content[view_tab[0]].tab_clicks[view_tab[1]]).hasClass('hidden'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(accordion_content[view_tab[0]].tab_clicks[view_tab[1]]).click().mouseleave();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction hideStatusMessage(type)\r\n{\r\n\t$('#' + type).slideUp();\r\n}\r\n\r\nfunction dd_message(settings)\r\n{\r\n\tvar config = {\r\n\t\tresizable: false,\r\n\t\tmodal: true,\r\n\t\thide_qtips: true,\r\n\t\tdiv_id: 'dd_message'\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\t// hide open tooltips so they aren't on top of the dialog\r\n\tif (config.hide_qtips)\r\n\t{\r\n\t\tif ($.fn.qtip)\r\n\t\t{\r\n\t\t\t$('.qtip.ui-tooltip').qtip('hide');\r\n\t\t}\r\n\t}\r\n\r\n\tif (config.type == 'error_msg')\r\n\t{\r\n\t\t// TODO: to fix this http://jsfiddle.net/XkSu9/\r\n\t\t//config.title = '<img src=\"' + PATH.image + '/icon/error.png\" class=\"img_valign\" /> <span style=\"color:#ffff00;\">' + config.title + '</span>';\r\n\t}\r\n\r\n\t// Require message\r\n\tif (!config.message)\r\n\t{\r\n\t\tdd_message({message: \"dd_message({message : 'requires message!' })\"});\r\n\t}\r\n\telse\r\n\t{\r\n\t\t// Set up buttons object\r\n\t\tif (!config.buttons)\r\n\t\t{\r\n\t\t\tconfig.buttons = {};\r\n\t\t}\r\n\r\n\t\t// Add confirm button\r\n\t\tif (settings.confirm)\r\n\t\t{\r\n\t\t\tconfig.buttons.Confirm = function () {\r\n\t\t\t\tif (settings.canConfirm)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (settings.canConfirm())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsettings.confirm();\r\n\t\t\t\t\t\t// Destroy div\r\n\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tsettings.confirm();\r\n\t\t\t\t\t// Destroy div\r\n\t\t\t\t\t$(this).remove();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Add cancel button with callback, else if add plain cancel if confirm button has been added, else add ok button\r\n\t\tif (settings.cancel)\r\n\t\t{\r\n\t\t\tconfig.buttons.Cancel = function () {\r\n\t\t\t\tsettings.cancel();\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t\telse if (settings.confirm)\r\n\t\t{\r\n\t\t\tconfig.buttons.Cancel = function () {\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t\telse if (!settings.noOk)\r\n\t\t{\r\n\t\t\tconfig.buttons.Ok = function () {\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\tif (settings.closeCallback)\r\n\t\t\t\t{\r\n\t\t\t\t\tsettings.closeCallback();\r\n\t\t\t\t}\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t// Create hidden message div\r\n\tif ($('#' + config.div_id).length == 0)\r\n\t{\r\n\t\tvar div = $('<div></div>');\r\n\t\tdiv.attr('id', config.div_id);\r\n\t\tdiv.attr('style', 'display:none;');\r\n\t\t$(document.body).append(div);\r\n\t}\r\n\r\n\t// Add message to hidden div\r\n\t$('#' + config.div_id).html(config.message);\r\n\r\n\t// Launch the dialog\r\n\t$('#' + config.div_id).dialog(config);\r\n}\r\n\r\nfunction handle_helpdesk()\r\n{\r\n\tif (!$('#helpdesk', '#footerlinks').length)\r\n\t{\r\n\t\t$('#footerlinks').append('<div id=\"helpdesk\">Dream Dinners Support</div>');\r\n\t}\r\n\r\n\t$('#helpdesk, #helpdesk_footer_link, #helpdesk_button, .helpdesk-popup').on('click', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar request_url = window.location.pathname + window.location.search;\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 60000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_helpdesk',\r\n\t\t\t\top: 'get_helpdesk',\r\n\t\t\t\trequest_url: request_url\r\n\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar dialog_contents = json.helpdesk_form;\r\n\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Dream Dinners Support',\r\n\t\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\t\theight: 620,\r\n\t\t\t\t\t\twidth: 650,\r\n\t\t\t\t\t\tmodal: false,\r\n\t\t\t\t\t\tdiv_id: 'helpdesk_dd_message',\r\n\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\topen: function (event, ui) {\r\n\t\t\t\t\t\t\t$(\"#form_helpdesk input[name='subject']\").focus();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t'Support Portal': function () {\r\n\t\t\t\t\t\t\t\tbounce('https://support.dreamdinners.com', '_blank');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t'Submit Ticket': function () {\r\n\r\n\t\t\t\t\t\t\t\tvar validationMessages = \"\";\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk input[name='subject']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages = \"Subject<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk textarea[name='description']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages += \"Description<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk select[name='ticket_type']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages += \"Ticket Type<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (validationMessages.length > 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar message = \"Please Fill out the following fields:<br /><br />\" + validationMessages;\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Input error',\r\n\t\t\t\t\t\t\t\t\t\tmessage: message\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tvar helpdesk_dd_message = $(\"#helpdesk_dd_message\")[0];\r\n\r\n\t\t\t\t\t\t\t\t//\tvar fileElem = $(\"#email_attachment\")[0];\r\n\t\t\t\t\t\t\t\t//\tvar files = fileElem.files;\r\n\r\n\t\t\t\t\t\t\t\tvar ticket = $(\"#form_helpdesk\").serialize();\r\n\t\t\t\t\t\t\t\tvar formData = new FormData();\r\n\r\n\t\t\t\t\t\t\t\t//\tfor (var i = 0; i < files.length; i++)\r\n\t\t\t\t\t\t\t\t//\t{\r\n\t\t\t\t\t\t\t\t//\t\tvar file = files[i];\r\n\r\n\t\t\t\t\t\t\t\t// Add the file to the request.\r\n\t\t\t\t\t\t\t\t//\t\tformData.append('email_attachment', file, file.name);\r\n\t\t\t\t\t\t\t\t//\t}\r\n\r\n\t\t\t\t\t\t\t\tformData.append('op', 'submit_ticket');\r\n\t\t\t\t\t\t\t\tformData.append('processor', 'admin_helpdesk');\r\n\t\t\t\t\t\t\t\tformData.append('ticket_data', ticket);\r\n\t\t\t\t\t\t\t\tformData.append('reporting_url', window.location.href);\r\n\r\n\t\t\t\t\t\t\t\tif (DEBUG_INFO)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tformData.append('debugInfo', DEBUG_INFO);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\tcontentType: false,\r\n\t\t\t\t\t\t\t\t\tprocessData: false,\r\n\t\t\t\t\t\t\t\t\tdata: formData,\r\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$(helpdesk_dd_message).remove();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tCancel: function () {\r\n\t\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: strError\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_inline_guest_search()\r\n{\r\n\t$(document).on('click', '[data-guestsearch]', function (e) {\r\n\r\n\t\tif ($('#ilgs_container').length)\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar search_button_parameters = $(this).data();\r\n\t\tdelete search_button_parameters['qtip']; // remove unnecessary data from being sent to processor\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 60000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_guestSearch',\r\n\t\t\t\top: 'get_search_form',\r\n\t\t\t\tdata: search_button_parameters\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar dialog_contents = json.search_form;\r\n\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Guest Search',\r\n\t\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\t\tmodal: false,\r\n\t\t\t\t\t\tdiv_id: 'ilgs_container',\r\n\t\t\t\t\t\theight: 300,\r\n\t\t\t\t\t\twidth: 600,\r\n\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\tclose: function () {\r\n\t\t\t\t\t\t\t$('#ilgs_container').remove();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\topen: function (event, ui) {\r\n\t\t\t\t\t\t\t$('#ilgs_search_value').focus();\r\n\r\n\t\t\t\t\t\t\tvar manualSearchTypeChange = false;\r\n\r\n\t\t\t\t\t\t\t$(document).on('change', '#ilgs_search_type', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tmanualSearchTypeChange = true;\r\n\r\n\t\t\t\t\t\t\t\t$('#ilgs_search_value').unmask();\r\n\r\n\t\t\t\t\t\t\t\tif ($('#ilgs_search_type') == 'phone')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_value').mask('999-999-9999');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('.telephone');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$(document).on('keyup', '#ilgs_search_value', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tif (e.which == 13)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_go').trigger('click');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// user manually changed search type, don't automatically change it\r\n\t\t\t\t\t\t\t\tif (manualSearchTypeChange == true)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar value = $('#ilgs_search_value').val();\r\n\t\t\t\t\t\t\t\t// not numeric entry, start with last name\r\n\t\t\t\t\t\t\t\tif (!$.isNumeric(value))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('lastname');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// numeric entry, probably guest id\r\n\t\t\t\t\t\t\t\tif ($.isNumeric(value))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('id');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// has @ symbol, probably email\r\n\t\t\t\t\t\t\t\tif (value.indexOf(\"@\") != -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('email');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// has space, probably first and last name\r\n\t\t\t\t\t\t\t\tif (value.indexOf(\" \") != -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('firstlast');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$(document).on('click', '#ilgs_search_go', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tvar searchtype = $('#ilgs_search_type').val();\r\n\t\t\t\t\t\t\t\tvar searchvalue = $('#ilgs_search_value').val();\r\n\t\t\t\t\t\t\t\tvar store_filter = $('#ilgs_search_all').prop(\"checked\") ? 1 : 0;\r\n\t\t\t\t\t\t\t\tvar currentStore = $('#currentStore').val();\r\n\r\n\t\t\t\t\t\t\t\t$('#ilgs_results').slideUp();\r\n\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php?processor=admin_guestSearch',\r\n\t\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\tsearch_type: searchtype,\r\n\t\t\t\t\t\t\t\t\t\tq: searchvalue,\r\n\t\t\t\t\t\t\t\t\t\tresults_type: 'inline_search',\r\n\t\t\t\t\t\t\t\t\t\tstore: (currentStore ? currentStore : 'none'),\r\n\t\t\t\t\t\t\t\t\t\tfilter: store_filter,\r\n\t\t\t\t\t\t\t\t\t\tselect_button_title: search_button_parameters.select_button_title\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$('#ilgs_results').html(json.data).slideDown();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$(document).on('click', '[data-ilgs_result]', function (e) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (typeof window[search_button_parameters.select_function] === 'function')\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// this will merge in all data- from the data-guestsearch button for use when the data-select_function function is called\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$.extend(this.dataset, search_button_parameters);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// call data-select_function and pass 'this' as variable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow[search_button_parameters.select_function](this);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// remove the search container\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('#ilgs_container').remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\telse if (typeof search_button_parameters.select_function !== undefined && search_button_parameters.select_function !== false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdd_console_log(search_button_parameters.select_function + '() specified in data-select_function, but not defined in javascript.');\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// if there is no data-select_function then the button navigates to user_details\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=admin_user_details&id=' + $(this).data('user_id'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\thandle_dashboard_update();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction menu_bar_init()\r\n{\r\n\tif ($.fn.make_dropdown)\r\n\t{\r\n\t\t$('#menubar > li').make_dropdown({'timeout': 250});\r\n\t}\r\n}\r\n\r\nfunction fadmin_idle_timeout()\r\n{\r\n\tif (!USER_LOGGEDIN || !$.cookie('DreamSite_TO'))\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\r\n\tTO = $.cookie('DreamSite_TO');\r\n\r\n\tfadmin_is_idle(true);\r\n\r\n\t$(document).idle(\r\n\t\tfunction () {\r\n\r\n\t\t\t// When idle\r\n\t\t\tif (!is_idle)\r\n\t\t\t{\r\n\t\t\t\tfadmin_is_idle(true);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tfunction () {\r\n\r\n\t\t\t// When active again\r\n\t\t\tif (is_idle)\r\n\t\t\t{\r\n\t\t\t\tfadmin_is_idle(false);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t{\r\n\t\t\tafter: 2000\r\n\t\t}\r\n\t);\r\n}\r\n\r\nfunction fadmin_is_idle(idle)\r\n{\r\n\tis_idle = idle;\r\n\tajax_login_in_view = false;\r\n\twarning_time = 120000; // 2 minute warning\r\n\r\n\tvar date = new Date();\r\n\tvar sdate = new Date();\r\n\r\n\tvar minutes = TO;\r\n\tif (!idle)\r\n\t{\r\n\t\tminutes = 60;\r\n\t}\r\n\tvar milliseconds = minutes * 60 * 1000;\r\n\r\n\tdate.setTime(date.getTime() + (milliseconds));\r\n\tsdate.setTime(date.getTime() + (milliseconds) + 1000);\r\n\t// Note: add 1 second so that idle period expiration handler has a chance to grab the session id\r\n\r\n\tif (!idle)\r\n\t{\r\n\t\tdd_console_log('Not Idle ' + milliseconds);\r\n\r\n\t\t// cancel future alert popup\r\n\t\t$.doTimeout('alert_timeout_timer');\r\n\r\n\t\t// cancel future warning toast\r\n\t\t$.doTimeout('toast_timeout_warning');\r\n\r\n\t\t// close existing warning toast\r\n\t\tif (dd_toast_id_close('toast_timeout_warning'))\r\n\t\t{\r\n\t\t\tdd_toast({message: 'Activity has canceled the logout.'});\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdd_console_log('Idle ' + milliseconds);\r\n\r\n\t\tif (USER_LOGGEDIN && !ajax_login_in_view)\r\n\t\t{\r\n\t\t\t// start time until alert popup\r\n\t\t\t// default warning in warning_time, half timeout if timeout less than warning_time (for testing)\r\n\t\t\twarning_milliseconds = milliseconds / 2;\r\n\r\n\t\t\tif (milliseconds > warning_time)\r\n\t\t\t{\r\n\t\t\t\twarning_milliseconds = milliseconds - warning_time;\r\n\t\t\t}\r\n\r\n\t\t\t$.doTimeout('toast_timeout_warning', warning_milliseconds, function () {\r\n\t\t\t\tdd_toast({\r\n\t\t\t\t\tmessage: 'You will soon be logged out due to inactivity. Activity will cancel the logout.',\r\n\t\t\t\t\tdelay: false,\r\n\t\t\t\t\ttoast_id: 'toast_timeout_warning',\r\n\t\t\t\t\tsound: false\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t// start time until alert popup\r\n\t\t\t$.doTimeout('alert_timeout_timer', milliseconds, function () {\r\n\t\t\t\tdo_alert_timeout();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tif (USER_LOGGEDIN)\r\n\t{\r\n\t\t$.cookie('DreamSite_Timer', true, {\r\n\t\t\texpires: date,\r\n\t\t\tdomain: COOKIE.domain,\r\n\t\t\tsecure: true\r\n\t\t});\r\n\t\t$.cookie(COOKIE.dd_sc_name, $.cookie(COOKIE.dd_sc_name), {\r\n\t\t\texpires: sdate,\r\n\t\t\tdomain: COOKIE.domain,\r\n\t\t\tsecure: true\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction do_alert_timeout()\r\n{\r\n\tif ($.cookie('DreamSite_Timer')) // cookie still exists from another tab activity, check again in 3 seconds\r\n\t{\r\n\t\t$.doTimeout('alert_timeout_timer', 3000, function () {\r\n\t\t\tdo_alert_timeout();\r\n\t\t});\r\n\t}\r\n\telse // cookie expired, so do popup\r\n\t{\r\n\t\talert_timeout();\r\n\t}\r\n}\r\n\r\nfunction dd_toast(settings)\r\n{\r\n\t// delay: false; will prevent fadeout, click to remove toast\r\n\t// message: message;\r\n\t// toast_id: 'unique_id'; assign a toast id to manipulate programmically, typically to close a sticky\r\n\t// position: 'topleft', 'botleft', 'topright', 'botright', 'topcenter', 'center', 'botcenter'\r\n\t// sound: true/false, play sound\r\n\t// xclose: true/false, only X closes instead of clicking anywhere\r\n\r\n\tvar config = {\r\n\t\tdelay: 4000,\r\n\t\tmessage: false,\r\n\t\ttoast_id: false,\r\n\t\tposition: 'topright',\r\n\t\tcss_class: false,\r\n\t\tsound: false,\r\n\t\txclose: false\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (typeof toast_obj === 'undefined')\r\n\t{\r\n\t\ttoast_obj = {};\r\n\t}\r\n\r\n\tvar toast_container_selector = '.dd_toast_container.' + config.position;\r\n\r\n\tif (config.toast_id)\r\n\t{\r\n\t\tdd_toast_id_close(config.toast_id, true);\r\n\t}\r\n\r\n\tif (config.message)\r\n\t{\r\n\t\t// create container if not available\r\n\t\tif (!$(toast_container_selector).length)\r\n\t\t{\r\n\t\t\t$('<div class=\"dd_toast_container ' + config.position + '\"></div>').appendTo('body');\r\n\t\t}\r\n\r\n\t\t// add toast to container, register click to close handler\r\n\t\tif (config.toast_id)\r\n\t\t{\r\n\t\t\ttoast_obj[config.toast_id] = $('<div class=\"dd_toast\"></div>').appendTo(toast_container_selector);\r\n\r\n\t\t\ttoast = toast_obj[config.toast_id];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttoast = $('<div class=\"dd_toast\"></div>').appendTo(toast_container_selector);\r\n\t\t}\r\n\r\n\t\tif (config.css_class)\r\n\t\t{\r\n\t\t\t$(toast).addClass(config.css_class);\r\n\t\t}\r\n\r\n\t\t// add the message\r\n\t\t$(toast).html(config.message);\r\n\r\n\t\t// add close button for sticky\r\n\t\tif (!config.delay || config.xclose == true)\r\n\t\t{\r\n\t\t\t$('<div class=\"dd_toast_close\">x</div>').on('click', function () {\r\n\r\n\t\t\t\t$(toast).stop().fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(toast);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}).css({'cursor': 'pointer'}).prependTo(toast);\r\n\t\t}\r\n\r\n\t\t// close when click anywhere on div\r\n\t\tif (config.xclose == false)\r\n\t\t{\r\n\t\t\t$(toast).on('click', function () {\r\n\r\n\t\t\t\t$(this).stop().fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}).css({'cursor': 'pointer'});\r\n\t\t}\r\n\r\n\t\t// play sound if true\r\n\t\tif (config.sound)\r\n\t\t{\r\n\t\t\t$('<embed src=\"' + PATH.script + '/customer/media/dd_toast_alert.mp3\" hidden=\"true\" autostart=\"true\" loop=\"false\"></embed>').appendTo(toast);\r\n\t\t}\r\n\r\n\t\t// fadein, auto close if delay is not false\r\n\t\t$(toast).fadeIn('fast', function () {\r\n\r\n\t\t\t// fadein animation complete\r\n\t\t\tif (config.delay)\r\n\t\t\t{\r\n\t\t\t\t$(this).delay(config.delay).fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n}\r\n\r\nfunction dd_toast_id_close(toast_id, instant)\r\n{\r\n\tif (typeof toast_obj !== 'undefined' && typeof toast_obj[toast_id] !== 'undefined')\r\n\t{\r\n\t\tif (instant == true)\r\n\t\t{\r\n\t\t\tdd_toast_cleanup($(toast_obj[toast_id]));\r\n\r\n\t\t\tdelete toast_obj[toast_id];\r\n\t\t}\r\n\t\telse // fadeout\r\n\t\t{\r\n\t\t\t$(toast_obj[toast_id]).stop().fadeOut('slow', function () {\r\n\t\t\t\t// fadeout animation complete\r\n\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\tdelete toast_obj[toast_id];\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_toast_exists(toast_id)\r\n{\r\n\tif (typeof toast_obj !== 'undefined' && typeof toast_obj[toast_id] !== 'undefined')\r\n\t{\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_toast_cleanup(elem)\r\n{\r\n\t// cleanup, remove from dom\r\n\t$(elem).remove();\r\n\r\n\t// if all toasts are closed, remove container\r\n\t$('.dd_toast_container').each(function () {\r\n\t\tif ($(this).is(':empty'))\r\n\t\t{\r\n\t\t\t$(this).remove();\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction alert_timeout()\r\n{\r\n\tUSER_LOGGEDIN = false;\r\n\tajax_login_in_view = true;\r\n\r\n\tdd_toast_id_close('toast_timeout_warning');\r\n\t// hide elements that should be hidden on logout\r\n\t$('[data-fadmin_perm]').each(function () {\r\n\t\tif ($(this).is(\":visible\"))\r\n\t\t{\r\n\t\t\t$(this).attr('data-hide_on_logout', true).hide();\r\n\t\t}\r\n\t});\r\n\r\n\t// invalidate DreamSite cookie\r\n\tdate = new Date();\r\n\tdate.setDate(date.getDate() - 1);\r\n\r\n\tvar last_session_id = $.cookie(COOKIE.dd_sc_name);\r\n\r\n\t$.cookie(COOKIE.dd_sc_name, false, {\r\n\t\texpires: date,\r\n\t\tdomain: COOKIE.domain\r\n\t});\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 60000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'login',\r\n\t\t\top: 'get_login_form'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tvar dialog_contents = json.login_form;\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Session has expired due to inactivity',\r\n\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\theight: 300,\r\n\t\t\t\t\twidth: 300,\r\n\t\t\t\t\tdiv_id: 'to_login_div',\r\n\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\topen: function (event, ui) {\r\n\r\n\t\t\t\t\t\tvar buttons = $(this).dialog(\"option\", \"buttons\");\r\n\r\n\t\t\t\t\t\tvar acceptFunction = buttons.Accept;\r\n\r\n\t\t\t\t\t\t//hide close button.\r\n\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\r\n\r\n\t\t\t\t\t\t// focus password field\r\n\t\t\t\t\t\t$('#fadmin_password_login').focus();\r\n\r\n\t\t\t\t\t\t// register keyup on password field, if enter submit form\r\n\t\t\t\t\t\t$('#fadmin_password_login').keyup(function (e) {\r\n\r\n\t\t\t\t\t\t\tif (e.keyCode == $.ui.keyCode.ENTER)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tacceptFunction();\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$('.ui-widget-overlay').css({\r\n\t\t\t\t\t\t\t'background': '#462200 url(\"' + PATH.image_admin + '/fadmin_background.jpg\")',\r\n\t\t\t\t\t\t\t'opacity': '1',\r\n\t\t\t\t\t\t\t'filter': 'none'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tAccept: function () {\r\n\r\n\t\t\t\t\t\t\tvar login_ui = $(\"#to_login_div\")[0];\r\n\t\t\t\t\t\t\t$(\"#to_login_div\").find('#error_message').html('');\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\tprocessor: 'login',\r\n\t\t\t\t\t\t\t\t\tprimary_email_login: $(\"#to_login_div\").find('#fadmin_primary_email_login').val(),\r\n\t\t\t\t\t\t\t\t\tpassword_login: $(\"#to_login_div\").find('#fadmin_password_login').val(),\r\n\t\t\t\t\t\t\t\t\tnobo: 1,\r\n\t\t\t\t\t\t\t\t\tsubmit_login: 1,\r\n\t\t\t\t\t\t\t\t\tremember_login: 1,\r\n\t\t\t\t\t\t\t\t\tlast_session_id: last_session_id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\tif (json.processor_message)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$(\"#to_login_div\").find('#error_message').html(json.processor_message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (json.user_type == 'CUSTOMER')\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tbounce('/');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$(login_ui).remove();\r\n\t\t\t\t\t\t\t\t\t\t\tajax_login_in_view = false;\r\n\t\t\t\t\t\t\t\t\t\t\tUSER_LOGGEDIN = true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$('#fadmin_username').html(json.firstname + ' ' + json.lastname);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$('#fadmin_usertype').html(json.user_type_text);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// find elements that were hidden on logout and show them if user_type permits\r\n\t\t\t\t\t\t\t\t\t\t\t$('[data-fadmin_perm][data-hide_on_logout]').each(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tperm_array = $(this).data('fadmin_perm').split(',');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (~$.inArray(json.user_type, perm_array))\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(this).removeProp('data-hide_on_logout').show();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$.cookie('DreamSite_Timer', true, {\r\n\t\t\t\t\t\t\t\t\t\t\t\texpires: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\tdomain: COOKIE.domain,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsecure: true\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tfadmin_is_idle(false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function () {\r\n\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\r\n\t\t\thandle_dashboard_update();\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction displayModalWaitDialog(div_id, message)\r\n{\r\n\tvar processWindowContent = '<span style=\"font-weight:bold;\">' + message + '</span>&nbsp;&nbsp;';\r\n\tprocessWindowContent += '<img src=\"' + PATH.image + '/style/throbber_circle.gif\" class=\"img_valign\" alt=\"Processing\" />';\r\n\r\n\tdd_message({\r\n\t\ttitle: 'Processing',\r\n\t\tmessage: processWindowContent,\r\n\t\tnoOk: true,\r\n\t\tcloseOnEscape: false,\r\n\t\tdialogClass: \"noclose\",\r\n\t\tmodal: true,\r\n\t\twidth: 500,\r\n\t\theight: 90,\r\n\t\tresizable: false,\r\n\t\tdiv_id: div_id\r\n\t});\r\n}\r\n\r\nfunction set_platepoints_progress_bar(new_value, animate)\r\n{\r\n\tif (!animate)\r\n\t{\r\n\t\t$('#pp_progressbar').progressbar({\r\n\t\t\tvalue: new_value,\r\n\t\t\tchange: function () {\r\n\t\t\t\t$('#pp_progresslabel').text(new_value + '%');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$.doTimeout('platepoints_progress', 2, function () {\r\n\r\n\t\t\tvar current_value = $('#pp_progressbar').progressbar('option', 'value');\r\n\r\n\t\t\tif (isNaN(current_value))\r\n\t\t\t{\r\n\t\t\t\tcurrent_value = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (current_value < 50)\r\n\t\t\t{\r\n\t\t\t\t$('#pp_progresslabel').addClass('dark');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('#pp_progresslabel').removeClass('dark');\r\n\t\t\t}\r\n\r\n\t\t\tif (new_value > current_value)\r\n\t\t\t{\r\n\t\t\t\tincrease = true;\r\n\t\t\t\tvalue_count = current_value + 1;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tincrease = false;\r\n\t\t\t\tvalue_count = current_value - 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (increase)\r\n\t\t\t{\r\n\t\t\t\tif (value_count > new_value)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#pp_progressbar').progressbar({\r\n\t\t\t\t\t\tvalue: value_count,\r\n\t\t\t\t\t\tchange: function () {\r\n\t\t\t\t\t\t\t$('#pp_progresslabel').text($('#pp_progressbar').progressbar('value') + '%');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (value_count < new_value)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#pp_progressbar').progressbar({\r\n\t\t\t\t\t\tvalue: value_count,\r\n\t\t\t\t\t\tchange: function () {\r\n\t\t\t\t\t\t\t$('#pp_progresslabel').text($('#pp_progressbar').progressbar('value') + '%');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction help_system_init()\r\n{\r\n\t$('[data-help]').each(function () {\r\n\t\t$(this).addClass(\"help_enabled\");\r\n\r\n\t\tvar indexStr = $(this).attr('data-help');\r\n\t\tvar index = indexStr.split(\"-\");\r\n\r\n\t\tvar thisHelpData = ddHelpData;\r\n\t\tfor (var x = 0; x < index.length; x++)\r\n\t\t{\r\n\t\t\tthisHelpData = thisHelpData[index[x]];\r\n\t\t}\r\n\r\n\t\t// Load tooltips\r\n\t\tif ($.fn.qtip && typeof thisHelpData != 'undefined')\r\n\t\t{\r\n\t\t\t$(this).qtip({\r\n\t\t\t\tshow: {\r\n\t\t\t\t\tsolo: true\r\n\t\t\t\t},\r\n\t\t\t\tcontent: {\r\n\t\t\t\t\ttext: \"<div class='help_tip_title'>\" + thisHelpData.title + \"</div><div class='help_tip_text'>\" + thisHelpData.help_text + \"</div><div class='help_tip_tech_text'>\" + thisHelpData.tech_text + \"</div>\"\r\n\t\t\t\t},\r\n\t\t\t\tposition: {\r\n\t\t\t\t\tmy: 'bottom left',\r\n\t\t\t\t\tat: 'top left',\r\n\t\t\t\t\tviewport: $(window),\r\n\t\t\t\t\tadjust: {\r\n\t\t\t\t\t\tmethod: 'flip',\r\n\t\t\t\t\t\ty: parseInt(0, 10) || 0,\r\n\t\t\t\t\t\tx: parseInt(10, 10) || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tclasses: 'ui-tooltip-dreamdinners_tt ui-tooltip-shadow'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t/*\r\n\t $('[data-help]').on('click', function () {\r\n\r\n\t var indexStr = $(this).attr('data-help');\r\n\t var index = indexStr.split(\"-\");\r\n\r\n\t var thisHelpData = ddHelpData;\r\n\t for (var x = 0; x < index.length; x++)\r\n\t {\r\n\t thisHelpData = thisHelpData[index[x]];\r\n\t }\r\n\r\n\r\n\t dd_message({\r\n\t title: 'Help',\r\n\t message: thisHelpData,\r\n\t modal: false\r\n\t });\r\n\r\n\t });\r\n\t */\r\n}\r\n\r\n//Legacy function, needs replacement\r\nfunction NewWindowScroll(mypage, myname, w, h)\r\n{\r\n\tvar LeftPosition = (screen.width) ? Math.floor((screen.width - w) / 2) : 0;\r\n\tvar TopPosition = (screen.height) ? Math.floor((screen.height - h) / 2) : 0;\r\n\tvar settings = 'height=' + h + ',width=' + w + ',top=' + TopPosition + ',left=' + LeftPosition + ',status=no,toolbar=no,scrollbars=1,resizable=1';\r\n\twindow.open(mypage, myname, settings);\r\n}\r\n\r\n$(function () {\r\n\r\n\t$(document).on('click', '#menu-toggle', function (e) {\r\n\t\te.preventDefault();\r\n\t\t$(\"#wrapper\").toggleClass(\"toggled\");\r\n\t});\r\n\r\n\t// prevent mouse wheel from changing number fields\r\n\t$(document).on('focus', 'input[type=number]', function (e) {\r\n\t\t$(this).on('wheel.disableScroll', function (e) {\r\n\t\t\te.preventDefault()\r\n\t\t})\r\n\t});\r\n\t$(document).on('blur', 'input[type=number]', function (e) {\r\n\t\t$(this).off('wheel.disableScroll')\r\n\t});\r\n\r\n\t$(document).on('click', '[data-confirm-nav]', function (e) {\r\n\t\te.preventDefault();\r\n\t\tvar href = this.href;\r\n\t\tvar message = $(this).data('confirm-nav');\r\n\t\tbootbox.confirm({\r\n\t\t\tmessage: message,\r\n\t\t\tcallback: function (result) {\r\n\t\t\t\tif (result)\r\n\t\t\t\t{\r\n\t\t\t\t\twindow.location = href;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '[data-multi_store_select_id], [data-multi_store_select_filter]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t// prevent multiple clicks\r\n\t\tif ($(this).hasClass('disabled'))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// check if they are using the form filters, otherwise they are requesting the form below\r\n\t\tif ($(this).data('multi_store_select_filter'))\r\n\t\t{\r\n\t\t\tswitch ($(this).data('multi_store_select_filter'))\r\n\t\t\t{\r\n\t\t\t\tcase 'all':\r\n\t\t\t\t\t$(\"#multi_store_select_form input[type=checkbox]\").prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'none':\r\n\t\t\t\t\t$(\"#multi_store_select_form input[type=checkbox]\").prop('checked', false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"][data-franchise_id=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-non-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"][data-franchise_id!=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"][data-franchise_id=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-non-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"][data-franchise_id!=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dist-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"DISTRIBUTION_CENTER\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dist-none':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"DISTRIBUTION_CENTER\"]').prop('checked', false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet multi_store_select_id = $(this).data('multi_store_select_id');\r\n\r\n\t\tlet this_button = $(this);\r\n\r\n\t\t// get currently set ids\r\n\t\tlet store_ids = $('#' + multi_store_select_id).val();\r\n\r\n\t\t$(this_button).addClass('disabled');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\top: 'multi_store_select',\r\n\t\t\t\tstore_id: store_ids\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.confirm({\r\n\t\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\t\tscrollable: true,\r\n\t\t\t\t\t\tcallback: function (result) {\r\n\t\t\t\t\t\t\tif (result)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet form = $('#multi_store_select_form');\r\n\t\t\t\t\t\t\t\tlet checked = form.serializeArray();\r\n\r\n\t\t\t\t\t\t\t\tlet store_ids = [];\r\n\t\t\t\t\t\t\t\t$.each(checked, function (index, value) {\r\n\t\t\t\t\t\t\t\t\tstore_ids.push(value.value);\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$('#' + multi_store_select_id).val(store_ids.join());\r\n\r\n\t\t\t\t\t\t\t\t$('#' + multi_store_select_id + '-count').text(checked.length);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$(this_button).removeClass('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tstrError = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '[data-user_id_pp_tooltip]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar user_id = $(this).data('user_id_pp_tooltip');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\top: 'platepoints_tooltip',\r\n\t\t\t\tuser_id: user_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json, status) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.dialog({\r\n\t\t\t\t\t\tmessage: json.tooltip_html,\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\tmanage: {\r\n\t\t\t\t\t\t\t\tlabel: 'Manage',\r\n\t\t\t\t\t\t\t\tclassName: 'btn-success',\r\n\t\t\t\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t\t\t\tbounce('/main.php?page=admin_user_plate_points&id=' + user_id + '&back=' + back_path());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tclose: {\r\n\t\t\t\t\t\t\t\tlabel: 'Close',\r\n\t\t\t\t\t\t\t\tclassName: 'btn-success'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.link-dinner-details', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar menu_id = $(this).data('menu_id');\r\n\t\tvar menu_item_id = $(this).data('menu_item_id');\r\n\t\tvar store_id = $(this).data('store_id');\r\n\t\tvar target = $(this).prop('target');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'menu_item',\r\n\t\t\t\top: 'find_item',\r\n\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\tmenu_item_id: menu_item_id,\r\n\t\t\t\tstore_id: store_id,\r\n\t\t\t\tdetailed: true\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.dialog({\r\n\t\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\t\tsize: 'large',\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\"Full details\": function () {\r\n\t\t\t\t\t\t\t\tbounce('main.php?page=item&recipe=' + json.recipe_id + '&ov_menu=' + json.menu_id, target);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: {\r\n\t\t\t\t\t\t\t\tlabel: \"Close\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.backoffice_change_store:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet backoffice_change_store = {\r\n\t\t\t'back': back_path(),\r\n\t\t\t'dialog': null\r\n\t\t}\r\n\r\n\t\t// create the modal ui with bootbox\r\n\t\tbackoffice_change_store.dialog = bootbox.dialog({\r\n\t\t\tmessage: '<p><i class=\"fa fa-spin fa-spinner\"></i> Loading store selector...</p>',\r\n\t\t\tsize: 'large',\r\n\t\t\tcenterVertical: true,\r\n\t\t\tcloseButton: false,\r\n\t\t\tbuttons: {\r\n\t\t\t\tok: {\r\n\t\t\t\t\tlabel: \"Select store\",\r\n\t\t\t\t\tclassName: 'btn-primary backoffice_change_store-confirm disabled',\r\n\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\tlet store = $('#change_store-selector').val();\r\n\t\t\t\t\t\tlet store_text = $('#change_store-selector option:selected').text();\r\n\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p><i class=\"fa fa-spin fa-spinner\"></i> Loading ' + store_text + '</p>');\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.modal-footer > .backoffice_change_store-confirm').addClass('disabled');\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\t\t\t\t\top: 'store_selector',\r\n\t\t\t\t\t\t\t\tdo: 'selector_select',\r\n\t\t\t\t\t\t\t\tstore: store,\r\n\t\t\t\t\t\t\t\tback: backoffice_change_store.back\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tbounce(decodeURIComponent(backoffice_change_store.back));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\tlabel: \"Cancel\",\r\n\t\t\t\t\tclassName: 'btn-danger',\r\n\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonShow: function (e) {\r\n\t\t\t\t// load the menu items\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\t\t\top: 'store_selector',\r\n\t\t\t\t\t\tdo: 'selector_get'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html(json.form);\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.modal-footer > .backoffice_change_store-confirm').removeClass('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(backoffice_change_store.dialog).on('change', '#change_store-selector', function (e) {\r\n\t\t\t$('.backoffice_change_store-confirm').trigger('click');\r\n\t\t});\r\n\r\n\t});\r\n\r\n\tif (getQueryVariable('tab'))\r\n\t{\r\n\t\tvar tabid = getQueryVariable('tab');\r\n\r\n\t\t$('#' + tabid + '-tab').tab('show');\r\n\t}\r\n\r\n\t/* Handle Bootstrap Tabbed Content */\r\n\t$('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n\t\te.target; // newly activated tab\r\n\t\te.relatedTarget; // previous active tab\r\n\r\n\t\t// html5 update url history\r\n\t\tif ($(e.target).data('urlpush') !== undefined && $(e.target).data('urlpush') === true)\r\n\t\t{\r\n\t\t\tif ($(e.target).data('target') !== undefined)\r\n\t\t\t{\r\n\t\t\t\tvar target = $(e.target).data('target');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tvar target = $(e.target).attr('href');\r\n\t\t\t}\r\n\r\n\t\t\tvar tabid = $(target).attr('id');\r\n\r\n\t\t\tnew_query_string = setQueryString('tab', tabid);\r\n\t\t\thistoryPush({url: new_query_string});\r\n\t\t}\r\n\t});\r\n\r\n});"],"names":["admin_global_init","data_tooltips_init","help_system_init","fadmin_idle_timeout","menu_bar_init","handle_inline_guest_search","handle_helpdesk","handle_tabbed_content","handle_accordion_content","$","document","ajaxStart","AJAX_IN_PROCESS","show","ajaxStop","hide","ajaxSuccess","event","xhr","settings","click_dd_message_button","div_id","button_title","topDiv","parent","found","find","each","buttonText","this","html","click","buttonTextAttempt2","onNBCreateSingleSession","menus_elem","getElementById","menus_clause","menu_id","value","selectedCell","cellName","id","bounce","IS_TOUCH_SCREEN_DEVICE","fn","qtip","content","attr","position","my","at","viewport","window","adjust","method","y","parseInt","x","style","classes","hostessDreamTasteOrder","session_id","session_text","userid","create_and_submit_form","action","input","session","request","sessionText","length","tabbed_content","count","data","dd_console_log","this_content","tab_clicks","tabs","tab_content","tabid","hasClass","confirmClass","append","on","e","stopPropagation","this_close_button","dd_message","title","message","confirm","addClass","children","not","first","trigger","cancel","removeClass","selected_tab","exit_early","data_callback","callback","undefined","getQueryVariable","tab_sections","split","new_query","new_query_tabs","index","view_tab","push","new_query_string","setQueryString","toString","historyPush","url","mouseleave","accordion_content","next","slideDown","hideStatusMessage","type","slideUp","config","resizable","modal","hide_qtips","extend","buttons","Confirm","canConfirm","remove","Cancel","noOk","Ok","closeCallback","div","body","dialog","preventDefault","request_url","location","pathname","search","ajax","timeout","dataType","processor","op","success","json","processor_success","dialog_contents","helpdesk_form","height","width","open","ui","focus","Support Portal","Submit Ticket","validationMessages","val","trim","helpdesk_dd_message","ticket","serialize","formData","FormData","href","DEBUG_INFO","cache","contentType","processData","processor_message","error","objAJAXRequest","strError","search_button_parameters","search_form","closeOnEscape","close","manualSearchTypeChange","unmask","mask","which","isNumeric","indexOf","searchtype","searchvalue","store_filter","prop","currentStore","search_type","q","results_type","store","filter","select_button_title","result_code","select_function","dataset","response","handle_dashboard_update","make_dropdown","USER_LOGGEDIN","cookie","TO","fadmin_is_idle","idle","is_idle","after","ajax_login_in_view","warning_time","date","Date","sdate","minutes","milliseconds","setTime","getTime","doTimeout","dd_toast_id_close","dd_toast","warning_milliseconds","delay","toast_id","sound","do_alert_timeout","expires","domain","COOKIE","secure","dd_sc_name","alert_timeout","css_class","xclose","toast_obj","toast_container_selector","appendTo","toast","stop","fadeOut","dd_toast_cleanup","css","cursor","prependTo","PATH","script","fadeIn","instant","dd_toast_exists","elem","is","setDate","getDate","last_session_id","login_form","acceptFunction","Accept","keyup","keyCode","ENTER","background","image_admin","opacity","login_ui","primary_email_login","password_login","nobo","submit_login","remember_login","user_type","firstname","lastname","user_type_text","perm_array","inArray","removeProp","reload","displayModalWaitDialog","processWindowContent","image","dialogClass","set_platepoints_progress_bar","new_value","animate","progressbar","change","text","current_value","isNaN","increase","value_count","indexStr","thisHelpData","ddHelpData","solo","help_text","tech_text","NewWindowScroll","mypage","myname","w","h","LeftPosition","screen","Math","floor","TopPosition","toggleClass","off","bootbox","result","let","multi_store_select_id","this_button","store_ids","store_id","scrollable","form","checked","serializeArray","join","user_id","status","tooltip_html","manage","label","className","back_path","menu_item_id","target","detailed","size","Full details","recipe_id","backoffice_change_store","back","centerVertical","closeButton","ok","store_text","do","decodeURIComponent","onShow","tab","relatedTarget"],"mappings":"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"}