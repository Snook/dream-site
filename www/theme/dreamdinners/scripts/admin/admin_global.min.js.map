{"version":3,"names":["admin_global_init","data_tooltips_init","help_system_init","fadmin_idle_timeout","menu_bar_init","handle_inline_guest_search","handle_helpdesk","handle_tabbed_content","handle_accordion_content","$","document","ajaxStart","AJAX_IN_PROCESS","show","ajaxStop","hide","ajaxSuccess","event","xhr","settings","click_dd_message_button","div_id","button_title","parent","find","each","this","html","click","onNBCreateSingleSession","menus_clause","getElementById","value","selectedCell","cellName","id","bounce","IS_TOUCH_SCREEN_DEVICE","fn","qtip","content","attr","position","my","at","viewport","window","adjust","method","y","parseInt","x","style","classes","hostessDreamTasteOrder","session_id","session_text","userid","create_and_submit_form","action","input","session","request","sessionText","length","tabbed_content","count","data","dd_console_log","this_content","tab_clicks","tabs","tab_content","tabid","hasClass","confirmClass","append","on","e","stopPropagation","this_close_button","dd_message","title","message","confirm","addClass","children","not","first","trigger","cancel","removeClass","selected_tab","exit_early","data_callback","callback","undefined","getQueryVariable","tab_sections","split","new_query","new_query_tabs","index","view_tab","push","new_query_string","setQueryString","toString","historyPush","url","mouseleave","accordion_content","next","slideDown","hideStatusMessage","type","slideUp","config","resizable","modal","hide_qtips","extend","buttons","Confirm","canConfirm","remove","Cancel","noOk","Ok","closeCallback","div","body","dialog","preventDefault","request_url","location","pathname","search","ajax","timeout","dataType","processor","op","success","json","processor_success","helpdesk_form","height","width","open","ui","focus","validationMessages","val","trim","helpdesk_dd_message","ticket","serialize","formData","FormData","href","DEBUG_INFO","cache","contentType","processData","processor_message","error","objAJAXRequest","strError","search_button_parameters","search_form","closeOnEscape","close","manualSearchTypeChange","unmask","mask","which","isNumeric","indexOf","searchtype","searchvalue","store_filter","prop","currentStore","search_type","q","results_type","store","filter","select_button_title","result_code","select_function","dataset","response","handle_dashboard_update","make_dropdown","USER_LOGGEDIN","cookie","TO","fadmin_is_idle","idle","is_idle","after","ajax_login_in_view","warning_time","date","Date","sdate","minutes","milliseconds","setTime","getTime","warning_milliseconds","doTimeout","dd_toast","delay","toast_id","sound","do_alert_timeout","dd_toast_id_close","expires","domain","COOKIE","secure","dd_sc_name","alert_timeout","css_class","xclose","toast_obj","toast_container_selector","appendTo","toast","stop","fadeOut","dd_toast_cleanup","css","cursor","prependTo","PATH","script","fadeIn","instant","dd_toast_exists","elem","is","setDate","getDate","last_session_id","login_form","acceptFunction","Accept","keyup","keyCode","ENTER","background","image_admin","opacity","login_ui","primary_email_login","password_login","nobo","submit_login","remember_login","user_type","firstname","lastname","user_type_text","perm_array","inArray","removeProp","reload","displayModalWaitDialog","processWindowContent","image","dialogClass","set_platepoints_progress_bar","new_value","animate","current_value","progressbar","isNaN","increase","value_count","change","text","thisHelpData","ddHelpData","solo","help_text","tech_text","NewWindowScroll","mypage","myname","w","h","LeftPosition","screen","Math","floor","toggleClass","off","bootbox","result","multi_store_select_id","this_button","store_ids","store_id","scrollable","checked","serializeArray","join","user_id","status","tooltip_html","manage","label","className","back_path","menu_id","menu_item_id","target","detailed","size","recipe_id","backoffice_change_store","back","centerVertical","closeButton","ok","store_text","do","decodeURIComponent","onShow","form","tab","relatedTarget"],"sourceRoot":"js/src/admin","sources":["admin_global.js"],"sourcesContent":["function admin_global_init()\r\n{\r\n\t// load tooltips\r\n\tdata_tooltips_init();\r\n\r\n\thelp_system_init();\r\n\r\n\tfadmin_idle_timeout();\r\n\r\n\t// drop down menus in fadmin\r\n\tmenu_bar_init();\r\n\t// Auto load [page_name]_init() functions\r\n\r\n\thandle_inline_guest_search();\r\n\r\n\thandle_helpdesk();\r\n\r\n\thandle_tabbed_content();\r\n\r\n\thandle_accordion_content();\r\n\r\n\t// Show ajax processing indicator\r\n\t$(document).ajaxStart(function () {\r\n\r\n\t\tAJAX_IN_PROCESS = true;\r\n\r\n\t\t$('.img_throbber_circle').show();\r\n\r\n\t});\r\n\r\n\t// Stop ajax processing indicator\r\n\t$(document).ajaxStop(function () {\r\n\t\tAJAX_IN_PROCESS = false;\r\n\r\n\t\t$('.img_throbber_circle').hide();\r\n\r\n\t});\r\n\r\n\t// this monitors ajax requests so you can do something always with them\r\n\t$(document).ajaxSuccess(function (event, xhr, settings) {\r\n\r\n\t\t// load any data-tooltips that may have been returned in ajax content\r\n\t\tdata_tooltips_init();\r\n\r\n\t\thandle_inline_guest_search();\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction click_dd_message_button(div_id, button_title)\r\n{\r\n\tvar topDiv = $(\"#\" + div_id).parent();\r\n\tvar found = false;\r\n\ttopDiv.find(\"[type=button]\").each(function () {\r\n\t\tvar buttonText = $(this).find(\"span\").html();\r\n\t\tif (buttonText == button_title)\r\n\t\t{\r\n\t\t\t$(this).click();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar buttonTextAttempt2 = $(this).html();\r\n\t\tif (buttonTextAttempt2 == button_title)\r\n\t\t{\r\n\t\t\t$(this).click();\r\n\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction onNBCreateSingleSession()\r\n{\r\n\tvar menus_elem = document.getElementById(\"menus\");\r\n\r\n\tvar menus_clause = \"\";\r\n\tif (menus_elem)\r\n\t{\r\n\t\tvar menu_id = document.getElementById(\"menus\").value;\r\n\t\tmenus_clause = \"&menu=\" + menu_id;\r\n\t}\r\n\r\n\tif (typeof selectedCell != \"undefined\" && selectedCell != null)\r\n\t{\r\n\t\tcellName = selectedCell.id;\r\n\t\tbounce(\"main.php?page=admin_create_session&selectedCell=\" + cellName);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tbounce(\"main.php?page=admin_create_session\" + menus_clause);\r\n\t}\r\n}\r\n\r\nfunction data_tooltips_init()\r\n{\r\n\tif (!IS_TOUCH_SCREEN_DEVICE)\r\n\t{\r\n\t\t// Load tooltips\r\n\t\tif ($.fn.qtip)\r\n\t\t{\r\n\t\t\t$('[data-tooltip]').qtip({\r\n\t\t\t\tcontent: {\r\n\t\t\t\t\tattr: 'data-tooltip'\r\n\t\t\t\t},\r\n\t\t\t\tposition: {\r\n\t\t\t\t\tmy: 'bottom left',\r\n\t\t\t\t\tat: 'top left',\r\n\t\t\t\t\tviewport: $(window),\r\n\t\t\t\t\tadjust: {\r\n\t\t\t\t\t\tmethod: 'shift',\r\n\t\t\t\t\t\ty: parseInt(0, 10) || 0,\r\n\t\t\t\t\t\tx: parseInt(10, 10) || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tclasses: 'ui-tooltip-dreamdinners_tt qtip-shadow'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction hostessDreamTasteOrder(session_id, session_text, userid)\r\n{\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=admin_order_mgr&user=' + userid,\r\n\t\tinput: ({\r\n\t\t\t'session': session_id,\r\n\t\t\t'request': 'savedTasteOrder',\r\n\t\t\t'sessionText': session_text\r\n\t\t})\r\n\t});\r\n}\r\n\r\nfunction handle_tabbed_content()\r\n{\r\n\tif ($('.tabbed-content').length == 0)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\twindow.tabbed_content = {};\r\n\r\n\t$('.tabbed-content').each(function (count) {\r\n\r\n\t\tif ($(this).data('tabid'))\r\n\t\t{\r\n\t\t\tif ($(this).data('tabid') in tabbed_content)\r\n\t\t\t{\r\n\t\t\t\tdd_console_log('data-tabid for tabbed-content must be unique.');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcount = $(this).data('tabid');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// store tabb\r\n\t\tvar this_content = tabbed_content[count] = this;\r\n\r\n\t\ttabbed_content[count].tab_clicks = {};\r\n\r\n\t\tvar tabs = $(this_content).find('.tabs');\r\n\t\tvar tab_content = $(this_content).find('.tabs-content');\r\n\r\n\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\tvar tabid = $(this).data('tabid');\r\n\r\n\t\t\t// tab needs a close button\r\n\t\t\tif ($(this).hasClass('close'))\r\n\t\t\t{\r\n\t\t\t\tvar confirmClass = '';\r\n\r\n\t\t\t\tif ($(this).hasClass('confirm'))\r\n\t\t\t\t{\r\n\t\t\t\t\tconfirmClass = ' confirm';\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(this).append('<span class=\"close' + confirmClass + '\" data-tooltip=\"Close\">X</span>').find('.close').on('click', function (e) {\r\n\r\n\t\t\t\t\t// keep the outer tab click even from firing\r\n\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t\t// assign this to var to use within dd_message\r\n\t\t\t\t\tvar this_close_button = this;\r\n\r\n\t\t\t\t\t// if the close button has a confirmation class then prompt\r\n\t\t\t\t\t// if it has class noconfirm skip to else, this is a one-time class to override confirm prompt\r\n\t\t\t\t\tif ($(this_close_button).hasClass('confirm') && !$(this_close_button).hasClass('noconfirm'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Confirm',\r\n\t\t\t\t\t\t\tmessage: 'Are you sure you wish to close this tab?',\r\n\t\t\t\t\t\t\tconfirm: function () {\r\n\t\t\t\t\t\t\t\t// hide the tab that is closing\r\n\t\t\t\t\t\t\t\t$(this_close_button).parent().addClass('hidden');\r\n\r\n\t\t\t\t\t\t\t\t// select the first available tab\r\n\t\t\t\t\t\t\t\t$(this_close_button).parent().parent().children().not('.hidden, .disabled').first().trigger('click');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: function () {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// has class noconfirm, remove it this is a one-time override\r\n\t\t\t\t\t\t$(this_close_button).removeClass('noconfirm');\r\n\r\n\t\t\t\t\t\t// hide the tab that is closing\r\n\t\t\t\t\t\t$(this_close_button).parent().addClass('hidden');\r\n\r\n\t\t\t\t\t\t// select the first available tab\r\n\t\t\t\t\t\t$(this_close_button).parent().parent().children().not('.hidden, .disabled').first().trigger('click');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// get the selected tab on load to select primary content\r\n\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t{\r\n\t\t\t\tselected_tab = this;\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\t\t\t}\r\n\r\n\t\t\t// add content class to content divs\r\n\t\t\tif (!$(this).hasClass('content'))\r\n\t\t\t{\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('content');\r\n\t\t\t}\r\n\r\n\t\t\t// store tab object to fire click events on\r\n\t\t\ttabbed_content[count].tab_clicks[tabid] = this;\r\n\r\n\t\t\t$(this).on('click', function () {\r\n\r\n\t\t\t\t// already selected, don't do anything\r\n\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// disabled, don't do anything\r\n\t\t\t\tif ($(this).hasClass('disabled'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar exit_early = false;\r\n\t\t\t\t// iterate over tabs to remove selected class from current selected tab\r\n\t\t\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\r\n\t\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t// handle optional callback on tab being de-selected\r\n\t\t\t\t\t\tif ($(this).data('deselect_callback'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar data_callback = $(this).data('deselect_callback');\r\n\t\t\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\t\t\tif (!callback(this))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\texit_early = true;\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(this).removeClass('selected');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (exit_early)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// handle optional link url\r\n\t\t\t\tif ($(this).data('link'))\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce($(this).data('link'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// iterate over content div to remove selected from current selected content\r\n\t\t\t\t$(tab_content).find('[data-tabid]').each(function () {\r\n\r\n\t\t\t\t\tif ($(this).hasClass('selected'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).removeClass('selected');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// add selected class to clicked tab\r\n\t\t\t\t$(tabs).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\r\n\t\t\t\t// add selected class to clicked content\r\n\t\t\t\t$(tab_content).find('[data-tabid=\"' + tabid + '\"]').addClass('selected');\r\n\r\n\t\t\t\t// handle optional callback\r\n\t\t\t\tif ($(this).data('callback'))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar data_callback = $(this).data('callback');\r\n\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\tcallback(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// html5 update url history\r\n\t\t\t\tif ($(this).data('urlpush') === undefined || $(this).data('urlpush') === 'true')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (getQueryVariable('tabs'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tab_sections = getQueryVariable('tabs').split(',');\r\n\r\n\t\t\t\t\t\tvar new_query = [];\r\n\t\t\t\t\t\tvar new_query_tabs = [];\r\n\r\n\t\t\t\t\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\t\t\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\t\t\t\t\tif (view_tab[0] == count)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + tabid);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + view_tab[1]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnew_query_tabs[view_tab[0]] = true;\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (new_query_tabs[count] === undefined)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnew_query.push(count + '.' + tabid);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnew_query_string = setQueryString('tabs', new_query.toString());\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnew_query_string = setQueryString('tabs', count + '.' + tabid);\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// select tabs based on url variable\r\n\tif (getQueryVariable('tabs'))\r\n\t{\r\n\t\tvar tab_sections = getQueryVariable('tabs').split(',');\r\n\r\n\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\tif (view_tab[0] !== undefined && view_tab[1] !== undefined)\r\n\t\t\t{\r\n\t\t\t\tif (!$(tabbed_content[view_tab[0]].tab_clicks[view_tab[1]]).hasClass('hidden'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(tabbed_content[view_tab[0]].tab_clicks[view_tab[1]]).click().mouseleave();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction handle_accordion_content()\r\n{\r\n\tif ($('.accordion-content').length == 0)\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\twindow.accordion_content = {};\r\n\r\n\t$('.accordion-content').each(function (count) {\r\n\t\tif ($(this).data('tabid'))\r\n\t\t{\r\n\t\t\tif ($(this).data('tabid') in accordion_content)\r\n\t\t\t{\r\n\t\t\t\tdd_console_log('data-tabid for accordion-content must be unique.');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcount = $(this).data('tabid');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// store tabb\r\n\t\tvar this_content = accordion_content[count] = this;\r\n\t\taccordion_content[count].tab_clicks = {};\r\n\t\tvar tabs = $(this_content).find('.tabs');\r\n\r\n\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\tvar tabid = $(this).data('tabid');\r\n\r\n\t\t\t// get the selected tab on load to select primary content\r\n\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t{\r\n\t\t\t\tselected_tab = this;\r\n\t\t\t\t$(this).next().slideDown();\r\n\t\t\t}\r\n\r\n\t\t\t// store tab object to fire click events on\r\n\t\t\taccordion_content[count].tab_clicks[tabid] = this;\r\n\r\n\t\t\t$(this).on('click', function () {\r\n\r\n\t\t\t\t// already selected, don't do anything\r\n\t\t\t\tif ($(this).hasClass('active') || $(this).hasClass('disabled'))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar exit_early = false;\r\n\t\t\t\t// iterate over tabs to remove selected class from current selected tab\r\n\t\t\t\t$(tabs).find('[data-tabid]').each(function () {\r\n\t\t\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// handle optional callback on tab being de-selected\r\n\t\t\t\t\t\tif ($(this).data('deselect_callback'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar data_callback = $(this).data('deselect_callback');\r\n\t\t\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\t\t\tif (!callback(this))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\texit_early = true;\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(this).removeClass('active');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (exit_early)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// handle optional link url\r\n\t\t\t\tif ($(this).data('link'))\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce($(this).data('link'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// iterate over content div to remove selected from current selected content\r\n\t\t\t\t$(tabs).find('[data-tabidcontent]').each(function () {\r\n\t\t\t\t\tif ($(this).hasClass('active'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).hide();\r\n\t\t\t\t\t\t$(this).removeClass('active');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// add selected class to clicked tab\r\n\t\t\t\t$(tabs).find('[data-tabid=\"' + tabid + '\"]').addClass('active');\r\n\r\n\t\t\t\t// add selected class to clicked content\r\n\t\t\t\t$(tabs).find('[data-tabidcontent=\"' + tabid + 'Content\"]').addClass('active').slideDown();\r\n\r\n\t\t\t\t// handle optional callback\r\n\t\t\t\tif ($(this).data('callback'))\r\n\t\t\t\t{\r\n\t\t\t\t\tvar data_callback = $(this).data('callback');\r\n\t\t\t\t\tvar callback = window[data_callback];\r\n\r\n\t\t\t\t\tif (callback != undefined)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// pass the clicked object to callback\r\n\t\t\t\t\t\tcallback(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// html5 update url history\r\n\t\t\t\tif ($(this).data('urlpush') === undefined || $(this).data('urlpush') === 'true')\r\n\t\t\t\t{\r\n\t\t\t\t\tif (getQueryVariable('atabs'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar tab_sections = getQueryVariable('atabs').split(',');\r\n\r\n\t\t\t\t\t\tvar new_query = [];\r\n\t\t\t\t\t\tvar new_query_tabs = [];\r\n\r\n\t\t\t\t\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\t\t\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\t\t\t\t\tif (view_tab[0] == count)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + tabid);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew_query.push(view_tab[0] + '.' + view_tab[1]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnew_query_tabs[view_tab[0]] = true;\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (new_query_tabs[count] === undefined)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnew_query.push(count + '.' + tabid);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnew_query_string = setQueryString('atabs', new_query.toString());\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tnew_query_string = setQueryString('atabs', count + '.' + tabid);\r\n\t\t\t\t\t\thistoryPush({url: new_query_string});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\t// select tabs based on url variable\r\n\tif (getQueryVariable('atabs'))\r\n\t{\r\n\t\tvar tab_sections = getQueryVariable('atabs').split(',');\r\n\r\n\t\t$.each(tab_sections, function (index, value) {\r\n\r\n\t\t\tvar view_tab = value.split('.');\r\n\r\n\t\t\tif (view_tab[0] !== undefined && view_tab[1] !== undefined && accordion_content)\r\n\t\t\t{\r\n\t\t\t\tif (!$(accordion_content[view_tab[0]].tab_clicks[view_tab[1]]).hasClass('hidden'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(accordion_content[view_tab[0]].tab_clicks[view_tab[1]]).click().mouseleave();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction hideStatusMessage(type)\r\n{\r\n\t$('#' + type).slideUp();\r\n}\r\n\r\nfunction dd_message(settings)\r\n{\r\n\tvar config = {\r\n\t\tresizable: false,\r\n\t\tmodal: true,\r\n\t\thide_qtips: true,\r\n\t\tdiv_id: 'dd_message'\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\t// hide open tooltips so they aren't on top of the dialog\r\n\tif (config.hide_qtips)\r\n\t{\r\n\t\tif ($.fn.qtip)\r\n\t\t{\r\n\t\t\t$('.qtip.ui-tooltip').qtip('hide');\r\n\t\t}\r\n\t}\r\n\r\n\tif (config.type == 'error_msg')\r\n\t{\r\n\t\t// TODO: to fix this http://jsfiddle.net/XkSu9/\r\n\t\t//config.title = '<img src=\"' + PATH.image + '/icon/error.png\" class=\"img_valign\" /> <span style=\"color:#ffff00;\">' + config.title + '</span>';\r\n\t}\r\n\r\n\t// Require message\r\n\tif (!config.message)\r\n\t{\r\n\t\tdd_message({message: \"dd_message({message : 'requires message!' })\"});\r\n\t}\r\n\telse\r\n\t{\r\n\t\t// Set up buttons object\r\n\t\tif (!config.buttons)\r\n\t\t{\r\n\t\t\tconfig.buttons = {};\r\n\t\t}\r\n\r\n\t\t// Add confirm button\r\n\t\tif (settings.confirm)\r\n\t\t{\r\n\t\t\tconfig.buttons.Confirm = function () {\r\n\t\t\t\tif (settings.canConfirm)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (settings.canConfirm())\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsettings.confirm();\r\n\t\t\t\t\t\t// Destroy div\r\n\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tsettings.confirm();\r\n\t\t\t\t\t// Destroy div\r\n\t\t\t\t\t$(this).remove();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Add cancel button with callback, else if add plain cancel if confirm button has been added, else add ok button\r\n\t\tif (settings.cancel)\r\n\t\t{\r\n\t\t\tconfig.buttons.Cancel = function () {\r\n\t\t\t\tsettings.cancel();\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t\telse if (settings.confirm)\r\n\t\t{\r\n\t\t\tconfig.buttons.Cancel = function () {\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t\telse if (!settings.noOk)\r\n\t\t{\r\n\t\t\tconfig.buttons.Ok = function () {\r\n\t\t\t\t// Destroy hidden div and dialog\r\n\t\t\t\tif (settings.closeCallback)\r\n\t\t\t\t{\r\n\t\t\t\t\tsettings.closeCallback();\r\n\t\t\t\t}\r\n\t\t\t\t$(this).remove();\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t// Create hidden message div\r\n\tif ($('#' + config.div_id).length == 0)\r\n\t{\r\n\t\tvar div = $('<div></div>');\r\n\t\tdiv.attr('id', config.div_id);\r\n\t\tdiv.attr('style', 'display:none;');\r\n\t\t$(document.body).append(div);\r\n\t}\r\n\r\n\t// Add message to hidden div\r\n\t$('#' + config.div_id).html(config.message);\r\n\r\n\t// Launch the dialog\r\n\t$('#' + config.div_id).dialog(config);\r\n}\r\n\r\nfunction handle_helpdesk()\r\n{\r\n\tif (!$('#helpdesk', '#footerlinks').length)\r\n\t{\r\n\t\t$('#footerlinks').append('<div id=\"helpdesk\">Dream Dinners Support</div>');\r\n\t}\r\n\r\n\t$('#helpdesk, #helpdesk_footer_link, #helpdesk_button, .helpdesk-popup').on('click', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar request_url = window.location.pathname + window.location.search;\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 60000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_helpdesk',\r\n\t\t\t\top: 'get_helpdesk',\r\n\t\t\t\trequest_url: request_url\r\n\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar dialog_contents = json.helpdesk_form;\r\n\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Dream Dinners Support',\r\n\t\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\t\theight: 620,\r\n\t\t\t\t\t\twidth: 650,\r\n\t\t\t\t\t\tmodal: false,\r\n\t\t\t\t\t\tdiv_id: 'helpdesk_dd_message',\r\n\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\topen: function (event, ui) {\r\n\t\t\t\t\t\t\t$(\"#form_helpdesk input[name='subject']\").focus();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t'Support Portal': function () {\r\n\t\t\t\t\t\t\t\tbounce('https://support.dreamdinners.com', '_blank');\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t'Submit Ticket': function () {\r\n\r\n\t\t\t\t\t\t\t\tvar validationMessages = \"\";\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk input[name='subject']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages = \"Subject<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk textarea[name='description']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages += \"Description<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ($(\"#form_helpdesk select[name='ticket_type']\").val().trim().length == 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvalidationMessages += \"Ticket Type<br />\";\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (validationMessages.length > 0)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar message = \"Please Fill out the following fields:<br /><br />\" + validationMessages;\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Input error',\r\n\t\t\t\t\t\t\t\t\t\tmessage: message\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tvar helpdesk_dd_message = $(\"#helpdesk_dd_message\")[0];\r\n\r\n\t\t\t\t\t\t\t\t//\tvar fileElem = $(\"#email_attachment\")[0];\r\n\t\t\t\t\t\t\t\t//\tvar files = fileElem.files;\r\n\r\n\t\t\t\t\t\t\t\tvar ticket = $(\"#form_helpdesk\").serialize();\r\n\t\t\t\t\t\t\t\tvar formData = new FormData();\r\n\r\n\t\t\t\t\t\t\t\t//\tfor (var i = 0; i < files.length; i++)\r\n\t\t\t\t\t\t\t\t//\t{\r\n\t\t\t\t\t\t\t\t//\t\tvar file = files[i];\r\n\r\n\t\t\t\t\t\t\t\t// Add the file to the request.\r\n\t\t\t\t\t\t\t\t//\t\tformData.append('email_attachment', file, file.name);\r\n\t\t\t\t\t\t\t\t//\t}\r\n\r\n\t\t\t\t\t\t\t\tformData.append('op', 'submit_ticket');\r\n\t\t\t\t\t\t\t\tformData.append('processor', 'admin_helpdesk');\r\n\t\t\t\t\t\t\t\tformData.append('ticket_data', ticket);\r\n\t\t\t\t\t\t\t\tformData.append('reporting_url', window.location.href);\r\n\r\n\t\t\t\t\t\t\t\tif (DEBUG_INFO)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tformData.append('debugInfo', DEBUG_INFO);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\t\t\t\t\tcache: false,\r\n\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\tcontentType: false,\r\n\t\t\t\t\t\t\t\t\tprocessData: false,\r\n\t\t\t\t\t\t\t\t\tdata: formData,\r\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$(helpdesk_dd_message).remove();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tCancel: function () {\r\n\t\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: strError\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction handle_inline_guest_search()\r\n{\r\n\t$(document).on('click', '[data-guestsearch]', function (e) {\r\n\r\n\t\tif ($('#ilgs_container').length)\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar search_button_parameters = $(this).data();\r\n\t\tdelete search_button_parameters['qtip']; // remove unnecessary data from being sent to processor\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 60000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_guestSearch',\r\n\t\t\t\top: 'get_search_form',\r\n\t\t\t\tdata: search_button_parameters\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar dialog_contents = json.search_form;\r\n\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Guest Search',\r\n\t\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\t\tmodal: false,\r\n\t\t\t\t\t\tdiv_id: 'ilgs_container',\r\n\t\t\t\t\t\theight: 300,\r\n\t\t\t\t\t\twidth: 600,\r\n\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\tclose: function () {\r\n\t\t\t\t\t\t\t$('#ilgs_container').remove();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\topen: function (event, ui) {\r\n\t\t\t\t\t\t\t$('#ilgs_search_value').focus();\r\n\r\n\t\t\t\t\t\t\tvar manualSearchTypeChange = false;\r\n\r\n\t\t\t\t\t\t\t$(document).on('change', '#ilgs_search_type', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tmanualSearchTypeChange = true;\r\n\r\n\t\t\t\t\t\t\t\t$('#ilgs_search_value').unmask();\r\n\r\n\t\t\t\t\t\t\t\tif ($('#ilgs_search_type') == 'phone')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_value').mask('999-999-9999');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('.telephone');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$(document).on('keyup', '#ilgs_search_value', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tif (e.which == 13)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_go').trigger('click');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// user manually changed search type, don't automatically change it\r\n\t\t\t\t\t\t\t\tif (manualSearchTypeChange == true)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar value = $('#ilgs_search_value').val();\r\n\t\t\t\t\t\t\t\t// not numeric entry, start with last name\r\n\t\t\t\t\t\t\t\tif (!$.isNumeric(value))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('lastname');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// numeric entry, probably guest id\r\n\t\t\t\t\t\t\t\tif ($.isNumeric(value))\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('id');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// has @ symbol, probably email\r\n\t\t\t\t\t\t\t\tif (value.indexOf(\"@\") != -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('email');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// has space, probably first and last name\r\n\t\t\t\t\t\t\t\tif (value.indexOf(\" \") != -1)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('#ilgs_search_type').val('firstlast');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$(document).on('click', '#ilgs_search_go', function (e) {\r\n\r\n\t\t\t\t\t\t\t\tvar searchtype = $('#ilgs_search_type').val();\r\n\t\t\t\t\t\t\t\tvar searchvalue = $('#ilgs_search_value').val();\r\n\t\t\t\t\t\t\t\tvar store_filter = $('#ilgs_search_all').prop(\"checked\") ? 1 : 0;\r\n\t\t\t\t\t\t\t\tvar currentStore = $('#currentStore').val();\r\n\r\n\t\t\t\t\t\t\t\t$('#ilgs_results').slideUp();\r\n\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php?processor=admin_guestSearch',\r\n\t\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\tsearch_type: searchtype,\r\n\t\t\t\t\t\t\t\t\t\tq: searchvalue,\r\n\t\t\t\t\t\t\t\t\t\tresults_type: 'inline_search',\r\n\t\t\t\t\t\t\t\t\t\tstore: (currentStore ? currentStore : 'none'),\r\n\t\t\t\t\t\t\t\t\t\tfilter: store_filter,\r\n\t\t\t\t\t\t\t\t\t\tselect_button_title: search_button_parameters.select_button_title\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$('#ilgs_results').html(json.data).slideDown();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$(document).on('click', '[data-ilgs_result]', function (e) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (typeof window[search_button_parameters.select_function] === 'function')\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// this will merge in all data- from the data-guestsearch button for use when the data-select_function function is called\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$.extend(this.dataset, search_button_parameters);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// call data-select_function and pass 'this' as variable\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow[search_button_parameters.select_function](this);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// remove the search container\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('#ilgs_container').remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\telse if (typeof search_button_parameters.select_function !== undefined && search_button_parameters.select_function !== false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdd_console_log(search_button_parameters.select_function + '() specified in data-select_function, but not defined in javascript.');\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// if there is no data-select_function then the button navigates to user_details\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=admin_user_details&id=' + $(this).data('user_id'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\t\t\tmessage: strError\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\thandle_dashboard_update();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction menu_bar_init()\r\n{\r\n\tif ($.fn.make_dropdown)\r\n\t{\r\n\t\t$('#menubar > li').make_dropdown({'timeout': 250});\r\n\t}\r\n}\r\n\r\nfunction fadmin_idle_timeout()\r\n{\r\n\tif (!USER_LOGGEDIN || !$.cookie('DreamSite_TO'))\r\n\t{\r\n\t\treturn;\r\n\t}\r\n\r\n\tTO = $.cookie('DreamSite_TO');\r\n\r\n\tfadmin_is_idle(true);\r\n\r\n\t$(document).idle(\r\n\t\tfunction () {\r\n\r\n\t\t\t// When idle\r\n\t\t\tif (!is_idle)\r\n\t\t\t{\r\n\t\t\t\tfadmin_is_idle(true);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tfunction () {\r\n\r\n\t\t\t// When active again\r\n\t\t\tif (is_idle)\r\n\t\t\t{\r\n\t\t\t\tfadmin_is_idle(false);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t{\r\n\t\t\tafter: 2000\r\n\t\t}\r\n\t);\r\n}\r\n\r\nfunction fadmin_is_idle(idle)\r\n{\r\n\tis_idle = idle;\r\n\tajax_login_in_view = false;\r\n\twarning_time = 120000; // 2 minute warning\r\n\r\n\tvar date = new Date();\r\n\tvar sdate = new Date();\r\n\r\n\tvar minutes = TO;\r\n\tif (!idle)\r\n\t{\r\n\t\tminutes = 60;\r\n\t}\r\n\tvar milliseconds = minutes * 60 * 1000;\r\n\r\n\tdate.setTime(date.getTime() + (milliseconds));\r\n\tsdate.setTime(date.getTime() + (milliseconds) + 1000);\r\n\t// Note: add 1 second so that idle period expiration handler has a chance to grab the session id\r\n\r\n\tif (!idle)\r\n\t{\r\n\t\tdd_console_log('Not Idle ' + milliseconds);\r\n\r\n\t\t// cancel future alert popup\r\n\t\t$.doTimeout('alert_timeout_timer');\r\n\r\n\t\t// cancel future warning toast\r\n\t\t$.doTimeout('toast_timeout_warning');\r\n\r\n\t\t// close existing warning toast\r\n\t\tif (dd_toast_id_close('toast_timeout_warning'))\r\n\t\t{\r\n\t\t\tdd_toast({message: 'Activity has canceled the logout.'});\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tdd_console_log('Idle ' + milliseconds);\r\n\r\n\t\tif (USER_LOGGEDIN && !ajax_login_in_view)\r\n\t\t{\r\n\t\t\t// start time until alert popup\r\n\t\t\t// default warning in warning_time, half timeout if timeout less than warning_time (for testing)\r\n\t\t\twarning_milliseconds = milliseconds / 2;\r\n\r\n\t\t\tif (milliseconds > warning_time)\r\n\t\t\t{\r\n\t\t\t\twarning_milliseconds = milliseconds - warning_time;\r\n\t\t\t}\r\n\r\n\t\t\t$.doTimeout('toast_timeout_warning', warning_milliseconds, function () {\r\n\t\t\t\tdd_toast({\r\n\t\t\t\t\tmessage: 'You will soon be logged out due to inactivity. Activity will cancel the logout.',\r\n\t\t\t\t\tdelay: false,\r\n\t\t\t\t\ttoast_id: 'toast_timeout_warning',\r\n\t\t\t\t\tsound: false\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t// start time until alert popup\r\n\t\t\t$.doTimeout('alert_timeout_timer', milliseconds, function () {\r\n\t\t\t\tdo_alert_timeout();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tif (USER_LOGGEDIN)\r\n\t{\r\n\t\t$.cookie('DreamSite_Timer', true, {\r\n\t\t\texpires: date,\r\n\t\t\tdomain: COOKIE.domain,\r\n\t\t\tsecure: true\r\n\t\t});\r\n\t\t$.cookie(COOKIE.dd_sc_name, $.cookie(COOKIE.dd_sc_name), {\r\n\t\t\texpires: sdate,\r\n\t\t\tdomain: COOKIE.domain,\r\n\t\t\tsecure: true\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction do_alert_timeout()\r\n{\r\n\tif ($.cookie('DreamSite_Timer')) // cookie still exists from another tab activity, check again in 3 seconds\r\n\t{\r\n\t\t$.doTimeout('alert_timeout_timer', 3000, function () {\r\n\t\t\tdo_alert_timeout();\r\n\t\t});\r\n\t}\r\n\telse // cookie expired, so do popup\r\n\t{\r\n\t\talert_timeout();\r\n\t}\r\n}\r\n\r\nfunction dd_toast(settings)\r\n{\r\n\t// delay: false; will prevent fadeout, click to remove toast\r\n\t// message: message;\r\n\t// toast_id: 'unique_id'; assign a toast id to manipulate programmically, typically to close a sticky\r\n\t// position: 'topleft', 'botleft', 'topright', 'botright', 'topcenter', 'center', 'botcenter'\r\n\t// sound: true/false, play sound\r\n\t// xclose: true/false, only X closes instead of clicking anywhere\r\n\r\n\tvar config = {\r\n\t\tdelay: 4000,\r\n\t\tmessage: false,\r\n\t\ttoast_id: false,\r\n\t\tposition: 'topright',\r\n\t\tcss_class: false,\r\n\t\tsound: false,\r\n\t\txclose: false\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (typeof toast_obj === 'undefined')\r\n\t{\r\n\t\ttoast_obj = {};\r\n\t}\r\n\r\n\tvar toast_container_selector = '.dd_toast_container.' + config.position;\r\n\r\n\tif (config.toast_id)\r\n\t{\r\n\t\tdd_toast_id_close(config.toast_id, true);\r\n\t}\r\n\r\n\tif (config.message)\r\n\t{\r\n\t\t// create container if not available\r\n\t\tif (!$(toast_container_selector).length)\r\n\t\t{\r\n\t\t\t$('<div class=\"dd_toast_container ' + config.position + '\"></div>').appendTo('body');\r\n\t\t}\r\n\r\n\t\t// add toast to container, register click to close handler\r\n\t\tif (config.toast_id)\r\n\t\t{\r\n\t\t\ttoast_obj[config.toast_id] = $('<div class=\"dd_toast\"></div>').appendTo(toast_container_selector);\r\n\r\n\t\t\ttoast = toast_obj[config.toast_id];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttoast = $('<div class=\"dd_toast\"></div>').appendTo(toast_container_selector);\r\n\t\t}\r\n\r\n\t\tif (config.css_class)\r\n\t\t{\r\n\t\t\t$(toast).addClass(config.css_class);\r\n\t\t}\r\n\r\n\t\t// add the message\r\n\t\t$(toast).html(config.message);\r\n\r\n\t\t// add close button for sticky\r\n\t\tif (!config.delay || config.xclose == true)\r\n\t\t{\r\n\t\t\t$('<div class=\"dd_toast_close\">x</div>').on('click', function () {\r\n\r\n\t\t\t\t$(toast).stop().fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(toast);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}).css({'cursor': 'pointer'}).prependTo(toast);\r\n\t\t}\r\n\r\n\t\t// close when click anywhere on div\r\n\t\tif (config.xclose == false)\r\n\t\t{\r\n\t\t\t$(toast).on('click', function () {\r\n\r\n\t\t\t\t$(this).stop().fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}).css({'cursor': 'pointer'});\r\n\t\t}\r\n\r\n\t\t// play sound if true\r\n\t\tif (config.sound)\r\n\t\t{\r\n\t\t\t$('<embed src=\"' + PATH.script + '/customer/media/dd_toast_alert.mp3\" hidden=\"true\" autostart=\"true\" loop=\"false\"></embed>').appendTo(toast);\r\n\t\t}\r\n\r\n\t\t// fadein, auto close if delay is not false\r\n\t\t$(toast).fadeIn('fast', function () {\r\n\r\n\t\t\t// fadein animation complete\r\n\t\t\tif (config.delay)\r\n\t\t\t{\r\n\t\t\t\t$(this).delay(config.delay).fadeOut('slow', function () {\r\n\r\n\t\t\t\t\t// fadeout animation complete\r\n\t\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n}\r\n\r\nfunction dd_toast_id_close(toast_id, instant)\r\n{\r\n\tif (typeof toast_obj !== 'undefined' && typeof toast_obj[toast_id] !== 'undefined')\r\n\t{\r\n\t\tif (instant == true)\r\n\t\t{\r\n\t\t\tdd_toast_cleanup($(toast_obj[toast_id]));\r\n\r\n\t\t\tdelete toast_obj[toast_id];\r\n\t\t}\r\n\t\telse // fadeout\r\n\t\t{\r\n\t\t\t$(toast_obj[toast_id]).stop().fadeOut('slow', function () {\r\n\t\t\t\t// fadeout animation complete\r\n\t\t\t\tdd_toast_cleanup(this);\r\n\r\n\t\t\t\tdelete toast_obj[toast_id];\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_toast_exists(toast_id)\r\n{\r\n\tif (typeof toast_obj !== 'undefined' && typeof toast_obj[toast_id] !== 'undefined')\r\n\t{\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_toast_cleanup(elem)\r\n{\r\n\t// cleanup, remove from dom\r\n\t$(elem).remove();\r\n\r\n\t// if all toasts are closed, remove container\r\n\t$('.dd_toast_container').each(function () {\r\n\t\tif ($(this).is(':empty'))\r\n\t\t{\r\n\t\t\t$(this).remove();\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction alert_timeout()\r\n{\r\n\tUSER_LOGGEDIN = false;\r\n\tajax_login_in_view = true;\r\n\r\n\tdd_toast_id_close('toast_timeout_warning');\r\n\t// hide elements that should be hidden on logout\r\n\t$('[data-fadmin_perm]').each(function () {\r\n\t\tif ($(this).is(\":visible\"))\r\n\t\t{\r\n\t\t\t$(this).attr('data-hide_on_logout', true).hide();\r\n\t\t}\r\n\t});\r\n\r\n\t// invalidate DreamSite cookie\r\n\tdate = new Date();\r\n\tdate.setDate(date.getDate() - 1);\r\n\r\n\tvar last_session_id = $.cookie(COOKIE.dd_sc_name);\r\n\r\n\t$.cookie(COOKIE.dd_sc_name, false, {\r\n\t\texpires: date,\r\n\t\tdomain: COOKIE.domain\r\n\t});\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 60000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'login',\r\n\t\t\top: 'get_login_form'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tvar dialog_contents = json.login_form;\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Session has expired due to inactivity',\r\n\t\t\t\t\tmessage: dialog_contents,\r\n\t\t\t\t\theight: 300,\r\n\t\t\t\t\twidth: 300,\r\n\t\t\t\t\tdiv_id: 'to_login_div',\r\n\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\topen: function (event, ui) {\r\n\r\n\t\t\t\t\t\tvar buttons = $(this).dialog(\"option\", \"buttons\");\r\n\r\n\t\t\t\t\t\tvar acceptFunction = buttons.Accept;\r\n\r\n\t\t\t\t\t\t//hide close button.\r\n\t\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\r\n\r\n\t\t\t\t\t\t// focus password field\r\n\t\t\t\t\t\t$('#fadmin_password_login').focus();\r\n\r\n\t\t\t\t\t\t// register keyup on password field, if enter submit form\r\n\t\t\t\t\t\t$('#fadmin_password_login').keyup(function (e) {\r\n\r\n\t\t\t\t\t\t\tif (e.keyCode == $.ui.keyCode.ENTER)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tacceptFunction();\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$('.ui-widget-overlay').css({\r\n\t\t\t\t\t\t\t'background': '#462200 url(\"' + PATH.image_admin + '/fadmin_background.jpg\")',\r\n\t\t\t\t\t\t\t'opacity': '1',\r\n\t\t\t\t\t\t\t'filter': 'none'\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tAccept: function () {\r\n\r\n\t\t\t\t\t\t\tvar login_ui = $(\"#to_login_div\")[0];\r\n\t\t\t\t\t\t\t$(\"#to_login_div\").find('#error_message').html('');\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\tprocessor: 'login',\r\n\t\t\t\t\t\t\t\t\tprimary_email_login: $(\"#to_login_div\").find('#fadmin_primary_email_login').val(),\r\n\t\t\t\t\t\t\t\t\tpassword_login: $(\"#to_login_div\").find('#fadmin_password_login').val(),\r\n\t\t\t\t\t\t\t\t\tnobo: 1,\r\n\t\t\t\t\t\t\t\t\tsubmit_login: 1,\r\n\t\t\t\t\t\t\t\t\tremember_login: 1,\r\n\t\t\t\t\t\t\t\t\tlast_session_id: last_session_id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t\tif (json.processor_message)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t$(\"#to_login_div\").find('#error_message').html(json.processor_message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (json.user_type == 'CUSTOMER')\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tbounce('/');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$(login_ui).remove();\r\n\t\t\t\t\t\t\t\t\t\t\tajax_login_in_view = false;\r\n\t\t\t\t\t\t\t\t\t\t\tUSER_LOGGEDIN = true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$('#fadmin_username').html(json.firstname + ' ' + json.lastname);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$('#fadmin_usertype').html(json.user_type_text);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// find elements that were hidden on logout and show them if user_type permits\r\n\t\t\t\t\t\t\t\t\t\t\t$('[data-fadmin_perm][data-hide_on_logout]').each(function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tperm_array = $(this).data('fadmin_perm').split(',');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (~$.inArray(json.user_type, perm_array))\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(this).removeProp('data-hide_on_logout').show();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$.cookie('DreamSite_Timer', true, {\r\n\t\t\t\t\t\t\t\t\t\t\t\texpires: 1,\r\n\t\t\t\t\t\t\t\t\t\t\t\tdomain: COOKIE.domain,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsecure: true\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tfadmin_is_idle(false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function () {\r\n\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\r\n\t\t\thandle_dashboard_update();\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction displayModalWaitDialog(div_id, message)\r\n{\r\n\tvar processWindowContent = '<span style=\"font-weight:bold;\">' + message + '</span>&nbsp;&nbsp;';\r\n\tprocessWindowContent += '<img src=\"' + PATH.image + '/style/throbber_circle.gif\" class=\"img_valign\" alt=\"Processing\" />';\r\n\r\n\tdd_message({\r\n\t\ttitle: 'Processing',\r\n\t\tmessage: processWindowContent,\r\n\t\tnoOk: true,\r\n\t\tcloseOnEscape: false,\r\n\t\tdialogClass: \"noclose\",\r\n\t\tmodal: true,\r\n\t\twidth: 500,\r\n\t\theight: 90,\r\n\t\tresizable: false,\r\n\t\tdiv_id: div_id\r\n\t});\r\n}\r\n\r\nfunction set_platepoints_progress_bar(new_value, animate)\r\n{\r\n\tif (!animate)\r\n\t{\r\n\t\t$('#pp_progressbar').progressbar({\r\n\t\t\tvalue: new_value,\r\n\t\t\tchange: function () {\r\n\t\t\t\t$('#pp_progresslabel').text(new_value + '%');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$.doTimeout('platepoints_progress', 2, function () {\r\n\r\n\t\t\tvar current_value = $('#pp_progressbar').progressbar('option', 'value');\r\n\r\n\t\t\tif (isNaN(current_value))\r\n\t\t\t{\r\n\t\t\t\tcurrent_value = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (current_value < 50)\r\n\t\t\t{\r\n\t\t\t\t$('#pp_progresslabel').addClass('dark');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('#pp_progresslabel').removeClass('dark');\r\n\t\t\t}\r\n\r\n\t\t\tif (new_value > current_value)\r\n\t\t\t{\r\n\t\t\t\tincrease = true;\r\n\t\t\t\tvalue_count = current_value + 1;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tincrease = false;\r\n\t\t\t\tvalue_count = current_value - 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (increase)\r\n\t\t\t{\r\n\t\t\t\tif (value_count > new_value)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#pp_progressbar').progressbar({\r\n\t\t\t\t\t\tvalue: value_count,\r\n\t\t\t\t\t\tchange: function () {\r\n\t\t\t\t\t\t\t$('#pp_progresslabel').text($('#pp_progressbar').progressbar('value') + '%');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (value_count < new_value)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$('#pp_progressbar').progressbar({\r\n\t\t\t\t\t\tvalue: value_count,\r\n\t\t\t\t\t\tchange: function () {\r\n\t\t\t\t\t\t\t$('#pp_progresslabel').text($('#pp_progressbar').progressbar('value') + '%');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction help_system_init()\r\n{\r\n\t$('[data-help]').each(function () {\r\n\t\t$(this).addClass(\"help_enabled\");\r\n\r\n\t\tvar indexStr = $(this).attr('data-help');\r\n\t\tvar index = indexStr.split(\"-\");\r\n\r\n\t\tvar thisHelpData = ddHelpData;\r\n\t\tfor (var x = 0; x < index.length; x++)\r\n\t\t{\r\n\t\t\tthisHelpData = thisHelpData[index[x]];\r\n\t\t}\r\n\r\n\t\t// Load tooltips\r\n\t\tif ($.fn.qtip && typeof thisHelpData != 'undefined')\r\n\t\t{\r\n\t\t\t$(this).qtip({\r\n\t\t\t\tshow: {\r\n\t\t\t\t\tsolo: true\r\n\t\t\t\t},\r\n\t\t\t\tcontent: {\r\n\t\t\t\t\ttext: \"<div class='help_tip_title'>\" + thisHelpData.title + \"</div><div class='help_tip_text'>\" + thisHelpData.help_text + \"</div><div class='help_tip_tech_text'>\" + thisHelpData.tech_text + \"</div>\"\r\n\t\t\t\t},\r\n\t\t\t\tposition: {\r\n\t\t\t\t\tmy: 'bottom left',\r\n\t\t\t\t\tat: 'top left',\r\n\t\t\t\t\tviewport: $(window),\r\n\t\t\t\t\tadjust: {\r\n\t\t\t\t\t\tmethod: 'flip',\r\n\t\t\t\t\t\ty: parseInt(0, 10) || 0,\r\n\t\t\t\t\t\tx: parseInt(10, 10) || 0\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tstyle: {\r\n\t\t\t\t\tclasses: 'ui-tooltip-dreamdinners_tt ui-tooltip-shadow'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t/*\r\n\t $('[data-help]').on('click', function () {\r\n\r\n\t var indexStr = $(this).attr('data-help');\r\n\t var index = indexStr.split(\"-\");\r\n\r\n\t var thisHelpData = ddHelpData;\r\n\t for (var x = 0; x < index.length; x++)\r\n\t {\r\n\t thisHelpData = thisHelpData[index[x]];\r\n\t }\r\n\r\n\r\n\t dd_message({\r\n\t title: 'Help',\r\n\t message: thisHelpData,\r\n\t modal: false\r\n\t });\r\n\r\n\t });\r\n\t */\r\n}\r\n\r\n//Legacy function, needs replacement\r\nfunction NewWindowScroll(mypage, myname, w, h)\r\n{\r\n\tvar LeftPosition = (screen.width) ? Math.floor((screen.width - w) / 2) : 0;\r\n\tvar TopPosition = (screen.height) ? Math.floor((screen.height - h) / 2) : 0;\r\n\tvar settings = 'height=' + h + ',width=' + w + ',top=' + TopPosition + ',left=' + LeftPosition + ',status=no,toolbar=no,scrollbars=1,resizable=1';\r\n\twindow.open(mypage, myname, settings);\r\n}\r\n\r\n$(function () {\r\n\r\n\t$(document).on('click', '#menu-toggle', function (e) {\r\n\t\te.preventDefault();\r\n\t\t$(\"#wrapper\").toggleClass(\"toggled\");\r\n\t});\r\n\r\n\t// prevent mouse wheel from changing number fields\r\n\t$(document).on('focus', 'input[type=number]', function (e) {\r\n\t\t$(this).on('wheel.disableScroll', function (e) {\r\n\t\t\te.preventDefault()\r\n\t\t})\r\n\t});\r\n\t$(document).on('blur', 'input[type=number]', function (e) {\r\n\t\t$(this).off('wheel.disableScroll')\r\n\t});\r\n\r\n\t$(document).on('click', '[data-confirm-nav]', function (e) {\r\n\t\te.preventDefault();\r\n\t\tvar href = this.href;\r\n\t\tvar message = $(this).data('confirm-nav');\r\n\t\tbootbox.confirm({\r\n\t\t\tmessage: message,\r\n\t\t\tcallback: function (result) {\r\n\t\t\t\tif (result)\r\n\t\t\t\t{\r\n\t\t\t\t\twindow.location = href;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '[data-multi_store_select_id], [data-multi_store_select_filter]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t// prevent multiple clicks\r\n\t\tif ($(this).hasClass('disabled'))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// check if they are using the form filters, otherwise they are requesting the form below\r\n\t\tif ($(this).data('multi_store_select_filter'))\r\n\t\t{\r\n\t\t\tswitch ($(this).data('multi_store_select_filter'))\r\n\t\t\t{\r\n\t\t\t\tcase 'all':\r\n\t\t\t\t\t$(\"#multi_store_select_form input[type=checkbox]\").prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'none':\r\n\t\t\t\t\t$(\"#multi_store_select_form input[type=checkbox]\").prop('checked', false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"][data-franchise_id=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'active-non-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"1\"][data-franchise_id!=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"][data-franchise_id=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'inactive-non-corporate':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"FRANCHISE\"][data-active=\"0\"][data-franchise_id!=\"220\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dist-all':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"DISTRIBUTION_CENTER\"]').prop('checked', true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'dist-none':\r\n\t\t\t\t\t$('#multi_store_select_form [data-store_type=\"DISTRIBUTION_CENTER\"]').prop('checked', false);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet multi_store_select_id = $(this).data('multi_store_select_id');\r\n\r\n\t\tlet this_button = $(this);\r\n\r\n\t\t// get currently set ids\r\n\t\tlet store_ids = $('#' + multi_store_select_id).val();\r\n\r\n\t\t$(this_button).addClass('disabled');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\top: 'multi_store_select',\r\n\t\t\t\tstore_id: store_ids\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.confirm({\r\n\t\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\t\tscrollable: true,\r\n\t\t\t\t\t\tcallback: function (result) {\r\n\t\t\t\t\t\t\tif (result)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tlet form = $('#multi_store_select_form');\r\n\t\t\t\t\t\t\t\tlet checked = form.serializeArray();\r\n\r\n\t\t\t\t\t\t\t\tlet store_ids = [];\r\n\t\t\t\t\t\t\t\t$.each(checked, function (index, value) {\r\n\t\t\t\t\t\t\t\t\tstore_ids.push(value.value);\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$('#' + multi_store_select_id).val(store_ids.join());\r\n\r\n\t\t\t\t\t\t\t\t$('#' + multi_store_select_id + '-count').text(checked.length);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$(this_button).removeClass('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tstrError = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '[data-user_id_pp_tooltip]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar user_id = $(this).data('user_id_pp_tooltip');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_fadmin_home',\r\n\t\t\t\top: 'platepoints_tooltip',\r\n\t\t\t\tuser_id: user_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json, status) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.dialog({\r\n\t\t\t\t\t\tmessage: json.tooltip_html,\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\tmanage: {\r\n\t\t\t\t\t\t\t\tlabel: 'Manage',\r\n\t\t\t\t\t\t\t\tclassName: 'btn-success',\r\n\t\t\t\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t\t\t\tbounce('/main.php?page=admin_user_plate_points&id=' + user_id + '&back=' + back_path());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tclose: {\r\n\t\t\t\t\t\t\t\tlabel: 'Close',\r\n\t\t\t\t\t\t\t\tclassName: 'btn-success'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.link-dinner-details', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar menu_id = $(this).data('menu_id');\r\n\t\tvar menu_item_id = $(this).data('menu_item_id');\r\n\t\tvar store_id = $(this).data('store_id');\r\n\t\tvar target = $(this).prop('target');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'menu_item',\r\n\t\t\t\top: 'find_item',\r\n\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\tmenu_item_id: menu_item_id,\r\n\t\t\t\tstore_id: store_id,\r\n\t\t\t\tdetailed: true\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.dialog({\r\n\t\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\t\tsize: 'large',\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\"Full details\": function () {\r\n\t\t\t\t\t\t\t\tbounce('main.php?page=item&recipe=' + json.recipe_id + '&ov_menu=' + json.menu_id, target);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: {\r\n\t\t\t\t\t\t\t\tlabel: \"Close\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.backoffice_change_store:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet backoffice_change_store = {\r\n\t\t\t'back': back_path(),\r\n\t\t\t'dialog': null\r\n\t\t}\r\n\r\n\t\t// create the modal ui with bootbox\r\n\t\tbackoffice_change_store.dialog = bootbox.dialog({\r\n\t\t\tmessage: '<p><i class=\"fa fa-spin fa-spinner\"></i> Loading store selector...</p>',\r\n\t\t\tsize: 'large',\r\n\t\t\tcenterVertical: true,\r\n\t\t\tcloseButton: false,\r\n\t\t\tbuttons: {\r\n\t\t\t\tok: {\r\n\t\t\t\t\tlabel: \"Select store\",\r\n\t\t\t\t\tclassName: 'btn-primary backoffice_change_store-confirm disabled',\r\n\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\tlet store = $('#change_store-selector').val();\r\n\t\t\t\t\t\tlet store_text = $('#change_store-selector option:selected').text();\r\n\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p><i class=\"fa fa-spin fa-spinner\"></i> Loading ' + store_text + '</p>');\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.modal-footer > .backoffice_change_store-confirm').addClass('disabled');\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\t\t\t\t\top: 'store_selector',\r\n\t\t\t\t\t\t\t\tdo: 'selector_select',\r\n\t\t\t\t\t\t\t\tstore: store,\r\n\t\t\t\t\t\t\t\tback: backoffice_change_store.back\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tbounce(decodeURIComponent(backoffice_change_store.back));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\tlabel: \"Cancel\",\r\n\t\t\t\t\tclassName: 'btn-danger',\r\n\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonShow: function (e) {\r\n\t\t\t\t// load the menu items\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\ttimeout: 60000,\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_helpers',\r\n\t\t\t\t\t\top: 'store_selector',\r\n\t\t\t\t\t\tdo: 'selector_get'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html(json.form);\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.modal-footer > .backoffice_change_store-confirm').removeClass('disabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\tbackoffice_change_store.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(backoffice_change_store.dialog).on('change', '#change_store-selector', function (e) {\r\n\t\t\t$('.backoffice_change_store-confirm').trigger('click');\r\n\t\t});\r\n\r\n\t});\r\n\r\n\tif (getQueryVariable('tab'))\r\n\t{\r\n\t\tvar tabid = getQueryVariable('tab');\r\n\r\n\t\t$('#' + tabid + '-tab').tab('show');\r\n\t}\r\n\r\n\t/* Handle Bootstrap Tabbed Content */\r\n\t$('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n\t\te.target; // newly activated tab\r\n\t\te.relatedTarget; // previous active tab\r\n\r\n\t\t// html5 update url history\r\n\t\tif ($(e.target).data('urlpush') !== undefined && $(e.target).data('urlpush') === true)\r\n\t\t{\r\n\t\t\tif ($(e.target).data('target') !== undefined)\r\n\t\t\t{\r\n\t\t\t\tvar target = $(e.target).data('target');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tvar target = $(e.target).attr('href');\r\n\t\t\t}\r\n\r\n\t\t\tvar tabid = $(target).attr('id');\r\n\r\n\t\t\tnew_query_string = setQueryString('tab', tabid);\r\n\t\t\thistoryPush({url: new_query_string});\r\n\t\t}\r\n\t});\r\n\r\n});"],"mappings":"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"}