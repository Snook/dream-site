let icoMoon,bootDialog=[],icoMoonList=[];$((function(){$(document).on("change","#menu_id",(function(e){$("#availability_date_start").val(this.options[this.selectedIndex].dataset.date_start),$("#availability_date_end").val(this.options[this.selectedIndex].dataset.date_end)})),$(document).on("change",".store-select-filter",(function(e){""==this.options[this.selectedIndex].value?$("[data-box_store_id]").showFlex():($("[data-box_store_id]").hideFlex(),$('[data-box_store_id="'+this.options[this.selectedIndex].value+'"]').showFlex())})),$(document).on("click","#BoxFormSubmit",(function(e){e.preventDefault();let t=$("#BoxForm").validateForm(),o=$("#Bundle1Form").validateForm(),n=$("#Bundle2Form").validateForm();t&&o&&n&&("new"==$('#BoxForm input[name="id"]').val()?($(this).prop({disabled:!0}),$("#BoxForm").submit()):($("#BoxForm").submit(),document.getElementById("box_bundle_1_active").checked&&$("#Bundle1Form").submit(),document.getElementById("box_bundle_2_active").checked&&$("#Bundle2Form").submit()))})),$(document).on("click",".box-deploy",(function(e){let t=this.dataset.box_id;bootDialog.deployDialog=bootbox.prompt({title:"Select stores to deploy to",inputType:"checkbox",inputOptions:storeDeployOptions,callback:function(e){if(null==e)bootDialog.deployDialog.modal("hide");else if(e.length){let o=new FormData;o.set("op","deploy_box"),o.set("stores",JSON.stringify(e)),o.set("box_id",t),fetch("/processor?processor=admin_manage_box",{method:"post",body:o}).then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{bounce("/?page=admin_manage_box")})).catch((e=>{console.error("Error:",e)}))}}})})),$(document).on("click",".box-expire",(function(e){let t=this.dataset.box_id;bootbox.confirm("Do you wish to expire this box now?",(function(e){if(1==e){let e=new FormData;e.set("op","expire_box"),e.set("box_id",t),fetch("/processor?processor=admin_manage_box",{method:"post",body:e}).then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{bounce("/?page=admin_manage_box")})).catch((e=>{console.error("Error:",e)}))}}))})),$(document).on("submit","[data-processor]",(function(e){if(e.preventDefault(),!1!==this.checkValidity()){let e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name","_form_name"),e.setAttribute("value",this.name),this.appendChild(e),fetch("/processor?processor="+this.dataset.processor,{method:this.dataset.processor_method.length>0?this.dataset.processor_method:"post",body:new FormData(this)}).then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{"BoxForm"==e.data.form_name&&e.data.bounce&&bounce("/?page=admin_manage_box&edit="+e.data.box_id),$("#BoxForm, #Bundle1Form, #Bundle2Form").removeClass("was-validated")})).catch((e=>{console.error("Error:",e)}))}})),$(document).on("change","#box_bundle_1_active, #box_bundle_2_active",(function(e){let t=new FormData;t.set("op","set_bundle_active_state"),t.set("bundle_id",this.dataset.bundle_id),t.set("box_id",this.dataset.box_id),t.set("box_bundle",this.dataset.box_bundle),t.set("checked",this.checked),fetch("/processor?processor=admin_manage_box",{method:"post",body:t}).then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{let t,o;if("box_bundle_1"==this.dataset.box_bundle?(t="Bundle1Form",o="bundle_1"):"box_bundle_2"==this.dataset.box_bundle&&(t="Bundle2Form",o="bundle_2"),$(this).is(":checked")){$("form#"+t+" :input").not(this).each((function(){$(this).data("has_orders")>0||$(this).prop({disabled:!1})})),$("#"+o+"_menu_items").showFlex(),"new"==this.dataset.bundle_id&&($('[id^="'+o+'_check_"]').attr("data-bundle_id",e.data.bundle_id),$("#box_"+o+"_active").attr("data-bundle_id",e.data.bundle_id),$("#"+t+' input[name="id"]').val(e.data.bundle_id),$("#"+t).submit())}else $("form#"+t+" :input").not(this).each((function(){$(this).prop({disabled:!0})})),$("#"+o+"_menu_items").hideFlex()})).catch((e=>{console.error("Error:",e)}))})),$(document).on("change","[data-bundle_menu_item_id]",(function(e){let t=new FormData;t.set("op","update_bundle_menu_item"),t.set("bundle_id",this.dataset.bundle_id),t.set("bundle_menu_item_id",this.dataset.bundle_menu_item_id),t.set("checked",this.checked),fetch("/processor?processor=admin_manage_box",{method:"post",body:t}).then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{fetchToasts(e)})).catch((e=>{console.error("Error:",e)}))})),$("#css_icon").length&&fetch(PATH.css+"/customer/fonts/selection.json").then((e=>{if(!e.ok)throw new Error("HTTP error "+e.status);return e.json()})).then((e=>{Object.keys(e.icons).forEach((function(t){let o=e.preferences.imagePref.prefix+e.icons[t].properties.name.split(",")[0];icoMoonList.push(o)})),icoMoonList.sort();let t=document.getElementById("css_icon").value;$("#css_icon").html(""),icoMoonList.forEach((function(e){$("#css_icon").append('<option value="'+e+'">'+e+"</option>")})),$("#css_icon").val(t).trigger("change")})).catch((e=>{console.error("Error:",e)})),$(document).on("change","#css_icon",(function(e){let t=$(this).val();$(".css_icon_preview").tooltip("dispose").attr({"data-toggle":"tooltip","data-placement":"top","data-html":"true",title:"<i class='dd-icon font-size-extra-extra-large "+t+"'></i>"}).html('<i class="dd-icon '+t+'"></i>')})),$(document).on("click",".css_icon_preview",(function(e){if(icoMoonList.length>0){let e='<div class="row mx-1">';$.each(icoMoonList,(function(t,o){e+='<a href="#" class="col p-2 m-1 mb-2 text-center text-decoration-hover-none'+($("#css_icon").val()==o?" text-white bg-orange border border-orange-dark":" text-body")+'" data-pick_icon_class="'+o+'" data-toggle="tooltip" data-placement="top" title="'+o+'"><i class="dd-icon '+o+' font-size-extra-large"></i></a>'})),e+="</div>",iconDialog=bootbox.dialog({title:"Select Delivered Box Icon",message:e,size:"large",scrollable:!0,onEscape:!0,closeButton:!0,buttons:{cancel:{label:"Close",className:"btn-primary"}}})}})),$(document).on("click","[data-pick_icon_class]",(function(e){e.preventDefault();let t=$(this).data("pick_icon_class");$("#css_icon").val(t).trigger("change"),iconDialog.modal("hide")}))}));
//# sourceMappingURL=manage_box.min.js.map