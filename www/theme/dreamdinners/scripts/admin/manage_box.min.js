let bootDialog=[],icoMoon,icoMoonList=[];let stores=[{text:"Rochester Hills - Dist. Ctr.",value:"312"}];$(function(){$(document).on("change","#menu_id",function(e){$("#availability_date_start").val(this.options[this.selectedIndex].dataset.date_start);$("#availability_date_start").prop({min:this.options[this.selectedIndex].dataset.date_start});$("#availability_date_end").val(this.options[this.selectedIndex].dataset.date_end)});$(document).on("change",".store-select-filter",function(e){if(this.options[this.selectedIndex].value==""){$("[data-box_store_id]").showFlex()}else{$("[data-box_store_id]").hideFlex();$('[data-box_store_id="'+this.options[this.selectedIndex].value+'"]').showFlex()}});$(document).on("click","#BoxFormSubmit",function(e){e.preventDefault();let t=$("#BoxForm").validateForm();let o=$("#Bundle1Form").validateForm();let n=$("#Bundle2Form").validateForm();if(t&&o&&n){if($('#BoxForm input[name="id"]').val()=="new"){$(this).prop({disabled:true});$("#BoxForm").submit()}else{$("#BoxForm").submit();if(document.getElementById("box_bundle_1_active").checked){$("#Bundle1Form").submit()}if(document.getElementById("box_bundle_2_active").checked){$("#Bundle2Form").submit()}}}});$(document).on("click",".box-deploy",function(e){let o=this.dataset.box_id;bootDialog["deployDialog"]=bootbox.prompt({title:"Select stores to deploy to",inputType:"checkbox",inputOptions:stores,callback:function(t){if(t==null){bootDialog["deployDialog"].modal("hide")}else if(t.length){let e=new FormData;e.set("op","deploy_box");e.set("stores",JSON.stringify(t));e.set("box_id",o);fetch("ddproc.php?processor=admin_manage_box",{method:"post",body:e}).then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(e=>{bounce("main.php?page=admin_manage_box")}).catch(e=>{console.error("Error:",e)})}}})});$(document).on("click",".box-expire",function(e){let t=this.dataset.box_id;bootbox.confirm("Do you wish to expire this box now?",function(e){if(e==true){let e=new FormData;e.set("op","expire_box");e.set("box_id",t);fetch("ddproc.php?processor=admin_manage_box",{method:"post",body:e}).then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(e=>{bounce("main.php?page=admin_manage_box")}).catch(e=>{console.error("Error:",e)})}})});$(document).on("submit","[data-processor]",function(e){e.preventDefault();if(this.checkValidity()!==false){let e=document.createElement("input");e.setAttribute("type","hidden");e.setAttribute("name","_form_name");e.setAttribute("value",this.name);this.appendChild(e);fetch("ddproc.php?processor="+this.dataset.processor,{method:this.dataset.processor_method.length>0?this.dataset.processor_method:"post",body:new FormData(this)}).then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(e=>{if(e.data.form_name=="BoxForm"&&e.data.bounce){bounce("main.php?page=admin_manage_box&edit="+e.data.box_id)}$("#BoxForm, #Bundle1Form, #Bundle2Form").removeClass("was-validated")}).catch(e=>{console.error("Error:",e)})}});$(document).on("change","#box_bundle_1_active, #box_bundle_2_active",function(e){let t=new FormData;t.set("op","set_bundle_active_state");t.set("bundle_id",this.dataset.bundle_id);t.set("box_id",this.dataset.box_id);t.set("box_bundle",this.dataset.box_bundle);t.set("checked",this.checked);fetch("ddproc.php?processor=admin_manage_box",{method:"post",body:t}).then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(t=>{let o,n;if(this.dataset.box_bundle=="box_bundle_1"){o="Bundle1Form";n="bundle_1"}else if(this.dataset.box_bundle=="box_bundle_2"){o="Bundle2Form";n="bundle_2"}if(!$(this).is(":checked")){$("form#"+o+" :input").not(this).each(function(){$(this).prop({disabled:true})});$("#"+n+"_menu_items").hideFlex()}else{$("form#"+o+" :input").not(this).each(function(){if($(this).data("has_orders")>0){return}$(this).prop({disabled:false})});$("#"+n+"_menu_items").showFlex();let e=this.dataset.bundle_id;if(e=="new"){$('[id^="'+n+'_check_"]').attr("data-bundle_id",t.data.bundle_id);$("#box_"+n+"_active").attr("data-bundle_id",t.data.bundle_id);$("#"+o+' input[name="id"]').val(t.data.bundle_id);$("#"+o).submit()}}}).catch(e=>{console.error("Error:",e)})});$(document).on("change","[data-bundle_menu_item_id]",function(e){let t=new FormData;t.set("op","update_bundle_menu_item");t.set("bundle_id",this.dataset.bundle_id);t.set("bundle_menu_item_id",this.dataset.bundle_menu_item_id);t.set("checked",this.checked);fetch("ddproc.php?processor=admin_manage_box",{method:"post",body:t}).then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(e=>{fetchToasts(e)}).catch(e=>{console.error("Error:",e)})});if($("#css_icon").length){fetch(PATH.css+"/customer/fonts/selection.json").then(e=>{if(!e.ok){throw new Error("HTTP error "+e.status)}return e.json()}).then(o=>{Object.keys(o.icons).forEach(function(e){let t=o.preferences.imagePref.prefix+o.icons[e].properties.name.split(",")[0];icoMoonList.push(t)});icoMoonList.sort();let e=document.getElementById("css_icon").value;$("#css_icon").html("");icoMoonList.forEach(function(e){$("#css_icon").append('<option value="'+e+'">'+e+"</option>")});$("#css_icon").val(e).trigger("change")}).catch(e=>{console.error("Error:",e)})}$(document).on("change","#css_icon",function(e){let t=$(this).val();$(".css_icon_preview").tooltip("dispose").attr({"data-toggle":"tooltip","data-placement":"top","data-html":"true",title:"<i class='dd-icon font-size-extra-extra-large "+t+"'></i>"}).html('<i class="dd-icon '+t+'"></i>')});$(document).on("click",".css_icon_preview",function(e){if(icoMoonList.length>0){let o='<div class="row mx-1">';$.each(icoMoonList,function(e,t){o+='<a href="#" class="col p-2 m-1 mb-2 text-center text-decoration-hover-none'+($("#css_icon").val()==t?" text-white bg-orange border border-orange-dark":" text-body")+'" data-pick_icon_class="'+t+'" data-toggle="tooltip" data-placement="top" title="'+t+'"><i class="dd-icon '+t+' font-size-extra-large"></i></a>'});o+="</div>";iconDialog=bootbox.dialog({title:"Select Delivered Box Icon",message:o,size:"large",scrollable:true,onEscape:true,closeButton:true,buttons:{cancel:{label:"Close",className:"btn-primary"}}})}});$(document).on("click","[data-pick_icon_class]",function(e){e.preventDefault();let t=$(this).data("pick_icon_class");$("#css_icon").val(t).trigger("change");iconDialog.modal("hide")})});
//# sourceMappingURL=manage_box.min.js.map