{"version":3,"file":"menu_editor.min.js","names":["numberOfCustomerFacingCTSItems","numberOfCustomerFacingEFLItems","sidesDataArray","gNumOptionalsAdded","notShown","dp_processing","xmlHttp","noOverrideUnderBase","resetPage","document","getElementById","value","submit","getPreviewItemPrice","itemID","ovrPrice","Number","$","val","isNaN","valueOf","text","removeOptionSelected","elSel","i","length","options","selected","remove","removeItem","itemNum","rowID","rowObj","parentNode","removeChild","sidesData","sideName","selObj","Option","calculatePage","displayValidationErrorMsg","msg","dd_message","title","message","clearErrors","style","display","statusTextDiv","innerHTML","storeChange","obj","menuChange","confirm_and_round_form","tab","hasOverridePrice","each","this","trim","modal","confirm","round_markup_to_override","cancel","dirty","index","is","o_input","parent","find","price","parseFloat","o_price","Math","ceil","toFixed","showFlex","selectedDefault","bootbox","alert","showPopup","config","settings","type","height","width","callBack","resizable","extend","ajax","url","module","success","data","status","error","objAJAXRequest","strError","response","getXmlHttpObject","objXMLHttp","XMLHttpRequest","e","ActiveXObject","def_price_save_handleTimeout","printString","def_price_retreive_handleTimeout","SaveDefPricingComplete","readyState","RetrieveDefPricingComplete","responseText","pricingArray","split","RidMap","key","item","totalCurrentlyWebVisible","ctsItemRows","rows","id","indexOf","itemNumber","substr","rid","overrideElemName","overrideElem","showCustomerBox","is_web_visible","checked","hideEverywhereBox","SavePricing","payLoad","currentPrice","menuInfo","mid","previewPrice","basePrice","base_price","show_to_customer","hide_completely","storeInfo","onreadystatechange","open","setRequestHeader","send","setTimeout","RetrievePricing","uniqueEFLEntreeId","is_unsaved","current2ServMarkup","current3ServMarkup","current4ServMarkup","current6ServMarkup","currentSidesMarkup","currentAssemblyFee","currentDeliveryAssemblyFee","currentDefaultStatus","formatAsMoney","markupData","delivery_assembly_fee","assembly_fee","markup_value_2_serving","markup_value_3_serving","markup_value_4_serving","markup_value_6_serving","markup_value_sides","menu_id","is_default","itemRows","getAttribute","ltd_menu_item_value","supports_ltd_roundup","is_chef_touched","sidesCount","overridePrice","orgOverridePrice","markupPrice","html","pricing_type","round","ORdelta","newPriceByMarkUp","isEnabled_Markup","visFlag","orgState","EFL_itemRows","entreeId","includes","push","markdown_change","markdown","markdown_value","original_markdown","markedDownPrice","discount","MUdelta","abs","picFlag","hidFlag","formFlag","hideFlex","confirm_and_check_form","form","validated","_check_form","warnOffOfEmptyMarkups","encounteredBasePriceIssue","problemItemList","menu_item_name","markdownObj","markDownPostObj","el","createElement","setAttribute","idStr","appendChild","finalizeMessage","getMarkUpPrice","servingsSize","addUnsavedEFLItem","item_id","name","size","thisItemCount","countItemsInRecipe","insertCellNum","row","insertRow","cellLeft","insertCell","visBox","cellLeft2","pickBox","cellName","nameNode","createTextNode","cellSize","cellbase","markup_price","cellcurrent","cellmarkup","celloverride","cellmarkdown","buttonTextNode","addUnsavedSideItem","category_label","tbl","cellLeft3","cellpreview","cellremaining","giveTabFocus","Proxy","URLSearchParams","window","location","search","get","searchParams","prop","tabs","substring","click","initNavTab","oldUrl","attr","newUrl","params","on","ready","menu_item_id","checkedState","is_store_special","uiTableFilter","change","Modernizr","input","placeholder","focus","blur","tempArr","markdownVal","div_id","noOk","start_price","newDiscount","targetPrice","newPercentage","buttons","Accept","Cancel","new_button","replaceWith","displayModalWaitDialog","closeOnEscape","event","ui","hide","Okay","entreeList","thisEntree","timeout","dataType","processor","store_id","STORE_DETAILS","op","entree_ids","json","processor_success","entree_id","results","count","items","handledCount","processor_message","close","bounce","hasClass","addClass","recipe_id","tr","clone","show","append","removeClass","handle_tabbed_content","errorMissingCategory","categoryLabel","css","console","log","subcategory_label","documentElement","body","animate","scrollTop","offset","top","oldCategory"],"sourceRoot":"js/src/dreamdinners/admin","sources":["menu_editor.js"],"sourcesContent":["let numberOfCustomerFacingCTSItems = 0;\nlet numberOfCustomerFacingEFLItems = 0;\nlet sidesDataArray = [];\nlet gNumOptionalsAdded = 0;\nlet notShown = true;\nlet dp_processing = false;\nlet xmlHttp = null;\nlet noOverrideUnderBase = false;\n\nfunction resetPage()\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction getPreviewItemPrice(itemID)\n{\n\t// does not exist so return the current price\n\tlet ovrPrice = Number($(\"#ovr_\" + itemID).val());\n\n\tif (isNaN(ovrPrice) || ovrPrice.valueOf() == 0)\n\t{\n\t\t// does not exist so return the markup price\n\t\treturn Number($(\"#row_\" + itemID + \" > .preview-price\").text());\n\t}\n\n\treturn ovrPrice;\n}\n\nfunction removeOptionSelected()\n{\n\tlet elSel = document.getElementById('sides');\n\tfor (let i = elSel.length - 1; i >= 1; i--)\n\t{\n\t\tif (elSel.options[i].selected)\n\t\t{\n\t\t\telSel.remove(i);\n\t\t}\n\t}\n}\n\nfunction removeItem(itemNum)\n{\n\tgNumOptionalsAdded--;\n\tlet rowID = \"row_\" + itemNum;\n\tlet rowObj = document.getElementById(rowID);\n\trowObj.parentNode.removeChild(rowObj);\n\n\tlet sidesData = sidesDataArray[itemNum];\n\tlet sideName = \"(\" + sidesData['SUPC_number'] + \") \" + sidesData['name'];\n\n\tlet selObj = document.getElementById('sides');\n\n\tselObj.options[selObj.length] = new Option(sideName, itemNum);\n\n\tcalculatePage();\n}\n\nfunction displayValidationErrorMsg(msg)\n{\n\tmsg = \"<span style='color:red; font-size:larger;'>\" + msg + \"</span>\";\n\n\tdd_message({\n\t\ttitle: 'Error',\n\t\tmessage: msg\n\t});\n}\n\nfunction clearErrors()\n{\n\tlet statusDiv = document.getElementById('errorMsg');\n\tstatusDiv.style.display = 'none';\n\tlet statusTextDiv = document.getElementById('errorMsgText');\n\tif(typeof statusTextDiv !== 'undefined' && statusTextDiv != null)\n\t{\n\t\tstatusTextDiv.innerHTML = \"\";\n\t}\n\n}\n\nfunction storeChange(obj)\n{\n\tdocument.getElementById('action').value = \"storeChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction menuChange(obj)\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction confirm_and_round_form(tab)\n{\n\tconst finalizeMessage = \"Are you sure want to update all Override Prices with rounded Markup Prices? \" +\n\t\t\"This action will replace existing override prices with the newly calculated price.\";\n\tlet hasOverridePrice = false;\n\t$('.' + tab + '-override-price-input').each(function () {\n\t\t\thasOverridePrice = $(this).val().trim() !== '';\n\t\t}\n\t);\n\n\tif (hasOverridePrice)\n\t{\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tround_markup_to_override(tab);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n\telse\n\t{\n\t\tround_markup_to_override(tab);\n\t}\n\n\treturn false;\n}\n\nfunction round_markup_to_override(tab)\n{\n\tlet dirty = false;\n\t$('.markup-price').each(function (index) {\n\t\tif ($(this).is('[readonly]'))\n\t\t{\n\t\t\t//nothing;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet o_input = $(this).parent().find('.' + tab + '-override-price-input');\n\t\t\tif (o_input.length)\n\t\t\t{\n\t\t\t\tlet price = parseFloat($(this).text());\n\t\t\t\tlet o_price = Math.ceil(price * 2) / 2;\n\t\t\t\to_input.val(o_price.toFixed(2));\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (dirty)\n\t{\n\t\tcalculatePage();\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\n}\n\nfunction selectedDefault()\n{\n\tif (notShown)\n\t{\n\t\tbootbox.alert(\"Any Menus that do not currently have their own specific settings finalized will inherit these default settings.\");\n\t\tnotShown = false;\n\t}\n\n\tcalculatePage();\n}\n\nfunction showPopup(config)\n{\n\tvar settings = { //defaults\n\t\ttype: 'GET',\n\t\theight: 500,\n\t\twidth: 600,\n\t\tmodal: false,\n\t\tcallBack: false,\n\t\tresizable: true\n\t};\n\n\t$.extend(settings, config);\n\n\t$.ajax({\n\t\turl: '?' + settings.module,\n\t\ttype: settings.type,\n\t\tsuccess: function (data, status) {\n\t\t\tsettings.message = data;\n\n\t\t\tdd_message(settings);\n\n\t\t\tif (typeof settings.callBack == 'function')\n\t\t\t{\n\t\t\t\tsettings.callBack();\n\t\t\t}\n\t\t},\n\t\terror: function (objAJAXRequest, strError) {\n\t\t\tresponse = 'Unexpected error';\n\t\t}\n\t});\n}\n\nfunction getXmlHttpObject()\n{\n\tlet objXMLHttp = null;\n\n\ttry\n\t{\n\t\t// Opera 8.0+, Firefox, Safari\n\t\tobjXMLHttp = new XMLHttpRequest();\n\t}\n\tcatch (e)\n\t{\n\t\t// Internet Explorer Browsers\n\t\ttry\n\t\t{\n\t\t\tobjXMLHttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tobjXMLHttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\t// Something went wrong\n\t\t\t}\n\t\t}\n\t}\n\n\treturn objXMLHttp;\n}\n\nfunction def_price_save_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction def_price_retreive_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction SaveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\tlet printString = \"Sides &amp; Sweets default pricing has been saved\";\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t}\n}\n\nfunction RetrieveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tif (xmlHttp.responseText && xmlHttp.responseText != \"error\" && xmlHttp.responseText != \"\")\n\t\t{\n\t\t\tlet pricingArray = xmlHttp.responseText.split(\"|\");\n\t\t\tlet RidMap = [];\n\t\t\tfor (let key in pricingArray)\n\t\t\t{\n\t\t\t\tvar item = pricingArray[key].split(\"~\");\n\t\t\t\tif (item[0])\n\t\t\t\t{\n\t\t\t\t\tRidMap[item[0]] = [\n\t\t\t\t\t\titem[1],\n\t\t\t\t\t\titem[2],\n\t\t\t\t\t\titem[3]\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcalculatePage();\n\n\t\t\tlet totalCurrentlyWebVisible = numberOfCustomerFacingCTSItems;\n\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tif (RidMap[rid])\n\t\t\t\t{\n\t\t\t\t\tlet overrideElemName = 'ovr_' + itemNumber;\n\t\t\t\t\tlet overrideElem = document.getElementById(overrideElemName);\n\t\t\t\t\tif (overrideElem)\n\t\t\t\t\t{\n\t\t\t\t\t\toverrideElem.value = RidMap[rid][2];\n\t\t\t\t\t}\n\n\t\t\t\t\tlet showCustomerBox = document.getElementById('vis_' + itemNumber);\n\n\t\t\t\t\tlet is_web_visible = showCustomerBox.checked;\n\n\t\t\t\t\tif (showCustomerBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][0] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!is_web_visible && totalCurrentlyWebVisible < 20)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = true;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (is_web_visible)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = false;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet hideEverywhereBox = document.getElementById('hid_' + itemNumber);\n\t\t\t\t\tif (hideEverywhereBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][1] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcalculatePage();\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tlet printString = \"There was an error when retrieving the default prices. Please try again.\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\t}\n\t}\n}\n\nfunction SavePricing()\n{\n\tdd_message({\n\t\ttitle: 'Save Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to save the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\t\t\tlet payLoad = \"data=\";\n\t\t\t// Chef Touched Selections\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\t\t\t\tlet previewPrice = Number($(\"#row_\" + itemNumber + \" > .preview-price\").text());\n\t\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\t\tif (previewPrice != \"\" && previewPrice != 0 && !isNaN(previewPrice))\n\t\t\t\t{\n\t\t\t\t\tcurrentPrice = previewPrice;\n\t\t\t\t}\n\n\t\t\t\tif (currentPrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").style.display = \"block\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"Override price must be greater than the price.\";\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet show_to_customer = \"0\";\n\n\t\t\t\tif (document.getElementById('vis_' + itemNumber) && document.getElementById('vis_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\tshow_to_customer = \"1\";\n\t\t\t\t}\n\n\t\t\t\tlet hide_completely = \"0\";\n\t\t\t\tif (document.getElementById('hid_' + itemNumber) && document.getElementById('hid_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\thide_completely = \"1\";\n\t\t\t\t}\n\n\t\t\t\tpayLoad += rid + \"~\" + show_to_customer + \"~\" + hide_completely + \"~\" + currentPrice + \"|\";\n\t\t\t}\n\n\t\t\txmlHttp = getXmlHttpObject();\n\t\t\tif (xmlHttp == null)\n\t\t\t{\n\t\t\t\t// temporary\n\t\t\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tlet url = \"/processor?processor=admin_defaultPricingProcessor&action=save&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = SaveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"POST\", url, true);\n\t\t\txmlHttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t\t\txmlHttp.setRequestHeader(\"Content-length\", payLoad.length);\n\t\t\txmlHttp.setRequestHeader(\"Connection\", \"close\");\n\t\t\txmlHttp.send(payLoad);\n\n\t\t\tsetTimeout(\"def_price_save_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction RetrievePricing()\n{\n\tif (dp_processing)\n\t{\n\t\treturn;\n\t}\n\n\txmlHttp = getXmlHttpObject();\n\tif (xmlHttp == null)\n\t{\n\t\t// temporary\n\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\treturn;\n\t}\n\n\tdd_message({\n\t\ttitle: 'Retrieve Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to retrieve the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=retrieve&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = RetrieveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"GET\", url, true);\n\t\t\txmlHttp.send(null);\n\n\t\t\tsetTimeout(\"def_price_retreive_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction calculatePage()\n{\n\tnumberOfCustomerFacingCTSItems = 0;\n\tnumberOfCustomerFacingEFLItems = 0;\n\n\tlet uniqueEFLEntreeId = [];\n\tlet is_unsaved = false;\n\n\tlet sidesCount = 0;\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet currentAssemblyFee = ((!$('#assembly_fee').val()) ? null : $('#assembly_fee').val());\n\tlet currentDeliveryAssemblyFee = ((!$('#delivery_assembly_fee').val()) ? null : $('#delivery_assembly_fee').val());\n\n\tlet currentDefaultStatus = document.getElementById('is_default_markupno').checked ? 0 : 1;\n\n\tif ($('#delivery_assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.delivery_assembly_fee) != formatAsMoney(currentDeliveryAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 1\");\n\t\t}\n\t}\n\n\tif ($('#assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.assembly_fee) != formatAsMoney(currentAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 2\");\n\t\t}\n\t}\n\n\tif ($('#markup_2_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_2_serving) != formatAsMoney(current2ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 3\");\n\t\t}\n\t}\n\n\tif ($('#markup_3_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_3_serving) != formatAsMoney(current3ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 4\");\n\t\t}\n\t}\n\n\tif ($('#markup_4_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_4_serving) != formatAsMoney(current4ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 5\");\n\t\t}\n\t}\n\n\tif ($('#markup_6_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_6_serving) != formatAsMoney(current6ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 6\");\n\t\t}\n\t}\n\n\tif ($('#markup_sides').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_sides) != formatAsMoney(currentSidesMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 7\");\n\t\t}\n\t}\n\n\tif (menuInfo.menu_id != '100')\n\t{\n\t\tif (markupData.is_default != currentDefaultStatus)\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 8\");\n\t\t}\n\t}\n\n\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\tfor (let i = 0; i < itemRows.length; i++)\n\t{\n\t\tif (itemRows[i].id.indexOf('row_') == -1 && itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\n\t\tif (itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tlet ltd_menu_item_value = 0;\n\t\tif (storeInfo.supports_ltd_roundup == 1)\n\t\t{\n\t\t\tltd_menu_item_value = Number(formatAsMoney(menuInfo.mid[itemNumber].ltd_menu_item_value));\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tif (overridePrice > 0 && ltd_menu_item_value > 0)\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney((overridePrice * 1) + (ltd_menu_item_value * 1)));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (isEnabled_Markup && newPriceByMarkUp > 0 && overridePrice == 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 9\");\n\t\t}\n\t\telse if (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 10\");\n\t\t}\n\t\telse if (isEnabled_Markup && overridePrice > 0 && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 11\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\torgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 12\");\n\t\t\t}\n\t\t}\n\t}\n\n\t// EFL Items\n\n\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t{\n\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1 && EFL_itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\tif (EFL_itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (!$('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tlet entreeId = $('#vis_' + itemNumber).data('entree_id');\n\n\t\t\tif (!uniqueEFLEntreeId.includes(entreeId))\n\t\t\t{\n\t\t\t\tnumberOfCustomerFacingEFLItems++;\n\t\t\t\tuniqueEFLEntreeId.push(entreeId);\n\t\t\t}\n\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tif (itemNumber == 13944)\n\t\t{\n\t\t\tlet x = 1;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse // servingSize == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\n\t\tlet markdown_change = false;\n\t\t// At this point we know the new price... apply the markdown if it exists\n\t\tif (isEnabled_Markup && $('#mkdn_' + itemNumber)[0])\n\t\t{\n\t\t\tlet markdown = $('#mkdn_' + itemNumber);\n\t\t\tlet markdown_value = formatAsMoney(markdown.data('markdown_value'));\n\t\t\tlet original_markdown = markdown.data('org_val');\n\t\t\tlet markedDownPrice = 0;\n\t\t\tif (overridePrice > 0)\n\t\t\t{\n\t\t\t\toverridePrice -= formatAsMoney(overridePrice * (markdown_value / 100));\n\t\t\t\tmarkedDownPrice = overridePrice;\n\t\t\t}\n\t\t\telse if (markupPrice > 0)\n\t\t\t{\n\t\t\t\tlet discount = Number(formatAsMoney(markupPrice * (markdown_value / 100)));\n\t\t\t\tmarkupPrice = formatAsMoney((markupPrice * 100) / 100);\n\t\t\t\tmarkupPrice = Math.round((markupPrice - discount.valueOf()) * 100) / 100;\n\t\t\t\tmarkedDownPrice = markupPrice;\n\t\t\t}\n\n\t\t\tif (original_markdown != markdown_value)\n\t\t\t{\n\t\t\t\tmarkdown_change = true;\n\t\t\t}\n\n\t\t}\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tif (Math.abs(ORdelta) < .005)\n\t\t{\n\t\t\tORdelta = 0;\n\t\t}\n\t\tif (Math.abs(MUdelta) < .005)\n\t\t{\n\t\t\tMUdelta = 0;\n\t\t}\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 13\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 14\");\n\t\t}\n\t\telse if (markdown_change)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markedDownPrice));\n\t\t\tis_unsaved = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 15\");\n\t\t\t}\n\t\t}\n\n\t\tlet picFlag = document.getElementById(\"pic_\" + itemNumber);\n\t\tif (picFlag)\n\t\t{\n\t\t\tlet orgState = picFlag.getAttribute('data-orgval');\n\t\t\tif ((picFlag.checked && orgState != 'CHECKED') || (!picFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 16\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\t// Chef Touched Selections\n\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t{\n\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\tif ($('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tnumberOfCustomerFacingCTSItems++;\n\t\t}\n\n\t\tif (currentSidesMarkup == 0 || currentSidesMarkup == null || currentSidesMarkup == \"\")\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\t\t\tmarkupPrice = basePrice;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * currentSidesMarkup) + 0.00000001) / 100));\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 17\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 18\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 19\");\n\t\t\t}\n\t\t}\n\n\t\tlet hidFlag = document.getElementById(\"hid_\" + itemNumber);\n\t\tif (hidFlag)\n\t\t{\n\t\t\tlet orgState = hidFlag.getAttribute('data-orgval');\n\t\t\tif ((hidFlag.checked && orgState != 'CHECKED') || (!hidFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 20\");\n\t\t\t}\n\t\t}\n\n\t\tlet formFlag = document.getElementById(\"form_\" + itemNumber);\n\t\tif (formFlag)\n\t\t{\n\t\t\tlet orgState = formFlag.getAttribute('data-orgval');\n\t\t\tif ((formFlag.checked && orgState != 'CHECKED') || (!formFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 21\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\tif (gNumOptionalsAdded != 0)\n\t{\n\t\tis_unsaved = true;\n\t\t//dd_console_log(\"Unsaved 22\");\n\t}\n\n\tif (is_unsaved)\n\t{\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\telse\n\t{\n\t\t$('#saved_message, #saved_message_2').hideFlex();\n\t}\n}\n\nfunction confirm_and_check_form()\n{\n\tlet form = $(\"#menu_editor_form\")[0];\n\n\tclearErrors();\n\n\tlet validated = _check_form(form);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet warnOffOfEmptyMarkups = false;\n\n\tlet currentVolumeReward = \"0\";\n\n\tlet message = \"\";\n\n\tif (validated)\n\t{\n\t\tif (current2ServMarkup < 0 || current4ServMarkup < 0 || current3ServMarkup < 0 || current6ServMarkup < 0 || currentSidesMarkup < 0)\n\t\t{\n\t\t\tmessage = \"Negative per cent markups are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (current2ServMarkup > 70 || current4ServMarkup > 70 || current3ServMarkup > 70 || current6ServMarkup > 70 || currentSidesMarkup > 70)\n\t\t{\n\t\t\tmessage += \"Markups greater than 70% are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward < 0)\n\t\t{\n\t\t\tmessage += \"Negative volume discounts are not permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward > 75)\n\t\t{\n\t\t\tmessage += \"Volume Dscounts greater than $75.00 are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward == \"\")\n\t\t{\n\t\t\tmessage += \"Please supply a valid volume discount. Use zero if you want no volume discount applied.<br />\";\n\t\t}\n\n\t\tif (($('#markup_2_serving').length != 0 && current2ServMarkup == null) || ($('#markup_4_serving').length != 0 && current4ServMarkup == null) || ($('#markup_3_serving').length != 0 && current3ServMarkup == null) || ($('#markup_6_serving').length != 0 && current6ServMarkup == null) || ($('#markup_sides').length != 0 && currentSidesMarkup == null))\n\t\t{\n\t\t\twarnOffOfEmptyMarkups = true;\n\t\t}\n\n\t\tlet assembly_fee = ((!$('#assembly_fee').val()) ? 0 : $('#assembly_fee').val());\n\t\tif (assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet delivery_assembly_fee = ((!$('#delivery_assembly_fee').val()) ? 0 : $('#delivery_assembly_fee').val())\n\t\tif (delivery_assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Delivery Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\t\tlet encounteredBasePriceIssue = false;\n\t\tlet problemItemList = \"\";\n\n\t\tfor (let i = 0; i < itemRows.length; i++)\n\t\t{\n\t\t\tif (itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\t\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t\t{\n\t\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = EFL_itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\tlet markdownObj = $(\"#mkdn_\" + itemNumber)[0];\n\t\t\tlet markDownPostObj = $(\"#upd_mkdn_\" + itemNumber)[0];\n\n\t\t\tif (markdownObj)\n\t\t\t{\n\t\t\t\tlet value = $(markdownObj).data(\"markdown_id\") + \"|\" + $(markdownObj).data(\"markdown_value\");\n\n\t\t\t\tif (!markDownPostObj)\n\t\t\t\t{\n\t\t\t\t\tlet el = document.createElement('input');\n\t\t\t\t\tel.setAttribute(\"type\", \"hidden\");\n\t\t\t\t\tel.setAttribute(\"value\", value);\n\t\t\t\t\tlet idStr = \"upd_mkdn_\" + itemNumber;\n\t\t\t\t\tel.setAttribute(\"id\", idStr);\n\t\t\t\t\tel.setAttribute(\"name\", idStr);\n\t\t\t\t\tmarkdownObj.appendChild(el);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmarkDownPostObj.val(value);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t{\n\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = ctsItemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\t\t\t\t}\n\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (encounteredBasePriceIssue)\n\t\t{\n\t\t\tmessage += \"The Override Price must be greater than the base price for:<br />\";\n\t\t\tmessage += problemItemList;\n\n\t\t}\n\n\t\tif (message != \"\")\n\t\t{\n\t\t\tvalidated = false;\n\t\t\tdisplayValidationErrorMsg(message);\n\t\t}\n\t}\n\n\tif (validated)\n\t{\n\t\tlet finalizeMessage = \"Are you sure want to submit these changes to your menu? If the menu is active the changes will be immediately available to your customers.\";\n\n\t\tif (warnOffOfEmptyMarkups)\n\t\t{\n\t\t\tfinalizeMessage += \"<br /><br /><span class='text-red font-weight-bold'>One or more of the Percentage MarkUp values is empty or 0. Please review and correct if this was unintentional.</span><br />\";\n\t\t}\n\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\t\t$(\"#menu_editor_form\").submit();\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\t/*\n\t\tif (confirm(finalizeMessage))\n\t\t{\n\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\t*/\n\t}\n\n\treturn false;\n}\n\nfunction getMarkUpPrice(servingsSize, basePrice)\n{\n\n\tlet markupPrice = Number(basePrice);\n\tbasePrice = Number(basePrice);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\n\t// if current markup then update markup column\n\tif (servingsSize == \"Sm (2)\")\n\t{\n\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current2ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (4)\")\n\t{\n\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current4ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (3)\")\n\t{\n\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current3ServMarkup) / 100));\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current6ServMarkup) / 100));\n\t\t}\n\t}\n\n\treturn markupPrice;\n}\n\nfunction addUnsavedEFLItem(item_id, name, size, base_price, thisItemCount, countItemsInRecipe)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('EFLitemsTbl');\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(0);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(++insertCellNum);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"pic_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(++insertCellNum);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(++insertCellNum);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\n\tvar el = document.createTextNode(size);\n\tcellSize.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// basePrice cell\n\t\tvar cellbase = row.insertCell(++insertCellNum);\n\t\tcellbase.setAttribute(\"class\", \"align-middle\");\n\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t\tcellbase.appendChild(el);\n\n\t\tvar markup_price = getMarkUpPrice(size, base_price);\n\t}\n\n\t// currentPrice cell\n\tvar cellcurrent = row.insertCell(++insertCellNum);\n\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\n\tif (isEnabled_Markup)\n\t{\n\t\tvar el = document.createTextNode(markup_price);\n\t}\n\telse\n\t{\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t}\n\tcellcurrent.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// markupPrice cell\n\t\tvar cellmarkup = row.insertCell(++insertCellNum);\n\t\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\n\t\tvar el = document.createTextNode(markup_price);\n\t\tcellmarkup.appendChild(el);\n\t}\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"any\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", \"\");\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tif (!isEnabled_Markup)\n\t{\n\t\tel.setAttribute(\"value\", formatAsMoney(base_price));\n\t}\n\tcelloverride.appendChild(el);\n\n\t// markdown\n\tvar cellmarkdown = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('button');\n\tvar idStr = \"add-mkdn_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"class\", \"button\");\n\tvar buttonTextNode = document.createTextNode(\"Add\");\n\tel.appendChild(buttonTextNode);\n\n\tcellmarkdown.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(++insertCellNum);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n}\n\nfunction addUnsavedSideItem(item_id, name, size, base_price, category_label)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('ctsItemsTbl');\n\n\tif ($('#temp_category').length == 0)\n\t{\n\t\tvar row = tbl.insertRow(-1);\n\t\trow.setAttribute(\"id\", \"temp_category\");\n\n\t\tvar cellName = row.insertCell(0);\n\t\tcellName.setAttribute(\"class\", \"font-weight-bold py-3\");\n\t\tcellName.setAttribute(\"colspan\", \"11\");\n\t\tvar nameNode = document.createTextNode('Newly Added Items');\n\t\tcellName.appendChild(nameNode);\n\t}\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(insertCellNum++);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"form_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// hide everywhere cell\n\tvar cellLeft3 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"hid_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft3.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(insertCellNum++);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(insertCellNum++);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(size);\n\tcellSize.appendChild(el);\n\n\t// basePrice cell\n\tvar cellbase = row.insertCell(insertCellNum++);\n\tcellbase.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(formatAsMoney(base_price));\n\tcellbase.appendChild(el);\n\n\tvar markup_price = getMarkUpPrice(size, base_price);\n\n\t// currentPrice cell\n\tvar cellcurrent = row.insertCell(insertCellNum++);\n\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(markup_price);\n\tcellcurrent.appendChild(el);\n\n\t// markupPrice cell\n\tvar cellmarkup = row.insertCell(insertCellNum++);\n\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\tvar el = document.createTextNode(markup_price);\n\tcellmarkup.appendChild(el);\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(insertCellNum++);\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"any\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", \"\");\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tcelloverride.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(insertCellNum++);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n\tvar el = document.createTextNode('');\n\tcellpreview.appendChild(el);\n\n\t// remianingInventory cell\n\tvar cellremaining = row.insertCell(insertCellNum++);\n\tcellremaining.setAttribute(\"class\", \"align-middle remaining-price\");\n\tvar el = document.createTextNode('0');\n\tcellremaining.appendChild(el);\n}\n\nfunction giveTabFocus()\n{\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\n\t\tget: (searchParams, prop) => searchParams.get(prop)\n\t});\n\tlet value = params.tabs; // \"some_value\"\n\tif (typeof value != 'undefined' && value != null)\n\t{\n\t\tvalue = value.substring(value.indexOf('menu.') + 5);\n\t\t$(document).find(\"[data-nav='\" + value + \"']\").click();\n\t}\n\n}\n\nfunction initNavTab()\n{\n\n\tvar oldUrl = $('#inv-nav-button').attr(\"href\"); // Get current url\n\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tabs'));\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\n\t\tget: (searchParams, prop) => searchParams.get(prop)\n\t});\n\n\tif (typeof params.tabs != 'undefined' && params.tabs != null)\n\t{\n\t\tnewUrl = newUrl + '&tabs=' + params.tabs;\n\t\t$('#inv-nav-button').attr(\"href\", newUrl);\n\t}\n\n\t$('.nav-tab').each(function () {\n\t\t$(this).on('click', function () {\n\t\t\tvar oldUrl = $('#inv-nav-button').attr(\"href\"); // Get current url\n\t\t\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tabs'));\n\t\t\tnewUrl = newUrl + '&tabs=menu.' + $(this).data('nav');\n\t\t\t$('#inv-nav-button').attr(\"href\", newUrl);\n\t\t});\n\t});\n}\n\n$(function () {\n\n\t$(document).ready(function () {\n\t\tcalculatePage()\n\t\tgiveTabFocus();\n\t\tinitNavTab();\n\t});\n\n\t$(document).on('change keyup', '#markup_6_serving, #markup_4_serving, #markup_3_serving, #markup_2_serving, #markup_sides, #assembly_fee, #delivery_assembly_fee, #volume_reward, [name=\"is_default_markup\"], [id^=pic_], [id^=form_], [id^=ovr_], [id^=vis_], [id^=hid_]', function (e) {\n\t\tcalculatePage();\n\t});\n\n\t$(document).on('change keyup', '[id^=vis_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\tlet checkedState = $(this).is(':checked');\n\n\t\t// Sides & Sweets\n\t\tif (menuInfo.mid[menu_item_id].is_chef_touched == '1')\n\t\t{\n\t\t\tif (checkedState && numberOfCustomerFacingCTSItems > 20)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': false});\n\n\t\t\t\tbootbox.alert('You can only display 20 Sides &amp; Sweets items on the customer facing menu.');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\t\t\t}\n\t\t}\n\t\t// EFL\n\t\telse if (menuInfo.mid[menu_item_id].is_store_special == '1')\n\t\t{\n\t\t\tif (!checkedState && numberOfCustomerFacingEFLItems > 10)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': true});\n\n\t\t\t\tbootbox.alert(\"You can only make 10 Fast Lane items visible at a time. Please hide another store special if you wish to make this item visible.\");\n\t\t\t}\n\t\t}\n\n\t});\n\n\t$(document).on('change keyup', '[id^=form_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('change keyup', '[id^=hid_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#vis_' + menu_item_id).prop({'checked': false});\n\t\t$('#form_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('keyup change', '#filter', function (e) {\n\t\t$.uiTableFilter($('#recipe_list'), this.value);\n\t});\n\n\t$(document).on('click', '#clear_filter', function (e) {\n\n\t\t$('#filter').val('').change();\n\n\t\tif (!Modernizr.input.placeholder)\n\t\t{\n\t\t\t// trick to restore placeholder on IE\n\t\t\t$('#filter').focus().blur();\n\t\t}\n\n\t});\n\n\t// handle markdowns\n\t$(document).on('click', '[id^=mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Edit Markdown',\n\t\t\tdiv_id: \"edit_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\tlet price = start_price;\n\t\t\t\tprice -= (price * (markdownVal / 100));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#edit_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#mkdn_' + itemID).html(formatAsMoney(newPercentage) + \"%\");\n\t\t\t\t\t$('#mkdn_' + itemID).data('markdown_value', newPercentage);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t// handle_add_new_markdown\n\t$(document).on('click', '[id^=add-mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Add Markdown',\n\t\t\tdiv_id: \"new_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(0));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#new_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet new_button = '<button class=\"button\" id=\"mkdn_' + itemID + '\" data-org_val=\"0\" data-markdown_id=\"new\" data-markdown_value=\"' + newDiscount + '\" >' + formatAsMoney(newDiscount) + '%</button>';\n\t\t\t\t\t$('#add-mkdn_' + itemID).replaceWith(new_button);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t$(document).on('click', '#add_past_menu_item:not(.disabled)', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving items. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: true,\n\t\t\ttitle: 'Add EFL Item',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_item&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_item]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\n\t\t\t\t\t});\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\tmessage: 'This will immediately add the listed items to the menu. Are you sure?',\n\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t'Add Items to Menu': function () {\n\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\top: 'add_menu_item',\n\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedEFLItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, handledCount, count);\n\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('/?page=admin_menu_editor&tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('click', '[data-add_menu_item]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_item=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_item=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_item=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n\n\t//////---------Add past Sides & Sweets\n\n\t$(document).on('click', '#add_past_menu_item_sides', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving Sides & Sweets. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: true,\n\t\t\ttitle: 'Add Sides & Sweets',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_sides_sweets&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\tlet errorMissingCategory = false;\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_side]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\t\t\t\t\t\tlet categoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").find(\":selected\").val();\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined'){\n\t\t\t\t\t\t\tcategoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").html();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined')\n\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t$(\"[data-recipe_category=\" + thisEntree + \"]\").css(\"border-color\", \"red\");\n\t\t\t\t\t\t\terrorMissingCategory = true;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tentreeList[thisEntree] = categoryLabel;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (errorMissingCategory)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.log('Missing');\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Please select a category for all items',\n\t\t\t\t\t\t\tmessage: 'Please select a category for all items'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\t\tmessage: 'This will immediately add the listed Sides & Sweets to the menu. Are you sure?',\n\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t'Add Sides & Sweets to Menu': function () {\n\n\t\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\t\top: 'add_menu_side',\n\t\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 0;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedSideItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, items[id].subcategory_label);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t$([\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.documentElement,\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.body\n\t\t\t\t\t\t\t\t\t\t\t\t]).animate({\n\t\t\t\t\t\t\t\t\t\t\t\t\tscrollTop: $(\"#temp_category\").offset().top\n\t\t\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error adding Sides & Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Network Error adding Sides and Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('/?page=admin_menu_editor&tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('change', '[data-recipe_category]', function (e) {\n\t\tlet categoryLabel = $(this).find(\":selected\").val();\n\n\t\tif (typeof categoryLabel == 'undefined')\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"red\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"black\");\n\t\t}\n\t});\n\n\t$(document).on('click', '[data-add_menu_side]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_side=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_side=\" + entree_id + \"]\").remove();\n\n\t\t\ttr.find(\"[data-recipe_category=\" + entree_id + \"]\").show();\n\n\t\t\tlet oldCategory = tr.find(\"[data-old_category=\" + entree_id + \"]\").html();\n\n\t\t\ttr.find(\"[data-old_category=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\n\t\t\t$(\"[data-recipe_category=\" + entree_id + \"]\").val(oldCategory);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_side=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n});"],"mappings":"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"}