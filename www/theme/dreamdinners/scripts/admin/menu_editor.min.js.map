{"version":3,"file":"menu_editor.min.js","names":["numberOfCustomerFacingCTSItems","numberOfCustomerFacingEFLItems","sidesDataArray","gNumOptionalsAdded","notShown","dp_processing","xmlHttp","noOverrideUnderBase","resetPage","document","getElementById","value","submit","getPreviewItemPrice","itemID","ovrPrice","Number","$","val","isNaN","valueOf","text","removeOptionSelected","elSel","i","length","options","selected","remove","removeItem","itemNum","rowID","rowObj","parentNode","removeChild","sidesData","sideName","selObj","Option","calculatePage","displayValidationErrorMsg","msg","dd_message","title","message","clearErrors","style","display","innerHTML","storeChange","obj","menuChange","confirm_and_round_form","tab","hasOverridePrice","each","this","trim","modal","confirm","round_markup_to_override","cancel","dirty","index","is","o_input","parent","find","price","parseFloat","o_price","Math","ceil","toFixed","showFlex","selectedDefault","bootbox","alert","getXmlHttpObject","objXMLHttp","XMLHttpRequest","e","ActiveXObject","def_price_save_handleTimeout","printString","def_price_retreive_handleTimeout","SaveDefPricingComplete","readyState","RetrieveDefPricingComplete","responseText","pricingArray","split","RidMap","key","item","totalCurrentlyWebVisible","ctsItemRows","rows","id","indexOf","itemNumber","substr","rid","overrideElemName","overrideElem","showCustomerBox","is_web_visible","checked","hideEverywhereBox","SavePricing","payLoad","currentPrice","menuInfo","mid","previewPrice","basePrice","base_price","show_to_customer","hide_completely","url","storeInfo","onreadystatechange","open","setRequestHeader","send","setTimeout","RetrievePricing","uniqueEFLEntreeId","is_unsaved","current2ServMarkup","current3ServMarkup","current4ServMarkup","current6ServMarkup","currentSidesMarkup","currentAssemblyFee","currentDeliveryAssemblyFee","currentDefaultStatus","formatAsMoney","markupData","delivery_assembly_fee","assembly_fee","markup_value_2_serving","markup_value_3_serving","markup_value_4_serving","markup_value_6_serving","markup_value_sides","menu_id","is_default","itemRows","getAttribute","ltd_menu_item_value","supports_ltd_roundup","is_chef_touched","sidesCount","overridePrice","orgOverridePrice","markupPrice","html","pricing_type","round","ORdelta","newPriceByMarkUp","isEnabled_Markup","visFlag","orgState","EFL_itemRows","entreeId","data","includes","push","markdown_change","markdown","markdown_value","original_markdown","markedDownPrice","discount","MUdelta","abs","picFlag","hidFlag","formFlag","hideFlex","confirm_and_check_form","form","validated","_check_form","warnOffOfEmptyMarkups","encounteredBasePriceIssue","problemItemList","menu_item_name","markdownObj","markDownPostObj","el","createElement","setAttribute","idStr","appendChild","finalizeMessage","getMarkUpPrice","servingsSize","addUnsavedEFLItem","item_id","name","size","thisItemCount","countItemsInRecipe","insertCellNum","row","insertRow","cellLeft","insertCell","visBox","cellLeft2","pickBox","cellName","nameNode","createTextNode","cellSize","cellbase","markup_price","cellcurrent","cellmarkup","celloverride","cellmarkdown","buttonTextNode","addUnsavedSideItem","category_label","tbl","cellLeft3","cellpreview","cellremaining","giveTabFocus","Proxy","URLSearchParams","window","location","search","get","searchParams","prop","tabs","substring","click","initNavTab","oldUrl","attr","newUrl","params","on","ready","menu_item_id","checkedState","is_store_special","uiTableFilter","change","Modernizr","input","placeholder","focus","blur","tempArr","markdownVal","div_id","height","width","resizable","noOk","start_price","newDiscount","targetPrice","newPercentage","buttons","Accept","Cancel","new_button","replaceWith","displayModalWaitDialog","showPopup","closeOnEscape","module","event","ui","hide","Okay","entreeList","thisEntree","ajax","type","timeout","dataType","processor","store_id","STORE_DETAILS","op","entree_ids","success","json","processor_success","entree_id","results","count","items","handledCount","processor_message","error","objAJAXRequest","strError","response","close","bounce","hasClass","addClass","recipe_id","tr","clone","show","append","removeClass","handle_tabbed_content","errorMissingCategory","categoryLabel","css","console","log","subcategory_label","documentElement","body","animate","scrollTop","offset","top","oldCategory"],"sourceRoot":"js/src/dreamdinners/admin","sources":["menu_editor.js"],"sourcesContent":["let numberOfCustomerFacingCTSItems = 0;\nlet numberOfCustomerFacingEFLItems = 0;\nlet sidesDataArray = [];\nlet gNumOptionalsAdded = 0;\nlet notShown = true;\nlet dp_processing = false;\nlet xmlHttp = null;\nlet noOverrideUnderBase = false;\n\nfunction resetPage()\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction getPreviewItemPrice(itemID)\n{\n\t// does not exist so return the current price\n\tlet ovrPrice = Number($(\"#ovr_\" + itemID).val());\n\n\tif (isNaN(ovrPrice) || ovrPrice.valueOf() == 0)\n\t{\n\t\t// does not exist so return the markup price\n\t\treturn Number($(\"#row_\" + itemID + \" > .preview-price\").text());\n\t}\n\n\treturn ovrPrice;\n}\n\nfunction removeOptionSelected()\n{\n\tlet elSel = document.getElementById('sides');\n\tfor (let i = elSel.length - 1; i >= 1; i--)\n\t{\n\t\tif (elSel.options[i].selected)\n\t\t{\n\t\t\telSel.remove(i);\n\t\t}\n\t}\n}\n\nfunction removeItem(itemNum)\n{\n\tgNumOptionalsAdded--;\n\tlet rowID = \"row_\" + itemNum;\n\tlet rowObj = document.getElementById(rowID);\n\trowObj.parentNode.removeChild(rowObj);\n\n\tlet sidesData = sidesDataArray[itemNum];\n\tlet sideName = \"(\" + sidesData['SUPC_number'] + \") \" + sidesData['name'];\n\n\tlet selObj = document.getElementById('sides');\n\n\tselObj.options[selObj.length] = new Option(sideName, itemNum);\n\n\tcalculatePage();\n}\n\nfunction displayValidationErrorMsg(msg)\n{\n\tmsg = \"<span style='color:red; font-size:larger;'>\" + msg + \"</span>\";\n\n\tdd_message({\n\t\ttitle: 'Error',\n\t\tmessage: msg\n\t});\n}\n\nfunction clearErrors()\n{\n\tlet statusDiv = document.getElementById('errorMsg');\n\tstatusDiv.style.display = 'none';\n\tlet statusTextDiv = document.getElementById('errorMsgText');\n\tstatusTextDiv.innerHTML = \"\";\n}\n\nfunction storeChange(obj)\n{\n\tdocument.getElementById('action').value = \"storeChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction menuChange(obj)\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction confirm_and_round_form(tab)\n{\n\tconst finalizeMessage = \"Are you sure want to update all Override Prices with rounded Markup Prices? \" +\n\t\t\"This action will replace existing override prices with the newly calculated price.\";\n\tlet hasOverridePrice = false;\n\t$('.' + tab + '-override-price-input').each(function () {\n\t\t\thasOverridePrice = $(this).val().trim() !== '';\n\t\t}\n\t);\n\n\tif (hasOverridePrice)\n\t{\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tround_markup_to_override(tab);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n\telse\n\t{\n\t\tround_markup_to_override(tab);\n\t}\n\n\treturn false;\n}\n\nfunction round_markup_to_override(tab)\n{\n\tlet dirty = false;\n\t$('.markup-price').each(function (index) {\n\t\tif ($(this).is('[readonly]'))\n\t\t{\n\t\t\t//nothing;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet o_input = $(this).parent().find('.' + tab + '-override-price-input');\n\t\t\tif (o_input.length)\n\t\t\t{\n\t\t\t\tlet price = parseFloat($(this).text());\n\t\t\t\tlet o_price = Math.ceil(price * 2) / 2;\n\t\t\t\to_input.val(o_price.toFixed(2));\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (dirty)\n\t{\n\t\tcalculatePage();\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\n}\n\nfunction selectedDefault()\n{\n\tif (notShown)\n\t{\n\t\tbootbox.alert(\"Any Menus that do not currently have their own specific settings finalized will inherit these default settings.\");\n\t\tnotShown = false;\n\t}\n\n\tcalculatePage();\n}\n\nfunction getXmlHttpObject()\n{\n\tlet objXMLHttp = null;\n\n\ttry\n\t{\n\t\t// Opera 8.0+, Firefox, Safari\n\t\tobjXMLHttp = new XMLHttpRequest();\n\t}\n\tcatch (e)\n\t{\n\t\t// Internet Explorer Browsers\n\t\ttry\n\t\t{\n\t\t\tobjXMLHttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tobjXMLHttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\t// Something went wrong\n\t\t\t}\n\t\t}\n\t}\n\n\treturn objXMLHttp;\n}\n\nfunction def_price_save_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction def_price_retreive_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction SaveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\tlet printString = \"Sides &amp; Sweets default pricing has been saved\";\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t}\n}\n\nfunction RetrieveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tif (xmlHttp.responseText && xmlHttp.responseText != \"error\" && xmlHttp.responseText != \"\")\n\t\t{\n\t\t\tlet pricingArray = xmlHttp.responseText.split(\"|\");\n\t\t\tlet RidMap = [];\n\t\t\tfor (let key in pricingArray)\n\t\t\t{\n\t\t\t\tvar item = pricingArray[key].split(\"~\");\n\t\t\t\tif (item[0])\n\t\t\t\t{\n\t\t\t\t\tRidMap[item[0]] = [\n\t\t\t\t\t\titem[1],\n\t\t\t\t\t\titem[2],\n\t\t\t\t\t\titem[3]\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcalculatePage();\n\n\t\t\tlet totalCurrentlyWebVisible = numberOfCustomerFacingCTSItems;\n\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tif (RidMap[rid])\n\t\t\t\t{\n\t\t\t\t\tlet overrideElemName = 'ovr_' + itemNumber;\n\t\t\t\t\tlet overrideElem = document.getElementById(overrideElemName);\n\t\t\t\t\tif (overrideElem)\n\t\t\t\t\t{\n\t\t\t\t\t\toverrideElem.value = RidMap[rid][2];\n\t\t\t\t\t}\n\n\t\t\t\t\tlet showCustomerBox = document.getElementById('vis_' + itemNumber);\n\n\t\t\t\t\tlet is_web_visible = showCustomerBox.checked;\n\n\t\t\t\t\tif (showCustomerBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][0] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!is_web_visible && totalCurrentlyWebVisible < 20)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = true;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (is_web_visible)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = false;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet hideEverywhereBox = document.getElementById('hid_' + itemNumber);\n\t\t\t\t\tif (hideEverywhereBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][1] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcalculatePage();\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tlet printString = \"There was an error when retrieving the default prices. Please try again.\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\t}\n\t}\n}\n\nfunction SavePricing()\n{\n\tdd_message({\n\t\ttitle: 'Save Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to save the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\t\t\tlet payLoad = \"data=\";\n\t\t\t// Chef Touched Selections\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\t\t\t\tlet previewPrice = Number($(\"#row_\" + itemNumber + \" > .preview-price\").text());\n\t\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\t\tif (previewPrice != \"\" && previewPrice != 0 && !isNaN(previewPrice))\n\t\t\t\t{\n\t\t\t\t\tcurrentPrice = previewPrice;\n\t\t\t\t}\n\n\t\t\t\tif (currentPrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").style.display = \"block\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"Override price must be greater than the price.\";\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet show_to_customer = \"0\";\n\n\t\t\t\tif (document.getElementById('vis_' + itemNumber) && document.getElementById('vis_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\tshow_to_customer = \"1\";\n\t\t\t\t}\n\n\t\t\t\tlet hide_completely = \"0\";\n\t\t\t\tif (document.getElementById('hid_' + itemNumber) && document.getElementById('hid_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\thide_completely = \"1\";\n\t\t\t\t}\n\n\t\t\t\tpayLoad += rid + \"~\" + show_to_customer + \"~\" + hide_completely + \"~\" + currentPrice + \"|\";\n\t\t\t}\n\n\t\t\txmlHttp = getXmlHttpObject();\n\t\t\tif (xmlHttp == null)\n\t\t\t{\n\t\t\t\t// temporary\n\t\t\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tlet url = \"ddproc.php?processor=admin_defaultPricingProcessor&action=save&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"ddproc.php?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = SaveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"POST\", url, true);\n\t\t\txmlHttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t\t\txmlHttp.setRequestHeader(\"Content-length\", payLoad.length);\n\t\t\txmlHttp.setRequestHeader(\"Connection\", \"close\");\n\t\t\txmlHttp.send(payLoad);\n\n\t\t\tsetTimeout(\"def_price_save_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction RetrievePricing()\n{\n\tif (dp_processing)\n\t{\n\t\treturn;\n\t}\n\n\txmlHttp = getXmlHttpObject();\n\tif (xmlHttp == null)\n\t{\n\t\t// temporary\n\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\treturn;\n\t}\n\n\tdd_message({\n\t\ttitle: 'Retrieve Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to retrieve the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tvar url = \"ddproc.php?processor=admin_defaultPricingProcessor&action=retrieve&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"ddproc.php?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = RetrieveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"GET\", url, true);\n\t\t\txmlHttp.send(null);\n\n\t\t\tsetTimeout(\"def_price_retreive_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction calculatePage()\n{\n\tnumberOfCustomerFacingCTSItems = 0;\n\tnumberOfCustomerFacingEFLItems = 0;\n\n\tlet uniqueEFLEntreeId = [];\n\tlet is_unsaved = false;\n\n\tlet sidesCount = 0;\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet currentAssemblyFee = ((!$('#assembly_fee').val()) ? null : $('#assembly_fee').val());\n\tlet currentDeliveryAssemblyFee = ((!$('#delivery_assembly_fee').val()) ? null : $('#delivery_assembly_fee').val());\n\n\tlet currentDefaultStatus = document.getElementById('is_default_markupno').checked ? 0 : 1;\n\n\tif ($('#delivery_assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.delivery_assembly_fee) != formatAsMoney(currentDeliveryAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 1\");\n\t\t}\n\t}\n\n\tif ($('#assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.assembly_fee) != formatAsMoney(currentAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 2\");\n\t\t}\n\t}\n\n\tif ($('#markup_2_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_2_serving) != formatAsMoney(current2ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 3\");\n\t\t}\n\t}\n\n\tif ($('#markup_3_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_3_serving) != formatAsMoney(current3ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 4\");\n\t\t}\n\t}\n\n\tif ($('#markup_4_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_4_serving) != formatAsMoney(current4ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 5\");\n\t\t}\n\t}\n\n\tif ($('#markup_6_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_6_serving) != formatAsMoney(current6ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 6\");\n\t\t}\n\t}\n\n\tif ($('#markup_sides').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_sides) != formatAsMoney(currentSidesMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 7\");\n\t\t}\n\t}\n\n\tif (menuInfo.menu_id != '100')\n\t{\n\t\tif (markupData.is_default != currentDefaultStatus)\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 8\");\n\t\t}\n\t}\n\n\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\tfor (let i = 0; i < itemRows.length; i++)\n\t{\n\t\tif (itemRows[i].id.indexOf('row_') == -1 && itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\n\t\tif (itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tlet ltd_menu_item_value = 0;\n\t\tif (storeInfo.supports_ltd_roundup == 1)\n\t\t{\n\t\t\tltd_menu_item_value = Number(formatAsMoney(menuInfo.mid[itemNumber].ltd_menu_item_value));\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tif (overridePrice > 0 && ltd_menu_item_value > 0)\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney((overridePrice * 1) + (ltd_menu_item_value * 1)));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (isEnabled_Markup && newPriceByMarkUp > 0 && overridePrice == 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 9\");\n\t\t}\n\t\telse if (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 10\");\n\t\t}\n\t\telse if (isEnabled_Markup && overridePrice > 0 && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 11\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\torgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 12\");\n\t\t\t}\n\t\t}\n\t}\n\n\t// EFL Items\n\n\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t{\n\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1 && EFL_itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\tif (EFL_itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (!$('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tlet entreeId = $('#vis_' + itemNumber).data('entree_id');\n\n\t\t\tif (!uniqueEFLEntreeId.includes(entreeId))\n\t\t\t{\n\t\t\t\tnumberOfCustomerFacingEFLItems++;\n\t\t\t\tuniqueEFLEntreeId.push(entreeId);\n\t\t\t}\n\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tif (itemNumber == 13944)\n\t\t{\n\t\t\tlet x = 1;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse // servingSize == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\n\t\tlet markdown_change = false;\n\t\t// At this point we know the new price... apply the markdown if it exists\n\t\tif (isEnabled_Markup && $('#mkdn_' + itemNumber)[0])\n\t\t{\n\t\t\tlet markdown = $('#mkdn_' + itemNumber);\n\t\t\tlet markdown_value = formatAsMoney(markdown.data('markdown_value'));\n\t\t\tlet original_markdown = markdown.data('org_val');\n\t\t\tlet markedDownPrice = 0;\n\t\t\tif (overridePrice > 0)\n\t\t\t{\n\t\t\t\toverridePrice -= formatAsMoney(overridePrice * (markdown_value / 100));\n\t\t\t\tmarkedDownPrice = overridePrice;\n\t\t\t}\n\t\t\telse if (markupPrice > 0)\n\t\t\t{\n\t\t\t\tlet discount = Number(formatAsMoney(markupPrice * (markdown_value / 100)));\n\t\t\t\tmarkupPrice = formatAsMoney((markupPrice * 100) / 100);\n\t\t\t\tmarkupPrice = Math.round((markupPrice - discount.valueOf()) * 100) / 100;\n\t\t\t\tmarkedDownPrice = markupPrice;\n\t\t\t}\n\n\t\t\tif (original_markdown != markdown_value)\n\t\t\t{\n\t\t\t\tmarkdown_change = true;\n\t\t\t}\n\n\t\t}\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tif (Math.abs(ORdelta) < .005)\n\t\t{\n\t\t\tORdelta = 0;\n\t\t}\n\t\tif (Math.abs(MUdelta) < .005)\n\t\t{\n\t\t\tMUdelta = 0;\n\t\t}\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 13\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 14\");\n\t\t}\n\t\telse if (markdown_change)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markedDownPrice));\n\t\t\tis_unsaved = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 15\");\n\t\t\t}\n\t\t}\n\n\t\tlet picFlag = document.getElementById(\"pic_\" + itemNumber);\n\t\tif (picFlag)\n\t\t{\n\t\t\tlet orgState = picFlag.getAttribute('data-orgval');\n\t\t\tif ((picFlag.checked && orgState != 'CHECKED') || (!picFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 16\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\t// Chef Touched Selections\n\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t{\n\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\tif ($('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tnumberOfCustomerFacingCTSItems++;\n\t\t}\n\n\t\tif (currentSidesMarkup == 0 || currentSidesMarkup == null || currentSidesMarkup == \"\")\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\t\t\tmarkupPrice = basePrice;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * currentSidesMarkup) + 0.00000001) / 100));\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 17\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 18\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 19\");\n\t\t\t}\n\t\t}\n\n\t\tlet hidFlag = document.getElementById(\"hid_\" + itemNumber);\n\t\tif (hidFlag)\n\t\t{\n\t\t\tlet orgState = hidFlag.getAttribute('data-orgval');\n\t\t\tif ((hidFlag.checked && orgState != 'CHECKED') || (!hidFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 20\");\n\t\t\t}\n\t\t}\n\n\t\tlet formFlag = document.getElementById(\"form_\" + itemNumber);\n\t\tif (formFlag)\n\t\t{\n\t\t\tlet orgState = formFlag.getAttribute('data-orgval');\n\t\t\tif ((formFlag.checked && orgState != 'CHECKED') || (!formFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 21\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\tif (gNumOptionalsAdded != 0)\n\t{\n\t\tis_unsaved = true;\n\t\t//dd_console_log(\"Unsaved 22\");\n\t}\n\n\tif (is_unsaved)\n\t{\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\telse\n\t{\n\t\t$('#saved_message, #saved_message_2').hideFlex();\n\t}\n}\n\nfunction confirm_and_check_form()\n{\n\tlet form = $(\"#menu_editor_form\")[0];\n\n\tclearErrors();\n\n\tlet validated = _check_form(form);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet warnOffOfEmptyMarkups = false;\n\n\tlet currentVolumeReward = \"0\";\n\n\tlet message = \"\";\n\n\tif (validated)\n\t{\n\t\tif (current2ServMarkup < 0 || current4ServMarkup < 0 || current3ServMarkup < 0 || current6ServMarkup < 0 || currentSidesMarkup < 0)\n\t\t{\n\t\t\tmessage = \"Negative per cent markups are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (current2ServMarkup > 70 || current4ServMarkup > 70 || current3ServMarkup > 70 || current6ServMarkup > 70 || currentSidesMarkup > 70)\n\t\t{\n\t\t\tmessage += \"Markups greater than 70% are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward < 0)\n\t\t{\n\t\t\tmessage += \"Negative volume discounts are not permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward > 75)\n\t\t{\n\t\t\tmessage += \"Volume Dscounts greater than $75.00 are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward == \"\")\n\t\t{\n\t\t\tmessage += \"Please supply a valid volume discount. Use zero if you want no volume discount applied.<br />\";\n\t\t}\n\n\t\tif (($('#markup_2_serving').length != 0 && current2ServMarkup == null) || ($('#markup_4_serving').length != 0 && current4ServMarkup == null) || ($('#markup_3_serving').length != 0 && current3ServMarkup == null) || ($('#markup_6_serving').length != 0 && current6ServMarkup == null) || ($('#markup_sides').length != 0 && currentSidesMarkup == null))\n\t\t{\n\t\t\twarnOffOfEmptyMarkups = true;\n\t\t}\n\n\t\tlet assembly_fee = ((!$('#assembly_fee').val()) ? 0 : $('#assembly_fee').val());\n\t\tif (assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet delivery_assembly_fee = ((!$('#delivery_assembly_fee').val()) ? 0 : $('#delivery_assembly_fee').val())\n\t\tif (delivery_assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Delivery Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\t\tlet encounteredBasePriceIssue = false;\n\t\tlet problemItemList = \"\";\n\n\t\tfor (let i = 0; i < itemRows.length; i++)\n\t\t{\n\t\t\tif (itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\t\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t\t{\n\t\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = EFL_itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\tlet markdownObj = $(\"#mkdn_\" + itemNumber)[0];\n\t\t\tlet markDownPostObj = $(\"#upd_mkdn_\" + itemNumber)[0];\n\n\t\t\tif (markdownObj)\n\t\t\t{\n\t\t\t\tlet value = $(markdownObj).data(\"markdown_id\") + \"|\" + $(markdownObj).data(\"markdown_value\");\n\n\t\t\t\tif (!markDownPostObj)\n\t\t\t\t{\n\t\t\t\t\tlet el = document.createElement('input');\n\t\t\t\t\tel.setAttribute(\"type\", \"hidden\");\n\t\t\t\t\tel.setAttribute(\"value\", value);\n\t\t\t\t\tlet idStr = \"upd_mkdn_\" + itemNumber;\n\t\t\t\t\tel.setAttribute(\"id\", idStr);\n\t\t\t\t\tel.setAttribute(\"name\", idStr);\n\t\t\t\t\tmarkdownObj.appendChild(el);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmarkDownPostObj.val(value);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t{\n\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = ctsItemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\t\t\t\t}\n\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (encounteredBasePriceIssue)\n\t\t{\n\t\t\tmessage += \"The Override Price must be greater than the base price for:<br />\";\n\t\t\tmessage += problemItemList;\n\n\t\t}\n\n\t\tif (message != \"\")\n\t\t{\n\t\t\tvalidated = false;\n\t\t\tdisplayValidationErrorMsg(message);\n\t\t}\n\t}\n\n\tif (validated)\n\t{\n\t\tlet finalizeMessage = \"Are you sure want to submit these changes to your menu? If the menu is active the changes will be immediately available to your customers.\";\n\n\t\tif (warnOffOfEmptyMarkups)\n\t\t{\n\t\t\tfinalizeMessage += \"<br /><br /><span class='text-red font-weight-bold'>One or more of the Percentage MarkUp values is empty or 0. Please review and correct if this was unintentional.</span><br />\";\n\t\t}\n\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\t\t$(\"#menu_editor_form\").submit();\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\t/*\n\t\tif (confirm(finalizeMessage))\n\t\t{\n\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\t*/\n\t}\n\n\treturn false;\n}\n\nfunction getMarkUpPrice(servingsSize, basePrice)\n{\n\n\tlet markupPrice = Number(basePrice);\n\tbasePrice = Number(basePrice);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\n\t// if current markup then update markup column\n\tif (servingsSize == \"Sm (2)\")\n\t{\n\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current2ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (4)\")\n\t{\n\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current4ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (3)\")\n\t{\n\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current3ServMarkup) / 100));\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current6ServMarkup) / 100));\n\t\t}\n\t}\n\n\treturn markupPrice;\n}\n\nfunction addUnsavedEFLItem(item_id, name, size, base_price, thisItemCount, countItemsInRecipe)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('EFLitemsTbl');\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(0);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(++insertCellNum);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"pic_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(++insertCellNum);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(++insertCellNum);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\n\tvar el = document.createTextNode(size);\n\tcellSize.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// basePrice cell\n\t\tvar cellbase = row.insertCell(++insertCellNum);\n\t\tcellbase.setAttribute(\"class\", \"align-middle\");\n\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t\tcellbase.appendChild(el);\n\n\t\tvar markup_price = getMarkUpPrice(size, base_price);\n\t}\n\n\t// currentPrice cell\n\tvar cellcurrent = row.insertCell(++insertCellNum);\n\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\n\tif (isEnabled_Markup)\n\t{\n\t\tvar el = document.createTextNode(markup_price);\n\t}\n\telse\n\t{\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t}\n\tcellcurrent.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// markupPrice cell\n\t\tvar cellmarkup = row.insertCell(++insertCellNum);\n\t\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\n\t\tvar el = document.createTextNode(markup_price);\n\t\tcellmarkup.appendChild(el);\n\t}\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"any\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", \"\");\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tif (!isEnabled_Markup)\n\t{\n\t\tel.setAttribute(\"value\", formatAsMoney(base_price));\n\t}\n\tcelloverride.appendChild(el);\n\n\t// markdown\n\tvar cellmarkdown = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('button');\n\tvar idStr = \"add-mkdn_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"class\", \"button\");\n\tvar buttonTextNode = document.createTextNode(\"Add\");\n\tel.appendChild(buttonTextNode);\n\n\tcellmarkdown.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(++insertCellNum);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n}\n\nfunction addUnsavedSideItem(item_id, name, size, base_price, category_label)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('ctsItemsTbl');\n\n\tif ($('#temp_category').length == 0)\n\t{\n\t\tvar row = tbl.insertRow(-1);\n\t\trow.setAttribute(\"id\", \"temp_category\");\n\n\t\tvar cellName = row.insertCell(0);\n\t\tcellName.setAttribute(\"class\", \"font-weight-bold py-3\");\n\t\tcellName.setAttribute(\"colspan\", \"11\");\n\t\tvar nameNode = document.createTextNode('Newly Added Items');\n\t\tcellName.appendChild(nameNode);\n\t}\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(insertCellNum++);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"form_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// hide everywhere cell\n\tvar cellLeft3 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"hid_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft3.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(insertCellNum++);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(insertCellNum++);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(size);\n\tcellSize.appendChild(el);\n\n\t// basePrice cell\n\tvar cellbase = row.insertCell(insertCellNum++);\n\tcellbase.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(formatAsMoney(base_price));\n\tcellbase.appendChild(el);\n\n\tvar markup_price = getMarkUpPrice(size, base_price);\n\n\t// currentPrice cell\n\tvar cellcurrent = row.insertCell(insertCellNum++);\n\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode(markup_price);\n\tcellcurrent.appendChild(el);\n\n\t// markupPrice cell\n\tvar cellmarkup = row.insertCell(insertCellNum++);\n\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\tvar el = document.createTextNode(markup_price);\n\tcellmarkup.appendChild(el);\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(insertCellNum++);\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"any\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", \"\");\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tcelloverride.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(insertCellNum++);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n\tvar el = document.createTextNode('');\n\tcellpreview.appendChild(el);\n\n\t// remianingInventory cell\n\tvar cellremaining = row.insertCell(insertCellNum++);\n\tcellremaining.setAttribute(\"class\", \"align-middle remaining-price\");\n\tvar el = document.createTextNode('0');\n\tcellremaining.appendChild(el);\n}\n\nfunction giveTabFocus()\n{\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\n\t\tget: (searchParams, prop) => searchParams.get(prop)\n\t});\n\tlet value = params.tabs; // \"some_value\"\n\tif (typeof value != 'undefined' && value != null)\n\t{\n\t\tvalue = value.substring(value.indexOf('menu.') + 5);\n\t\t$(document).find(\"[data-nav='\" + value + \"']\").click();\n\t}\n\n}\n\nfunction initNavTab()\n{\n\n\tvar oldUrl = $('#inv-nav-button').attr(\"href\"); // Get current url\n\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tabs'));\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\n\t\tget: (searchParams, prop) => searchParams.get(prop)\n\t});\n\n\tif (typeof params.tabs != 'undefined' && params.tabs != null)\n\t{\n\t\tnewUrl = newUrl + '&tabs=' + params.tabs;\n\t\t$('#inv-nav-button').attr(\"href\", newUrl);\n\t}\n\n\t$('.nav-tab').each(function () {\n\t\t$(this).on('click', function () {\n\t\t\tvar oldUrl = $('#inv-nav-button').attr(\"href\"); // Get current url\n\t\t\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tabs'));\n\t\t\tnewUrl = newUrl + '&tabs=menu.' + $(this).data('nav');\n\t\t\t$('#inv-nav-button').attr(\"href\", newUrl);\n\t\t});\n\t});\n}\n\n$(function () {\n\n\t$(document).ready(function () {\n\t\tcalculatePage()\n\t\tgiveTabFocus();\n\t\tinitNavTab();\n\t});\n\n\t$(document).on('change keyup', '#markup_6_serving, #markup_4_serving, #markup_3_serving, #markup_2_serving, #markup_sides, #assembly_fee, #delivery_assembly_fee, #volume_reward, [name=\"is_default_markup\"], [id^=pic_], [id^=form_], [id^=ovr_], [id^=vis_], [id^=hid_]', function (e) {\n\t\tcalculatePage();\n\t});\n\n\t$(document).on('change keyup', '[id^=vis_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\tlet checkedState = $(this).is(':checked');\n\n\t\t// Sides & Sweets\n\t\tif (menuInfo.mid[menu_item_id].is_chef_touched == '1')\n\t\t{\n\t\t\tif (checkedState && numberOfCustomerFacingCTSItems > 20)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': false});\n\n\t\t\t\tbootbox.alert('You can only display 20 Sides &amp; Sweets items on the customer facing menu.');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\t\t\t}\n\t\t}\n\t\t// EFL\n\t\telse if (menuInfo.mid[menu_item_id].is_store_special == '1')\n\t\t{\n\t\t\tif (!checkedState && numberOfCustomerFacingEFLItems > 10)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': true});\n\n\t\t\t\tbootbox.alert(\"You can only make 10 Fast Lane items visible at a time. Please hide another store special if you wish to make this item visible.\");\n\t\t\t}\n\t\t}\n\n\t});\n\n\t$(document).on('change keyup', '[id^=form_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('change keyup', '[id^=hid_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#vis_' + menu_item_id).prop({'checked': false});\n\t\t$('#form_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('keyup change', '#filter', function (e) {\n\t\t$.uiTableFilter($('#recipe_list'), this.value);\n\t});\n\n\t$(document).on('click', '#clear_filter', function (e) {\n\n\t\t$('#filter').val('').change();\n\n\t\tif (!Modernizr.input.placeholder)\n\t\t{\n\t\t\t// trick to restore placeholder on IE\n\t\t\t$('#filter').focus().blur();\n\t\t}\n\n\t});\n\n\t// handle markdowns\n\t$(document).on('click', '[id^=mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Edit Markdown',\n\t\t\tdiv_id: \"edit_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\tlet price = start_price;\n\t\t\t\tprice -= (price * (markdownVal / 100));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#edit_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#mkdn_' + itemID).html(formatAsMoney(newPercentage) + \"%\");\n\t\t\t\t\t$('#mkdn_' + itemID).data('markdown_value', newPercentage);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t// handle_add_new_markdown\n\t$(document).on('click', '[id^=add-mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Add Markdown',\n\t\t\tdiv_id: \"new_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(0));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#new_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet new_button = '<button class=\"button\" id=\"mkdn_' + itemID + '\" data-org_val=\"0\" data-markdown_id=\"new\" data-markdown_value=\"' + newDiscount + '\" >' + formatAsMoney(newDiscount) + '%</button>';\n\t\t\t\t\t$('#add-mkdn_' + itemID).replaceWith(new_button);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t$(document).on('click', '#add_past_menu_item:not(.disabled)', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving items. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: true,\n\t\t\ttitle: 'Add EFL Item',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_item&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t\t$(\".modal-backdrop\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t\t\t$(\".modal-backdrop\").remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t\t\t$(\".modal-backdrop\").remove();\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_item]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\n\t\t\t\t\t});\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\tmessage: 'This will immediately add the listed items to the menu. Are you sure?',\n\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t'Add Items to Menu': function () {\n\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\top: 'add_menu_item',\n\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedEFLItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, handledCount, count);\n\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('main.php?page=admin_menu_editor&tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('click', '[data-add_menu_item]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_item=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_item=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_item=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: 'ddproc.php',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n\n\t//////---------Add past Sides & Sweets\n\n\t$(document).on('click', '#add_past_menu_item_sides', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving Sides & Sweets. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: false,\n\t\t\ttitle: 'Add Sides & Sweets',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_sides_sweets&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t\t\t$(\".modal-backdrop\").remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\t\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t\t\t$(\".modal-backdrop\").remove();\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\tlet errorMissingCategory = false;\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_side]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\t\t\t\t\t\tlet categoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").find(\":selected\").val();\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined'){\n\t\t\t\t\t\t\tcategoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").html();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined')\n\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t$(\"[data-recipe_category=\" + thisEntree + \"]\").css(\"border-color\", \"red\");\n\t\t\t\t\t\t\terrorMissingCategory = true;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tentreeList[thisEntree] = categoryLabel;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (errorMissingCategory)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.log('Missing');\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Please select a category for all items',\n\t\t\t\t\t\t\tmessage: 'Please select a category for all items'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\t\tmessage: 'This will immediately add the listed Sides & Sweets to the menu. Are you sure?',\n\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t'Add Sides & Sweets to Menu': function () {\n\n\t\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\t\top: 'add_menu_side',\n\t\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 0;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedSideItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, items[id].subcategory_label);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t$([\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.documentElement,\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.body\n\t\t\t\t\t\t\t\t\t\t\t\t]).animate({\n\t\t\t\t\t\t\t\t\t\t\t\t\tscrollTop: $(\"#temp_category\").offset().top\n\t\t\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error adding Sides & Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Network Error adding Sides and Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('main.php?page=admin_menu_editor&tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('change', '[data-recipe_category]', function (e) {\n\t\tlet categoryLabel = $(this).find(\":selected\").val();\n\n\t\tif (typeof categoryLabel == 'undefined')\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"red\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"black\");\n\t\t}\n\t});\n\n\t$(document).on('click', '[data-add_menu_side]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_side=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_side=\" + entree_id + \"]\").remove();\n\n\t\t\ttr.find(\"[data-recipe_category=\" + entree_id + \"]\").show();\n\n\t\t\tlet oldCategory = tr.find(\"[data-old_category=\" + entree_id + \"]\").html();\n\n\t\t\ttr.find(\"[data-old_category=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\n\t\t\t$(\"[data-recipe_category=\" + entree_id + \"]\").val(oldCategory);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_side=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: 'ddproc.php',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n});"],"mappings":"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"}