{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["menu_editor.js"],"sourcesContent":["$(function () {\n\n\t$(\"#menu_editor_form\").submit(function (e) {\n\n\t\te.preventDefault();\n\t\tlet form = this;\n\n\t\tbootbox.confirm(\"Are you sure want to submit these changes to your menu? If the menu is active the changes will be immediately available to your customers.\", function (result) {\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\tform.submit();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$(\"#menu_editor_form\").removeClass('was-validated');\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t});\n\n\t$('#menus').on('change', function (e) {\n\n\t\tlet menu_id = $(this).val();\n\n\t\tcreate_and_submit_form({\n\t\t\taction: 'main.php?page=admin_menu_editor_new',\n\t\t\tinput: ({\n\t\t\t\t'action': 'changeMenu',\n\t\t\t\t'menus': menu_id\n\t\t\t})\n\t\t});\n\n\t});\n\n\t$('#store').on('change', function (e) {\n\n\t\tlet store_id = $(this).val();\n\n\t\tcreate_and_submit_form({\n\t\t\taction: 'main.php?page=admin_menu_editor_new',\n\t\t\tinput: ({\n\t\t\t\t'action': 'changeStore',\n\t\t\t\t'store': store_id\n\t\t\t})\n\t\t});\n\n\t});\n\n\t$(document).on('change keyup', '.override-price-input', function (e) {\n\n\t\tlet new_value = formatAsMoney($.trim($(this).val()));\n\t\tlet new_value_cents = new_value.toString().split('.')[1];\n\t\tlet orgval = $(this).data('orgval');\n\t\tlet ltd_menu_item_value = $(this).data('ltd_menu_item_value');\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\tlet tier_1_price = $(this).data('tier_1_price');\n\t\tlet tier_2_price = $(this).data('tier_2_price');\n\t\tlet tier_3_price = $(this).data('tier_3_price');\n\t\tlet preview_price = null;\n\n\t\t$(this).removeClass([\n\t\t\t'border-green',\n\t\t\t'border-orange',\n\t\t\t'border-red',\n\t\t\t'border-width-2'\n\t\t]);\n\n\t\t$(\"#row_\" + menu_item_id + \" > .preview-price\").removeClass([\n\t\t\t'text-green',\n\t\t\t'text-orange',\n\t\t\t'text-red'\n\t\t]).text('');\n\n\t\tif ($(this).val() && orgval != new_value)\n\t\t{\n\t\t\tlet preview_price = Number(new_value) + Number(ltd_menu_item_value);\n\n\t\t\t$(\"#row_\" + menu_item_id + \" > .preview-price\").text(preview_price);\n\n\t\t\tif ((tier_1_price && tier_3_price) && (new_value < tier_1_price || new_value > tier_3_price))\n\t\t\t{\n\t\t\t\t$(\"#row_\" + menu_item_id + \" > .preview-price\").addClass('text-red');\n\t\t\t\t$(this).addClass('border-red border-width-2');\n\t\t\t}\n\t\t\telse if (new_value_cents != '49' && new_value_cents != '99')\n\t\t\t{\n\t\t\t\t$(\"#row_\" + menu_item_id + \" > .preview-price\").addClass('text-orange');\n\t\t\t\t$(this).addClass('border-orange border-width-2');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$(\"#row_\" + menu_item_id + \" > .preview-price\").addClass('text-green');\n\t\t\t\t$(this).addClass('border-green');\n\t\t\t}\n\t\t}\n\n\t});\n\n\t$(document).on('change keyup', '.markup-input', function (e) {\n\n\t\tlet markup_type = $(this).attr('name');\n\t\tlet markup_value = Number($(this).val());\n\t\tlet pricing_type = $(this).data('pricing_type');\n\n\t\tswitch (markup_type)\n\t\t{\n\t\t\tcase 'markup_2_serving':\n\t\t\tcase 'markup_3_serving':\n\t\t\tcase 'markup_4_serving':\n\t\t\tcase 'markup_6_serving':\n\t\t\t\t// loop price input that isn't a side or readonly\n\t\t\t\t$('.override-price-input[data-pricing_type=\"' + pricing_type + '\"]:not([data-category_group=\"SIDE\"][readonly])').each(function () {\n\t\t\t\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\t\t\t\tlet base_price = Number($(this).data('price'));\n\t\t\t\t\tlet markup_price = formatAsMoney(base_price + (Math.round((base_price * markup_value) + 0.00000001) / 100));\n\t\t\t\t\t$('.markup-price[data-menu_item_id=\"' + menu_item_id + '\"]').text(markup_price);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'markup_sides':\n\t\t\t\t// loop price input that is a side and not readonly\n\t\t\t\t$('.override-price-input[data-category_group=\"SIDE\"]:not([readonly])').each(function () {\n\t\t\t\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\t\t\t\tlet base_price = Number($(this).data('price'));\n\t\t\t\t\tlet markup_price = formatAsMoney(base_price + (Math.round((base_price * markup_value) + 0.00000001) / 100));\n\t\t\t\t\t$('.markup-price[data-menu_item_id=\"' + menu_item_id + '\"]').text(markup_price);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\n\t});\n\t$('.markup-input').trigger('change');\n\n\t// check for changes\n\t$(document).on('change keyup', '.visibility-select, .override-price-input, .markup-input', function (e) {\n\n\t\tlet is_unsaved = false;\n\t\t$('.unsaved-message').hideFlex();\n\n\t\t// check if any options are changed\n\t\t$('.visibility-select').each(function () {\n\n\t\t\t$(this).removeClass([\n\t\t\t\t'border-orange'\n\t\t\t]);\n\n\t\t\tif (Number($(this).val()) != Number($(this).data('orgval')))\n\t\t\t{\n\t\t\t\t$(this).addClass([\n\t\t\t\t\t'border-orange'\n\t\t\t\t]);\n\n\t\t\t\tis_unsaved = true;\n\n\t\t\t}\n\n\t\t});\n\n\t\t// check if any override prices are changed\n\t\t$('.override-price-input').each(function () {\n\n\t\t\tlet new_value = formatAsMoney($.trim($(this).val()));\n\t\t\tlet new_value_cents = new_value.toString().split('.')[1];\n\t\t\tlet orgval = $(this).data('orgval');\n\n\t\t\tif (orgval != '' && orgval != new_value)\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\n\t\t\t}\n\n\t\t});\n\n\t\t// check if any markup values are changed\n\t\t$('.markup-input').each(function () {\n\n\t\t\tlet new_value = formatAsMoney($.trim($(this).val()));\n\t\t\tlet new_value_cents = new_value.toString().split('.')[1];\n\t\t\tlet orgval = $(this).data('orgval');\n\n\t\t\tif (orgval != '' && orgval != new_value)\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\n\t\t\t}\n\n\t\t});\n\n\t\tif (is_unsaved)\n\t\t{\n\t\t\t$('.unsaved-message').showFlex();\n\t\t}\n\n\t});\n\n\t// handle adding efl and side menu items to menu\n\t$(document).on('click', '[data-add_past_menu_item]:not(.disabled)', function (e) {\n\n\t\te.preventDefault();\n\n\t\tlet add_menu_item = {\n\t\t\t'menu_id': $('#menus').val(),\n\t\t\t'store_id': STORE_DETAILS.id,\n\t\t\t'item_type': $(this).data('add_past_menu_item'),\n\t\t\t'selected_items': {},\n\t\t\t'dialog': null\n\t\t}\n\n\t\t// create the modal ui with bootbox\n\t\tadd_menu_item.dialog = bootbox.dialog({\n\t\t\tmessage: '<p><i class=\"fa fa-spin fa-spinner\"></i> Loading menu items...</p>',\n\t\t\tsize: 'large',\n\t\t\tcloseButton: false,\n\t\t\tbuttons: {\n\t\t\t\tadd_items: {\n\t\t\t\t\tlabel: \"Add selected menu items\",\n\t\t\t\t\tclassName: 'btn-primary disabled add-menu-items-confirm',\n\t\t\t\t\tcallback: function () {\n\n\t\t\t\t\t\t// nothing selected, close window\n\t\t\t\t\t\tif (Object.keys(add_menu_item.selected_items).length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// using native confirm since bootstrap doesn't support multiple modals\n\t\t\t\t\t\tif (confirm(\"This will immediately add the listed items to the menu. Are you sure you wish to add the selected menu items to the menu?\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html('<p><i class=\"fa fa-spin fa-spinner\"></i> Adding menu items...</p>');\n\t\t\t\t\t\t\tadd_menu_item.dialog.find('.modal-footer').hideFlex();\n\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\ttimeout: 60000,\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tprocessor: 'admin_menu_editor',\n\t\t\t\t\t\t\t\t\tmenu_id: add_menu_item.menu_id,\n\t\t\t\t\t\t\t\t\tstore_id: add_menu_item.store_id,\n\t\t\t\t\t\t\t\t\top: 'add_items',\n\t\t\t\t\t\t\t\t\titems: add_menu_item.selected_items\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=admin_menu_editor_new&tab=nav-' + add_menu_item.item_type);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// confirmation dialog is presented above, prevent dialog from closing\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcancel: {\n\t\t\t\t\tlabel: \"Cancel\",\n\t\t\t\t\tclassName: 'btn-danger',\n\t\t\t\t\tcallback: function () {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonShow: function (e) {\n\t\t\t\t// load the menu items\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\ttimeout: 60000,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tprocessor: 'admin_menu_editor',\n\t\t\t\t\t\tmenu_id: add_menu_item.menu_id,\n\t\t\t\t\t\tstore_id: add_menu_item.store_id,\n\t\t\t\t\t\top: 'get_items',\n\t\t\t\t\t\titem_type: add_menu_item.item_type\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html(json.menu_item_html);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html('<p>' + json.processor_message + '</p>');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\tadd_menu_item.dialog.find('.bootbox-body').html('<p>Unexpected error: ' + strError + '</p>');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// handle add menu item button\n\t\t$(add_menu_item.dialog).on('click', '[data-add_menu_item]:not(.disabled)', function (e) {\n\n\t\t\te.preventDefault();\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet menu_item_id = $(this).data('add_menu_item');\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\t// add this item to list to be saved\n\t\t\tadd_menu_item.selected_items[entree_id] = entree_id;\n\n\t\t\t// enable the submit button\n\t\t\tadd_menu_item.dialog.find('.modal-footer > .add-menu-items-confirm').removeClass('disabled');\n\n\t\t\t$('.row_menu_editor_add_item[data-recipe_id=\"' + recipe_id + '\"]').showFlex();\n\n\t\t});\n\n\t\t// handel cancel adding a menu item\n\t\t$(add_menu_item.dialog).on('click', '[data-add_menu_item_cancel]:not(.disabled)', function (e) {\n\n\t\t\te.preventDefault();\n\t\t\tlet menu_item_id = $(this).data('add_menu_item_cancel');\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\t// remove this item from list to be saved\n\t\t\tdelete add_menu_item.selected_items[entree_id];\n\n\t\t\t// no entries in unsaved_entries, disable the submit button\n\t\t\tif (Object.keys(add_menu_item.selected_items).length === 0)\n\t\t\t{\n\t\t\t\tadd_menu_item.dialog.find('.modal-footer > .add-menu-items-confirm').addClass('disabled');\n\t\t\t}\n\n\t\t\t$('[data-add_menu_item=\"' + menu_item_id + '\"]').removeClass('disabled');\n\t\t\t$('.row_menu_editor_add_item[data-recipe_id=\"' + recipe_id + '\"]').hideFlex();\n\n\t\t});\n\n\t\t// handle menu item search\n\t\t$(add_menu_item.dialog).on('keyup change', '#add_menu_item_filter', function (e) {\n\n\t\t\t$.uiTableFilter($('#add_menu_item_recipe_list'), this.value);\n\n\t\t});\n\n\t\t// handle search input clearing\n\t\t$(add_menu_item.dialog).on('click', '#add_menu_item_clear_filter', function (e) {\n\n\t\t\t$('#add_menu_item_filter').val('').change();\n\n\t\t});\n\n\t\t// handel menu info lookup, we load within the modal becaues Bootstrap doesn't support multiple modals\n\t\t$(add_menu_item.dialog).on('click', '[data-add_menu_item_info]', function (e) {\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\t\t\tlet fetched = $('.add_menu_item_info[data-recipe_id=\"' + recipe_id + '\"]').data('fetched');\n\n\t\t\tif (fetched)\n\t\t\t{\n\t\t\t\t$('.add_menu_item_info[data-recipe_id=\"' + recipe_id + '\"]').showFlex();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$('.add_menu_item_info[data-recipe_id=\"' + recipe_id + '\"]').html('<span class=\"font-weight-bold\"><i class=\"fa fa-spin fa-spinner\"></i> Loading menu item info...</span>').showFlex();\n\n\t\t\t$.ajax({\n\t\t\t\turl: 'ddproc.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\ttimeout: 20000,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tprocessor: 'admin_menu_editor',\n\t\t\t\t\tmenu_id: add_menu_item.menu_id,\n\t\t\t\t\tstore_id: add_menu_item.store_id,\n\t\t\t\t\top: 'menu_item_info',\n\t\t\t\t\tentree_id: entree_id,\n\t\t\t\t\trecipe_id: recipe_id\n\t\t\t\t},\n\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t$('.add_menu_item_info[data-recipe_id=\"' + recipe_id + '\"]').data('fetched', true).html(json.data);\n\t\t\t\t},\n\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\tmessage: response\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t});\n\t\t});\n\n\t\t// hadle closing the menu item info panel\n\t\t$(add_menu_item.dialog).on('click', '[data-add_menu_item_info_close]', function (e) {\n\n\t\t\tlet recipe_id = $(this).data('add_menu_item_info_close');\n\n\t\t\t$('.add_menu_item_info[data-recipe_id=\"' + recipe_id + '\"]').hideFlex();\n\n\t\t});\n\n\t}); // end adding efl and side menu items to menu\n\n\t// handle markup roundup\n\t$(document).on('click', '[data-round_up_markup]', function (e) {\n\n\t\tlet item_type = $(this).data('round_up_markup');\n\n\t\tbootbox.confirm(\"Are you sure want to update all Override Prices with rounded Markup Prices? This action will replace existing override prices with the newly calculated price.\", function (result) {\n\t\t\tif (result)\n\t\t\t{\n\t\t\t\t$('.override-price-input[data-category_group=\"' + item_type + '\"]:not([readonly])').each(function () {\n\n\t\t\t\t\tif ($.trim($(this).val()) != '')\n\t\t\t\t\t{\n\t\t\t\t\t\tlet o_input = Number($(this).val());\n\t\t\t\t\t\tlet o_price = Math.ceil(price * 2) / 2;\n\t\t\t\t\t\to_input.val(o_price.toFixed(2));\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t});\n\n\t// handle fetchin default pricing\n\t$(document).on('click', '.sides-sweets-get-pricing', function (e) {\n\n\t\tlet operation = $(this).data('operation');\n\n\t\tif (operation === 'default_pricing_get')\n\t\t{\n\t\t\tbootbox.confirm(\"Are you sure want to update all Override Prices with rounded Markup Prices? This action will replace existing override prices with the newly calculated price.\", function (result) {\n\t\t\t\tif (result)\n\t\t\t\t{\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tprocessor: 'admin_menu_editor',\n\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\top: operation\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$.each(json.pricingData, function (recipe_id, pricing_type) {\n\t\t\t\t\t\t\t\t\t$.each(pricing_type, function (pricing_type, pricing) {\n\t\t\t\t\t\t\t\t\t\t$('.override-price-input[data-recipe_id=\"' + recipe_id + '\"][data-pricing_type=\"' + pricing_type + '\"]:not([readonly])').val(pricing.default_price).trigger('change');\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (operation === 'default_pricing_save')\n\t\t{\n\t\t\tlet prices = {};\n\n\t\t\t$('.override-price-input[data-category_group=\"SIDE\"]:not([readonly])').each(function () {\n\n\t\t\t\tlet save_price = 0;\n\t\t\t\tlet recipe_id = $(this).data('recipe_id');\n\t\t\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\t\t\tlet price = Number($(this).data('price'));\n\t\t\t\tlet markup_price = Number($('.markup-price[data-menu_item_id=\"' + menu_item_id + '\"]').text());\n\t\t\t\tlet override_price = Number($(this).val());\n\t\t\t\tlet vis = $('.visibility-select[data-recipe_id=\"' + recipe_id + '\"][data-visibility_type=\"vis\"]').val();\n\t\t\t\tlet hid = $('.visibility-select[data-recipe_id=\"' + recipe_id + '\"][data-visibility_type=\"hid\"]').val();\n\t\t\t\tlet form = $('.visibility-select[data-recipe_id=\"' + recipe_id + '\"][data-visibility_type=\"form\"]').val();\n\n\t\t\t\tif (override_price !== 0)\n\t\t\t\t{\n\t\t\t\t\tsave_price = override_price;\n\t\t\t\t}\n\t\t\t\telse if (markup_price !== 0)\n\t\t\t\t{\n\t\t\t\t\tsave_price = markup_price;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsave_price = price;\n\t\t\t\t}\n\n\t\t\t\tif (save_price !== 0)\n\t\t\t\t{\n\t\t\t\t\tprices[recipe_id] = {\n\t\t\t\t\t\t'price': save_price,\n\t\t\t\t\t\t'vis': vis,\n\t\t\t\t\t\t'hid': hid,\n\t\t\t\t\t\t'form': form\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\tif (Object.keys(prices).length !== 0)\n\t\t\t{\n\t\t\t\tbootbox.confirm(\"Are you sure you want to save the default Sides and Sweets pricing and visibility? This cannot be undone.\", function (result) {\n\t\t\t\t\tif (result)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: 'ddproc.php',\n\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tprocessor: 'admin_menu_editor',\n\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\top: operation,\n\t\t\t\t\t\t\t\tprices: prices\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$.each(json.pricingData, function (recipe_id, pricing_type) {\n\t\t\t\t\t\t\t\t\t\t$.each(pricing_type, function (pricing_type, pricing) {\n\t\t\t\t\t\t\t\t\t\t\t$('.override-price-input[data-recipe_id=\"' + recipe_id + '\"][data-pricing_type=\"' + pricing_type + '\"]:not([readonly])').val(pricing.default_price).trigger('change');\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t});\n\n});"],"names":["$","submit","e","preventDefault","form","this","bootbox","confirm","result","removeClass","on","menu_id","val","create_and_submit_form","action","input","menus","store_id","store","document","new_value","formatAsMoney","trim","new_value_cents","toString","split","orgval","data","ltd_menu_item_value","menu_item_id","tier_1_price","tier_2_price","tier_3_price","preview_price","text","Number","addClass","markup_type","attr","markup_value","pricing_type","each","base_price","markup_price","Math","round","trigger","is_unsaved","hideFlex","showFlex","add_menu_item","STORE_DETAILS","id","item_type","selected_items","dialog","message","size","closeButton","buttons","add_items","label","className","callback","Object","keys","length","find","html","ajax","url","type","dataType","timeout","processor","op","items","success","json","processor_success","bounce","processor_message","error","objAJAXRequest","strError","cancel","onShow","menu_item_html","entree_id","recipe_id","uiTableFilter","value","change","fetched","response","dd_message","title","o_input","o_price","ceil","price","toFixed","operation","pricingData","pricing","default_price","prices","save_price","override_price","vis","hid"],"mappings":"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"}