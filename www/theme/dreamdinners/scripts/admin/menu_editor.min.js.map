{"version":3,"file":"menu_editor.min.js","names":["numberOfCustomerFacingCTSItems","numberOfCustomerFacingEFLItems","sidesDataArray","gNumOptionalsAdded","notShown","dp_processing","xmlHttp","noOverrideUnderBase","resetPage","document","getElementById","value","submit","getPreviewItemPrice","itemID","ovrPrice","Number","$","val","isNaN","valueOf","text","removeOptionSelected","elSel","i","length","options","selected","remove","removeItem","itemNum","rowID","rowObj","parentNode","removeChild","sidesData","sideName","selObj","Option","calculatePage","displayValidationErrorMsg","msg","dd_message","title","message","clearErrors","html","hideFlex","storeChange","obj","menuChange","confirm_and_round_form","tab","hasOverridePrice","each","this","trim","modal","confirm","round_markup_to_override","cancel","dirty","index","is","o_input","parent","find","price","parseFloat","o_price","Math","ceil","toFixed","showFlex","selectedDefault","bootbox","alert","showPopup","config","settings","type","height","width","callBack","resizable","extend","ajax","url","module","success","data","status","error","objAJAXRequest","strError","response","getXmlHttpObject","objXMLHttp","XMLHttpRequest","e","ActiveXObject","def_price_save_handleTimeout","printString","style","display","innerHTML","def_price_retreive_handleTimeout","SaveDefPricingComplete","readyState","RetrieveDefPricingComplete","responseText","pricingArray","split","RidMap","key","item","totalCurrentlyWebVisible","ctsItemRows","rows","id","indexOf","itemNumber","substr","rid","overrideElemName","overrideElem","showCustomerBox","is_web_visible","checked","hideEverywhereBox","SavePricing","payLoad","currentPrice","menuInfo","mid","previewPrice","basePrice","base_price","show_to_customer","hide_completely","storeInfo","onreadystatechange","open","setRequestHeader","send","setTimeout","RetrievePricing","uniqueEFLEntreeId","is_unsaved","current2ServMarkup","current3ServMarkup","current4ServMarkup","current6ServMarkup","currentSidesMarkup","currentAssemblyFee","currentDeliveryAssemblyFee","formatAsMoney","markupData","delivery_assembly_fee","assembly_fee","markup_value_2_serving","markup_value_3_serving","markup_value_4_serving","markup_value_6_serving","markup_value_sides","itemRows","getAttribute","ltd_menu_item_value","supports_ltd_roundup","is_chef_touched","sidesCount","overridePrice","orgOverridePrice","markupPrice","pricing_type","round","ORdelta","newPriceByMarkUp","isEnabled_Markup","visFlag","orgState","EFL_itemRows","entreeId","includes","push","markdown_change","markdown","markdown_value","original_markdown","markedDownPrice","discount","MUdelta","abs","picFlag","hidFlag","formFlag","confirm_and_check_form","form","validated","_check_form","warnOffOfEmptyMarkups","encounteredBasePriceIssue","problemItemList","menu_item_name","markdownObj","markDownPostObj","el","createElement","setAttribute","idStr","appendChild","finalizeMessage","getMarkUpPrice","servingsSize","addUnsavedEFLItem","item_id","name","size","thisItemCount","countItemsInRecipe","insertCellNum","row","insertRow","cellLeft","insertCell","visBox","cellLeft2","pickBox","cellName","nameNode","createTextNode","cellSize","cellbase","markup_price","cellcurrent","cellmarkup","celloverride","cellmarkdown","buttonTextNode","addUnsavedSideItem","category_label","tbl","cellLeft3","isEnabled_Markup_Sides","cellpreview","cellremaining","giveTabFocus","Proxy","URLSearchParams","window","location","search","get","searchParams","prop","tabs","substring","click","ready","on","menu_item_id","checkedState","is_store_special","uiTableFilter","change","Modernizr","input","placeholder","focus","blur","tempArr","markdownVal","div_id","noOk","start_price","newDiscount","targetPrice","newPercentage","buttons","Accept","Cancel","new_button","replaceWith","displayModalWaitDialog","closeOnEscape","menu_id","event","ui","hide","Okay","entreeList","thisEntree","timeout","dataType","processor","store_id","STORE_DETAILS","op","entree_ids","json","processor_success","entree_id","results","count","items","handledCount","processor_message","close","bounce","hasClass","addClass","recipe_id","tr","clone","show","append","removeClass","handle_tabbed_content","errorMissingCategory","categoryLabel","css","console","log","subcategory_label","documentElement","body","animate","scrollTop","offset","top","oldCategory"],"sourceRoot":"js/src/dreamdinners/admin","sources":["menu_editor.js"],"sourcesContent":["let numberOfCustomerFacingCTSItems = 0;\nlet numberOfCustomerFacingEFLItems = 0;\nlet sidesDataArray = [];\nlet gNumOptionalsAdded = 0;\nlet notShown = true;\nlet dp_processing = false;\nlet xmlHttp = null;\nlet noOverrideUnderBase = false;\n\nfunction resetPage()\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction getPreviewItemPrice(itemID)\n{\n\t// does not exist so return the current price\n\tlet ovrPrice = Number($(\"#ovr_\" + itemID).val());\n\n\tif (isNaN(ovrPrice) || ovrPrice.valueOf() == 0)\n\t{\n\t\t// does not exist so return the markup price\n\t\treturn Number($(\"#row_\" + itemID + \" > .preview-price\").text());\n\t}\n\n\treturn ovrPrice;\n}\n\nfunction removeOptionSelected()\n{\n\tlet elSel = document.getElementById('sides');\n\tfor (let i = elSel.length - 1; i >= 1; i--)\n\t{\n\t\tif (elSel.options[i].selected)\n\t\t{\n\t\t\telSel.remove(i);\n\t\t}\n\t}\n}\n\nfunction removeItem(itemNum)\n{\n\tgNumOptionalsAdded--;\n\tlet rowID = \"row_\" + itemNum;\n\tlet rowObj = document.getElementById(rowID);\n\trowObj.parentNode.removeChild(rowObj);\n\n\tlet sidesData = sidesDataArray[itemNum];\n\tlet sideName = \"(\" + sidesData['SUPC_number'] + \") \" + sidesData['name'];\n\n\tlet selObj = document.getElementById('sides');\n\n\tselObj.options[selObj.length] = new Option(sideName, itemNum);\n\n\tcalculatePage();\n}\n\nfunction displayValidationErrorMsg(msg)\n{\n\tmsg = \"<span style='color:red; font-size:larger;'>\" + msg + \"</span>\";\n\n\tdd_message({\n\t\ttitle: 'Error',\n\t\tmessage: msg\n\t});\n}\n\nfunction clearErrors()\n{\n\t$('#errorMsgText').html('');\n\t$('#errorMsg').hideFlex();\n}\n\nfunction storeChange(obj)\n{\n\tdocument.getElementById('action').value = \"storeChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction menuChange(obj)\n{\n\tdocument.getElementById('action').value = \"menuChange\";\n\tdocument.getElementById('menu_editor_form').submit();\n}\n\nfunction confirm_and_round_form(tab)\n{\n\tconst finalizeMessage = \"Are you sure want to update all Override Prices with rounded Markup Prices? \" +\n\t\t\"This action will replace existing override prices with the newly calculated price.\";\n\tlet hasOverridePrice = false;\n\t$('.' + tab + '-override-price-input').each(function () {\n\t\t\thasOverridePrice = $(this).val().trim() !== '';\n\t\t}\n\t);\n\n\tif (hasOverridePrice)\n\t{\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tround_markup_to_override(tab);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n\telse\n\t{\n\t\tround_markup_to_override(tab);\n\t}\n\n\treturn false;\n}\n\nfunction round_markup_to_override(tab)\n{\n\tlet dirty = false;\n\t$('.markup-price').each(function (index) {\n\t\tif ($(this).is('[readonly]'))\n\t\t{\n\t\t\t//nothing;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet o_input = $(this).parent().find('.' + tab + '-override-price-input');\n\t\t\tif (o_input.length)\n\t\t\t{\n\t\t\t\tlet price = parseFloat($(this).text());\n\t\t\t\tlet o_price = Math.ceil(price * 2) / 2;\n\t\t\t\to_input.val(o_price.toFixed(2));\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (dirty)\n\t{\n\t\tcalculatePage();\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\n}\n\nfunction selectedDefault()\n{\n\tif (notShown)\n\t{\n\t\tbootbox.alert(\"Any Menus that do not currently have their own specific settings finalized will inherit these default settings.\");\n\t\tnotShown = false;\n\t}\n\n\tcalculatePage();\n}\n\nfunction showPopup(config)\n{\n\tvar settings = { //defaults\n\t\ttype: 'GET',\n\t\theight: 500,\n\t\twidth: 600,\n\t\tmodal: false,\n\t\tcallBack: false,\n\t\tresizable: true\n\t};\n\n\t$.extend(settings, config);\n\n\t$.ajax({\n\t\turl: '?' + settings.module,\n\t\ttype: settings.type,\n\t\tsuccess: function (data, status) {\n\t\t\tsettings.message = data;\n\n\t\t\tdd_message(settings);\n\n\t\t\tif (typeof settings.callBack == 'function')\n\t\t\t{\n\t\t\t\tsettings.callBack();\n\t\t\t}\n\t\t},\n\t\terror: function (objAJAXRequest, strError) {\n\t\t\tresponse = 'Unexpected error';\n\t\t}\n\t});\n}\n\nfunction getXmlHttpObject()\n{\n\tlet objXMLHttp = null;\n\n\ttry\n\t{\n\t\t// Opera 8.0+, Firefox, Safari\n\t\tobjXMLHttp = new XMLHttpRequest();\n\t}\n\tcatch (e)\n\t{\n\t\t// Internet Explorer Browsers\n\t\ttry\n\t\t{\n\t\t\tobjXMLHttp = new ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tobjXMLHttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\t// Something went wrong\n\t\t\t}\n\t\t}\n\t}\n\n\treturn objXMLHttp;\n}\n\nfunction def_price_save_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction def_price_retreive_handleTimeout()\n{\n\tif (dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tlet printString = \"The server has not responded. Please try again.\";\n\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t}\n}\n\nfunction SaveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\tlet printString = \"Sides &amp; Sweets default pricing has been saved\";\n\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t}\n}\n\nfunction RetrieveDefPricingComplete()\n{\n\tif ((xmlHttp.readyState == 4 || xmlHttp.readyState == \"complete\") && dp_processing)\n\t{\n\t\tdp_processing = false;\n\n\t\tif (xmlHttp.responseText && xmlHttp.responseText != \"error\" && xmlHttp.responseText != \"\")\n\t\t{\n\t\t\tlet pricingArray = xmlHttp.responseText.split(\"|\");\n\t\t\tlet RidMap = [];\n\t\t\tfor (let key in pricingArray)\n\t\t\t{\n\t\t\t\tvar item = pricingArray[key].split(\"~\");\n\t\t\t\tif (item[0])\n\t\t\t\t{\n\t\t\t\t\tRidMap[item[0]] = [\n\t\t\t\t\t\titem[1],\n\t\t\t\t\t\titem[2],\n\t\t\t\t\t\titem[3]\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcalculatePage();\n\n\t\t\tlet totalCurrentlyWebVisible = numberOfCustomerFacingCTSItems;\n\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tif (RidMap[rid])\n\t\t\t\t{\n\t\t\t\t\tlet overrideElemName = 'ovr_' + itemNumber;\n\t\t\t\t\tlet overrideElem = document.getElementById(overrideElemName);\n\t\t\t\t\tif (overrideElem)\n\t\t\t\t\t{\n\t\t\t\t\t\toverrideElem.value = RidMap[rid][2];\n\t\t\t\t\t}\n\n\t\t\t\t\tlet showCustomerBox = document.getElementById('vis_' + itemNumber);\n\n\t\t\t\t\tlet is_web_visible = showCustomerBox.checked;\n\n\t\t\t\t\tif (showCustomerBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][0] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!is_web_visible && totalCurrentlyWebVisible < 20)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = true;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (is_web_visible)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tshowCustomerBox.checked = false;\n\t\t\t\t\t\t\t\ttotalCurrentlyWebVisible--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet hideEverywhereBox = document.getElementById('hid_' + itemNumber);\n\t\t\t\t\tif (hideEverywhereBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (RidMap[rid][1] == \"1\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideEverywhereBox.checked = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcalculatePage();\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'none';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\tlet printString = \"There was an error when retrieving the default prices. Please try again.\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = 'block';\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = printString;\n\t\t}\n\t}\n}\n\nfunction SavePricing()\n{\n\tdd_message({\n\t\ttitle: 'Save Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to save the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\t\t\tlet payLoad = \"data=\";\n\t\t\t// Chef Touched Selections\n\t\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\t\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t\t{\n\t\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet itemNumber = null;\n\t\t\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\t\t\tlet rid = document.getElementById('rec_id_' + itemNumber).innerHTML;\n\n\t\t\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\t\t\t\tlet previewPrice = Number($(\"#row_\" + itemNumber + \" > .preview-price\").text());\n\t\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\t\tif (previewPrice != \"\" && previewPrice != 0 && !isNaN(previewPrice))\n\t\t\t\t{\n\t\t\t\t\tcurrentPrice = previewPrice;\n\t\t\t\t}\n\n\t\t\t\tif (currentPrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"none\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").style.display = \"block\";\n\t\t\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"Override price must be greater than the price.\";\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet show_to_customer = \"0\";\n\n\t\t\t\tif (document.getElementById('vis_' + itemNumber) && document.getElementById('vis_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\tshow_to_customer = \"1\";\n\t\t\t\t}\n\n\t\t\t\tlet hide_completely = \"0\";\n\t\t\t\tif (document.getElementById('hid_' + itemNumber) && document.getElementById('hid_' + itemNumber).checked)\n\t\t\t\t{\n\t\t\t\t\thide_completely = \"1\";\n\t\t\t\t}\n\n\t\t\t\tpayLoad += rid + \"~\" + show_to_customer + \"~\" + hide_completely + \"~\" + currentPrice + \"|\";\n\t\t\t}\n\n\t\t\txmlHttp = getXmlHttpObject();\n\t\t\tif (xmlHttp == null)\n\t\t\t{\n\t\t\t\t// temporary\n\t\t\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tlet url = \"/processor?processor=admin_defaultPricingProcessor&action=save&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = SaveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"POST\", url, true);\n\t\t\txmlHttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t\t\txmlHttp.setRequestHeader(\"Content-length\", payLoad.length);\n\t\t\txmlHttp.setRequestHeader(\"Connection\", \"close\");\n\t\t\txmlHttp.send(payLoad);\n\n\t\t\tsetTimeout(\"def_price_save_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction RetrievePricing()\n{\n\tif (dp_processing)\n\t{\n\t\treturn;\n\t}\n\n\txmlHttp = getXmlHttpObject();\n\tif (xmlHttp == null)\n\t{\n\t\t// temporary\n\t\tbootbox.alert(\"The Default Pricing function is not compatible with your browser. Please contact your store for assistance.\");\n\t\treturn;\n\t}\n\n\tdd_message({\n\t\ttitle: 'Retrieve Default Pricing and Visibility',\n\t\tmessage: 'Are you sure you want to retrieve the default Sides and Sweets pricing and visibility? This cannot be undone.',\n\t\tconfirm: function () {\n\n\t\t\tdocument.getElementById('dp_proc_mess').style.display = \"inline\";\n\t\t\tdocument.getElementById(\"dp_error\").style.display = \"none\";\n\t\t\tdocument.getElementById(\"dp_error\").innerHTML = \"\";\n\n\t\t\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=retrieve&store_id=\" + storeInfo.id;\n\t\t\t//\tvar url = \"/processor?processor=admin_defaultPricingProcessor&action=save&data=\" + payLoad + \"&store_id=<?=$this->store_id?>\";\n\t\t\txmlHttp.onreadystatechange = RetrieveDefPricingComplete;\n\n\t\t\txmlHttp.open(\"GET\", url, true);\n\t\t\txmlHttp.send(null);\n\n\t\t\tsetTimeout(\"def_price_retreive_handleTimeout();\", 20000);\n\t\t\tdp_processing = true;\n\t\t},\n\t\tcancel: function () {\n\t\t}\n\t});\n\n}\n\nfunction calculatePage()\n{\n\tnumberOfCustomerFacingCTSItems = 0;\n\tnumberOfCustomerFacingEFLItems = 0;\n\n\tlet uniqueEFLEntreeId = [];\n\tlet is_unsaved = false;\n\n\tlet sidesCount = 0;\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet currentAssemblyFee = ((!$('#assembly_fee').val()) ? null : $('#assembly_fee').val());\n\tlet currentDeliveryAssemblyFee = ((!$('#delivery_assembly_fee').val()) ? null : $('#delivery_assembly_fee').val());\n\n\tif ($('#delivery_assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.delivery_assembly_fee) != formatAsMoney(currentDeliveryAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 1\");\n\t\t}\n\t}\n\n\tif ($('#assembly_fee').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.assembly_fee) != formatAsMoney(currentAssemblyFee))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 2\");\n\t\t}\n\t}\n\n\tif ($('#markup_2_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_2_serving) != formatAsMoney(current2ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 3\");\n\t\t}\n\t}\n\n\tif ($('#markup_3_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_3_serving) != formatAsMoney(current3ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 4\");\n\t\t}\n\t}\n\n\tif ($('#markup_4_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_4_serving) != formatAsMoney(current4ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 5\");\n\t\t}\n\t}\n\n\tif ($('#markup_6_serving').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_6_serving) != formatAsMoney(current6ServMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 6\");\n\t\t}\n\t}\n\n\tif ($('#markup_sides').length != 0)\n\t{\n\t\tif (formatAsMoney(markupData.markup_value_sides) != formatAsMoney(currentSidesMarkup))\n\t\t{\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 7\");\n\t\t}\n\t}\n\n\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\tfor (let i = 0; i < itemRows.length; i++)\n\t{\n\t\tif (itemRows[i].id.indexOf('row_') == -1 && itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\n\t\tif (itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tlet ltd_menu_item_value = 0;\n\t\tif (storeInfo.supports_ltd_roundup == 1)\n\t\t{\n\t\t\tltd_menu_item_value = Number(formatAsMoney(menuInfo.mid[itemNumber].ltd_menu_item_value));\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tif (overridePrice > 0 && ltd_menu_item_value > 0)\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney((overridePrice * 1) + (ltd_menu_item_value * 1)));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.000000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\n\t\t\t\tif (ltd_menu_item_value > 0)\n\t\t\t\t{\n\t\t\t\t\tmarkupPrice = Number((markupPrice * 1) + (ltd_menu_item_value * 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (isEnabled_Markup && newPriceByMarkUp > 0 && overridePrice == 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 9\");\n\t\t}\n\t\telse if (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 10\");\n\t\t}\n\t\telse if (isEnabled_Markup && overridePrice > 0 && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 11\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\torgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 12\");\n\t\t\t}\n\t\t}\n\t}\n\n\t// EFL Items\n\n\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t{\n\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1 && EFL_itemRows[i].id != 'addonEditorRow')\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\tif (EFL_itemRows[i].id == 'addonEditorRow')\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].getAttribute('item_id');\n\t\t\tif (!itemNumber)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemNumber = EFL_itemRows[i].id.substr(4);\n\t\t}\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (!$('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tlet entreeId = $('#vis_' + itemNumber).data('entree_id');\n\n\t\t\tif (!uniqueEFLEntreeId.includes(entreeId))\n\t\t\t{\n\t\t\t\tnumberOfCustomerFacingEFLItems++;\n\t\t\t\tuniqueEFLEntreeId.push(entreeId);\n\t\t\t}\n\n\t\t}\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tif (itemNumber == 13944)\n\t\t{\n\t\t\tlet x = 1;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\t// if current markup then update markup column\n\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\n\t\tif (menuInfo.mid[itemNumber].pricing_type == \"HALF\")\n\t\t{\n\t\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current3ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"TWO\")\n\t\t{\n\t\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current2ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse if (menuInfo.mid[itemNumber].pricing_type == \"FOUR\")\n\t\t{\n\t\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse // menuInfo.mid[itemNumber].pricing_type == \"FULL\"\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current4ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\t\telse // servingSize == \"FULL\"\n\t\t{\n\t\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t\t{\n\t\t\t\tmarkupPrice = basePrice;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * current6ServMarkup) + 0.00000001) / 100));\n\t\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t\t}\n\t\t}\n\n\t\tlet markdown_change = false;\n\t\t// At this point we know the new price... apply the markdown if it exists\n\t\tif (isEnabled_Markup && $('#mkdn_' + itemNumber)[0])\n\t\t{\n\t\t\tlet markdown = $('#mkdn_' + itemNumber);\n\t\t\tlet markdown_value = formatAsMoney(markdown.data('markdown_value'));\n\t\t\tlet original_markdown = markdown.data('org_val');\n\t\t\tlet markedDownPrice = 0;\n\t\t\tif (overridePrice > 0)\n\t\t\t{\n\t\t\t\toverridePrice -= formatAsMoney(overridePrice * (markdown_value / 100));\n\t\t\t\tmarkedDownPrice = overridePrice;\n\t\t\t}\n\t\t\telse if (markupPrice > 0)\n\t\t\t{\n\t\t\t\tlet discount = Number(formatAsMoney(markupPrice * (markdown_value / 100)));\n\t\t\t\tmarkupPrice = formatAsMoney((markupPrice * 100) / 100);\n\t\t\t\tmarkupPrice = Math.round((markupPrice - discount.valueOf()) * 100) / 100;\n\t\t\t\tmarkedDownPrice = markupPrice;\n\t\t\t}\n\n\t\t\tif (original_markdown != markdown_value)\n\t\t\t{\n\t\t\t\tmarkdown_change = true;\n\t\t\t}\n\n\t\t}\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tif (Math.abs(ORdelta) < .005)\n\t\t{\n\t\t\tORdelta = 0;\n\t\t}\n\t\tif (Math.abs(MUdelta) < .005)\n\t\t{\n\t\t\tMUdelta = 0;\n\t\t}\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 13\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 14\");\n\t\t}\n\t\telse if (markdown_change)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markedDownPrice));\n\t\t\tis_unsaved = true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 15\");\n\t\t\t}\n\t\t}\n\n\t\tlet picFlag = document.getElementById(\"pic_\" + itemNumber);\n\t\tif (picFlag)\n\t\t{\n\t\t\tlet orgState = picFlag.getAttribute('data-orgval');\n\t\t\tif ((picFlag.checked && orgState != 'CHECKED') || (!picFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 16\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\t// Chef Touched Selections\n\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t{\n\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet itemNumber = null;\n\t\titemNumber = ctsItemRows[i].id.substr(4);\n\n\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\tlet currentPrice = Number(menuInfo.mid[itemNumber].price);\n\n\t\tif (menuInfo.mid[itemNumber].is_chef_touched == '1')\n\t\t{\n\t\t\tsidesCount++;\n\t\t}\n\n\t\tlet overridePrice = Number(0);\n\t\tlet orgOverridePrice = Number(0);\n\n\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t{\n\t\t\toverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).value));\n\t\t\torgOverridePrice = Number(formatAsMoney(document.getElementById('ovr_' + itemNumber).getAttribute('data-orgval')));\n\t\t}\n\n\t\tlet markupPrice = null;\n\n\t\tif ($('#vis_' + itemNumber).is(':checked'))\n\t\t{\n\t\t\tnumberOfCustomerFacingCTSItems++;\n\t\t}\n\n\t\tif (currentSidesMarkup == 0 || currentSidesMarkup == null || currentSidesMarkup == \"\")\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html();\n\t\t\tmarkupPrice = basePrice;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice + (Math.round((basePrice * currentSidesMarkup) + 0.00000001) / 100));\n\t\t\t$(\"#row_\" + itemNumber + \" > .markup-price\").html(markupPrice);\n\t\t}\n\n\t\tmarkupPrice = formatAsMoney(markupPrice) * 1;\n\n\t\tlet ORdelta = overridePrice - currentPrice;\n\t\tlet MUdelta = markupPrice - currentPrice;\n\n\t\tlet newPriceByMarkUp = false;\n\t\tif (MUdelta != 0 && ORdelta != 0)\n\t\t{\n\t\t\tnewPriceByMarkUp = true;\n\t\t}\n\n\t\tif (overridePrice > 0 && ORdelta != 0)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(overridePrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 17\");\n\t\t}\n\t\telse if (isEnabled_Markup && newPriceByMarkUp)\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text(formatAsMoney(markupPrice));\n\t\t\tis_unsaved = true;\n\t\t\t//dd_console_log(\"Unsaved 18\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(\"#row_\" + itemNumber + \" > .preview-price\").text('');\n\t\t}\n\n\t\tlet visFlag = document.getElementById(\"vis_\" + itemNumber);\n\t\tif (visFlag)\n\t\t{\n\t\t\tlet orgState = visFlag.getAttribute('data-orgval');\n\t\t\tif ((visFlag.checked && orgState != 'CHECKED') || (!visFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 19\");\n\t\t\t}\n\t\t}\n\n\t\tlet hidFlag = document.getElementById(\"hid_\" + itemNumber);\n\t\tif (hidFlag)\n\t\t{\n\t\t\tlet orgState = hidFlag.getAttribute('data-orgval');\n\t\t\tif ((hidFlag.checked && orgState != 'CHECKED') || (!hidFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 20\");\n\t\t\t}\n\t\t}\n\n\t\tlet formFlag = document.getElementById(\"form_\" + itemNumber);\n\t\tif (formFlag)\n\t\t{\n\t\t\tlet orgState = formFlag.getAttribute('data-orgval');\n\t\t\tif ((formFlag.checked && orgState != 'CHECKED') || (!formFlag.checked && orgState == 'CHECKED'))\n\t\t\t{\n\t\t\t\tis_unsaved = true;\n\t\t\t\t//dd_console_log(\"Unsaved 21\");\n\t\t\t}\n\t\t}\n\n\t}\n\n\tif (gNumOptionalsAdded != 0)\n\t{\n\t\tis_unsaved = true;\n\t\t//dd_console_log(\"Unsaved 22\");\n\t}\n\n\tif (is_unsaved)\n\t{\n\t\t$('#saved_message, #saved_message_2').showFlex();\n\t}\n\telse\n\t{\n\t\t$('#saved_message, #saved_message_2').hideFlex();\n\t}\n}\n\nfunction confirm_and_check_form()\n{\n\tlet form = $(\"#menu_editor_form\")[0];\n\n\tclearErrors();\n\n\tlet validated = _check_form(form);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\tlet currentSidesMarkup = ((!$('#markup_sides').val()) ? null : $('#markup_sides').val());\n\tlet warnOffOfEmptyMarkups = false;\n\n\tlet currentVolumeReward = \"0\";\n\n\tlet message = \"\";\n\n\tif (validated)\n\t{\n\t\tif (current2ServMarkup < 0 || current4ServMarkup < 0 || current3ServMarkup < 0 || current6ServMarkup < 0 || currentSidesMarkup < 0)\n\t\t{\n\t\t\tmessage = \"Negative per cent markups are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (current2ServMarkup > 70 || current4ServMarkup > 70 || current3ServMarkup > 70 || current6ServMarkup > 70 || currentSidesMarkup > 70)\n\t\t{\n\t\t\tmessage += \"Markups greater than 70% are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward < 0)\n\t\t{\n\t\t\tmessage += \"Negative volume discounts are not permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward > 75)\n\t\t{\n\t\t\tmessage += \"Volume Dscounts greater than $75.00 are not currently permitted.<br />\";\n\t\t}\n\n\t\tif (currentVolumeReward == \"\")\n\t\t{\n\t\t\tmessage += \"Please supply a valid volume discount. Use zero if you want no volume discount applied.<br />\";\n\t\t}\n\n\t\tif (($('#markup_2_serving').length != 0 && current2ServMarkup == null) || ($('#markup_4_serving').length != 0 && current4ServMarkup == null) || ($('#markup_3_serving').length != 0 && current3ServMarkup == null) || ($('#markup_6_serving').length != 0 && current6ServMarkup == null) || ($('#markup_sides').length != 0 && currentSidesMarkup == null))\n\t\t{\n\t\t\twarnOffOfEmptyMarkups = true;\n\t\t}\n\n\t\tlet assembly_fee = ((!$('#assembly_fee').val()) ? 0 : $('#assembly_fee').val());\n\t\tif (assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet delivery_assembly_fee = ((!$('#delivery_assembly_fee').val()) ? 0 : $('#delivery_assembly_fee').val())\n\t\tif (delivery_assembly_fee < 0)\n\t\t{\n\t\t\tmessage += \"The Delivery Assembly Fee must be greater than or equal to 0.<br />\";\n\t\t}\n\n\t\tlet itemRows = document.getElementById('itemsTbl').rows;\n\n\t\tlet encounteredBasePriceIssue = false;\n\t\tlet problemItemList = \"\";\n\n\t\tfor (let i = 0; i < itemRows.length; i++)\n\t\t{\n\t\t\tif (itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\n\n\t\tfor (let i = 0; i < EFL_itemRows.length; i++)\n\t\t{\n\t\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = EFL_itemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\n\t\t\tlet markdownObj = $(\"#mkdn_\" + itemNumber)[0];\n\t\t\tlet markDownPostObj = $(\"#upd_mkdn_\" + itemNumber)[0];\n\n\t\t\tif (markdownObj)\n\t\t\t{\n\t\t\t\tlet value = $(markdownObj).data(\"markdown_id\") + \"|\" + $(markdownObj).data(\"markdown_value\");\n\n\t\t\t\tif (!markDownPostObj)\n\t\t\t\t{\n\t\t\t\t\tlet el = document.createElement('input');\n\t\t\t\t\tel.setAttribute(\"type\", \"hidden\");\n\t\t\t\t\tel.setAttribute(\"value\", value);\n\t\t\t\t\tlet idStr = \"upd_mkdn_\" + itemNumber;\n\t\t\t\t\tel.setAttribute(\"id\", idStr);\n\t\t\t\t\tel.setAttribute(\"name\", idStr);\n\t\t\t\t\tmarkdownObj.appendChild(el);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmarkDownPostObj.val(value);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\n\t\t\t\t}\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tlet ctsItemRows = document.getElementById('ctsItemsTbl').rows;\n\n\t\tfor (let i = 0; i < ctsItemRows.length; i++)\n\t\t{\n\t\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet itemNumber = ctsItemRows[i].id.substr(4);\n\t\t\tlet basePrice = Number(menuInfo.mid[itemNumber].base_price);\n\t\t\tlet overridePrice = \"\";\n\n\t\t\tif (document.getElementById('ovr_' + itemNumber))\n\t\t\t{\n\t\t\t\toverridePrice = Number(document.getElementById('ovr_' + itemNumber).value);\n\t\t\t}\n\n\t\t\tif (overridePrice && overridePrice != \"\")\n\t\t\t{\n\t\t\t\tif (noOverrideUnderBase && overridePrice < basePrice)\n\t\t\t\t{\n\t\t\t\t\tencounteredBasePriceIssue = true;\n\t\t\t\t\tproblemItemList += menuInfo.mid[itemNumber].menu_item_name + \"<br />\";\n\t\t\t\t}\n\n\t\t\t\tif (overridePrice > 999)\n\t\t\t\t{\n\t\t\t\t\tmessage += \"The Override Price must be less than $999.00<br />\";\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (encounteredBasePriceIssue)\n\t\t{\n\t\t\tmessage += \"The Override Price must be greater than the base price for:<br />\";\n\t\t\tmessage += problemItemList;\n\n\t\t}\n\n\t\tif (message != \"\")\n\t\t{\n\t\t\tvalidated = false;\n\t\t\tdisplayValidationErrorMsg(message);\n\t\t}\n\t}\n\n\tif (validated)\n\t{\n\t\tlet finalizeMessage = \"Are you sure want to submit these changes to your menu? If the menu is active the changes will be immediately available to your customers.\";\n\n\t\tif (warnOffOfEmptyMarkups)\n\t\t{\n\t\t\tfinalizeMessage += \"<br /><br /><span class='text-red font-weight-bold'>One or more of the Percentage MarkUp values is empty or 0. Please review and correct if this was unintentional.</span><br />\";\n\t\t}\n\n\t\tdd_message({\n\t\t\ttitle: 'Attention',\n\t\t\tmessage: finalizeMessage,\n\t\t\tmodal: true,\n\t\t\tconfirm: function () {\n\t\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\t\t$(\"#menu_editor_form\").submit();\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tcancel: function () {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\t/*\n\t\tif (confirm(finalizeMessage))\n\t\t{\n\t\t\tdocument.getElementById('action').value = \"finalize\";\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\t*/\n\t}\n\n\treturn false;\n}\n\nfunction getMarkUpPrice(servingsSize, basePrice)\n{\n\n\tlet markupPrice = Number(basePrice);\n\tbasePrice = Number(basePrice);\n\n\tlet current2ServMarkup = ((!$('#markup_2_serving').val()) ? null : $('#markup_2_serving').val());\n\tlet current3ServMarkup = ((!$('#markup_3_serving').val()) ? null : $('#markup_3_serving').val());\n\tlet current4ServMarkup = ((!$('#markup_4_serving').val()) ? null : $('#markup_4_serving').val());\n\tlet current6ServMarkup = ((!$('#markup_6_serving').val()) ? null : $('#markup_6_serving').val());\n\n\t// if current markup then update markup column\n\tif (servingsSize == \"Sm (2)\")\n\t{\n\t\tif (current2ServMarkup == 0 || current2ServMarkup == null || current2ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current2ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (4)\")\n\t{\n\t\tif (current4ServMarkup == 0 || current4ServMarkup == null || current4ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current4ServMarkup) / 100));\n\t\t}\n\t}\n\telse if (servingsSize == \"Md (3)\")\n\t{\n\t\tif (current3ServMarkup == 0 || current3ServMarkup == null || current3ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current3ServMarkup) / 100));\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (current6ServMarkup == 0 || current6ServMarkup == null || current6ServMarkup == \"\")\n\t\t{\n\t\t\tmarkupPrice = basePrice.valueOf();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmarkupPrice = formatAsMoney(basePrice.valueOf() + (Math.round(basePrice.valueOf() * current6ServMarkup) / 100));\n\t\t}\n\t}\n\n\treturn markupPrice;\n}\n\nfunction addUnsavedEFLItem(item_id, name, size, base_price, thisItemCount, countItemsInRecipe)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('EFLitemsTbl');\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(0);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(++insertCellNum);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"pic_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(++insertCellNum);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(++insertCellNum);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\n\tvar el = document.createTextNode(size);\n\tcellSize.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// basePrice cell\n\t\tvar cellbase = row.insertCell(++insertCellNum);\n\t\tcellbase.setAttribute(\"class\", \"align-middle\");\n\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t\tcellbase.appendChild(el);\n\n\t\tvar markup_price = getMarkUpPrice(size, base_price);\n\t}\n\n\t// currentPrice cell\n\tvar cellcurrent = row.insertCell(++insertCellNum);\n\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\n\tif (isEnabled_Markup)\n\t{\n\t\tvar el = document.createTextNode(markup_price);\n\t}\n\telse\n\t{\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t}\n\tcellcurrent.appendChild(el);\n\n\tif (isEnabled_Markup)\n\t{\n\t\t// markupPrice cell\n\t\tvar cellmarkup = row.insertCell(++insertCellNum);\n\t\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\n\t\tvar el = document.createTextNode(markup_price);\n\t\tcellmarkup.appendChild(el);\n\t}\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"0.01\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", formatAsMoney(base_price));\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tif (!isEnabled_Markup)\n\t{\n\t\tel.setAttribute(\"value\", formatAsMoney(base_price));\n\t}\n\tcelloverride.appendChild(el);\n\n\t// markdown\n\tvar cellmarkdown = row.insertCell(++insertCellNum);\n\n\tvar el = document.createElement('button');\n\tvar idStr = \"add-mkdn_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"class\", \"btn btn-primary btn-sm\");\n\tvar buttonTextNode = document.createTextNode(\"Add\");\n\tel.appendChild(buttonTextNode);\n\n\tcellmarkdown.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(++insertCellNum);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n}\n\nfunction addUnsavedSideItem(item_id, name, size, base_price, category_label)\n{\n\tlet insertCellNum = 0;\n\n\tif (item_id == 0)\n\t{\n\t\treturn;\n\t} // do nothing\n\n\tvar tbl = document.getElementById('ctsItemsTbl');\n\n\tif ($('#temp_category').length == 0)\n\t{\n\t\tvar row = tbl.insertRow(-1);\n\t\trow.setAttribute(\"id\", \"temp_category\");\n\n\t\tvar cellName = row.insertCell(0);\n\t\tcellName.setAttribute(\"class\", \"font-weight-bold py-3\");\n\t\tcellName.setAttribute(\"colspan\", \"11\");\n\t\tvar nameNode = document.createTextNode('Newly Added Items');\n\t\tcellName.appendChild(nameNode);\n\t}\n\n\tvar row = tbl.insertRow(-1);\n\trow.setAttribute(\"id\", \"row_\" + item_id);\n\n\t// visibility cell\n\tvar cellLeft = row.insertCell(insertCellNum++);\n\n\tvar visBox = document.createElement(\"input\");\n\n\tvisBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"vis_\" + item_id;\n\tvisBox.setAttribute(\"id\", idStr);\n\tvisBox.setAttribute(\"name\", idStr);\n\tvisBox.setAttribute(\"class\", \"align-middle\");\n\tvisBox.setAttribute(\"data-orgval\", \"CHECKED\");\n\tvisBox.setAttribute(\"data-menu_item_id\", item_id);\n\tvisBox.setAttribute(\"checked\", \"checked\");\n\tcellLeft.appendChild(visBox);\n\n\t// picksheet cell\n\tvar cellLeft2 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"form_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft2.appendChild(pickBox);\n\n\t// hide everywhere cell\n\tvar cellLeft3 = row.insertCell(insertCellNum++);\n\n\tvar pickBox = document.createElement(\"input\");\n\n\tpickBox.setAttribute(\"type\", \"checkbox\");\n\tvar idStr = \"hid_\" + item_id;\n\tpickBox.setAttribute(\"id\", idStr);\n\tpickBox.setAttribute(\"name\", idStr);\n\tpickBox.setAttribute(\"class\", \"align-middle\");\n\tpickBox.setAttribute(\"data-orgval\", \"\");\n\tpickBox.setAttribute(\"step\", \"any\");\n\n\tcellLeft3.appendChild(pickBox);\n\n\t// name cell\n\tvar cellName = row.insertCell(insertCellNum++);\n\tcellName.setAttribute(\"class\", \"align-middle text-left\");\n\tvar nameNode = document.createTextNode(name);\n\tcellName.appendChild(nameNode);\n\n\t// size cell\n\tvar cellSize = row.insertCell(insertCellNum++);\n\tcellSize.setAttribute(\"class\", \"align-middle\");\n\tvar el = document.createTextNode('1 item');\n\tcellSize.appendChild(el);\n\n\tif (isEnabled_Markup_Sides)\n\t{\n\t\t// basePrice cell\n\t\tvar cellbase = row.insertCell(insertCellNum++);\n\t\tcellbase.setAttribute(\"class\", \"align-middle\");\n\t\tvar el = document.createTextNode(formatAsMoney(base_price));\n\t\tcellbase.appendChild(el);\n\n\t\tvar markup_price = getMarkUpPrice(size, base_price);\n\n\t\t// currentPrice cell\n\t\tvar cellcurrent = row.insertCell(insertCellNum++);\n\t\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\t\tvar el = document.createTextNode(markup_price);\n\t\tcellcurrent.appendChild(el);\n\n\t\t// markupPrice cell\n\t\tvar cellmarkup = row.insertCell(insertCellNum++);\n\t\tcellmarkup.setAttribute(\"class\", \"align-middle markup-price\");\n\t\tvar el = document.createTextNode(markup_price);\n\t\tcellmarkup.appendChild(el);\n\t}\n\n\tif (!isEnabled_Markup_Sides)\n\t{\n\t\t// currentPrice cell\n\t\tvar cellcurrent = row.insertCell(insertCellNum++);\n\t\tcellcurrent.setAttribute(\"class\", \"align-middle\");\n\t\tvar el = document.createTextNode(base_price);\n\t\tcellcurrent.appendChild(el);\n\t}\n\n\t// overridePrice cell\n\tvar celloverride = row.insertCell(insertCellNum++);\n\tvar el = document.createElement('input');\n\tel.setAttribute(\"type\", \"number\");\n\tel.setAttribute(\"size\", \"3\");\n\tel.setAttribute(\"step\", \"0.01\");\n\n\tel.setAttribute(\"class\", \"form-control form-control-sm no-spin-button\");\n\n\tel.setAttribute(\"maxlength\", \"6\");\n\tel.setAttribute(\"data-orgval\", formatAsMoney(base_price));\n\n\tvar idStr = \"ovr_\" + item_id;\n\tel.setAttribute(\"id\", idStr);\n\tel.setAttribute(\"name\", idStr);\n\tif (!isEnabled_Markup_Sides)\n\t{\n\t\tel.setAttribute(\"value\", formatAsMoney(base_price));\n\t}\n\tcelloverride.appendChild(el);\n\n\t// previewPrice cell\n\tvar cellpreview = row.insertCell(insertCellNum++);\n\tcellpreview.setAttribute(\"class\", \"align-middle preview-price\");\n\tvar el = document.createTextNode('');\n\tcellpreview.appendChild(el);\n\n\t// remianingInventory cell\n\tvar cellremaining = row.insertCell(insertCellNum++);\n\tcellremaining.setAttribute(\"class\", \"align-middle remaining-price\");\n\tvar el = document.createTextNode('0');\n\tcellremaining.appendChild(el);\n}\n\nfunction giveTabFocus()\n{\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\n\t\tget: (searchParams, prop) => searchParams.get(prop)\n\t});\n\tlet value = params.tabs; // \"some_value\"\n\tif (typeof value != 'undefined' && value != null)\n\t{\n\t\tvalue = value.substring(value.indexOf('menu.') + 5);\n\t\t$(document).find(\"[data-nav='\" + value + \"']\").click();\n\t}\n\n}\n\n$(function () {\n\n\t$(document).ready(function () {\n\t\tcalculatePage()\n\t\tgiveTabFocus();\n\t});\n\n\t$(document).on('change keyup', '#markup_6_serving, #markup_4_serving, #markup_3_serving, #markup_2_serving, #markup_sides, #assembly_fee, #delivery_assembly_fee, #volume_reward, [name=\"is_default_markup\"], [id^=pic_], [id^=form_], [id^=ovr_], [id^=vis_], [id^=hid_]', function (e) {\n\t\tcalculatePage();\n\t});\n\n\t$(document).on('change keyup', '[id^=vis_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\t\tlet checkedState = $(this).is(':checked');\n\n\t\t// Sides & Sweets\n\t\tif (menuInfo.mid[menu_item_id].is_chef_touched == '1')\n\t\t{\n\t\t\tif (checkedState && numberOfCustomerFacingCTSItems > 20)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': false});\n\n\t\t\t\tbootbox.alert('You can only display 20 Sides &amp; Sweets items on the customer facing menu.');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\t\t\t}\n\t\t}\n\t\t// EFL\n\t\telse if (menuInfo.mid[menu_item_id].is_store_special == '1')\n\t\t{\n\t\t\tif (!checkedState && numberOfCustomerFacingEFLItems > 10)\n\t\t\t{\n\t\t\t\t$(this).prop({'checked': true});\n\n\t\t\t\tbootbox.alert(\"You can only make 10 Fast Lane items visible at a time. Please hide another store special if you wish to make this item visible.\");\n\t\t\t}\n\t\t}\n\n\t});\n\n\t$(document).on('change keyup', '[id^=form_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#hid_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('change keyup', '[id^=hid_]', function (e) {\n\n\t\tlet menu_item_id = $(this).data('menu_item_id');\n\n\t\t$('#vis_' + menu_item_id).prop({'checked': false});\n\t\t$('#form_' + menu_item_id).prop({'checked': false});\n\n\t});\n\n\t$(document).on('keyup change', '#filter', function (e) {\n\t\t$.uiTableFilter($('#recipe_list'), this.value);\n\t});\n\n\t$(document).on('click', '#clear_filter', function (e) {\n\n\t\t$('#filter').val('').change();\n\n\t\tif (!Modernizr.input.placeholder)\n\t\t{\n\t\t\t// trick to restore placeholder on IE\n\t\t\t$('#filter').focus().blur();\n\t\t}\n\n\t});\n\n\t// handle markdowns\n\t$(document).on('click', '[id^=mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Edit Markdown',\n\t\t\tdiv_id: \"edit_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\tlet price = start_price;\n\t\t\t\tprice -= (price * (markdownVal / 100));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#edit_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#edit_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#edit_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#mkdn_' + itemID).html(formatAsMoney(newPercentage) + \"%\");\n\t\t\t\t\t$('#mkdn_' + itemID).data('markdown_value', newPercentage);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t// handle_add_new_markdown\n\t$(document).on('click', '[id^=add-mkdn_]', function (e) {\n\n\t\ttempArr = this.id.split(\"_\");\n\t\tlet itemID = tempArr[1];\n\n\t\tlet markdownVal = $(this).data('markdown_value');\n\t\tlet markdownID = $(this).data('markdown_id');\n\n\t\tdd_message({\n\t\t\ttitle: 'Add Markdown',\n\t\t\tdiv_id: \"new_mkdn\",\n\t\t\tmessage: $(\"#markdown_editor\").html(),\n\t\t\theight: 350,\n\t\t\twidth: 400,\n\t\t\tresizable: true,\n\t\t\tnoOk: true,\n\t\t\topen: function () {\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(markdownVal);\n\n\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(0));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").on('keyup', function (e) {\n\t\t\t\t\tprice = start_price;\n\t\t\t\t\tnewDiscount = $(this).val();\n\n\t\t\t\t\tif (newDiscount < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 0;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newDiscount > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewDiscount = 20;\n\t\t\t\t\t\t$(this).val(newDiscount);\n\t\t\t\t\t}\n\n\t\t\t\t\tprice -= (price * (newDiscount / 100));\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(price));\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").on('keyup', function (e) {\n\n\t\t\t\t\tlet targetPrice = $(this).val();\n\t\t\t\t\tlet newPercentage = ((start_price - targetPrice) / start_price) * 100;\n\n\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\n\t\t\t\t});\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#current_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#base_price\").html(\"$\" + formatAsMoney(menuInfo.mid[itemID].base_price));\n\n\t\t\t\t$(\"#new_mkdn\").find(\"#item_title\").html(menuInfo.mid[itemID].menu_item_name);\n\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tAccept: function () {\n\t\t\t\t\tlet start_price = getPreviewItemPrice(itemID);\n\n\t\t\t\t\tlet newPercentage = $(\"#new_mkdn\").find(\"#markdown_amount\").val();\n\t\t\t\t\tif (newPercentage > 20)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 20;\n\t\t\t\t\t\tprice = (start_price * (newPercentage / 100));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price - price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount is limited to 20%. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (newPercentage < 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewPercentage = 0;\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_amount\").val(formatAsMoney(newPercentage));\n\t\t\t\t\t\t$(\"#new_mkdn\").find(\"#markdown_price\").val(formatAsMoney(start_price));\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\tmessage: \"The percentage of discount cannot be negative. The amounts have been adjusted. Please review and re-submit.\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet new_button = '<button class=\"btn btn-primary btn-sm\" id=\"mkdn_' + itemID + '\" data-org_val=\"0\" data-markdown_id=\"new\" data-markdown_value=\"' + newDiscount + '\" >' + formatAsMoney(newDiscount) + '%</button>';\n\t\t\t\t\t$('#add-mkdn_' + itemID).replaceWith(new_button);\n\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t$(this).remove();\n\n\t\t\t\t},\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t});\n\n\t$(document).on('click', '#add_past_menu_item:not(.disabled)', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving items. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: true,\n\t\t\ttitle: 'Add EFL Item',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_item&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_item]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\n\t\t\t\t\t});\n\n\t\t\t\t\tdd_message({\n\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\tmessage: 'This will immediately add the listed items to the menu. Are you sure?',\n\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t'Add Items to Menu': function () {\n\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\top: 'add_menu_item',\n\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedEFLItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, handledCount, count);\n\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('/backoffice/menu_editor?tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('click', '[data-add_menu_item]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_item=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_item=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_item=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_item]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n\n\t//////---------Add past Sides & Sweets\n\n\t$(document).on('click', '#add_past_menu_item_sides', function (e) {\n\n\t\tdisplayModalWaitDialog('wait_for_adding_item_div', \"Retrieving Sides & Sweets. Please wait ...\");\n\n\t\tshowPopup({\n\t\t\tmodal: true,\n\t\t\ttitle: 'Add Sides & Sweets',\n\t\t\tnoOk: true,\n\t\t\tcloseOnEscape: false,\n\t\t\theight: 720,\n\t\t\tdiv_id: 'add_menu_item_popup_div',\n\t\t\tmodule: 'page=admin_menu_editor_add_sides_sweets&menu_id=' + menuInfo.menu_id,\n\t\t\topen: function (event, ui) {\n\t\t\t\t$(this).parent().find('.ui-dialog-titlebar-close').hide();\n\t\t\t\t$(\"#wait_for_adding_item_div\").remove();\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tCancel: function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t},\n\t\t\t\tOkay: function () {\n\n\t\t\t\t\tlet entreeList = {};\n\n\t\t\t\t\tlet errorMissingCategory = false;\n\t\t\t\t\t$('#sel_list').find('[data-rmv_menu_side]').each(function () {\n\n\t\t\t\t\t\tlet thisEntree = $(this).data('entree_id');\n\t\t\t\t\t\tentreeList[thisEntree] = thisEntree;\n\t\t\t\t\t\tlet categoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").find(\":selected\").val();\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined'){\n\t\t\t\t\t\t\tcategoryLabel = $(\"[data-recipe_category=\" + thisEntree + \"]:visible\").html();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (typeof categoryLabel == 'undefined')\n\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t$(\"[data-recipe_category=\" + thisEntree + \"]\").css(\"border-color\", \"red\");\n\t\t\t\t\t\t\terrorMissingCategory = true;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tentreeList[thisEntree] = categoryLabel;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (errorMissingCategory)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.log('Missing');\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: 'Please select a category for all items',\n\t\t\t\t\t\t\tmessage: 'Please select a category for all items'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\t\tmessage: 'This will immediately add the listed Sides & Sweets to the menu. Are you sure?',\n\t\t\t\t\t\t\tnoOk: true,\n\t\t\t\t\t\t\theight: 180,\n\t\t\t\t\t\t\tbuttons: {\n\t\t\t\t\t\t\t\t'Add Sides & Sweets to Menu': function () {\n\n\t\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\t\turl: '/processor',\n\t\t\t\t\t\t\t\t\t\ttype: 'POST',\n\t\t\t\t\t\t\t\t\t\ttimeout: 20000,\n\t\t\t\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\t\t\t\t\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\t\t\t\t\t\t\t\top: 'add_menu_side',\n\t\t\t\t\t\t\t\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\t\t\t\t\t\t\t\tentree_ids: entreeList\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsuccess: function (json) {\n\t\t\t\t\t\t\t\t\t\t\tif (json.processor_success)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 0;\n\t\t\t\t\t\t\t\t\t\t\t\tfor (let entree_id in json.results)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet count = json.results[entree_id]['count'];\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet items = json.results[entree_id]['items'];\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet handledCount = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let id in items)\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// update json array with latest data\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmenuInfo = json.menuInfo;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddUnsavedSideItem(items[id].item_id, items[id].name, items[id].size, items[id].base_price, items[id].subcategory_label);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thandledCount++;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tcalculatePage();\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (handledCount > 1)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#empty_menu_message\").remove();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t$([\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.documentElement,\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.body\n\t\t\t\t\t\t\t\t\t\t\t\t]).animate({\n\t\t\t\t\t\t\t\t\t\t\t\t\tscrollTop: $(\"#temp_category\").offset().top\n\t\t\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Error adding Sides & Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\t\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\t\t\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: 'Network Error adding Sides and Sweets',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: response\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t\t$('#add_menu_item_popup_div').remove();\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'Cancel': function () {\n\t\t\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tclose: function () {\n\t\t\t\tbounce('/backoffice/menu_editor?tabs=menu.efl');\n\t\t\t}\n\t\t});\n\n\t});\n\n\t$(document).on('change', '[data-recipe_category]', function (e) {\n\t\tlet categoryLabel = $(this).find(\":selected\").val();\n\n\t\tif (typeof categoryLabel == 'undefined')\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"red\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).css(\"border-color\", \"black\");\n\t\t}\n\t});\n\n\t$(document).on('click', '[data-add_menu_side]', function (e) {\n\t\t// prevent multiple submissions\n\t\tif ($(this).hasClass('disabled'))\n\t\t{\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\t$(this).addClass('disabled');\n\n\t\t\tlet entree_id = $(this).data('entree_id');\n\t\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t\tlet tr = $('[data-recipe_id_row=\"' + recipe_id + '\"]').clone();\n\n\t\t\ttr.find(\"[data-rmv_menu_side=\" + entree_id + \"]\").show();\n\t\t\ttr.find(\"[data-add_menu_side=\" + entree_id + \"]\").remove();\n\n\t\t\ttr.find(\"[data-recipe_category=\" + entree_id + \"]\").show();\n\n\t\t\tlet oldCategory = tr.find(\"[data-old_category=\" + entree_id + \"]\").html();\n\n\t\t\ttr.find(\"[data-old_category=\" + entree_id + \"]\").remove();\n\n\t\t\t$(\"#selected_items tbody\").append(tr);\n\n\t\t\t$(\"[data-recipe_category=\" + entree_id + \"]\").val(oldCategory);\n\t\t}\n\n\t});\n\n\t$(document).on('click', '[data-rmv_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$('#selected_items tbody [data-recipe_id_row=\"' + recipe_id + '\"]').remove();\n\t\tlet org_tr = $('#recipe_list tbody [data-recipe_id_row=\"' + recipe_id + '\"]');\n\t\torg_tr.find('[data-add_menu_side=\"' + entree_id + '\"]').removeClass('disabled');\n\n\t});\n\n\t$(document).on('click', '[data-info_menu_side]', function (e) {\n\n\t\tlet entree_id = $(this).data('entree_id');\n\t\tlet recipe_id = $(this).data('recipe_id');\n\n\t\t$.ajax({\n\t\t\turl: '/processor',\n\t\t\ttype: 'POST',\n\t\t\ttimeout: 20000,\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tprocessor: 'admin_menuEditor',\n\t\t\t\tstore_id: STORE_DETAILS.id,\n\t\t\t\top: 'menu_item_info',\n\t\t\t\tmenu_id: menuInfo.menu_id,\n\t\t\t\tentree_id: entree_id,\n\t\t\t\trecipe_id: recipe_id\n\t\t\t},\n\t\t\tsuccess: function (json) {\n\t\t\t\tdd_message({\n\t\t\t\t\tmodal: true,\n\t\t\t\t\ttitle: 'Item Information',\n\t\t\t\t\theight: 720,\n\t\t\t\t\twidth: 720,\n\t\t\t\t\tmessage: json.data,\n\t\t\t\t\topen: function () {\n\t\t\t\t\t\thandle_tabbed_content();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\terror: function (objAJAXRequest, strError) {\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: response\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t});\n\t});\n});"],"mappings":"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"}