(function(){"use strict";if(manageSingleStore){$(document).on("keyup blur",".notice-message, .notice-title",function(e){if($(this).val()!=strip_tags($(this).val())){$(this).val(strip_tags($(this).val()))}})}$(document).on("click",".storeSelector-select-all",function(e){$("#storeSelector input[type=checkbox]").prop("checked",true)});$(document).on("click",".storeSelector-select-none",function(e){$("#storeSelector input[type=checkbox]").prop("checked",false)});$(document).on("click",".storeSelector-select-corporate",function(e){$('#storeSelector [data-storeSelect_franchise_id="220"]').prop("checked",true)});$(document).on("click",".storeSelector-select-not-corporate",function(e){$('#storeSelector [data-storeSelect_franchise_id!="220"]').prop("checked",true)});$(document).on("click",".notice-store-filter:not(.disabled)",function(e){$(".notice-select-filter").val($(this).data("filter_store_id")).trigger("change")});$(document).on("change",".notice-select-filter",function(e){$(".notice-list").children().each(function(){$(this).hide()});$("[data-filter_store_id]").removeClass("disabled");if($(this).val()=="home_office_managed"){$(".notice-list").children('[data-home_office_managed="1"]').each(function(){$(this).show()})}else if($(this).val()=="home_office_managed_not"){$(".notice-list").children('[data-home_office_managed="0"]').each(function(){$(this).show()})}else if($(this).val()!=""){var t=$(this).val();$(".notice-list").children().find('[name="store_id"]').each(function(){var e=$(this).val().split(",");if(!$.inArray(t,e)){$(this).parentsUntil("[data-notice_id_div]").parent().show();$(this).parentsUntil("[data-notice_id_div]").find("[data-filter_store_id]").addClass("disabled")}})}else{$(".notice-list").children().each(function(){$(this).show()})}});$(document).on("change",".notice-alert_css",function(e){var t=$(this).parents("form:first");var i=$(this).val();$(this).parent().find("select option").each(function(){var e=$(this).val();$("[name='message']",t).removeClass(e)});$("[name='message']",t).addClass(i)});$(document).on("change",".notice-select-audience",function(e){var t=$(this).parents("form:first");var i=$("[name='id']",t).val();var n=$('[data-notice_id_div="'+i+'"]');if($(this).val()==="STORE"){$(n).find(".div-notice-title").show();$("[name='title']",t).prop("required",true);$(n).find(".div-notice-select-style").hide();$(n).find(".div-notice-select-store").show();$("[name='alert_css']",t).prop("required",false).val("").trigger("change")}else{$(n).find(".div-notice-select-style").show();$("[name='alert_css']",t).prop("required",true);$(n).find(".div-notice-select-store").hide();$(n).find(".div-notice-title").hide();$("[name='title']",t).prop("required",false)}});$(document).on("click",".notice-create",function(e){e.preventDefault();$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_manage_site_notice",op:"get_notice_form"},success:function(e){if(e.processor_success){$(".notice-list").prepend(e.html);$('[data-notice_id_div="'+e.notice_id+'"]').slideDown()}},error:function(e,t){t="Unexpected error"}})});$(document).on("click",".notice-store-select:not(.disabled)",function(e){var o=$(this);var s=$(o).parents("form:first");var t=$("[name='store_id']",s).val();$(".notice-store-select").addClass("disabled");$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_manage_site_notice",op:"get_store_select",store_id:t},success:function(e){if(e.processor_success){bootbox.confirm({message:e.html,scrollable:true,callback:function(e){if(e){var t=$("#storeSelector");var i=t.serializeArray();var n=[];$.each(i,function(e,t){n.push(t.value)});$("[name='store_id']",s).val(n.join());$(o).find(".notice-store_id-count").text(i.length)}$(".notice-store-select").removeClass("disabled")}})}},error:function(e,t){t="Unexpected error"}})});$(document).on("submit",".notice-form",function(e){var t=$(this);e.preventDefault();if($(e.delegateTarget.activeElement).not("input, textarea").length==0){$(t).removeClass("was-validated");$(t).find(".btn-spinning").removeClass("btn-spinning");$(t).find(".ld-spin").remove();e.preventDefault();return false}if(t["0"].checkValidity()!==false){var i={};$.each(t.serializeArray(),function(){i[this.name]=this.value});var n=JSON.stringify(i);$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_manage_site_notice",op:"save_site_notice",notice_details:n},success:function(e){if(e.processor_success){if(e.notice_id){$("[name='id']",t).val(e.notice_id);$(t).parent().attr("data-notice_id_div",e.notice_id)}$(t).removeClass("was-validated");$(t).find(".btn-spinning").removeClass("btn-spinning");$(t).find(".ld-spin").remove()}},error:function(e,t){t="Unexpected error"}})}});$(document).on("click",".notice-delete",function(e){e.preventDefault();var t=$(this).parents("form:first");var i=$("[name='id']",t).val();var n="<p>Are you sure you wish to delete this notice?</p>";if($("[name='message']",t).val()){n+='<p class="'+($("[name='alert_css']",t).val()?$("[name='alert_css']",t).val():"alert")+'">'+$("[name='message']",t).val()+"</p>"}bootbox.confirm({message:n,callback:function(e){if(e){if(i.startsWith("new-")){$('[data-notice_id_div="'+i+'"]').slideUp("normal",function(){$(this).remove()})}else{$.ajax({url:"ddproc.php",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_manage_site_notice",op:"delete_site_notice",notice_id:i},success:function(e){if(e.processor_success){$('[data-notice_id_div="'+i+'"]').slideUp("normal",function(){$(this).remove()});$(".btn-spinning").removeClass("btn-spinning");$(".ld-spin").remove()}},error:function(e,t){t="Unexpected error"}})}}}})})})();
//# sourceMappingURL=manage_site_notice.min.js.map