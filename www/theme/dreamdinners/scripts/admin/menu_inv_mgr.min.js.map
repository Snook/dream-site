{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["menu_inv_mgr.js"],"sourcesContent":["let sidesDataArray = [];\r\nlet notShown = true;\r\n\r\nfunction menu_editor_init()\r\n{\r\n\tinit_sales_mix_editing();\r\n\tinit_week_inventory_editing();\r\n\tinit_override_inventory_editing();\r\n\tinit_inventory_calculation();\r\n\tinit_saving_guest_counts();\r\n\tinit_saving_store_sales_mix();\r\n\tinit_resetting_store_sales_mix();\r\n\tinit_finalize_preorder();\r\n\tinit_save_sides_inventory();\r\n\tinit_save_EFL_inventory();\r\n\tinit_saving_override_inventory();\r\n\tinit_saving_week_inventory();\r\n\tinit_show_actuals();\r\n\tinit_export_sales();\r\n\tinit_reset_to_current();\r\n\r\n\treconcile_data();\r\n\r\n\tcalculatePage();\r\n\r\n\tinitNavTab();\r\n\r\n\t$(\"#itemsTbl, #ctsItemsTbl\").stickyTableHeaders();\r\n\r\n\tif (!menuState.hasSavedPreOrder)\r\n\t{\r\n\t\t$(\"[id^='finalize_week_']\").each(function () {\r\n\t\t\t$(this).addClass('disabled');\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nfunction initNavTab()\r\n{\r\n\r\n\tvar oldUrl = $('#inv_mgr').attr(\"href\"); // Get current url\r\n\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tabs'));\r\n\tconst params = new Proxy(new URLSearchParams(window.location.search), {\r\n\t\tget: (searchParams, prop) => searchParams.get(prop)\r\n\t});\r\n\tnewUrl = newUrl + '&tabs=' + params.tabs;\r\n\t$('#inv_mgr').attr(\"href\", newUrl);\r\n\r\n\t$('.tab').each(function () {\r\n\t\t$(this).on('click', function () {\r\n\t\t\tvar oldUrl = $('#inv_mgr').attr(\"href\"); // Get current url\r\n\t\t\tvar newUrl = oldUrl.substring(0, oldUrl.indexOf('&tab'));\r\n\t\t\tnewUrl = newUrl + '&tabs=menu.' + $(this).data('tabid');\r\n\t\t\t$('#inv_mgr').attr(\"href\", newUrl);\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction init_reset_to_current()\r\n{\r\n\t$(\"#reset_to_current\").on('click', function () {\r\n\t\tbootbox.confirm(\"Are you sure you wish to reset the Inventory Manager to last published values? You will lose any unsaved changes.\", function (result) {\r\n\t\t\tif (result)\r\n\t\t\t{\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n}\r\n\r\nfunction init_export_sales()\r\n{\r\n\t$(\"#export_menu_sales\").on('click', function () {\r\n\r\n\t\tlet hasDirtyFields = false;\r\n\t\t$(\"[id^='wta']\").each(function () {\r\n\r\n\t\t\tif ($(this).hasClass('dirty'))\r\n\t\t\t{\r\n\t\t\t\thasDirtyFields = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!menuState.hasSavedPreOrder || hasDirtyFields)\r\n\t\t{\r\n\t\t\tlet message = \"\";\r\n\t\t\tif (!menuState.hasSavedPreOrder)\r\n\t\t\t{\r\n\t\t\t\tmessage = \"The Pre-Order has not been finalized. This export function will export values currently stored in the database.\";\r\n\t\t\t}\r\n\r\n\t\t\tif (hasDirtyFields)\r\n\t\t\t{\r\n\t\t\t\tif (message == \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage = \"There are unsaved weekly projections. The export will use values currently stored in the database. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage += \"There are also unsaved weekly projections. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmessage += \"<br /><br />Do you want to continue with the export?\";\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Export PreOrder',\r\n\t\t\t\tmessage: message,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\twidth: 400,\r\n\t\t\t\theight: 300,\r\n\t\t\t\tconfirm: function () {\r\n\t\t\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_month_sales_projection&store=\" + gStore_ID + \"&menu_id=\" + menu_id;\r\n\t\t\t\t\twindow.location = url;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_month_sales_projection&store=\" + gStore_ID + \"&menu_id=\" + menu_id;\r\n\t\t\twindow.location = url;\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"[id^='export_week_']\").on('click', function () {\r\n\r\n\t\tlet weekNumber = this.id.split(\"_\")[2];\r\n\t\tlet hasDirtyFields = false;\r\n\t\t$(\"[id^='wta\" + weekNumber + \"']\").each(function () {\r\n\r\n\t\t\tif ($(this).hasClass('dirty'))\r\n\t\t\t{\r\n\t\t\t\thasDirtyFields = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!menuState.hasSavedPreOrder || hasDirtyFields)\r\n\t\t{\r\n\t\t\tlet message = \"\";\r\n\r\n\t\t\tif (!menuState.hasSavedPreOrder)\r\n\t\t\t{\r\n\t\t\t\tmessage = \"The Pre-Order has not been finalized. This export function will export values currently stored in the database.\";\r\n\t\t\t}\r\n\t\t\tif (hasDirtyFields)\r\n\t\t\t{\r\n\t\t\t\tif (message == \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage = \"There are unsaved weekly projections. The export will use values currently stored in the database. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage += \"There are also unsaved weekly projections. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmessage += \"<br /><br />Do you want to continue with the export?\";\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Export PreOrder',\r\n\t\t\t\tmessage: message,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\twidth: 400,\r\n\t\t\t\theight: 300,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\tlet weekStart = $(this).data(\"week_start\");\r\n\t\t\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_weekly_sales&store=\" + gStore_ID + \"&weekStart=\" + weekStart + \"&menu_id=\" + menu_id;\r\n\t\t\t\t\twindow.location = url;\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet weekStart = $(this).data(\"week_start\");\r\n\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_weekly_sales&store=\" + gStore_ID + \"&weekStart=\" + weekStart + \"&menu_id=\" + menu_id;\r\n\t\t\twindow.location = url;\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"[id^='export_by_range']\").on('click', function () {\r\n\r\n\t\tlet weekNumber = this.id.split(\"_\")[2];\r\n\t\tlet hasDirtyFields = false;\r\n\t\t$(\"[id^='wta\" + weekNumber + \"']\").each(function () {\r\n\r\n\t\t\tif ($(this).hasClass('dirty'))\r\n\t\t\t{\r\n\t\t\t\thasDirtyFields = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (!menuState.hasSavedPreOrder || hasDirtyFields)\r\n\t\t{\r\n\t\t\tlet message = \"\";\r\n\r\n\t\t\tif (!menuState.hasSavedPreOrder)\r\n\t\t\t{\r\n\t\t\t\tmessage = \"The Pre-Order has not been finalized. This export function will export values currently stored in the database.\";\r\n\t\t\t}\r\n\t\t\tif (hasDirtyFields)\r\n\t\t\t{\r\n\t\t\t\tif (message == \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage = \"There are unsaved weekly projections. The export will use values currently stored in the database. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage += \"There are also unsaved weekly projections. You may want to save these value first.\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tmessage += \"<br /><br />Do you want to continue with the export?\";\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Export PreOrder By Range',\r\n\t\t\t\tmessage: message,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\twidth: 400,\r\n\t\t\t\theight: 300,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\tlet start = $(\"[name='range_day_start']\").val();\r\n\t\t\t\t\tlet end = $(\"[name='range_day_end']\").val();\r\n\t\t\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_sales_by_range&store=\" + gStore_ID + \"&start=\" + start + \"&end=\" + end + \"&menu_id=\" + menu_id;\r\n\t\t\t\t\twindow.location = url;\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tlet start = $(\"[name='range_day_start']\").val();\r\n\t\t\tlet end = $(\"[name='range_day_end']\").val();\r\n\t\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_sales_by_range&store=\" + gStore_ID + \"&start=\" + start + \"&end=\" + end + \"&menu_id=\" + menu_id;\r\n\t\t\twindow.location = url;\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"#export_EFL_sales\").on('click', function () {\r\n\r\n\t\tlet url = \"main.php?page=admin_menu_inventory_mgr&op=export_EFL_sales&store=\" + gStore_ID + \"&menu_id=\" + menu_id;\r\n\t\twindow.location = url;\r\n\t});\r\n\r\n\t$(\".expand_export\").click(function () {\r\n\t\t$header = $(this);\r\n\t\t$content = $(\"#export_by_dates\");\r\n\t\t$header.html(function () {\r\n\t\t\treturn \"<span class='button'>Export By Date</span>\";\r\n\t\t});\r\n\t\t$content.slideToggle(500, function () {\r\n\t\t});\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction init_show_actuals()\r\n{\r\n\t$(\"#show_actuals\").on('click', function () {\r\n\r\n\t\tlet btn_name = $(this).html();\r\n\r\n\t\tif (btn_name == 'View Servings Sold')\r\n\t\t{\r\n\t\t\t$(this).html(\"Hide Servings Sold\");\r\n\r\n\t\t\t$(\"[id^='tr_act_']\").each(function () {\r\n\t\t\t\tlet thisInv = $(this).val();\r\n\t\t\t\tlet thisRecipe = this.id.split(\"_\")[2];\r\n\t\t\t\t$(this).removeClass('collapse');\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).html(\"View Servings Sold\");\r\n\r\n\t\t\t$(\"[id^='tr_act_']\").each(function () {\r\n\t\t\t\tlet thisInv = $(this).val();\r\n\t\t\t\tlet thisRecipe = this.id.split(\"_\")[2];\r\n\t\t\t\t$(this).addClass('collapse');\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction init_save_EFL_inventory()\r\n{\r\n\t$(\"#save_efl_inv\").on('click', function () {\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize PreOrder',\r\n\t\t\tmessage: \"Are you sure you wish to save EFL Available to Promise inventory?\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 180,\r\n\t\t\tconfirm: function () {\r\n\r\n\t\t\t\tlet overrideValues = {};\r\n\r\n\t\t\t\t$(\"[id^='ofi_']\").each(function () {\r\n\r\n\t\t\t\t\tlet thisInv = $(this).val();\r\n\t\t\t\t\tlet thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\t\t\t\toverrideValues[thisRecipe] = thisInv;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdisplayModalWaitDialog('MIM_progress', \"Saving EFL Inventory ...\");\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\t\t\top: 'save_override_inventory',\r\n\t\t\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\toverrideValues: overrideValues\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(\"[id^='ofi_']\").each(function () {\r\n\t\t\t\t\t\t\t\t$(this).removeClass('unsaved');\r\n\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\tlet curVal = $(this).val() * 1;\r\n\t\t\t\t\t\t\t\t$(this).data('org_val', curVal);\r\n\t\t\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\r\n\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n}\r\n\r\nfunction init_save_sides_inventory()\r\n{\r\n\t$(\"#save_sides_inv\").on('click', function () {\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize PreOrder',\r\n\t\t\tmessage: \"Are you sure you wish to save Sides Available to Promise inventory?\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 150,\r\n\t\t\tconfirm: function () {\r\n\r\n\t\t\t\tvar overrideValues = {};\r\n\r\n\t\t\t\t$(\"[id^='ori_']\").each(function () {\r\n\r\n\t\t\t\t\tvar thisInv = $(this).val();\r\n\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\t\t\t\toverrideValues[thisRecipe] = thisInv;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdisplayModalWaitDialog('MIM_progress', \"Saving Sides Inventory ...\");\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\t\t\top: 'save_override_inventory',\r\n\t\t\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\toverrideValues: overrideValues,\r\n\t\t\t\t\t\tsave_to_global: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(\"[id^='ori_']\").each(function () {\r\n\t\t\t\t\t\t\t\t$(this).removeClass('unsaved');\r\n\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\tvar curVal = $(this).val() * 1;\r\n\t\t\t\t\t\t\t\t$(this).data('org_val', curVal);\r\n\t\t\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\r\n\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction dd_round_amount(inAmount)\r\n{\r\n\tinAmount += .000005;\r\n\r\n\tvar tempVal = inAmount * 1000.0;\r\n\ttempVal = parseInt(tempVal);\r\n\ttempVal = tempVal / 10;\r\n\tvar pennyFraction = tempVal - Math.floor(tempVal);\r\n\tif (pennyFraction >= .5)\r\n\t{\r\n\t\ttempVal = Math.floor(tempVal) + 1;\r\n\t}\r\n\telse\r\n\t{\r\n\t\ttempVal = Math.floor(tempVal);\r\n\t}\r\n\r\n\treturn tempVal / 100;\r\n}\r\n\r\nfunction validateSalesMix()\r\n{\r\n\tvar sumPercents = 0;\r\n\t$(\"[id^='ssmx_']\").each(function () {\r\n\t\tvar newVal = dd_round_amount($(this).val() * 1);\r\n\t\tsumPercents += newVal;\r\n\t\tsumPercents = dd_round_amount(sumPercents);\r\n\t\tif (sumPercents > 10000)\r\n\t\t{\r\n\t\t\talert(\"Invalid entry\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\t});\r\n\r\n\tif (sumPercents * 100 != 10000)\r\n\t{\r\n\t\tvar delta = dd_round_amount(Math.abs(sumPercents - 100.0));\r\n\t\tvar guidance = \"\";\r\n\t\tif (sumPercents > 100.0)\r\n\t\t{\r\n\t\t\tguidance += \"Remove a total of \" + delta + \" from one more items to establish a 100.0% total\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tguidance += \"Add a total of \" + delta + \" from one more items to establish a 100.0% total\";\r\n\t\t}\r\n\r\n\t\t$(\"#page_error_display\").html(\"The Store Sales Mix does not equal 100% (\" + sumPercents + \"). <br />\" + guidance);\r\n\t\treturn false;\r\n\t}\r\n\r\n\t$(\"#page_error_display\").html(\"\");\r\n\treturn true;\r\n}\r\n\r\nfunction init_week_inventory_editing()\r\n{\r\n\t$(\"[id^='wta']\").on('change', function () {\r\n\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\tvar curVal = $(this).val() * 1;\r\n\t\tif (orgVal != curVal)\r\n\t\t{\r\n\t\t\t$(this).addClass('dirty');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('dirty');\r\n\t\t}\r\n\t\treconcile_weeks_to_monthly_projection();\r\n\t});\r\n\r\n}\r\n\r\nfunction init_override_inventory_editing()\r\n{\r\n\t// Core\r\n\t/*\r\n\t$(\"[id^='ovi_']\").on('change', function () {\r\n\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\tvar curVal = $(this).val() * 1;\r\n\t\tif (orgVal != curVal)\r\n\t\t{\r\n\t\t\t$(this).addClass('dirty');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('dirty');\r\n\t\t}\r\n\r\n\t\tvar numSold = Number($(this).data('numsold'));\r\n\t\tif ($(this).val() < numSold)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'The Override Inventory must be greater than or equal to the number of future pickups.'\r\n\t\t\t});\r\n\r\n\t\t\t$(this).val(numSold);\r\n\t\t}\r\n\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t$(\"#ri_\" + thisRecipe).html($(this).val() - numSold.valueOf());\r\n\r\n\t});\r\n*/\r\n\t// EFL\r\n\t$(\"[id^='ofi_']\").on('change', function () {\r\n\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\tvar curVal = $(this).val() * 1;\r\n\t\tif (orgVal != curVal)\r\n\t\t{\r\n\t\t\t$(this).addClass('dirty');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('dirty');\r\n\t\t}\r\n\r\n\t\tvar numSold = Number($(this).data('numsold'));\r\n\t\tif ($(this).val() < numSold)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'The Override Inventory must be greater than or equal to the number sold.'\r\n\t\t\t});\r\n\t\t\t$(this).val(numSold);\r\n\t\t}\r\n\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t$(\"#atos_\" + thisRecipe).html($(this).val() - numSold.valueOf());\r\n\r\n\t});\r\n\r\n\t//sides\r\n\t$(\"[id^='ori_']\").on('change', function () {\r\n\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\tvar curVal = $(this).val() * 1;\r\n\t\tif (orgVal != curVal)\r\n\t\t{\r\n\t\t\t$(this).addClass('dirty');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('dirty');\r\n\t\t}\r\n\r\n\t\tvar number_sold = Number($(this).data('number_sold'));\r\n\t\tif ($(this).val() < number_sold)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'The Override Inventory must be greater than or equal to the number sold.'\r\n\t\t\t});\r\n\r\n\t\t\t$(this).val(number_sold);\r\n\t\t}\r\n\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t$(\"#atos_\" + thisRecipe).html($(this).val() - number_sold.valueOf());\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction reconcile_data()\r\n{\r\n\t// detect total mix <> 100%\r\n\tvalidateSalesMix();\r\n\treconcile_weeks_to_monthly_projection();\r\n}\r\n\r\nfunction reconcile_weeks_to_monthly_projection()\r\n{\r\n\t$(\"[id^='poi_']\").each(function () {\r\n\t\t// check for zero inventory\r\n\t\tvar thisVal = $(this).html();\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\tvar weekly_sum = ($(\"#wta1_\" + thisRecipe).val() * 1) + ($(\"#wta2_\" + thisRecipe).val() * 1) + ($(\"#wta3_\" + thisRecipe).val() * 1) + ($(\"#wta4_\" + thisRecipe).val() * 1);\r\n\r\n\t\tif ($(\"#wta5_\" + thisRecipe)[0])\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta5_\" + thisRecipe).val()) * 1;\r\n\t\t}\r\n\r\n\t\t$(\"#pwt_\" + thisRecipe).html(weekly_sum);\r\n\t\tvar numSold = Number($(\"#ovi_\" + thisRecipe).data('numsold'));\r\n\r\n\t\tif (weekly_sum == 0)\r\n\t\t{\r\n\t\t\tweekly_sum = ($(\"#cur_adj_inv_\" + thisRecipe).data('default_inventory') * 1);\r\n\t\t}\r\n\r\n\t\t$(\"#cur_adj_inv_\" + thisRecipe).html(weekly_sum);\r\n\t\t$(\"#cur_rmg_\" + thisRecipe).html(weekly_sum - numSold.valueOf());\r\n\r\n\t\tif (weekly_sum != thisVal && weekly_sum != 0)\r\n\t\t{\r\n\t\t\tlet huh = USER_PREFERENCES.HAS_SEEN_ELEMENT.value.WEEKLY_INVENTORY_WARNING;\r\n\t\t\tif (!USER_PREFERENCES.HAS_SEEN_ELEMENT.value.WEEKLY_INVENTORY_WARNING)\r\n\t\t\t{\r\n\r\n\t\t\t\tlet variance_msg = \"The entered servings number for a particular menu item have deviated from the original preordered amount. Please note that deviations from the preorder can create excess or a shortage of inventory. If you have exceeded your preorder, please contact your AE to secure adequate inventory. By clicking 'Okay' you are acknowledging this information.\";\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Variance from Pre-order',\r\n\t\t\t\t\tmessage: \"<div>\" + variance_msg + \"</div><div style='margin:5px;'><input type='checkbox' id='WEEKLY_INVENTORY_WARNING' name='WEEKLY_INVENTORY_WARNING' />&nbsp;<label for='WEEKLY_INVENTORY_WARNING'>Do not show this warning.</label></div>\",\r\n\t\t\t\t\tcloseCallback: function () {\r\n\t\t\t\t\t\tif ($(\"#WEEKLY_INVENTORY_WARNING\").is(\":checked\"))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tUSER_PREFERENCES.HAS_SEEN_ELEMENT.value.WEEKLY_INVENTORY_WARNING = 1;\r\n\t\t\t\t\t\t\tset_user_pref('HAS_SEEN_ELEMENT', USER_PREFERENCES.HAS_SEEN_ELEMENT.value, USER_DETAILS.id, null)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t$(this).addClass(\"warning_text\");\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass(\"warning_text\");\r\n\t\t}\r\n\r\n\t});\r\n\r\n}\r\n\r\nfunction init_finalize_preorder()\r\n{\r\n\t$(\"#finalize_preorder\").on('click', function () {\r\n\r\n\t\t$(\"[id^='poi_']\").each(function () {\r\n\t\t\t// check for zero inventory\r\n\t\t\tvar thisVal = $(this).html();\r\n\t\t\tif (thisVal == '0')\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: \"<h4>Zero Projected Inventory Encountered</h4> Please be sure that all items have a non-zero sales mix or that you have clicked the 'Calculate Projected Inventory' Button.\"\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize PreOrder',\r\n\t\t\tmessage: \"Are you sure you wish to Finalize the Pre-Order Projected  Inventory?\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 150,\r\n\t\t\tconfirm: function () {\r\n\t\t\t\tvar preorderInventory = {};\r\n\t\t\t\tvar week1Inv = {};\r\n\t\t\t\tvar week2Inv = {};\r\n\t\t\t\tvar week3Inv = {};\r\n\t\t\t\tvar week4Inv = {};\r\n\t\t\t\tvar week5Inv = {};\r\n\r\n\t\t\t\tvar encounteredNegativeInventory = false;\r\n\t\t\t\tvar thisVal = null;\r\n\t\t\t\tvar thisRecipe = null;\r\n\t\t\t\tvar curNumberSold = null;\r\n\t\t\t\tvar recipeName = null;\r\n\t\t\t\t$(\"[id^='pwt_']\").each(function () {\r\n\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\tthisVal = $(this).html();\r\n\t\t\t\t\tthisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\tpreorderInventory[thisRecipe] = thisVal;\r\n\r\n\t\t\t\t\tcurNumberSold = $(\"#ovi_\" + thisRecipe).data(\"numsold\");\r\n\r\n\t\t\t\t\tif (curNumberSold > thisVal && !encounteredNegativeInventory)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trecipeName = $(\"#rname_\" + thisRecipe).html();\r\n\t\t\t\t\t\tencounteredNegativeInventory = true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (encounteredNegativeInventory)\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: \"Error\",\r\n\t\t\t\t\t\tdiv_id: \"neg_warn\",\r\n\t\t\t\t\t\theight: 300,\r\n\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\tmessage: \"Recipe \" + recipeName + \" (ID \" + thisRecipe + \") has currently sold \" + curNumberSold + \" servings and the projected amount is less than that.\" +\r\n\t\t\t\t\t\t\t\" This would create negative inventory.  Please increase the projection.\"\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$(\"[id^='wta1_']\").each(function () {\r\n\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\tweek1Inv[thisRecipe] = thisVal;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(\"[id^='wta2_']\").each(function () {\r\n\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\tweek2Inv[thisRecipe] = thisVal;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(\"[id^='wta3_']\").each(function () {\r\n\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\tweek3Inv[thisRecipe] = thisVal;\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(\"[id^='wta4_']\").each(function () {\r\n\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\tweek4Inv[thisRecipe] = thisVal;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// TODO: make conditional\r\n\t\t\t\t\t$(\"[id^='wta5_']\").each(function () {\r\n\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\tweek5Inv[thisRecipe] = thisVal;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdisplayModalWaitDialog('MIM_progress', \"Finalizing Core Menu Projections ...\");\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\t\t\t\top: 'save_preorder_inventory',\r\n\t\t\t\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\t\tpreorderInventory: preorderInventory,\r\n\t\t\t\t\t\t\tweek1Inv: week1Inv,\r\n\t\t\t\t\t\t\tweek2Inv: week2Inv,\r\n\t\t\t\t\t\t\tweek3Inv: week3Inv,\r\n\t\t\t\t\t\t\tweek4Inv: week4Inv,\r\n\t\t\t\t\t\t\tweek5Inv: week5Inv\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t$(\"[id^='finalize_week_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('disabled');\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_poi_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_pwt_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_odd')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_odd');\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_wt1_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta1_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_wt2_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta2_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_wt3_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta3_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_wt4_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta4_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='td_wt5_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('static_unsaved_even')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('static_saved_even');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta5_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$(\"[id^='ovi_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\t$(this).removeClass('unsaved')\r\n\t\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t// update Cur Inventory/Remaining and hidden vals\r\n\t\t\t\t\t\t\t\t$(\"[id^='pwt_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\t// check for zero inventory\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).html();\r\n\t\t\t\t\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t\t\t\t\t$(\"#cur_adj_inv_\" + thisRecipe).html(thisVal);\r\n\t\t\t\t\t\t\t\t\t$(\"#cur_adj_inv_\" + thisRecipe).data(\"default_inventory\", thisVal);\r\n\t\t\t\t\t\t\t\t\tvar numSold = $(\"#ovi_\" + thisRecipe).data(\"numsold\");\r\n\t\t\t\t\t\t\t\t\t$(\"#cur_rmg_\" + thisRecipe).html(thisVal - numSold);\r\n\t\t\t\t\t\t\t\t\t$(\"#ovi_\" + thisRecipe).val(thisVal);\r\n\t\t\t\t\t\t\t\t\t$(\"#ovi_\" + thisRecipe).data(\"org_val\", thisVal);\r\n\t\t\t\t\t\t\t\t\t$(\"#pts-td_\" + thisRecipe).data(\"tooltip\", 'Stored inventory: ' + thisVal + ' Remaining: ' + (thisVal - numSold));\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\tdata_tooltips_init();\r\n\r\n\t\t\t\t\t\t\t\t// update org_val\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta1_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\t\t\t\t$(this).data(\"org_val\", thisVal)\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta2_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\t\t\t\t$(this).data(\"org_val\", thisVal)\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta3_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\t\t\t\t$(this).data(\"org_val\", thisVal)\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta4_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\t\t\t\t$(this).data(\"org_val\", thisVal)\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t// TODO: make conditional\r\n\t\t\t\t\t\t\t\t$(\"[id^='wta5_']\").each(function () {\r\n\t\t\t\t\t\t\t\t\tvar thisVal = $(this).val();\r\n\t\t\t\t\t\t\t\t\t$(this).data(\"org_val\", thisVal)\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction init_saving_guest_counts()\r\n{\r\n\t$(\"#save_guest_counts\").on('click', function () {\r\n\r\n\t\tvar numRegGuests = $(\"#regular_guest_count_goal\").val();\r\n\t\tvar numTasteGuests = $(\"#taste_guest_count_goal\").val();\r\n\t\tvar numIntroGuests = $(\"#intro_guest_count_goal\").val();\r\n\r\n\t\tdisplayModalWaitDialog('MIM_progress', \"Saving  Guest Count Projections ...\");\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\top: 'save_guest_counts',\r\n\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\tmenu_anchor_date: menu_anchor_date,\r\n\t\t\t\tnumRegGuests: numRegGuests,\r\n\t\t\t\tnumTasteGuests: numTasteGuests,\r\n\t\t\t\tnumIntroGuests: numIntroGuests\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t$(\"#regular_guest_count_goal\").removeClass('unsaved');\r\n\t\t\t\t\t$(\"#regular_guest_count_goal\").addClass('saved');\r\n\t\t\t\t\t$(\"#intro_guest_count_goal\").removeClass('unsaved');\r\n\t\t\t\t\t$(\"#intro_guest_count_goal\").addClass('saved');\r\n\t\t\t\t\t$(\"#taste_guest_count_goal\").removeClass('unsaved');\r\n\t\t\t\t\t$(\"#taste_guest_count_goal\").addClass('saved');\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: response\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction init_saving_week_inventory()\r\n{\r\n\t$(\"[id^='finalize_week_']\").on('click', function () {\r\n\r\n\t\tif ($(this).hasClass('disabled'))\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar thisWeek = this.id.split(\"_\")[2];\r\n\r\n\t\tvar preFlightResult = sumAndStoreOverrideInventory(thisWeek, true);\r\n\r\n\t\tif (preFlightResult !== false)\r\n\t\t{\r\n\t\t\tvar thisRecipe = preFlightResult[0];\r\n\t\t\tvar curNumberSold = preFlightResult[1];\r\n\t\t\tvar recipeName = $(\"#rname_\" + thisRecipe).html();\r\n\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: \"Error\",\r\n\t\t\t\tdiv_id: \"neg_warn\",\r\n\t\t\t\theight: 300,\r\n\t\t\t\tmodal: true,\r\n\t\t\t\tmessage: \"Recipe \" + recipeName + \" (ID \" + thisRecipe + \") has currently sold \" + curNumberSold + \" servings and the projected amount is less than that.\" +\r\n\t\t\t\t\t\" This would create negative inventory.  Please increase the projection.\"\r\n\t\t\t});\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize Week',\r\n\t\t\tmessage: \"Are you sure you wish to Finalize the Weekly Projected Inventory for week\" + thisWeek + \"?<br /><br />(This will increase the Available to Promise total that controls availability on your menus.)\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 150,\r\n\t\t\tconfirm: function () {\r\n\r\n\t\t\t\tvar overrideValues = {};\r\n\r\n\t\t\t\t$(\"[id^='wta\" + thisWeek + \"_']\").each(function () {\r\n\r\n\t\t\t\t\tvar thisInv = $(this).val();\r\n\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\t\t\t\toverrideValues[thisRecipe] = thisInv;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdisplayModalWaitDialog('MIM_progress', \"Saving Week \" + thisWeek + \" Inventory ...\");\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\t\t\top: 'finalize_week',\r\n\t\t\t\t\t\tweek_number: thisWeek,\r\n\t\t\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\toverrideValues: overrideValues\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(\"[id^='wta\" + thisWeek + \"_']\").each(function () {\r\n\t\t\t\t\t\t\t\t$(this).removeClass('unsaved');\r\n\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\tvar curVal = $(this).val() * 1;\r\n\t\t\t\t\t\t\t\t$(this).data('org_val', curVal);\r\n\t\t\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tsumAndStoreOverrideInventory(thisWeek, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction sumAndStoreOverrideInventory(thisWeek, preflight)\r\n{\r\n\tvar overrideValues = {};\r\n\r\n\t$(\"[id^='poi_']\").each(function () {\r\n\t\t// check for zero inventory\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\tvar weekly_sum = 0;\r\n\r\n\t\tif (thisWeek == 1)\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta1_\" + thisRecipe).val() * 1);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta1_\" + thisRecipe).data(\"org_val\") * 1);\r\n\t\t}\r\n\t\tif (thisWeek == 2)\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta2_\" + thisRecipe).val() * 1);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta2_\" + thisRecipe).data(\"org_val\") * 1);\r\n\t\t}\r\n\t\tif (thisWeek == 3)\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta3_\" + thisRecipe).val() * 1);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta3_\" + thisRecipe).data(\"org_val\") * 1);\r\n\t\t}\r\n\r\n\t\tif (thisWeek == 4)\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta4_\" + thisRecipe).val() * 1);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tweekly_sum += ($(\"#wta4_\" + thisRecipe).data(\"org_val\") * 1);\r\n\t\t}\r\n\r\n\t\tif ($(\"#wta5_\" + thisRecipe)[0])\r\n\t\t{\r\n\t\t\tif (thisWeek == 5)\r\n\t\t\t{\r\n\t\t\t\tweekly_sum += ($(\"#wta5_\" + thisRecipe).val() * 1);\r\n\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tweekly_sum += ($(\"#wta5_\" + thisRecipe).data(\"org_val\") * 1);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\toverrideValues[thisRecipe] = weekly_sum;\r\n\r\n\t\tvar numSold = Number($(\"#ovi_\" + thisRecipe).data('numsold'));\r\n\t\t$(\"cur_rmg_\" + thisRecipe).html(weekly_sum - numSold.valueOf());\r\n\r\n\t});\r\n\r\n\tif (preflight)\r\n\t{\r\n\t\tvar hasNegativeInventory = false;\r\n\t\tvar badRecipe = null;\r\n\t\tvar numSold = null;\r\n\t\t$(\"[id^='ovi_']\").each(function () {\r\n\t\t\tbadRecipe = this.id.split(\"_\")[1];\r\n\t\t\tvar newVal = overrideValues[badRecipe];\r\n\t\t\tnumSold = $(this).data(\"numsold\");\r\n\r\n\t\t\tif (numSold > newVal)\r\n\t\t\t{\r\n\t\t\t\thasNegativeInventory = true;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (hasNegativeInventory)\r\n\t\t{\r\n\t\t\treturn [\r\n\t\t\t\tbadRecipe,\r\n\t\t\t\tnumSold\r\n\t\t\t];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tdisplayModalWaitDialog('MIM_progress', \"Saving Override Inventory ...\");\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\top: 'save_override_inventory',\r\n\t\t\tstore_id: gStore_ID,\r\n\t\t\tmenu_id: menu_id,\r\n\t\t\toverrideValues: overrideValues\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\t$(\"[id^='ovi_']\").each(function () {\r\n\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\tvar newVal = overrideValues[thisRecipe];\r\n\t\t\t\t\t$(this).data('org_val', newVal);\r\n\t\t\t\t\t$(this).val(newVal);\r\n\t\t\t\t\t$(\"#cur_adj_inv_\" + thisRecipe).html(newVal);\r\n\t\t\t\t\tvar numSold = $(this).data(\"numsold\");\r\n\t\t\t\t\t$(\"#cur_rmg_\" + thisRecipe).html(newVal - numSold);\r\n\t\t\t\t\t$(\"#pts-td_\" + thisRecipe).data(\"tooltip\", 'Stored inventory: ' + newVal + ' Remaining: ' + (newVal - numSold));\r\n\t\t\t\t\t$(\"#cur_adj_inv_\" + thisRecipe).data(\"default_inventory\", newVal);\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: response\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction init_saving_override_inventory()\r\n{\r\n\t$(\"#save_override_inventory\").on('click', function () {\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize PreOrder',\r\n\t\t\tmessage: \"Are you sure you wish to save the Core Menu Available to Promise inventory?\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 150,\r\n\t\t\tconfirm: function () {\r\n\r\n\t\t\t\tvar overrideValues = {};\r\n\r\n\t\t\t\t$(\"[id^='ovi_']\").each(function () {\r\n\r\n\t\t\t\t\tvar thisInv = $(this).val();\r\n\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\t\t\t\toverrideValues[thisRecipe] = thisInv;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdisplayModalWaitDialog('MIM_progress', \"Saving Core Inventory ...\");\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\t\t\top: 'save_override_inventory',\r\n\t\t\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\t\t\toverrideValues: overrideValues\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$(\"[id^='ovi_']\").each(function () {\r\n\t\t\t\t\t\t\t\t$(this).removeClass('unsaved');\r\n\t\t\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\t\t\tvar curVal = $(this).val() * 1;\r\n\t\t\t\t\t\t\t\t$(this).data('org_val', curVal);\r\n\t\t\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: response\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction init_resetting_store_sales_mix()\r\n{\r\n\t$(\"#reset_sales_mix\").on('click', function () {\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Finalize Week',\r\n\t\t\tmessage: \"Are you sure you want to reset your store's sales mix to national values?\",\r\n\t\t\tmodal: true,\r\n\t\t\twidth: 400,\r\n\t\t\theight: 150,\r\n\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t$(\"[id^='nsm_']\").each(function () {\r\n\r\n\t\t\t\t\tvar thisMix = $(this).html();\r\n\t\t\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\t\t\t$(\"#ssmx_\" + thisRecipe).val(thisMix);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvalidateSalesMix();\r\n\r\n\t\t\t\t$(\"[id^='ssmx_']\").each(function () {\r\n\t\t\t\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\t\t\t\tvar curVal = $(this).val() * 1;\r\n\t\t\t\t\tif (orgVal != curVal)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).addClass('dirty');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction init_saving_store_sales_mix()\r\n{\r\n\t$(\"#save_sales_mix\").on('click', function () {\r\n\r\n\t\tvar storeSalesMix = {};\r\n\r\n\t\t$(\"[id^='ssmx_']\").each(function () {\r\n\r\n\t\t\tvar thisMix = $(this).val();\r\n\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\r\n\t\t\tstoreSalesMix[thisRecipe] = thisMix;\r\n\t\t});\r\n\r\n\t\tdisplayModalWaitDialog('MIM_progress', \"Saving Store Sales Mix  ...\");\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'admin_menuEditor',\r\n\t\t\t\top: 'save_store_sales_mix',\r\n\t\t\t\tstore_id: gStore_ID,\r\n\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\tstoreSalesMix: storeSalesMix\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t$(\"[id^='ssmx_']\").each(function () {\r\n\t\t\t\t\t\t$(this).removeClass('unsaved');\r\n\t\t\t\t\t\t$(this).addClass('saved');\r\n\t\t\t\t\t\tvar curVal = $(this).val() * 1;\r\n\t\t\t\t\t\t$(this).data('org_val', curVal);\r\n\t\t\t\t\t\t$(this).removeClass('dirty');\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmenuState.hasSavedStoreMix = true;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t$(\"#MIM_progress\").remove();\r\n\t\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: response\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nlet starterPackMix = {};\r\n\r\nfunction setNormalizedStarterPackMix()\r\n{\r\n\r\n\t$(\"[id^='ssmx_']\").each(function () {\r\n\t\tvar thisMix = $(this).val() / 100.0;\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\tvar isIntro = $(this).data('is_intro');\r\n\r\n\t\tif (isIntro)\r\n\t\t{\r\n\t\t\tstarterPackMix[thisRecipe] = thisMix;\r\n\t\t}\r\n\t});\r\n\r\n\tlet totalTastePercent = 0.0;\r\n\tfor (let key in starterPackMix)\r\n\t{\r\n\t\ttotalTastePercent += starterPackMix[key];\r\n\t}\r\n\r\n\tlet scaleFactor = 1.0 / totalTastePercent;\r\n\r\n\tfor (let key in starterPackMix)\r\n\t{\r\n\t\tstarterPackMix[key] = starterPackMix[key] * scaleFactor;\r\n\t}\r\n}\r\n\r\nlet workShopMix = {};\r\n\r\nfunction setNormalizedWorkshopMix()\r\n{\r\n\r\n\t$(\"[id^='ssmx_']\").each(function () {\r\n\t\tvar thisMix = $(this).val() / 100.0;\r\n\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\tvar isTaste = $(this).data('is_taste');\r\n\r\n\t\tif (isTaste)\r\n\t\t{\r\n\t\t\tworkShopMix[thisRecipe] = thisMix;\r\n\t\t}\r\n\t});\r\n\r\n\tlet totalTastePercent = 0.0;\r\n\tfor (let key in workShopMix)\r\n\t{\r\n\t\ttotalTastePercent += workShopMix[key];\r\n\t}\r\n\r\n\tlet scaleFactor = 1.0 / totalTastePercent;\r\n\r\n\tfor (let key in workShopMix)\r\n\t{\r\n\t\tworkShopMix[key] = workShopMix[key] * scaleFactor;\r\n\t}\r\n\r\n}\r\n\r\nfunction init_inventory_calculation()\r\n{\r\n\t$(\"#calc_inv\").on('click', function () {\r\n\r\n\t\t// validate percentages\r\n\t\tif (!validateSalesMix())\r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetNormalizedWorkshopMix();\r\n\t\tsetNormalizedStarterPackMix();\r\n\r\n\t\tvar averageServings = 29;\r\n\t\tvar numRegGuests = $(\"#regular_guest_count_goal\").val();\r\n\t\tvar numTasteGuests = $(\"#taste_guest_count_goal\").val();\r\n\t\tvar numIntroGuests = $(\"#intro_guest_count_goal\").val();\r\n\r\n\t\t$(\"[id^='ssmx_']\").not('[data-is_bundle=\"1\"]').each(function () {\r\n\r\n\t\t\tvar thisMix = $(this).val() / 100.0;\r\n\t\t\tvar thisRecipe = this.id.split(\"_\")[1];\r\n\t\t\tvar isIntro = $(this).data('is_intro');\r\n\t\t\tvar isTaste = $(this).data('is_taste');\r\n\r\n\t\t\tvar total_servingsNeeded = numRegGuests * averageServings * thisMix;\r\n\r\n\t\t\tif (isIntro)\r\n\t\t\t{\r\n\t\t\t\ttotal_servingsNeeded += numIntroGuests * 12 * starterPackMix[thisRecipe];\r\n\t\t\t}\r\n\r\n\t\t\tif (isTaste)\r\n\t\t\t{\r\n\t\t\t\ttotal_servingsNeeded += numTasteGuests * 9 * workShopMix[thisRecipe];\r\n\t\t\t}\r\n\r\n\t\t\ttotal_servingsNeeded = Math.round(total_servingsNeeded);\r\n\r\n\t\t\t$(\"#poi_\" + thisRecipe).html(total_servingsNeeded);\r\n\t\t\t$(\"#pwt_\" + thisRecipe).html(total_servingsNeeded);\r\n\t\t\t$(\"#cur_adj_inv_\" + thisRecipe).html(total_servingsNeeded);\r\n\t\t\t$(\"#ovi_\" + thisRecipe).val(total_servingsNeeded);\r\n\r\n\t\t\tvar weeksTotal = 0;\r\n\t\t\tfor (x in weekInfo)\r\n\t\t\t{\r\n\t\t\t\tvar number = weekInfo[x]['menu_week_number'];\r\n\t\t\t\tvar targetID = \"wt\" + number + \"_\" + thisRecipe;\r\n\t\t\t\tvar targetIDEditable = \"wta\" + number + \"_\" + thisRecipe;\r\n\t\t\t\tvar distributionPercent = weekInfo[x]['distribution_percent'] / 100;\r\n\t\t\t\tvar thisProjection = Math.round(distributionPercent * total_servingsNeeded);\r\n\t\t\t\tweeksTotal += thisProjection;\r\n\r\n\t\t\t\t$(\"#\" + targetID).html(thisProjection);\r\n\t\t\t\t$(\"#\" + targetIDEditable).val(thisProjection);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (weeksTotal != total_servingsNeeded)\r\n\t\t\t{\r\n\t\t\t\tvar diff = weeksTotal - total_servingsNeeded;\r\n\t\t\t\tthisProjection -= diff;\r\n\t\t\t\t$(\"#\" + targetID).html(thisProjection);\r\n\t\t\t\t$(\"#\" + targetIDEditable).val(thisProjection);\r\n\t\t\t}\r\n\r\n\t\t\treconcile_weeks_to_monthly_projection();\r\n\t\t});\r\n\t});\r\n\r\n}\r\n\r\nfunction init_sales_mix_editing()\r\n{\r\n\r\n\t$(\"[id^='ssmx_']\").on('change', function () {\r\n\t\tvalidateSalesMix();\r\n\t\tvar orgVal = $(this).data(\"org_val\") * 1;\r\n\t\tvar curVal = $(this).val() * 1;\r\n\t\tif (orgVal != curVal)\r\n\t\t{\r\n\t\t\t$(this).addClass('dirty');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('dirty');\r\n\t\t}\r\n\r\n\t});\r\n}\r\n\r\nfunction resetPage()\r\n{\r\n\tdocument.getElementById('action').value = \"menuChange\";\r\n\tdocument.getElementById('menu_editor_form').submit();\r\n}\r\n\r\nfunction displayValidationErrorMsg(msg)\r\n{\r\n\tmsg = \"<span style='color:red; font-size:larger;'>\" + msg + \"</span>\";\r\n\r\n\tdd_message({\r\n\t\ttitle: 'Error',\r\n\t\tmessage: msg\r\n\t});\r\n}\r\n\r\nfunction clearErrors()\r\n{\r\n\tvar statusDiv = document.getElementById('errorMsg');\r\n\tstatusDiv.style.display = 'none';\r\n\tstatusTextDiv = document.getElementById('errorMsgText');\r\n\tstatusTextDiv.innerHTML = \"\";\r\n}\r\n\r\nfunction storeChange(obj)\r\n{\r\n\tdocument.getElementById('action').value = \"storeChange\";\r\n\tdocument.getElementById('menu_editor_form').submit();\r\n}\r\n\r\nfunction menuChange(obj)\r\n{\r\n\tdocument.getElementById('action').value = \"menuChange\";\r\n\tdocument.getElementById('menu_editor_form').submit();\r\n}\r\n\r\nfunction calculatePage()\r\n{\r\n\r\n\tvar is_unsaved = false;\r\n\tvar sidesCount = 0;\r\n\r\n\tvar itemRows = document.getElementById('itemsTbl').rows;\r\n\r\n\tfor (var i = 0; i < itemRows.length; i++)\r\n\t{\r\n\t\tif (itemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = null;\r\n\t\tif (itemRows[i].id == 'addonEditorRow')\r\n\t\t{\r\n\t\t\titemNumber = itemRows[i].getAttribute('item_id');\r\n\t\t\tif (!itemNumber)\r\n\t\t\t{\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\titemNumber = itemRows[i].id.substr(4);\r\n\t\t}\r\n\r\n\t}\r\n\t// EFL Items\r\n\r\n\tvar EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\r\n\r\n\tfor (var i = 0; i < EFL_itemRows.length; i++)\r\n\t{\r\n\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = null;\r\n\t\tif (EFL_itemRows[i].id == 'addonEditorRow')\r\n\t\t{\r\n\t\t\titemNumber = EFL_itemRows[i].getAttribute('item_id');\r\n\t\t\tif (!itemNumber)\r\n\t\t\t{\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\titemNumber = EFL_itemRows[i].id.substr(4);\r\n\t\t}\r\n\r\n\t}\r\n\t// Chef Touched Selections\r\n\tvar ctsItemRows = document.getElementById('ctsItemsTbl').rows;\r\n\tfor (i = 0; i < ctsItemRows.length; i++)\r\n\t{\r\n\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = null;\r\n\t\titemNumber = ctsItemRows[i].id.substr(4);\r\n\t}\r\n\r\n}\r\n\r\nfunction confirm_and_check_form()\r\n{\r\n\r\n\tvar form = $(\"#menu_editor_form\")[0];\r\n\r\n\tclearErrors();\r\n\r\n\tvalidated = _check_form(form);\r\n\r\n\tvar itemRows = document.getElementById('itemsTbl').rows;\r\n\r\n\tfor (var i = 0; i < itemRows.length; i++)\r\n\t{\r\n\t\tif (itemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = itemRows[i].id.substr(4);\r\n\r\n\t}\r\n\r\n\tvar EFL_itemRows = document.getElementById('EFLitemsTbl').rows;\r\n\r\n\tfor (var i = 0; i < EFL_itemRows.length; i++)\r\n\t{\r\n\t\tif (EFL_itemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = EFL_itemRows[i].id.substr(4);\r\n\t}\r\n\r\n\tvar ctsItemRows = document.getElementById('ctsItemsTbl').rows;\r\n\r\n\tfor (i = 0; i < ctsItemRows.length; i++)\r\n\t{\r\n\t\tif (ctsItemRows[i].id.indexOf('row_') == -1)\r\n\t\t{\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar itemNumber = ctsItemRows[i].id.substr(4);\r\n\t}\r\n\r\n\tif (message != \"\")\r\n\t{\r\n\t\tvalidated = false;\r\n\t\tdisplayValidationErrorMsg(message);\r\n\t}\r\n\r\n\tif (validated)\r\n\t{\r\n\t\tvar finalizeMessage = \"Are you sure want to submit these changes to your menu? If the menu is active the changes will be immediately available to your customers.\";\r\n\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Attention',\r\n\t\t\tmessage: finalizeMessage,\r\n\t\t\tmodal: true,\r\n\t\t\tconfirm: function () {\r\n\t\t\t\tdocument.getElementById('action').value = \"finalize\";\r\n\t\t\t\t$(\"#menu_editor_form\").submit();\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tcancel: function () {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t``\r\n\t}\r\n\treturn false;\r\n}"],"names":["let","sidesDataArray","notShown","menu_editor_init","init_sales_mix_editing","init_week_inventory_editing","init_override_inventory_editing","init_inventory_calculation","init_saving_guest_counts","init_saving_store_sales_mix","init_resetting_store_sales_mix","init_finalize_preorder","init_save_sides_inventory","init_save_EFL_inventory","init_saving_override_inventory","init_saving_week_inventory","init_show_actuals","init_export_sales","init_reset_to_current","reconcile_data","calculatePage","initNavTab","$","stickyTableHeaders","menuState","hasSavedPreOrder","each","this","addClass","oldUrl","attr","newUrl","substring","indexOf","params","Proxy","URLSearchParams","window","location","search","get","searchParams","prop","tabs","on","data","bootbox","confirm","result","reload","hasDirtyFields","hasClass","message","dd_message","title","modal","width","height","url","gStore_ID","menu_id","weekNumber","id","split","weekStart","start","val","end","click","$header","$content","html","slideToggle","btn_name","thisInv","thisRecipe","removeClass","overrideValues","displayModalWaitDialog","ajax","type","timeout","dataType","processor","op","store_id","success","json","remove","processor_success","curVal","processor_message","error","objAJAXRequest","strError","response","save_to_global","dd_round_amount","inAmount","tempVal","parseInt","pennyFraction","Math","floor","validateSalesMix","sumPercents","newVal","alert","delta","abs","guidance","orgVal","reconcile_weeks_to_monthly_projection","numSold","Number","valueOf","number_sold","thisVal","weekly_sum","huh","USER_PREFERENCES","HAS_SEEN_ELEMENT","value","WEEKLY_INVENTORY_WARNING","variance_msg","closeCallback","is","set_user_pref","USER_DETAILS","preorderInventory","week1Inv","week2Inv","week3Inv","week4Inv","week5Inv","encounteredNegativeInventory","curNumberSold","recipeName","div_id","data_tooltips_init","numRegGuests","numTasteGuests","numIntroGuests","menu_anchor_date","thisWeek","preFlightResult","sumAndStoreOverrideInventory","week_number","preflight","hasNegativeInventory","badRecipe","thisMix","storeSalesMix","hasSavedStoreMix","starterPackMix","setNormalizedStarterPackMix","isIntro","totalTastePercent","key","scaleFactor","workShopMix","setNormalizedWorkshopMix","isTaste","averageServings","not","total_servingsNeeded","round","weeksTotal","x","weekInfo","number","targetID","targetIDEditable","distributionPercent","thisProjection","diff","resetPage","document","getElementById","submit","displayValidationErrorMsg","msg","clearErrors","statusDiv","style","display","statusTextDiv","innerHTML","storeChange","obj","menuChange","is_unsaved","sidesCount","itemRows","rows","i","length","itemNumber","getAttribute","substr","EFL_itemRows","ctsItemRows","confirm_and_check_form","form","validated","_check_form","finalizeMessage","cancel"],"mappings":"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"}