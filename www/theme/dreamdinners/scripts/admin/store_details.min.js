function store_details_init(){handle_preview_elements(),handle_dyanmic_store_hours(),SetGrandOpeningWidget(!0),$("#update_grandopeningdate").length&&(document.getElementById("update_grandopeningdate").checked=!1),handle_archive_store(),handle_delete_store(),handle_empty_latlong(),handle_address_change(),$(".telephone").mask("999-999-9999"),handle_same_as_store(),handle_order_customization(),$("#manager_1_user_id").bind("change, keypress, keyup",(function(e){$("#manager_1_user_id").val()||$("#manager_1_name, #manager_1_primary_email, #manager_1_telephone_1").val("")})),$(document).on("keyup",".previewable",(function(e){$(this).val()!=strip_tags($(this).val(),"<a>")&&$(this).val(strip_tags($(this).val(),"<a><b>")),""!=$(this).val()?$("#"+$(this).attr("id")+"_preview").html(nl2br($(this).val())).slideDown():$("#"+$(this).attr("id")+"_preview").slideUp()})),$(document).on("focusout","#social_twitter, #social_facebook, #social_instagram",(function(e){""==$(this).val()&&$(this).val("dreamdinners")}))}function addManager(e){$("#manager_1_user_id").val($(e).data("user_id")),$("#manager_1_name").val($(e).data("firstname")+" "+$(e).data("lastname")),$("#manager_1_primary_email").val($(e).data("primary_email")),$("#manager_1_telephone_1").val($(e).data("telephone_1"))}function handle_dyanmic_store_hours(){$(".store-hours-selector-open").each((function(){createTimeSelection($(this),"open")})),$(".store-hours-selector-close").each((function(){createTimeSelection($(this),"close")})),$(".store-closed").each((function(){createClosedCheckbox($(this))})),$("#preview-hours").on("click",(function(){let e=document.getElementById("bio_store_hours_preview");e&&(e.style.display="block",e.innerHTML=nl2br(decodeTimeSelection())),$("#bio_store_hours").val(decodeTimeSelection())})),togglePreview($("#bio_store_hours")),""!=$.trim($("#bio_store_hours").val())&&encodeTimeSelection()}function decodeTimeSelection(){let e="";return $(".store-hour-selection-container").each((function(){let t=$(this).data("day");if($("#store-is-closed-"+t).is(":checked"))e+=t+": Closed\n";else{let a=$("#store-hours-open-"+t).val(),n=$("#store-hours-close-"+t).val();e+=t+": "+millitaryToMeridiem(a)+" - "+millitaryToMeridiem(n)+"\n"}})),e}function millitaryToMeridiem(e){let t=(e=e.split(":"))[0],a=t>=12?"pm":"am";return t=t>12?t-12:t,t="00"==t?12:t,t+":"+e[1]+" "+a}function meridiemToMillatary(e){var t=Number(e.match(/^(\d+)/)[1]),a=Number(e.match(/:(\d+)/)[1]),n=e.match(/\s(.*)$/)[1];"PM"==n&&t<12&&(t+=12),"AM"==n&&12==t&&(t-=12);var i=t.toString(),o=a.toString();return t<10&&(i="0"+i),a<10&&(o="0"+o),i+":"+o}function encodeTimeSelection(){let e=$("#bio_store_hours").val().split(/\r?\n/);for(let t=0;t<e.length;t++){let a=e[t].split(": "),n=a[0];if("Closed"==a[1])$("#store-is-closed-"+n).prop("checked",!0);else{let e=a[1].split(" - "),t=e[0],i=e[1];$("#store-hours-open-"+n).val(meridiemToMillatary(t)),$("#store-hours-close-"+n).val(meridiemToMillatary(i))}console.log(n)}}function createTimeSelection(e,t){let a=$('<select id="store-hours-'+t+"-"+e.data("day")+'" data-day="'+e.data("day")+'"/>');for(let e in time_picker_hours)$("<option />",{value:e,text:time_picker_hours[e]}).appendTo(a);a.appendTo(e)}function createClosedCheckbox(e){$('<input type="checkbox" id="store-is-closed-'+e.data("day")+'" data-day="'+e.data("day")+'" name="Closed"/> <label for="Closed">Closed</label>').appendTo(e)}function handle_preview_elements(){$(".previewable").each((function(){togglePreview($(this))}))}function handle_order_customization(){$("#supports_meal_customization").on("click",(function(){toggleOrderCustomization(this.checked)}))}function toggleOrderCustomization(e){e?$(".customization_fields").show():$(".customization_fields").hide()}function handle_same_as_store(){$("#pkg_ship_same_as_store, #letter_ship_same_as_store").on("click",(function(){var e=$(this).data("contact"),t=!0;$(this).is(":checked")?$("#"+e+"_is_commercial, #"+e+"_address_line1, #"+e+"_address_line2, #"+e+"_city, #"+e+"_state_id, #"+e+"_postal_code, #"+e+"_telephone_day").val((function(){return $(this).data("store_value")})):t=!1,$("#"+e+"_is_commercial, #"+e+"_address_line1, #"+e+"_address_line2, #"+e+"_city, #"+e+"_state_id, #"+e+"_postal_code, #"+e+"_telephone_day").attr({disabled:t})}))}function onPlatePointsOptinChange(e){e.checked?($("#supports_plate_points_signature_row").show(),$("#supports_plate_points_signature").attr("data-dd_required",!0)):($("#supports_plate_points_signature_row").hide(),$("#supports_plate_points_signature").attr("data-dd_required",!1))}function override_check_form(e,t){let a=!0;$("#default_delayed_payment_deposit").length&&($("#default_delayed_payment_deposit").val()<20&&(dd_message({message:"The Delayed Payment Deposit must be at least $20."}),a=!1));return $("[id$='_session_desc']").each((function(){0!=$(this).val().length&&$(this).val().length<6&&(dd_message({message:"Session Descriptions must either be empty or must be more than 5 characters in length. If empty the defauly description will be used."}),a=!1)})),!!a&&_check_form(t)}function handle_address_change(){$("#address_line1, #address_line2, #city, #state_id, #postal_code, #usps_adc").bind("keyup change click",(function(){linear_address=$("#address_line1").val(),linear_address+=", "+$("#city").val(),linear_address+=", "+$("#state_id").val(),linear_address+=" "+$("#postal_code").val(),""!=$("#usps_adc").val()&&(linear_address+="-"+$("#usps_adc").val()),$(".gllpSearchField").val(linear_address),$("#map_link").prop("href","https://maps.google.com/maps?q="+linear_address+"&iwloc=A&hl=en")}))}function handle_empty_latlong(){$("#address_latitude").is(":disabled")||""!=$("#address_latitude").val()&&"0.000000"!=$("#address_latitude").val()&&""!=$("#address_longitude").val()&&"0.000000"!=$("#address_longitude").val()||(dd_message({message:"Latitude and Longitude have not yet been set for this store, please drag the marker to the front door of the store."}),$(".gllpSearchButton").trigger("click"))}function handle_archive_store(){$("#archive_store").on("click",(function(){store_name=$(this).data("store_name"),home_office_id=$(this).data("home_office_id"),store_id=$(this).data("store_id"),dd_message({title:"Archive Store",message:"Are you sure you want to archive and re-open "+store_name+" #"+home_office_id+"?",confirm:function(){bounce("main.php?page=admin_archive_store&store="+store_id)}})}))}function handle_delete_store(){$("#delete_store").on("click",(function(){store_id=$(this).data("store_id"),dd_message({title:"Delete Store",message:'Are you sure you want to <span style="color: red; font-weight: bold;">permanently delete</span> this store from all of Dream Dinners?',confirm:function(){bounce("main.php?page=admin_store_details&id="+store_id+"&action=deleteStore"),create_and_submit_form({action:"main.php?page=admin_store_details&id"+store_id,input:{action:"deleteStore",id:store_id}})}})}))}function updatePreview(e){if(e){var t=document.getElementById(e.attr("name")+"_preview");e&&t&&(t.innerHTML=nl2br(e.val()))}}function togglePreview(e){let t=document.getElementById(e.attr("name")+"_preview");"none"==t.style.display?(t.style.display="block",updatePreview(e)):t.style.display="none"}function update_grand_opening_function(e){SetGrandOpeningWidget(!e.checked)}function SetGrandOpeningWidget(e){var t="hidden";document.getElementById("grand_opening_date_Month_ID")&&(document.getElementById("grand_opening_date_Month_ID").disabled=e),document.getElementById("grand_opening_date_Day_ID")&&(document.getElementById("grand_opening_date_Day_ID").disabled=e),document.getElementById("grand_opening_date_Year_ID")&&(document.getElementById("grand_opening_date_Year_ID").disabled=e),document.getElementById("grand_opening_date_Month_ID")&&(document.getElementById("grand_opening_date_Month_ID").disabled=e),0==e&&(t="visible"),document.getElementById("grand_opening_date_ID_Link")&&(document.getElementById("grand_opening_date_ID_Link").style.visibility=t)}
//# sourceMappingURL=store_details.min.js.map