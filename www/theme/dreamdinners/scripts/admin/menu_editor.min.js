const limit_visible_efl=10,limit_visible_sides=20;function showPopup(e){var t={type:"GET",height:500,width:600,modal:!1,callBack:!1,resizable:!0};$.extend(t,e),$.ajax({url:"?"+t.module,type:t.type,success:function(e,i){t.message=e,dd_message(t),"function"==typeof t.callBack&&t.callBack()},error:function(e,t){response="Unexpected error"}})}$(document).ready((function(){$(".menu-editor-ovr").trigger("change")})),$('#menu-editor-nav > [data-toggle="tab"]').on("shown.bs.tab",(function(e){historyReplace({url:"?tab=nav-"+$(e.currentTarget).data("nav")})})),$(document).on("change","#menu",(function(e){let t=$(this).val();e.preventDefault(),$(this.form).formHasChanged()?bootbox.dialog({title:"Confirmation",message:"<p>Are you sure you wish to change menus? You will lose any unsaved changes.</p>",centerVertical:!0,buttons:{cancel:{label:"Cancel",className:"btn-secondary mr-auto",callback:function(){$("#menu").valDefault()}},confirm:{label:"Switch menu",callback:function(){create_and_submit_form({action:"/backoffice/menu-editor",input:{menu:t}})}}}}):create_and_submit_form({action:"/backoffice/menu-editor",input:{menu:t}})})),$(document).on("click",".sides-sweets-save",(function(e){e.preventDefault(),bootbox.dialog({title:"Confirmation",message:"<p>Are you sure you wish to save all current Sides &amp; Sweets pricing and visibility settings to retrieve on future menus?</p>",centerVertical:!0,buttons:{cancel:{label:"Cancel",className:"btn-secondary mr-auto"},confirm:{label:"Save defaults",className:"btn-danger",callback:function(){let e=bootbox.dialog({message:'<p><i class="fa fa-spin fa-spinner"></i> Saving defaults, please wait.</p>',centerVertical:!0,closeButton:!1}),t={};$(".menu-editor-ovr").each((function(e){let i=$(this).data("menu_item_id"),a=$(this).data("recipe_id");t[a]={ovr:$(this).val(),vis:$('.menu-editor-vis[data-menu_item_id="'+i+'"]').val(),hid:$('.menu-editor-hid[data-menu_item_id="'+i+'"]').val(),pic:$('.menu-editor-pic[data-menu_item_id="'+i+'"]').val(),form:$('.menu-editor-form[data-menu_item_id="'+i+'"]').val()}})),$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_defaultPricingProcessor",store_id:STORE_DETAILS.id,action:"save",data:t},success:function(t){t.processor_success?e.modal("hide"):dd_message({title:"Error",message:t.processor_message})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Error",message:response})}})}}}})})),$(document).on("click",".sides-sweets-retrieve",(function(e){e.preventDefault(),bootbox.prompt({title:"Confirmation",message:"<p>This will update settings for both hidden and visible Sides &amp; Sweets tabs. You will have the ability to review the changes before finalizing. Select the setings you wish to retrieve.</p>",inputType:"checkbox",inputOptions:[{text:"Show on customer menu",value:"vis"},{text:"Show on Sides & Sweets Forms",value:"form"},{text:"Price",value:"ovr"}],centerVertical:!0,buttons:{cancel:{label:"Cancel",className:"btn-secondary mr-auto"},confirm:{label:"Retrieve defaults"}},callback:function(e){e&&(0===e.length?bootbox.alert({title:"Notice",message:"<p>No options were selected.</p>",centerVertical:!0}):$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_defaultPricingProcessor",store_id:STORE_DETAILS.id,action:"retrieve"},success:function(t){t.processor_success?$.each(t.settings,(function(t,i){if(e.includes("ovr")&&$('.menu-editor-ovr[data-recipe_id="'+t+'"][data-category_id="9"]').val(i.ovr).trigger("change"),e.includes("vis")){let e=new Set;$('.menu-editor-vis[data-category_id="9"] option:selected[value="1"]').each((function(){e.add($(this).closest("select").data("recipe_id"))})),e.size<=20&&$('.menu-editor-vis[data-recipe_id="'+t+'"][data-category_id="9"]').val(i.vis).trigger("change"),$('.menu-editor-hid[data-recipe_id="'+t+'"][data-category_id="9"]').val(i.hid).trigger("change")}e.includes("form")&&($('.menu-editor-form[data-recipe_id="'+t+'"][data-category_id="9"]').val(i.form).trigger("change"),$('.menu-editor-hid[data-recipe_id="'+t+'"][data-category_id="9"]').val(i.hid).trigger("change"))})):dd_message({title:"Error",message:t.processor_message})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Error",message:response})}}))}})})),$(document).on("change",".menu-editor-hid",(function(e){let t=$(this).data("menu_item_id");1==this.value&&$('.menu-editor-vis[data-menu_item_id="'+t+'"], .menu-editor-form[data-menu_item_id="'+t+'"], .menu-editor-pic[data-menu_item_id="'+t+'"]').val(0).trigger("change"),$(this).valNotDefault()?$(this).addClass("border-orange"):$(this).removeClass("border-orange")})),$(document).on("change",".menu-editor-vis, .menu-editor-form, .menu-editor-pic",(function(e){let t=$(this).data("menu_item_id"),i=$(this).data("category_id"),a=$(this).data("is_store_special"),o=new Set;1==this.value&&($('.menu-editor-hid[data-menu_item_id="'+t+'"]').val(0).trigger("change"),$(this).is(".menu-editor-vis")&&(9==i&&($('.menu-editor-vis[data-category_id="9"] option:selected[value="1"]').each((function(){o.add($(this).closest("select").data("recipe_id"))})),o.size>20&&($(this).closest("select").valDefault(),$('.menu-editor-hid[data-menu_item_id="'+t+'"]').valDefault(),bootbox.alert({title:"Notice",message:"<p>You may only display a maximum of 20 Sides &amp; Sweets recipes on the customer facing menu.</p>",centerVertical:!0}))),4==i&&1==a&&($('.menu-editor-vis[data-category_id="4"][data-is_store_special="1"] option:selected[value="1"]').each((function(){o.add($(this).closest("select").data("recipe_id"))})),o.size>10&&($(this).closest("select").valDefault(),$('.menu-editor-hid[data-menu_item_id="'+t+'"]').valDefault(),bootbox.alert({title:"Notice",message:"<p>You may only display a maximum of 10 Extended Fast Lane recipes on the customer facing menu.</p>",centerVertical:!0}))))),$(this).valNotDefault()?$(this).addClass("border-orange"):$(this).removeClass("border-orange")})),$(document).on("change keyup",".menu-editor-ovr",(function(e){let t=$(this).data("menu_item_id"),i=Number($(this).data("lowest_tier_price")),a=Number($(this).data("highest_tier_price")),o=Number(Number($(this).val()).toFixed(2));var n=Number($(this).val()).toFixed(2).split(".");$(this).removeClass("border-orange"),$('.ovr-alert-danger[data-menu_item_id="'+t+'"]').hideFlex(),$('.ovr-alert-warning[data-menu_item_id="'+t+'"]').hideFlex(),$(this).valNotDefault()&&$(this).addClass("border-orange"),i>0&&a>0&&(o<i||o>a)&&$('.ovr-alert-danger[data-menu_item_id="'+t+'"]').showFlex(),o>0&&"99"!=n[1]&&"49"!=n[1]&&$('.ovr-alert-warning[data-menu_item_id="'+t+'"]').showFlex()})),$(document).on("change keyup",".menu-editor-hid, .menu-editor-vis, .menu-editor-form, .menu-editor-pic, .menu-editor-ovr",(function(e){$("#menu-editor-nav > [data-nav] > .fa-asterisk").hideFlex(),$(".menu-editor-unsaved-alert").hideFlex(),$(this.form).formHasChanged()&&$(".menu-editor-unsaved-alert").showFlex(),$("#menu-editor-nav > [data-nav]").each((function(){let e=$(this).data("nav");$("#nav-"+e).find(".border-orange").length&&$('#menu-editor-nav > [data-nav="'+e+'"] > .fa-asterisk').showFlex()}))})),$(document).on("click",".menu-editor-reset",(function(e){bootbox.dialog({title:"Confirmation",message:"<p>Are you sure you wish to reset all currently pending changes?</p>",centerVertical:!0,buttons:{cancel:{label:"Cancel",className:"btn-secondary mr-auto"},confirm:{label:"Reset changes",className:"btn-danger",callback:function(){$("#menu_editor_form").trigger("reset"),$("#menu_editor_form").removeClass("was-validated"),$("#menu-editor-nav > [data-nav] > .fa-exclamation-circle").hideFlex(),$("#menu-editor-nav > [data-nav] > .fa-asterisk").hideFlex(),$(".menu-editor-vis, .menu-editor-form, .menu-editor-pic, .menu-editor-hid, .menu-editor-ovr").removeClass("border-orange")}}},onHidden:function(e){$(".menu-editor-ovr").trigger("change")}})})),$(document).on("submit keydown keyup","#menu_editor_form",(function(e){if(13==e.keyCode)return e.preventDefault(),!1})),$(document).on("click",".menu-editor-finalize",(function(e){$("#menu-editor-nav > [data-nav] > .fa-exclamation-circle").hideFlex(),!1!==$("#menu_editor_form").validateForm()?bootbox.dialog({title:"Confirmation",message:"<p>Are you sure you wish to save all menu editor changes?</p>",centerVertical:!0,buttons:{cancel:{label:"Cancel",className:"btn-secondary mr-auto"},confirm:{label:"Finalize changes",className:"btn-danger",callback:function(){$("#action").val("finalize"),$("#menu_editor_form").trigger("submit"),bootbox.dialog({message:'<p><i class="fa fa-spin fa-spinner"></i> Finalizing changes, please wait.</p>',centerVertical:!0,closeButton:!1})}}}}):(bootbox.alert({title:"Notice",message:"<p>There is an issue with the submission, check tabs for required fields.</p>",centerVertical:!0}),$("#menu-editor-nav > [data-nav]").each((function(){let e=$(this).data("nav");$("#nav-"+e).find(".form-control:invalid").length&&$('#menu-editor-nav > [data-nav="'+e+'"] > .fa-exclamation-circle').showFlex()})))})),$(document).on("click","#add_past_menu_item:not(.disabled)",(function(e){displayModalWaitDialog("wait_for_adding_item_div","Retrieving items. Please wait ...");let t=$(this).data("menu_id");showPopup({modal:!0,title:"Add EFL Item",noOk:!0,closeOnEscape:!1,height:720,div_id:"add_menu_item_popup_div",module:"page=admin_menu_editor_add_item&menu_id="+t,open:function(e,t){$(this).parent().find(".ui-dialog-titlebar-close").hide(),$("#wait_for_adding_item_div").remove()},buttons:{Cancel:function(){$(this).remove()},Okay:function(){let e={};$("#sel_list").find("[data-rmv_menu_item]").each((function(){let t=$(this).data("entree_id");e[t]=t})),dd_message({title:"",message:"This will immediately add the listed items to the menu. Are you sure?",noOk:!0,height:180,buttons:{"Add Items to Menu":function(){bootbox.dialog({message:'<p><i class="fa fa-spin fa-spinner"></i> Adding menu items, please wait.</p>',centerVertical:!0,closeButton:!1}),$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_menuEditor",store_id:STORE_DETAILS.id,op:"add_menu_item",menu_id:t,entree_ids:e},success:function(e){e.processor_success?bounce("/backoffice/menu-editor?tab=nav-efl"):dd_message({title:"Error",message:e.processor_message})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Error",message:response})}}),$(this).remove(),$("#add_menu_item_popup_div").remove()},Cancel:function(){$(this).remove()}}})}},close:function(){bounce("/backoffice/menu-editor?tab=nav-efl")}})})),$(document).on("click","[data-add_menu_item]",(function(e){if($(this).hasClass("disabled"));else{$(this).addClass("disabled");let e=$(this).data("entree_id"),t=$(this).data("recipe_id"),i=$('[data-recipe_id_row="'+t+'"]').clone();i.find("[data-rmv_menu_item="+e+"]").show(),i.find("[data-add_menu_item="+e+"]").remove(),$("#selected_items tbody").append(i)}})),$(document).on("click","[data-rmv_menu_item]",(function(e){let t=$(this).data("entree_id"),i=$(this).data("recipe_id");$('#selected_items tbody [data-recipe_id_row="'+i+'"]').remove(),$('#recipe_list tbody [data-recipe_id_row="'+i+'"]').find('[data-add_menu_item="'+t+'"]').removeClass("disabled")})),$(document).on("click","[data-info_menu_item]",(function(e){let t=$(this).data("entree_id"),i=$(this).data("recipe_id");$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_menuEditor",store_id:STORE_DETAILS.id,op:"menu_item_info",menu_id:menu_id,entree_id:t,recipe_id:i},success:function(e){dd_message({modal:!0,title:"Item Information",height:720,width:720,message:e.data,open:function(){handle_tabbed_content()}})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Error",message:response})}})})),$(document).on("click","#add_past_menu_item_sides:not(.disabled)",(function(e){displayModalWaitDialog("wait_for_adding_item_div","Retrieving Sides & Sweets. Please wait ...");let t=$(this).data("menu_id");showPopup({modal:!0,title:"Add Sides & Sweets",noOk:!0,closeOnEscape:!1,height:720,div_id:"add_menu_item_popup_div",module:"page=admin_menu_editor_add_sides_sweets&menu_id="+t,open:function(e,t){$(this).parent().find(".ui-dialog-titlebar-close").hide(),$("#wait_for_adding_item_div").remove()},buttons:{Cancel:function(){$(this).remove()},Okay:function(){let e={},i=!1;$("#sel_list").find("[data-rmv_menu_side]").each((function(){let t=$(this).data("entree_id");e[t]=t;let a=$("[data-recipe_category="+t+"]:visible").find(":selected").val();void 0===a&&(a=$("[data-recipe_category="+t+"]:visible").html()),void 0===a?($("[data-recipe_category="+t+"]").css("border-color","red"),i=!0):e[t]=a})),i?(console.log("Missing"),dd_message({title:"Please select a category for all items",message:"Please select a category for all items"})):dd_message({title:"",message:"This will immediately add the listed Sides & Sweets to the menu. Are you sure?",noOk:!0,height:180,buttons:{"Add Sides & Sweets to Menu":function(){bootbox.dialog({message:'<p><i class="fa fa-spin fa-spinner"></i> Adding menu items, please wait.</p>',centerVertical:!0,closeButton:!1}),$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_menuEditor",store_id:STORE_DETAILS.id,op:"add_menu_side",menu_id:t,entree_ids:e},success:function(e){e.processor_success?bounce("/backoffice/menu-editor?tab=nav-sides-hidden"):dd_message({title:"Error adding Sides & Sweets",message:e.processor_message})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Network Error adding Sides and Sweets",message:response})}}),$(this).remove(),$("#add_menu_item_popup_div").remove()},Cancel:function(){$(this).remove()}}})}},close:function(){bounce("/backoffice/menu-editor?tab=nav-sides-hidden")}})})),$(document).on("change","[data-recipe_category]",(function(e){void 0===$(this).find(":selected").val()?$(this).css("border-color","red"):$(this).css("border-color","black")})),$(document).on("click","[data-add_menu_side]",(function(e){if($(this).hasClass("disabled"));else{$(this).addClass("disabled");let e=$(this).data("entree_id"),t=$(this).data("recipe_id"),i=$('[data-recipe_id_row="'+t+'"]').clone();i.find("[data-rmv_menu_side="+e+"]").show(),i.find("[data-add_menu_side="+e+"]").remove(),i.find("[data-recipe_category="+e+"]").show();let a=i.find("[data-old_category="+e+"]").html();i.find("[data-old_category="+e+"]").remove(),$("#selected_items tbody").append(i),$("[data-recipe_category="+e+"]").val(a)}})),$(document).on("click","[data-rmv_menu_side]",(function(e){let t=$(this).data("entree_id"),i=$(this).data("recipe_id");$('#selected_items tbody [data-recipe_id_row="'+i+'"]').remove(),$('#recipe_list tbody [data-recipe_id_row="'+i+'"]').find('[data-add_menu_side="'+t+'"]').removeClass("disabled")})),$(document).on("click","[data-info_menu_side]",(function(e){let t=$(this).data("entree_id"),i=$(this).data("recipe_id");$.ajax({url:"/processor",type:"POST",timeout:2e4,dataType:"json",data:{processor:"admin_menuEditor",store_id:STORE_DETAILS.id,op:"menu_item_info",menu_id:menu_id,entree_id:t,recipe_id:i},success:function(e){dd_message({modal:!0,title:"Item Information",height:720,width:720,message:e.data,open:function(){handle_tabbed_content()}})},error:function(e,t){response="Unexpected error: "+t,dd_message({title:"Error",message:response})}})})),$(document).on("keyup change","#filter",(function(e){$.uiTableFilter($("#recipe_list"),this.value)})),$(document).on("click","#clear_filter",(function(e){$("#filter").val("").change(),Modernizr.input.placeholder||$("#filter").focus().blur()}));
//# sourceMappingURL=menu_editor.min.js.map