{"version":3,"file":"account.min.js","names":["handle_tc_delayed_payment","$","on","is","dd_message","title","lang","en","tc","terms_and_conditions","message","delayed_payment","modal","noOk","buttons","Agree","this","remove","prop","Decline","delayed_payment_decline","handle_platepoints_enrollment","set_req","attr","data","getQueryVariable","triggerHandler","how_did_you_hear_init","val","showFlex","document","e","hideFlex","disabled","required","opt_out_platepoints","user_id","div_id","zIndex","resizable","cancel","confirm","handle_opt_out_platepoints","ajax","url","type","timeout","dataType","processor","op","success","json","status","processor_success","show","checkboxObj","error","objAJAXRequest","strError","response","unsub_email","bootbox","result","fullAccountOnlyFieldList","requiredFieldList","updateConversionState","obj","disabledVal","thisFieldName","checked","thisElem","getElementById","setAttribute","isPartialAccount","mousedown","target","firstYear","value","isCreate","trigger"],"sourceRoot":"js/src/dreamdinners/admin","sources":["account.js"],"sourcesContent":["function handle_tc_delayed_payment()\n{\n\t$('#tc_delayed_payment').on('click', function () {\n\n\t\tif ($('#tc_delayed_payment').is(':checked'))\n\t\t{\n\n\t\t\tdd_message({\n\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\t\tmessage: lang.en.tc.delayed_payment,\n\t\t\t\tmodal: true,\n\t\t\t\tnoOk: true,\n\t\t\t\tbuttons: {\n\t\t\t\t\t\"Agree\": function () {\n\n\t\t\t\t\t\t$(this).remove();\n\n\t\t\t\t\t\t$('#tc_delayed_payment').prop(\"checked\", true);\n\n\t\t\t\t\t},\n\t\t\t\t\t\"Decline\": function () {\n\n\t\t\t\t\t\tdd_message({\n\t\t\t\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\t\t\t\t\tmessage: lang.en.tc.delayed_payment_decline\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$('#tc_delayed_payment').prop(\"checked\", false);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdd_message({\n\t\t\t\ttitle: lang.en.tc.terms_and_conditions,\n\t\t\t\tmessage: lang.en.tc.delayed_payment_decline\n\t\t\t});\n\t\t}\n\n\t});\n}\n\nfunction handle_platepoints_enrollment()\n{\n\t$('#enroll_in_plate_points').on('click', function () {\n\t\tset_req = false;\n\t\tif ($(this).is(\":checked\"))\n\t\t{\n\t\t\tset_req = true;\n\t\t}\n\t\t$('#referral_source, #gender, #birthday_month, #birthday_year, #number_of_kids, #number_of_kids, #desired_homemade_meals_per_week, #number_of_adults, #contribute_income, #use_lists, #number_monthly_dine_outs').attr('data-dd_required', set_req).attr('required', set_req);\n\t\t$('#prefer_daytime_sessions, #prefer_evening_sessions, #prefer_weekend_sessions').data('checkbox_group_required', set_req);\n\t\t//$('#prefer_daytime_sessions, #prefer_evening_sessions, #prefer_weekend_sessions').data('checkbox_group_required', false).attr('required', false);\n\t});\n\tif (getQueryVariable('pp_enroll'))\n\t{\n\t\t$('#enroll_in_plate_points').prop('checked', true).triggerHandler('click');\n\t}\n}\n\nfunction how_did_you_hear_init()\n{\n\n\tif ($('#referral_source').val() == 'OTHER')\n\t{\n\t\t$(\"#referral_source_details_div\").showFlex();\n\t}\n\telse if ($('#referral_source').val() == 'CUSTOMER_REFERRAL')\n\t{\n\t\t$(\"#customer_referral_email_div\").showFlex();\n\t}\n\telse if ($('#referral_source').val() == 'VIRTUAL_PARTY')\n\t{\n\t\t$(\"#virtual_party_source_details_div\").showFlex();\n\t}\n\n\t$(document).on('change', '#referral_source', function (e) {\n\n\t\t// defaults\n\t\t$(\"#referral_source_details_div\").hideFlex();\n\t\t$(\"#referral_source_details\").prop({\n\t\t\t'disabled': true,\n\t\t\t'required': false\n\t\t}).val('');\n\n\t\t$(\"#virtual_party_source_details_div\").hideFlex();\n\t\t$(\"#virtual_party_source_details\").prop({\n\t\t\t'disabled': true,\n\t\t\t'required': false\n\t\t}).val('');\n\n\t\t$(\"#customer_referral_email_div\").hideFlex();\n\t\t$(\"#customer_referral_email\").prop({\n\t\t\t'disabled': true,\n\t\t\t'required': false\n\t\t}).val('');\n\n\n\t\tif ($(this).val() == 'OTHER')\n\t\t{\n\t\t\t$(\"#referral_source_details_div\").showFlex();\n\t\t\t$(\"#referral_source_details\").prop({\n\t\t\t\t'disabled': false,\n\t\t\t\t'required': true\n\t\t\t}).val('');\n\t\t}\n\t\telse if ($(this).val() == 'CUSTOMER_REFERRAL')\n\t\t{\n\n\t\t\t$(\"#customer_referral_email_div\").showFlex();\n\t\t\t$(\"#customer_referral_email\").prop({\n\t\t\t\t'disabled': false,\n\t\t\t\t'required': true\n\t\t\t}).val('');\n\n\t\t}\n\t\telse if ($(this).val() == 'VIRTUAL_PARTY')\n\t\t{\n\t\t\t$(\"#virtual_party_source_details_div\").showFlex();\n\t\t\t$(\"#virtual_party_source_details\").prop({\n\t\t\t\t'disabled': false,\n\t\t\t\t'required': true\n\t\t\t}).val('');\n\t\t}\n\n\t});\n}\n\nfunction opt_out_platepoints(user_id)\n{\n\tdd_message({\n\t\tdiv_id: 'optoutconfirm',\n\t\ttitle: 'Confirm PLATEPOINTS Opt Out',\n\t\tmessage: \"The guest will receive an email explaining the consequences of opting out. Are you sure you want to opt out this guest?\",\n\t\tzIndex: 2,\n\t\tresizable: false,\n\t\tcancel: function () {\n\t\t},\n\t\tconfirm: function () {\n\t\t\thandle_opt_out_platepoints(user_id);\n\t\t}\n\t});\n}\n\nfunction handle_opt_out_platepoints(user_id)\n{\n\t$.ajax({\n\t\turl: 'ddproc.php',\n\t\ttype: 'POST',\n\t\ttimeout: 20000,\n\t\tdataType: 'json',\n\t\tdata: {\n\t\t\tprocessor: 'plate_points_processor',\n\t\t\tuser_id: user_id,\n\t\t\top: 'opt_out_user'\n\t\t},\n\t\tsuccess: function (json, status) {\n\t\t\tif (json.processor_success)\n\t\t\t{\n\t\t\t\t$(\"#enroll_in_plate_points\").attr('checked', false);\n\t\t\t\t$(\"#dr_guest_opt_out_message\").show();\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Success',\n\t\t\t\t\tmessage: 'The guest was opted out of the PLATEPOINTS program.'\n\t\t\t\t});\n\n\t\t\t\t$(\"#dr2convertConfirm\").remove();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdd_message({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\tmessage: 'There was a problem opting the guest out of the PLATEPOINTS program.'\n\t\t\t\t});\n\t\t\t\t$(checkboxObj).prop('checked', false);\n\t\t\t}\n\t\t},\n\t\terror: function (objAJAXRequest, strError) {\n\t\t\tresponse = 'Unexpected error';\n\t\t}\n\t});\n\n}\n\n$(document).on('change', '#generateLogin', function (e) {\n\n\tif ($(this).is(':checked'))\n\t{\n\t\t$('#email_main_row, #email_confirm_row, #main_pw_row, #confirm_pw_row').hideFlex();\n\t\t$('#primary_email, #confirm_email_address, #password, #password_confirm').prop({'disabled': true, 'required': false}).val('');\n\t}\n\telse\n\t{\n\t\t$('#email_main_row, #email_confirm_row, #main_pw_row, #confirm_pw_row').showFlex();\n\t\t$('#primary_email, #confirm_email_address, #password, #password_confirm').prop({'disabled': false, 'required': true});\n\t}\n\n});\n\n$(document).on('click', '.email-unsubscribe', function (e) {\n\n\tlet unsub_email = $(this).data('email');\n\n\tbootbox.confirm(\"Are you sure you wish to invalidate this guest's email address? This will affect other stores' ability to search by the original email address and the guest's ability to login if this is changed without their knowledge.\", function (result) {\n\t\tif (result)\n\t\t{\n\t\t\t$('#primary_email, #confirm_email_address').val(unsub_email);\n\t\t}\n\t});\n\n});\n\n$(document).on('change', '#add_email', function (e) {\n\n\tif (!$(this).is(':checked'))\n\t{\n\t\t$('#email_main_row, #email_confirm_row, #secondary_email_row').hideFlex();\n\t\t$('#primary_email, #confirm_email_address').prop({'disabled': true, 'required': false}).val('');\n\t}\n\telse\n\t{\n\t\t$('#email_main_row, #email_confirm_row, #secondary_email_row').showFlex();\n\t\t$('#primary_email, #confirm_email_address').prop({'disabled': false, 'required': true});\n\t}\n\n});\n\nvar fullAccountOnlyFieldList = {};\nfullAccountOnlyFieldList[0] = \"address_line1\";\nfullAccountOnlyFieldList[1] = \"address_line2\";\nfullAccountOnlyFieldList[2] = \"city\";\nfullAccountOnlyFieldList[3] = \"state_id\";\nfullAccountOnlyFieldList[4] = \"postal_code\";\nfullAccountOnlyFieldList[5] = \"telephone_1_call_time\";\nfullAccountOnlyFieldList[6] = \"telephone_1\";\nfullAccountOnlyFieldList[7] = \"telephone_2_call_time\";\nfullAccountOnlyFieldList[7] = \"telephone_2\";\nfullAccountOnlyFieldList[8] = \"genderF\";\nfullAccountOnlyFieldList[9] = \"genderM\";\nfullAccountOnlyFieldList[10] = \"password\";\nfullAccountOnlyFieldList[12] = \"password_confirm\";\nfullAccountOnlyFieldList[13] = \"fax\";\nfullAccountOnlyFieldList[14] = \"birthday_month\";\nfullAccountOnlyFieldList[15] = \"number_of_kids\";\nfullAccountOnlyFieldList[16] = \"family_size\";\nfullAccountOnlyFieldList[17] = \"favorite_meals\";\nfullAccountOnlyFieldList[18] = \"why_works\";\nfullAccountOnlyFieldList[19] = \"guest_employer\";\nfullAccountOnlyFieldList[20] = \"spouse_employer\";\nfullAccountOnlyFieldList[21] = \"upcoming_events\";\nfullAccountOnlyFieldList[22] = \"misc_notes\";\nfullAccountOnlyFieldList[23] = \"genderX\";\n\nvar requiredFieldList = {};\nrequiredFieldList[0] = \"address_line1\";\nrequiredFieldList[2] = \"city\";\nrequiredFieldList[3] = \"state_id\";\nrequiredFieldList[4] = \"postal_code\";\nrequiredFieldList[5] = \"telephone_1_call_time\";\nrequiredFieldList[6] = \"telephone_1\";\nrequiredFieldList[7] = \"genderF\";\nrequiredFieldList[8] = \"genderM\";\nrequiredFieldList[9] = \"genderX\";\n\nfunction updateConversionState(obj)\n{\n\tvar disabledVal = true;\n\tif (obj.checked)\n\t{\n\t\tdisabledVal = false;\n\t}\n\n\tfor (var thisFieldName in fullAccountOnlyFieldList)\n\t{\n\t\tvar thisElem = document.getElementById(fullAccountOnlyFieldList[thisFieldName]);\n\t\tif (thisElem)\n\t\t{\n\t\t\tthisElem.disabled = disabledVal;\n\t\t}\n\t}\n\n\tif (disabledVal)\n\t{\n\t\tfor (var thisFieldName in requiredFieldList)\n\t\t{\n\t\t\tvar thisElem = document.getElementById(requiredFieldList[thisFieldName]);\n\t\t\tif (thisElem)\n\t\t\t{\n\t\t\t\tthisElem.setAttribute('required', 'false');\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor (var thisFieldName in requiredFieldList)\n\t\t{\n\t\t\tvar thisElem = document.getElementById(requiredFieldList[thisFieldName]);\n\t\t\tif (thisElem)\n\t\t\t{\n\t\t\t\tthisElem.setAttribute('required', 'true');\n\t\t\t}\n\t\t}\n\t}\n}\n\n$(function () {\n\n\tif (isPartialAccount)\n\t{\n\t\tupdateConversionState(document.getElementById(\"convertToFull\"));\n\t}\n\n\thow_did_you_hear_init();\n\n\thandle_platepoints_enrollment();\n\n\t$(\"#birthday_year\").mousedown(function (obj) {\n\t\tif (obj.target[1])\n\t\t{\n\t\t\tvar firstYear = obj.target[1].value;\n\t\t\tfirstYear = firstYear - 23;\n\t\t\tif ($(\"#birthday_year\").val() == '')\n\t\t\t{\n\t\t\t\t$(\"#birthday_year\").val(firstYear);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (isCreate)\n\t{\n\t\thandle_tc_delayed_payment();\n\t}\n\n\t$('#generateLogin').trigger('change');\n});"],"mappings":"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"}