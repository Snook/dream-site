{"version":3,"names":["$","document","on","e","hasClass","removeClass","addClass","user_id","this","data","ajax","url","type","timeout","dataType","processor","birth_month","find","val","birth_year","op","success","json","status","processor_success","dd_message","title","message","error","objAJAXRequest","strError","response","spinner","session_id","order_id","store_id","size","modal","confirm","reason","div_id","paymentList","each","id","bootbox","dialog","closeButton","remove","closeOnEscape","noOk","buttons","OK","bounce","processor_message","console","log"],"sourceRoot":"js/src/customer","sources":["order_details.js"],"sourcesContent":["$(document).on('click','#enroll_in_plate_points', function (e) {\r\n\tif( $('#plate-points-fields').hasClass('collapse')){\r\n\t\t$('#plate-points-fields').removeClass('collapse')\r\n\t}else{\r\n\t\t$('#plate-points-fields').addClass('collapse')\r\n\t}\r\n});\r\n\r\n\r\n\r\n$(document).on('click','#handle-plate-points-enroll', function (e) {\r\n\tlet user_id = $(this).data('user_id');\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'plate_points_processor',\r\n\t\t\tuser_id: user_id,\r\n\t\t\tbirth_month: $('#birthday_month').find(\":selected\").val(),\r\n\t\t\tbirth_year: $('#birthday_year').find(\":selected\").val(),\r\n\t\t\top: 'opt_in_with_birthday'\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\t$('#plate-points-fields').addClass('collapse');\r\n\t\t\t\t$('#plate-points-checkbox').addClass('collapse');\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'PlatePoints Enrollment Complete',\r\n\t\t\t\t\tmessage: 'You are now enrolled in the PlatePoints program.'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: 'There was a problem opting into the PlatePoints program.'\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n\r\n\r\n\r\n$(document).on('click','#handle-cancel-delivered-order', function (e) {\r\n\r\n\tvar session_id = $(this).data('session_id');\r\n\tvar order_id = $(this).data('order_id');\r\n\tvar store_id = $(this).data('store_id');\r\n\tvar user_id = $(this).data('user_id');\r\n\tvar bounce_to = $(this).data('bounce');\r\n\r\n\tvar spinner;\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'delivered_cancel_order',\r\n\t\t\top: 'cancel_preflight',\r\n\t\t\tstore_id: store_id,\r\n\t\t\tsession_id: session_id,\r\n\t\t\tuser_id: user_id,\r\n\t\t\torder_id: order_id\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (json.processor_success && json.data)\r\n\t\t\t{\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Cancel Order?',\r\n\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\tsize: 'large',\r\n\t\t\t\t\tmodal: true,\r\n\t\t\t\t\tconfirm: function (json, status) {\r\n\r\n\t\t\t\t\t\tvar reason = $(\"#cancellation_reason\").val();\r\n\t\t\t\t\t\tif (reason == \"\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: '',\r\n\t\t\t\t\t\t\t\tdiv_id: 'Uneek262020',\r\n\t\t\t\t\t\t\t\tmessage: \"Please select a reason for cancelling\"});\r\n\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar paymentList = {};\r\n\t\t\t\t\t\t$(\"#cancel_parent input:hidden\").each(function () {\r\n\r\n\t\t\t\t\t\t\tpaymentList[this.id] = $(this).val();\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar reason = $(\"#cancellation_reason\").val();\r\n\r\n\r\n\t\t\t\t\t\tspinner = bootbox.dialog({\r\n\t\t\t\t\t\t\tmessage: '<p class=\"text-center mb-0\"><i class=\"fa fa-spin fa-cog\"></i> Cancelling the order...</p>',\r\n\t\t\t\t\t\t\tcloseButton: false\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// do something in the background\r\n\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\ttimeout: 30000,\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'delivered_cancel_order',\r\n\t\t\t\t\t\t\t\top: 'cancel',\r\n\t\t\t\t\t\t\t\tstore_id: store_id,\r\n\t\t\t\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\torder_id: order_id,\r\n\t\t\t\t\t\t\t\tpaymentList: paymentList,\r\n\t\t\t\t\t\t\t\treason: reason\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\tspinner.remove();\r\n\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Order was Canceled',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\r\n\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\t\t\tcloseButton: false,\r\n\t\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\t\"OK\": function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=my_meals&tab=nav-past_orders');\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Error Cancelling Order',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\tconsole.log('Unexpected error: ' + strError);\r\n\t\t\t\t\t\t\t\tspinner.remove();\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Error Cancelling Order',\r\n\t\t\t\t\t\t\t\t\tmessage: 'Sorry, their was an error processing your order cancellation.',\r\n\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\"OK\": function () {\r\n\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=my_meals&tab=nav-past_orders');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: response\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t});\r\n\r\n});"],"mappings":"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"}