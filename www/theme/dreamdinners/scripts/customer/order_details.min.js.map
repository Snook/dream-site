{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["order_details.js"],"sourcesContent":["$(document).on('click','#enroll_in_plate_points', function (e) {\r\n\tif( $('#plate-points-fields').hasClass('collapse')){\r\n\t\t$('#plate-points-fields').removeClass('collapse')\r\n\t}else{\r\n\t\t$('#plate-points-fields').addClass('collapse')\r\n\t}\r\n});\r\n\r\n\r\n\r\n$(document).on('click','#handle-plate-points-enroll', function (e) {\r\n\tlet user_id = $(this).data('user_id');\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'plate_points_processor',\r\n\t\t\tuser_id: user_id,\r\n\t\t\tbirth_month: $('#birthday_month').find(\":selected\").val(),\r\n\t\t\tbirth_year: $('#birthday_year').find(\":selected\").val(),\r\n\t\t\top: 'opt_in_with_birthday'\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\t$('#plate-points-fields').addClass('collapse');\r\n\t\t\t\t$('#plate-points-checkbox').addClass('collapse');\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'PlatePoints Enrollment Complete',\r\n\t\t\t\t\tmessage: 'You are now enrolled in the PlatePoints program.'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: 'There was a problem opting into the PlatePoints program.'\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n\r\n\r\n\r\n$(document).on('click','#handle-cancel-delivered-order', function (e) {\r\n\r\n\tvar session_id = $(this).data('session_id');\r\n\tvar order_id = $(this).data('order_id');\r\n\tvar store_id = $(this).data('store_id');\r\n\tvar user_id = $(this).data('user_id');\r\n\tvar bounce_to = $(this).data('bounce');\r\n\r\n\tvar spinner;\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'delivered_cancel_order',\r\n\t\t\top: 'cancel_preflight',\r\n\t\t\tstore_id: store_id,\r\n\t\t\tsession_id: session_id,\r\n\t\t\tuser_id: user_id,\r\n\t\t\torder_id: order_id\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (json.processor_success && json.data)\r\n\t\t\t{\r\n\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Cancel Order?',\r\n\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\tsize: 'large',\r\n\t\t\t\t\tmodal: true,\r\n\t\t\t\t\tconfirm: function (json, status) {\r\n\r\n\t\t\t\t\t\tvar reason = $(\"#cancellation_reason\").val();\r\n\t\t\t\t\t\tif (reason == \"\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\ttitle: '',\r\n\t\t\t\t\t\t\t\tdiv_id: 'Uneek262020',\r\n\t\t\t\t\t\t\t\tmessage: \"Please select a reason for cancelling\"});\r\n\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar paymentList = {};\r\n\t\t\t\t\t\t$(\"#cancel_parent input:hidden\").each(function () {\r\n\r\n\t\t\t\t\t\t\tpaymentList[this.id] = $(this).val();\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar reason = $(\"#cancellation_reason\").val();\r\n\r\n\r\n\t\t\t\t\t\tspinner = bootbox.dialog({\r\n\t\t\t\t\t\t\tmessage: '<p class=\"text-center mb-0\"><i class=\"fa fa-spin fa-cog\"></i> Cancelling the order...</p>',\r\n\t\t\t\t\t\t\tcloseButton: false\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// do something in the background\r\n\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\ttimeout: 30000,\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'delivered_cancel_order',\r\n\t\t\t\t\t\t\t\top: 'cancel',\r\n\t\t\t\t\t\t\t\tstore_id: store_id,\r\n\t\t\t\t\t\t\t\tsession_id: session_id,\r\n\t\t\t\t\t\t\t\tuser_id: user_id,\r\n\t\t\t\t\t\t\t\torder_id: order_id,\r\n\t\t\t\t\t\t\t\tpaymentList: paymentList,\r\n\t\t\t\t\t\t\t\treason: reason\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\tspinner.remove();\r\n\t\t\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Order was Canceled',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.data,\r\n\t\t\t\t\t\t\t\t\t\tdiv_id: 'cancel_order',\r\n\t\t\t\t\t\t\t\t\t\tcloseOnEscape: false,\r\n\t\t\t\t\t\t\t\t\t\tcloseButton: false,\r\n\t\t\t\t\t\t\t\t\t\tmodal: true,\r\n\t\t\t\t\t\t\t\t\t\tnoOk: true,\r\n\t\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\t\"OK\": function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=my_meals&tab=nav-past_orders');\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\t\ttitle: 'Error Cancelling Order',\r\n\t\t\t\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\tconsole.log('Unexpected error: ' + strError);\r\n\t\t\t\t\t\t\t\tspinner.remove();\r\n\t\t\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\t\t\ttitle: 'Error Cancelling Order',\r\n\t\t\t\t\t\t\t\t\tmessage: 'Sorry, their was an error processing your order cancellation.',\r\n\t\t\t\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\t\t\t\"OK\": function () {\r\n\t\t\t\t\t\t\t\t\t\t\tbounce('main.php?page=my_meals&tab=nav-past_orders');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error: ' + strError;\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: response\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t});\r\n\r\n});"],"names":["$","document","on","e","hasClass","removeClass","addClass","let","user_id","this","data","ajax","url","type","timeout","dataType","processor","birth_month","find","val","birth_year","op","success","json","status","processor_success","dd_message","title","message","error","objAJAXRequest","strError","response","session_id","order_id","store_id","bounce_to","spinner","size","modal","confirm","reason","div_id","paymentList","each","id","bootbox","dialog","closeButton","remove","closeOnEscape","noOk","buttons","OK","bounce","processor_message","console","log"],"mappings":"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"}