{"version":3,"file":"session_menu.min.js","names":["neededQuantity","canIncrementBundleSubItem","input","selector","parentItemInfo","menuItemInfo","mid","$","data","parentNumItemsRequired","parseInt","number_items_required","itemInfo","menu_item_id","sub_item","groupID","bundle_to_menu_item_group_id","total_org","total_current","groupInfo","each","inputItemInfo","this","inputGroupID","this_org","this_cur","val","bundle_groups","length","restoreButtonState","entree_id","total_servings","myTypes","key","servingSize","thisType","servings_per_item","qty_in_cart","left","remaining_servings","removeClass","html","price","show","inventoryCheck","hasInventory","newServingsThisInstance","modal_message","title","message","addClass","text","hide","countCoreItemsServings","servingsOrdered","item_info","Number","countItemsServings","includeFreezer","totalMealNights","countItems","itemsOrdered","countCoreItems","updateServingsCountAndCheckoutButton","quantityOrdered","coreQuantityOrdered","menu_view","order_minimum","minimum_type","shouldEnableCheckoutButton","minServings","minimum","order_type","number_servings_required","is_applicable","has_freezer_inventory","recommended_servings","progress_min","remaining","more","showFlex","hideFlex","Math","round","progress_rec","rec_servings","quantityOrdered_rec","progress_add","quantityOrdered_add","css","width","attr","slideDown","slideUp","coupon","limit_to_mfy_fee","limit_to_delivery_fee","update_cart","action","menuItem","menuItemEntree","sub_items","isNumeric","is_bundle","qty","ajax","url","type","timeout","dataType","processor","op","item","success","json","processor_success","coupon_code_discount_total","grand_total","pricing_type","replaceWith","cart_update","appendTo","remove","trim","err_message","result_code","callback","bounce","window","location","href","error","objAJAXRequest","strError","itemkey","document","on","e","continue_process","servings","checked","entree_total","servings_before","USER_PREFERENCES","SESSION_MENU_CART_FLY_TO","value","category_id","cart","is","parent","imgtodrag","recipe_id","eq","imgclone","clone","offset","top","pageY","pageX","position","border","animate","detach","bootbox","confirm","result","children","toggleFlex","preventDefault","menu_id","store_id","dialog","buttons","cancel","label","processor_message","response","view_menu","create_and_submit_form","scrollTop","tab","session_id","sid","result_day","bounce_to","filter","session_types_array","split","inArray","target","source","current_session_id","find","modal","prop","target_id","current_order_id","pwd_input","pwd","which","trigger","session_type","code","not","slideToggle","canIncrement","add_coupon_code","payment_type","coupon_code","orderInfo","coupon_code_short_title","formatAsMoney","output","reload","indexOf","height","resizable","_etmc","push","clear_cart","limit_to_recipe_id","checkValidity","stopPropagation","primary_email_login","password_login","firstname","lastname","telephone_1","nobo","submit_login","remember_login","scrollIntoView","behavior","block","toggle","doTimeout","unixtime","Date","getTime","hasClass","isIE","mobileCartElem","fixMobileTop","scroll"],"sourceRoot":"js/src/dreamdinners/customer","sources":["session_menu.js"],"sourcesContent":["var neededQuantity = 36;\r\n\r\nif (typeof order_minimum !== 'undefined' && typeof order_minimum.minimum !== 'undefined')\r\n{\r\n\tneededQuantity = order_minimum.minimum;\r\n}\r\n\r\nfunction canIncrementBundleSubItem(input, selector)\r\n{\r\n\r\n\tlet parentItemInfo = menuItemInfo.mid[$(input).data('parent_item')];\r\n\tlet parentNumItemsRequired = parseInt(parentItemInfo.number_items_required);\r\n\tlet itemInfo = menuItemInfo.mid[parentItemInfo.menu_item_id].sub_item[$(input).data('menu_item_id')];\r\n\tlet groupID = parseInt(itemInfo.bundle_to_menu_item_group_id) || 0;\r\n\r\n\t// check that we aren't going over the total\r\n\tlet total_org = 0;\r\n\tlet total_current = 0;\r\n\tlet groupInfo = [];\r\n\r\n\t$(selector + '[data-parent_item=\"' + parentItemInfo.menu_item_id + '\"]').each(function () {\r\n\r\n\t\tlet inputItemInfo = menuItemInfo.mid[parentItemInfo.menu_item_id].sub_item[$(this).data('menu_item_id')];\r\n\t\tlet inputGroupID = parseInt(inputItemInfo.bundle_to_menu_item_group_id) || 0;\r\n\r\n\t\tlet this_org = parseInt($(this).data('org_val')) || 0;\r\n\t\tlet this_cur = parseInt($(this).val()) || 0;\r\n\r\n\t\ttotal_org += this_org;\r\n\t\ttotal_current += this_cur;\r\n\r\n\t\tif (typeof groupInfo[inputGroupID] == 'undefined')\r\n\t\t{\r\n\t\t\tgroupInfo[inputGroupID] = {\r\n\t\t\t\ttotal_org: 0,\r\n\t\t\t\ttotal_current: 0\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tgroupInfo[inputGroupID].total_org += this_org;\r\n\t\tgroupInfo[inputGroupID].total_current += this_cur;\r\n\r\n\t});\r\n\r\n\t// check if over the bundle total\r\n\tif (total_current > parentNumItemsRequired)\r\n\t{\r\n\t\treturn 'Number of items for the bundle has been reached';\r\n\t}\r\n\r\n\t// check if over the group total\r\n\tif (parentItemInfo.bundle_groups.length > 0)\r\n\t{\r\n\t\tif (groupInfo[groupID].total_current > parentItemInfo.bundle_groups[groupID].number_items_required)\r\n\t\t{\r\n\t\t\treturn 'Number of items for the group has been reached';\r\n\t\t}\r\n\t}\r\n\r\n\t// all else\r\n\treturn true;\r\n\r\n}\r\n\r\nfunction restoreButtonState(menu_item_id)\r\n{\r\n\tvar entree_id = menuItemInfo['mid'][menu_item_id].entree_id;\r\n\tvar total_servings = 0;\r\n\r\n\tvar myTypes = menuItemInfo['entree'][entree_id];\r\n\r\n\t// total servings used so far\r\n\tfor (key in myTypes)\r\n\t{\r\n\r\n\t\tvar thisType = menuItemInfo['mid'][key];\r\n\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\t\tvar thisTypeServings = thisType.qty_in_cart * servingSize;\r\n\t\ttotal_servings += thisTypeServings;\r\n\t}\r\n\r\n\tvar left = menuItemInfo['mid'][menu_item_id].remaining_servings - total_servings;\r\n\r\n\tfor (key in myTypes)\r\n\t{\r\n\t\tvar thisType = menuItemInfo['mid'][key];\r\n\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\r\n\t\tif (servingSize <= left)\r\n\t\t{\r\n\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"]').removeClass('disabled');\r\n\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"] > .price').html(menuItemInfo['mid'][key].price);\r\n\r\n\t\t\t// only restore the + icon on the button not being clicked\r\n\t\t\tif (key != menu_item_id)\r\n\t\t\t{\r\n\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"] > .fas').show();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction inventoryCheck(menu_item_id)\r\n{\r\n\tvar hasInventory = true;\r\n\r\n\t// sanity check anytime this function is called\r\n\tif (menuItemInfo['mid'][menu_item_id].qty_in_cart < 0)\r\n\t{\r\n\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart = 0;\r\n\t}\r\n\r\n\tvar entree_id = menuItemInfo['mid'][menu_item_id].entree_id;\r\n\tvar total_servings = 0;\r\n\tvar newServingsThisInstance = menuItemInfo['mid'][menu_item_id].servings_per_item * 1; // only adding 1 at a time so no \" * qty \"\r\n\r\n\tvar myTypes = menuItemInfo['entree'][entree_id];\r\n\r\n\t// total servings used so far\r\n\tfor (key in myTypes)\r\n\t{\r\n\r\n\t\tvar thisType = menuItemInfo['mid'][key];\r\n\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\t\tvar thisTypeServings = thisType.qty_in_cart * servingSize;\r\n\t\ttotal_servings += thisTypeServings;\r\n\t}\r\n\r\n\tif (total_servings + newServingsThisInstance > menuItemInfo['mid'][menu_item_id].remaining_servings)\r\n\t{\r\n\t\tmodal_message({\r\n\t\t\ttitle: 'Inventory Limit Reached',\r\n\t\t\tmessage: \"Please contact your store if you wish to purchase more of this item. The store's available inventory limit has been reached.\"\r\n\t\t});\r\n\r\n\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart += 1;\r\n\r\n\t\thasInventory = false;\r\n\t}\r\n\telse\r\n\t{\r\n\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart += 1;\r\n\t}\r\n\r\n\tvar left = menuItemInfo['mid'][menu_item_id].remaining_servings - (total_servings + newServingsThisInstance);\r\n\r\n\tfor (key in myTypes)\r\n\t{\r\n\t\tvar thisType = menuItemInfo['mid'][key];\r\n\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\r\n\t\tif (servingSize > left)\r\n\t\t{\r\n\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"]').addClass('disabled');\r\n\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"] > .price').text('Sold out');\r\n\t\t\t$('.add-to-cart[data-menu_item_id=\"' + key + '\"] > .fas').hide();\r\n\t\t}\r\n\t}\r\n\r\n\treturn hasInventory;\r\n}\r\n\r\nfunction countCoreItemsServings()\r\n{\r\n\tvar servingsOrdered = 0;\r\n\r\n\t$.each(menuItemInfo['mid'], function (key, item_info) {\r\n\r\n\t\t// sanity check anytime this function is called\r\n\t\tif (item_info['qty_in_cart'] < 0)\r\n\t\t{\r\n\t\t\titem_info['qty_in_cart'] = 0;\r\n\r\n\t\t\tmenuItemInfo['mid'][key].qty_in_cart = 0;\r\n\t\t}\r\n\r\n\t\tif (item_info['qty_in_cart'] > 0)\r\n\t\t{\r\n\t\t\tif (item_info['category_id'] != '9')\r\n\t\t\t{\r\n\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t{\r\n\t\t\t\t\tservingsOrdered += Number(item_info['servings_per_item']) * Number(item_info['qty_in_cart']);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn servingsOrdered;\r\n}\r\n\r\nfunction countItemsServings(includeFreezer)\r\n{\r\n\tvar servingsOrdered = 0;\r\n\tvar totalMealNights = 0;\r\n\r\n\tif (typeof includeFreezer === 'undefined')\r\n\t{\r\n\t\tincludeFreezer = false;\r\n\t}\r\n\r\n\t$.each(menuItemInfo['mid'], function (key, item_info) {\r\n\r\n\t\t// sanity check anytime this function is called\r\n\t\tif (item_info['qty_in_cart'] < 0)\r\n\t\t{\r\n\t\t\titem_info['qty_in_cart'] = 0;\r\n\r\n\t\t\tmenuItemInfo['mid'][key].qty_in_cart = 0;\r\n\t\t}\r\n\r\n\t\tif (item_info['qty_in_cart'] > 0)\r\n\t\t{\r\n\r\n\t\t\tif (includeFreezer)\r\n\t\t\t{\r\n\t\t\t\tservingsOrdered += Number(item_info['servings_per_item'] * item_info['qty_in_cart']);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (item_info['category_id'] != 9)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (item_info['is_bundle'] === '1')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tservingsOrdered += Number(item_info['qty_in_cart']) * Number(item_info['servings_per_item']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tservingsOrdered = Number(item_info['servings_per_item']) * Number(item_info['qty_in_cart']);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item_info['category_id'] != 9)\r\n\t\t\t{\r\n\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t{\r\n\t\t\t\t\ttotalMealNights += Number(item_info['qty_in_cart']);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (totalMealNights > 0)\r\n\t{\r\n\t\t$('.total-meal-nights-plural').show();\r\n\t\t$('.total-meal-nights').text(totalMealNights);\r\n\r\n\t\tif (totalMealNights == 1)\r\n\t\t{\r\n\t\t\t$('.total-meal-nights-plural').hide();\r\n\t\t}\r\n\r\n\t\t$('.meal-nights').show();\r\n\t\t$('.meal-select').hide();\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$('.total-meal-nights').text('0');\r\n\t\t$('.total-meal-nights-plural').show();\r\n\r\n\t\t$('.meal-select').show();\r\n\t\t$('.meal-nights').hide();\r\n\t}\r\n\r\n\treturn servingsOrdered;\r\n}\r\n\r\nfunction countItems(includeFreezer)\r\n{\r\n\tvar itemsOrdered = 0;\r\n\tvar totalMealNights = 0;\r\n\r\n\tif (typeof includeFreezer === 'undefined')\r\n\t{\r\n\t\tincludeFreezer = false;\r\n\t}\r\n\r\n\t$.each(menuItemInfo['mid'], function (key, item_info) {\r\n\r\n\t\t// sanity check anytime this function is called\r\n\t\tif (item_info['qty_in_cart'] < 0)\r\n\t\t{\r\n\t\t\titem_info['qty_in_cart'] = 0;\r\n\r\n\t\t\tmenuItemInfo['mid'][key].qty_in_cart = 0;\r\n\t\t}\r\n\r\n\t\tif (item_info['qty_in_cart'] > 0)\r\n\t\t{\r\n\t\t\tif (includeFreezer)\r\n\t\t\t{\r\n\t\t\t\titemsOrdered += Number(item_info['qty_in_cart']);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif (item_info['category_id'] != 9)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\titemsOrdered += Number(item_info['qty_in_cart']) * Number(item_info['item_count_per_item']);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (item_info['category_id'] != 9)\r\n\t\t\t{\r\n\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t{\r\n\t\t\t\t\ttotalMealNights += Number(item_info['qty_in_cart']) * Number(item_info['item_count_per_item']);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tif (totalMealNights > 0)\r\n\t{\r\n\t\t$('.total-meal-nights-plural').show();\r\n\t\t$('.total-meal-nights').text(totalMealNights);\r\n\r\n\t\tif (totalMealNights == 1)\r\n\t\t{\r\n\t\t\t$('.total-meal-nights-plural').hide();\r\n\t\t}\r\n\r\n\t\t$('.meal-nights').show();\r\n\t\t$('.meal-select').hide();\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$('.total-meal-nights').text('0');\r\n\t\t$('.total-meal-nights-plural').show();\r\n\r\n\t\t$('.meal-select').show();\r\n\t\t$('.meal-nights').hide();\r\n\t}\r\n\r\n\treturn itemsOrdered;\r\n}\r\n\r\nfunction countCoreItems()\r\n{\r\n\tvar itemsOrdered = 0;\r\n\r\n\t$.each(menuItemInfo['mid'], function (key, item_info) {\r\n\r\n\t\t// sanity check anytime this function is called\r\n\t\tif (item_info['qty_in_cart'] < 0)\r\n\t\t{\r\n\t\t\titem_info['qty_in_cart'] = 0;\r\n\t\t\tmenuItemInfo['mid'][key].qty_in_cart = 0;\r\n\t\t}\r\n\r\n\t\tif (item_info['qty_in_cart'] > 0)\r\n\t\t{\r\n\t\t\tif (item_info['category_id'] != 9)\r\n\t\t\t{\r\n\t\t\t\tif (item_info['item_contributes_to_minimum_order'])\r\n\t\t\t\t{\r\n\t\t\t\t\titemsOrdered += Number(item_info['qty_in_cart']) * Number(item_info['item_count_per_item']);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\treturn itemsOrdered;\r\n}\r\n\r\nfunction updateServingsCountAndCheckoutButton()\r\n{\r\n\t// update bundle item state\r\n\t$('.add-bundle-to-cart').each(function () {\r\n\r\n\t\t$(this).addClass('disabled');\r\n\r\n\t\tlet menu_item_id = $(this).data('menu_item_id');\r\n\t\tlet parentItemInfo = menuItemInfo.mid[menu_item_id];\r\n\t\tlet parentNumItemsRequired = parseInt(parentItemInfo.number_items_required);\r\n\r\n\t\tlet total_current = 0;\r\n\r\n\t\t$('.bundle-subitem-qty[data-parent_item=\"' + menu_item_id + '\"]').each(function () {\r\n\r\n\t\t\tlet this_cur = parseInt($(this).val()) || 0;\r\n\r\n\t\t\ttotal_current += this_cur;\r\n\r\n\t\t});\r\n\r\n\t\t$('.bundle-subitem-total[data-menu_item_id=\"' + menu_item_id + '\"]').text(total_current);\r\n\r\n\t\tif (parentNumItemsRequired == total_current)\r\n\t\t{\r\n\t\t\t$(this).removeClass('disabled');\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (typeof menuItemInfo != \"undefined\")\r\n\t{\r\n\t\tvar quantityOrdered = 0;\r\n\r\n\t\tvar coreQuantityOrdered = 0;\r\n\r\n\t\tif (typeof menu_view === 'undefined' || menu_view == null)\r\n\t\t{\r\n\t\t\tmenu_view = '';\r\n\t\t}\r\n\r\n\t\tif (typeof (order_minimum) != 'undefined' && typeof (order_minimum.minimum) != 'undefined' && order_minimum.minimum_type == 'ITEM')\r\n\t\t{\r\n\r\n\t\t\tquantityOrdered = countItems(menu_view == 'session_menu_freezer');\r\n\t\t\tcoreQuantityOrdered = countCoreItems();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tquantityOrdered = countItemsServings(menu_view == 'session_menu_freezer');\r\n\t\t\tcoreQuantityOrdered = countCoreItemsServings();\r\n\t\t}\r\n\r\n\t\tvar shouldEnableCheckoutButton = false;\r\n\r\n\t\tif (typeof (order_minimum) == 'undefined')\r\n\t\t{\r\n\t\t\torder_minimum = {};\r\n\t\t}\r\n\t\tvar minServings = typeof (order_minimum.minimum) == 'undefined' ? 36 : order_minimum.minimum;\r\n\t\tif (order_type == 'INTRO' || order_type == 'DREAM_TASTE' || order_type == 'FUNDRAISER')\r\n\t\t{\r\n\t\t\tminServings = number_servings_required;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (order_minimum.is_applicable == false)\r\n\t\t\t{\r\n\t\t\t\tif (order_minimum.has_freezer_inventory == true)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (menu_view == 'session_menu_freezer')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tminServings = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tminServings = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tminServings = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* handle progress bar */\r\n\t\t// var recommended_servings = $('.progress-min').data('recommended_servings');\r\n\r\n\t\tvar recommended_servings = (typeof order_minimum.minimum) == 'undefined' ? 36 : order_minimum.minimum;\r\n\t\tvar progress_min = 0;\r\n\r\n\t\tvar remaining = recommended_servings - quantityOrdered;\r\n\t\tvar more = ' more '\r\n\t\tif (quantityOrdered == 0)\r\n\t\t{\r\n\t\t\tmore = ' ';\r\n\t\t}\r\n\t\tif (remaining > 0)\r\n\t\t{\r\n\t\t\t$('.remaining-note').showFlex();\r\n\t\t\t$('.remaining').text(remaining + more);\r\n\t\t\tif (remaining == 1)\r\n\t\t\t{\r\n\t\t\t\t$('.plural').hide();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.plural').show();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('.remaining-note').hideFlex();\r\n\t\t}\r\n\r\n\t\tif (quantityOrdered > 0)\r\n\t\t{\r\n\r\n\t\t\tprogress_min = Math.round((quantityOrdered / minServings) * 100);\r\n\r\n\t\t\tif (progress_min >= 100)\r\n\t\t\t{\r\n\t\t\t\tprogress_min = 100;\r\n\r\n\t\t\t\t$('.progress-min').removeClass('bg-gray-dark').addClass('bg-green');\r\n\t\t\t\t$('.progress-star').removeClass('text-gray').addClass('text-green');\r\n\t\t\t\t$('.required-servings-note').hideFlex();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.progress-min').removeClass('bg-green').addClass('bg-gray-dark');\r\n\t\t\t\t$('.progress-star').removeClass('text-green').addClass('text-gray');\r\n\t\t\t\t$('.required-servings-note').showFlex();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar progress_rec = 0;\r\n\t\tif (progress_min == 100)\r\n\t\t{\r\n\t\t\tvar rec_servings = recommended_servings - minServings;\r\n\r\n\t\t\tif (quantityOrdered > minServings)\r\n\t\t\t{\r\n\t\t\t\tvar quantityOrdered_rec = quantityOrdered - minServings;\r\n\r\n\t\t\t\tif (quantityOrdered_rec > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tprogress_rec = Math.round((quantityOrdered_rec / rec_servings) * 100);\r\n\r\n\t\t\t\t\tif (progress_rec > 100)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tprogress_rec = 100;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar progress_add = 0;\r\n\t\tif (progress_rec == 100)\r\n\t\t{\r\n\t\t\tvar quantityOrdered_add = quantityOrdered - recommended_servings;\r\n\r\n\t\t\tif (quantityOrdered_add > 0)\r\n\t\t\t{\r\n\t\t\t\tprogress_add = Math.round((quantityOrdered_add / (minServings * 3)) * 100);\r\n\r\n\t\t\t\tif (progress_add > 100)\r\n\t\t\t\t{\r\n\t\t\t\t\tprogress_add = 100;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (progress_min > 0)\r\n\t\t{\r\n\t\t\t$('.progress-min-value').text(progress_min + '%');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('.progress-min-value').text('');\r\n\t\t}\r\n\r\n\t\t$('.progress-min').css({\r\n\t\t\t'width': progress_min + '%'\r\n\t\t}).attr('aria-valuenow', progress_min);\r\n\r\n\t\t$('.progress-rec').css({\r\n\t\t\t'width': progress_rec + '%'\r\n\t\t}).attr('aria-valuenow', progress_rec);\r\n\r\n\t\t$('.progress-add').css({\r\n\t\t\t'width': progress_add + '%'\r\n\t\t}).attr('aria-valuenow', progress_add);\r\n\r\n\t\t/* end handle progress bar */\r\n\r\n\t\tif (menu_view == 'session_menu_freezer' && order_minimum.is_applicable == false)\r\n\t\t{\r\n\t\t\t//Core not required\r\n\t\t\tneededQuantity = minServings - quantityOrdered;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tneededQuantity = minServings - coreQuantityOrdered;\r\n\t\t}\r\n\r\n\t\tif (order_minimum.is_applicable == false)\r\n\t\t{\r\n\t\t\tif (order_minimum.has_freezer_inventory == true)\r\n\t\t\t{\r\n\t\t\t\tif (menu_view == 'session_menu_freezer')\r\n\t\t\t\t{\r\n\t\t\t\t\tneededQuantity = neededQuantity;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tneededQuantity = 0;\r\n\t\t\t\t}\r\n\t\t\t\t$('.meals-list, .cart-total-div').slideDown();\r\n\t\t\t\t$('.progress-star').hide();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (neededQuantity <= 0)\r\n\t\t{\r\n\t\t\tneededQuantity = 0;\r\n\r\n\t\t\tshouldEnableCheckoutButton = true;\r\n\t\t}\r\n\r\n\t\tif (shouldEnableCheckoutButton)\r\n\t\t{\r\n\t\t\t$('.continue-btn').removeClass('disabled');\r\n\t\t\t$('.continue-btn-div').slideDown();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('.continue-btn').addClass('disabled');\r\n\t\t\t$('.continue-btn-div').slideUp();\r\n\t\t}\r\n\r\n\t\tif (quantityOrdered == \"\")\r\n\t\t{\r\n\t\t\tquantityOrdered = \"0\";\r\n\t\t}\r\n\r\n\t\t// update coupon display\r\n\t\tif (coupon.limit_to_mfy_fee == 1 || coupon.limit_to_delivery_fee == 1)\r\n\t\t{\r\n\t\t\t$('.coupon-code-total-service-div').show();\r\n\t\t\t$('.coupon-code-total-div').hide();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('.coupon-code-total-service-div').hide();\r\n\t\t\t$('.coupon-code-total-div').show();\r\n\t\t}\r\n\r\n\t\treturn quantityOrdered;\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction update_cart(menu_item_id, action)\r\n{\r\n\tif (action == 'del')\r\n\t{\r\n\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\r\n\t\tif (menuItemInfo['mid'][menu_item_id].qty_in_cart < 0)\r\n\t\t{\r\n\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart = 0;\r\n\t\t}\r\n\r\n\t\trestoreButtonState(menu_item_id);\r\n\t}\r\n\r\n\tlet menuItem = menuItemInfo['mid'][menu_item_id];\r\n\tlet menuItemEntree = menuItemInfo['entree'][menuItem.entree_id];\r\n\tlet sub_items = {};\r\n\r\n\tif (!$.isNumeric(menuItem.qty_in_cart))\r\n\t{\r\n\t\tmenuItem.qty_in_cart = 0;\r\n\t}\r\n\r\n\tif (menuItem.is_bundle == '1')\r\n\t{\r\n\t\t$('.bundle-subitem-qty[data-parent_item=\"' + menu_item_id + '\"]').each(function () {\r\n\r\n\t\t\tlet mid = $(this).data('menu_item_id');\r\n\t\t\tlet qty = parseInt($(this).val()) || 0;\r\n\r\n\t\t\tmenuItemInfo['mid'][menu_item_id].sub_item[mid].qty_in_cart += parseInt($(this).val()) || 0;\r\n\r\n\t\t\tif (qty > 0)\r\n\t\t\t{\r\n\t\t\t\tsub_items[mid] = qty;\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'cart_item_processor',\r\n\t\t\top: 'update',\r\n\t\t\titem: menu_item_id,\r\n\t\t\tis_bundle: sub_items,\r\n\t\t\tqty: menuItem.qty_in_cart,\r\n\t\t\torder_type: order_type\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\r\n\t\t\tif (json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tif (order_type != json.order_type)\r\n\t\t\t\t{\r\n\t\t\t\t\torder_type = json.order_type;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('.coupon-code-total').text(json.coupon_code_discount_total);\r\n\t\t\t\t$('.cart-total').text(json.grand_total);\r\n\r\n\t\t\t\t$('.cart-total').text(json.grand_total);\r\n\r\n\t\t\t\tif (order_type == 'STANDARD' || order_type == 'SPECIAL_EVENT')\r\n\t\t\t\t{\r\n\t\t\t\t\tupdateServingsCountAndCheckoutButton();\r\n\r\n\t\t\t\t\tif (menuItem.qty_in_cart > 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] > .fas, .configure-bundle[data-menu_item_id=\"' + menu_item_id + '\"] > .fas').hide();\r\n\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] > .cart-amount, .configure-bundle[data-menu_item_id=\"' + menu_item_id + '\"] > .cart-amount').text('(' + menuItem.qty_in_cart + ')').show();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] > .fas, .configure-bundle[data-menu_item_id=\"' + menu_item_id + '\"] > .fas').show();\r\n\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] > .cart-amount, .configure-bundle[data-menu_item_id=\"' + menu_item_id + '\"] > .cart-amount').text('0').hide();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse if (order_type == 'INTRO')\r\n\t\t\t\t{\r\n\t\t\t\t\t// handle allowing only one size choice\r\n\t\t\t\t\t$.each(menuItemEntree, function (mid, pricing_type) {\r\n\r\n\t\t\t\t\t\tif (menuItem.qty_in_cart > 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + mid + '\"]').addClass('disabled');\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + mid + '\"] > .fas').removeClass('fa-plus text-white');\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] .fas').addClass('fa-check text-dark');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + mid + '\"]').removeClass('disabled');\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + mid + '\"] > .fas').removeClass('fa-check text-dark').addClass('fa-plus text-white');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (menuItem.qty_in_cart > 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tif ($('[data-cart_menu_item=\"' + menu_item_id + '\"]').length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('[data-cart_menu_item=\"' + menu_item_id + '\"]').replaceWith(json.cart_update);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(json.cart_update).appendTo($('.meals-list')).hide().slideDown();\r\n\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideDown();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$('.clear-all-cart-items-div').show();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + menu_item_id + '\"] > .fas').show();\r\n\r\n\t\t\t\t\t$('[data-cart_menu_item=\"' + menu_item_id + '\"]').slideUp('slow', function () {\r\n\r\n\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\tif (!$('.meals-list').html().trim().length)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (order_minimum.is_applicable == false)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tif (order_minimum.has_freezer_inventory != true)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideDown();\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($('.meals-list').html().trim().length)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.msg_empty_cart').slideUp('slow', function () {\r\n\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideDown();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\t$('.desktop-cart-div').find(\".meals-list\").animate({scrollTop: $('.desktop-cart-div').find(\".meals-list\").prop(\"scrollHeight\")}, 2000);\r\n\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\r\n\t\t\t\tupdateServingsCountAndCheckoutButton();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// action failed, return qty in cart to pre-click state\r\n\t\t\t\tif (action == 'del')\r\n\t\t\t\t{\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart += 1;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\r\n\t\t\t\t\tif (menuItemInfo['mid'][menu_item_id].qty_in_cart < 0)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\r\n\t\t\t\tvar err_message = \"Error Adding item to cart. If you continue to receive this message please contact your store.\";\r\n\t\t\t\tif (json.result_code == 5)\r\n\t\t\t\t{\r\n\t\t\t\t\terr_message = \"You have added the number of dinners allowed for this special event or session type. Please remove a dinner from your cart to add this dinner.\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmodal_message({\r\n\t\t\t\t\ttitle: \"Error\",\r\n\t\t\t\t\tmessage: err_message,\r\n\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t//reload the page so out of stock or other issues will be made visible.\r\n\t\t\t\t\t\tbounce(window.location.href);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\t\t\t// action failed, return qty in cart to pre-click state\r\n\t\t\tif (action == 'del')\r\n\t\t\t{\r\n\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart += 1;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\r\n\t\t\t\tif (menuItemInfo['mid'][menu_item_id].qty_in_cart < 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t$('.ld-spin').remove();\r\n\r\n\t\t\tmodal_message({\r\n\t\t\t\ttitle: \"Error\",\r\n\t\t\t\tmessage: 'Unexpected error, if you continue to receive this message please contact your store.'\r\n\t\t\t})\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\n$(function () {\r\n\r\n\t//\tvar type = typeof menuItemInfo;\r\n\r\n\tif (typeof menuItemInfo != 'undefined' && menuItemInfo != null)\r\n\t{\r\n\t\t// Note: initial sold out state does not factor the items in the cart so\r\n\r\n\t\t//  check for insufficiency for each item.  This will udpate and disable any items that are out\r\n\t\t$.each(menuItemInfo['entree'], function (key, item_info) {\r\n\t\t\tvar total_servings = 0;\r\n\t\t\tvar myTypes = menuItemInfo['entree'][key];\r\n\r\n\t\t\tvar hasHalf = false;\r\n\t\t\tvar hasFull = false;\r\n\t\t\tvar halfID = false;\r\n\t\t\tvar fullID = false;\r\n\t\t\t// total servings used so far\r\n\t\t\tfor (itemkey in myTypes)\r\n\t\t\t{\r\n\t\t\t\tif (myTypes[itemkey] == \"HALF\")\r\n\t\t\t\t{\r\n\t\t\t\t\thasHalf = true;\r\n\t\t\t\t\thalfID = itemkey;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (myTypes[itemkey] == \"FULL\")\r\n\t\t\t\t{\r\n\t\t\t\t\thasFull = true;\r\n\t\t\t\t\tfullID = itemkey;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar thisType = menuItemInfo['mid'][itemkey];\r\n\t\t\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\t\t\t\tvar thisTypeServings = thisType.qty_in_cart * servingSize;\r\n\t\t\t\ttotal_servings += thisTypeServings;\r\n\t\t\t}\r\n\r\n\t\t\tlet left = menuItemInfo['mid'][itemkey].remaining_servings - total_servings;\r\n\r\n\t\t\tfor (itemkey in myTypes)\r\n\t\t\t{\r\n\t\t\t\tvar thisType = menuItemInfo['mid'][itemkey];\r\n\t\t\t\tvar servingSize = (thisType.servings_per_item * 1);\r\n\r\n\t\t\t\tif (left < servingSize)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + itemkey + '\"]').addClass('disabled');\r\n\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + itemkey + '\"] > .price').text(\"Sold out\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t// Calculate page\r\n\tupdateServingsCountAndCheckoutButton();\r\n\r\n\t// handle cart addition\r\n\t$(document).on('click change', '.add-to-cart:not(.disabled)', function (e) {\r\n\r\n\t\tvar menu_item_id = $(this).data('menu_item_id');\r\n\t\tvar menuItem = menuItemInfo['mid'][menu_item_id];\r\n\t\tvar menuItemEntree = menuItemInfo['entree'][menuItem.entree_id];\r\n\r\n\t\tif (inventoryCheck(menu_item_id))\r\n\t\t{\r\n\t\t\tcontinue_process = true;\r\n\r\n\t\t\tif (order_type == 'DREAM_TASTE' || order_type == \"FUNDRAISER\")\r\n\t\t\t{\r\n\t\t\t\tservings = countItemsServings();\r\n\r\n\t\t\t\tif (servings > number_servings_required)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.checked = false;\r\n\r\n\t\t\t\t\tif (order_type == 'DREAM_TASTE')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\t\ttitle: 'Event Offer',\r\n\t\t\t\t\t\t\tmessage: 'You have completed your Meal Prep Workshop order and are ready to checkout.'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\t\ttitle: 'Event Offer',\r\n\t\t\t\t\t\t\tmessage: 'You have completed your Fundraiser order and are ready to checkout.'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\t\t\t\t\tservings = countItemsServings(); // force display to correct meal number\r\n\r\n\t\t\t\t\tcontinue_process = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (order_type == 'INTRO')\r\n\t\t\t{\r\n\t\t\t\tvar entree_total = 0;\r\n\r\n\t\t\t\t$.each(menuItemEntree, function (mid, pricing_type) {\r\n\r\n\t\t\t\t\tentree_total += menuItemInfo['mid'][mid].qty_in_cart;\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (entree_total >= 2)\r\n\t\t\t\t{\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Meal Prep Starter Pack',\r\n\t\t\t\t\t\tmessage: 'Meal Prep Starter Pack orders are limited to only 1 large or 1 medium selection per meal.'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\t\t\t\t\tcontinue_process = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tservings = countItemsServings();\r\n\t\t\t\tservings_before = servings - menuItemInfo['mid'][menu_item_id].servings_per_item;\r\n\r\n\t\t\t\tif (servings_before == number_servings_required)\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).removeClass('disabled');\r\n\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Meal Prep Starter Pack',\r\n\t\t\t\t\t\tmessage: 'You have completed your Meal Prep Starter Pack and are ready to checkout.'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\t\t\t\t\tcontinue_process = false;\r\n\t\t\t\t}\r\n\t\t\t\telse if (servings > number_servings_required)\r\n\t\t\t\t{\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Meal Prep Starter Pack',\r\n\t\t\t\t\t\tmessage: 'You have 1 medium meal left to complete your Meal Prep Starter Pack. You may order six medium dinners or three large dinners (or a combination of both sizes).'\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tmenuItemInfo['mid'][menu_item_id].qty_in_cart -= 1;\r\n\t\t\t\t\tcontinue_process = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (continue_process)\r\n\t\t\t{\r\n\t\t\t\tupdate_cart(menu_item_id, 'add');\r\n\r\n\t\t\t\t/* animate cart */\r\n\t\t\t\tif ((!USER_PREFERENCES || USER_PREFERENCES.SESSION_MENU_CART_FLY_TO.value > 0) && menuItemInfo['mid'][menu_item_id].category_id != 9)\r\n\t\t\t\t{\r\n\t\t\t\t\tvar cart = false;\r\n\r\n\t\t\t\t\t$('.progress-min').each(function (e) {\r\n\r\n\t\t\t\t\t\tif ($(this).is(':visible'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcart = $(this).parent();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (cart)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar imgtodrag = $('[data-recipe_img=\"' + menuItemInfo['mid'][menu_item_id].recipe_id + '\"]').eq(0);\r\n\r\n\t\t\t\t\t\tif (imgtodrag)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar imgclone = imgtodrag.clone();\r\n\r\n\t\t\t\t\t\t\t$(imgclone).removeClass('card-img-top').addClass('shadow border-green-light');\r\n\r\n\t\t\t\t\t\t\timgclone.offset({\r\n\t\t\t\t\t\t\t\ttop: e.pageY - 20,\r\n\t\t\t\t\t\t\t\tleft: e.pageX - 40\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.css({\r\n\t\t\t\t\t\t\t\t\t'position': 'absolute',\r\n\t\t\t\t\t\t\t\t\t'width': 80,\r\n\t\t\t\t\t\t\t\t\t'border': '2px solid',\r\n\t\t\t\t\t\t\t\t\t'z-index': '1500',\r\n\t\t\t\t\t\t\t\t\t'pointer-events': 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.appendTo($('body'))\r\n\t\t\t\t\t\t\t\t.animate({\r\n\t\t\t\t\t\t\t\t\t'top': cart.offset().top + 1,\r\n\t\t\t\t\t\t\t\t\t'left': cart.offset().left + ((cart.width() / 2) - 20),\r\n\t\t\t\t\t\t\t\t\t'width': 40\r\n\t\t\t\t\t\t\t\t}, 1000, 'easeInOutExpo');\r\n\r\n\t\t\t\t\t\t\timgclone.hide(\"puff\", {}, 500, function () {\r\n\t\t\t\t\t\t\t\t$(this).detach()\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// handle item removal\r\n\t$(document).on('click', '.remove-from-cart', function (e) {\r\n\t\tvar menu_item_id = $(this).data('menu_item_id');\r\n\r\n\t\tif (menuItemInfo.mid[menu_item_id].is_bundle == '1' && menuItemInfo.mid[menu_item_id].qty_in_cart > 1)\r\n\t\t{\r\n\t\t\tbootbox.confirm(\"Due to the complexity of this menu item you will need to re-add this menu item with your desired selections. Do you wish to continue?\", function (result) {\r\n\t\t\t\tif (result == true)\r\n\t\t\t\t{\r\n\t\t\t\t\tmenuItemInfo.mid[menu_item_id].qty_in_cart = 0;\r\n\r\n\t\t\t\t\t$('.bundle-subitem-qty[data-parent_item=\"' + menu_item_id + '\"]').each(function () {\r\n\r\n\t\t\t\t\t\tlet mid = $(this).data('menu_item_id');\r\n\r\n\t\t\t\t\t\tmenuItemInfo['mid'][mid].qty_in_cart = 0;\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tupdate_cart(menu_item_id, 'del');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tupdate_cart(menu_item_id, 'del');\r\n\t\t}\r\n\r\n\t\tif ($('.session_menu-meals-list').children().length <= 2)\r\n\t\t{\r\n\t\t\t$('.clear-all-cart-items-div').hide();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.sm-change-menu', function (e) {\r\n\t\t$('.sm-row-change-menu').toggleFlex();\r\n\t});\r\n\r\n\t$(document).on('click', '.sm-change-menu-starter', function (e) {\r\n\t\t$('.sm-row-change-menu-starter').toggleFlex();\r\n\t});\r\n\r\n\t$(document).on('click', '.sm-customization-available', function (e) {\r\n\t\t$('.sm-row-customization-available').toggleFlex();\r\n\t});\r\n\r\n\t$(document).on('click', '.link-dinner-details', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tvar menu_id = $(this).data('menu_id');\r\n\t\tvar menu_item_id = $(this).data('menu_item_id');\r\n\t\tvar store_id = $(this).data('store_id');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'menu_item',\r\n\t\t\t\top: 'find_item',\r\n\t\t\t\tmenu_id: menu_id,\r\n\t\t\t\tmenu_item_id: menu_item_id,\r\n\t\t\t\tstore_id: store_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbootbox.dialog({\r\n\t\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\t\t\"Full details\": function () {\r\n\t\t\t\t\t\t\t\tbounce('main.php?page=item&recipe=' + json.recipe_id + '&ov_menu=' + json.menu_id);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcancel: {\r\n\t\t\t\t\t\t\t\tlabel: \"Close\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// handle private party intro\r\n\t$(document).on('click', '.pp-view-intro, .pp-view-standard', function (e) {\r\n\t\tvar view_menu = $(this).data('view_menu');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'ddproc.php?processor=session_type',\r\n\t\t\tinput: ({\r\n\t\t\t\ttype: view_menu\r\n\t\t\t})\r\n\t\t});\r\n\t});\r\n\r\n\t// handle item page play button\r\n\t$(document).on('click', '.play-video', function (e) {\r\n\r\n\t\t$('html, body').animate({\r\n\t\t\tscrollTop: $('#video-tab').offset().top\r\n\t\t}, 2000);\r\n\r\n\t\t$('#video-tab').tab('show');\r\n\r\n\t});\r\n\r\n\t/*\r\n\t* Session Selection\r\n\t*/\r\n\t// handle session selection\r\n\t$(document).on('click', 'input[name=\"sessionRadio\"]', function (e) {\r\n\r\n\t\tvar session_id = $(this).val();\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_session_processor',\r\n\t\t\t\top: 'save',\r\n\t\t\t\tsid: session_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('[for^=\"sessionRadio-\"]').removeClass('bg-green font-weight-bold text-white');\r\n\t\t\t\t\t$('[data-day]').removeClass('bg-green font-weight-bold text-white').addClass('bg-gray-light');\r\n\r\n\t\t\t\t\t$('[for=\"sessionRadio-' + session_id + '\"]').addClass('bg-green font-weight-bold text-white');\r\n\t\t\t\t\t$('[data-day=\"' + json.result_day + '\"]').removeClass('bg-gray-light').addClass('bg-green text-white');\r\n\r\n\t\t\t\t\tbounce(json.bounce_to);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// session filter\r\n\t$(document).on('change', 'input[name^=\"filter-show_\"]', function (e) {\r\n\r\n\t\t$('[data-row_session_types]').hideFlex();\r\n\t\t$('.no-filter-selected').showFlex();\r\n\r\n\t\t$('input[name^=\"filter-show_\"]').each(function (e) {\r\n\r\n\t\t\tvar filter = $(this).data('filter');\r\n\r\n\t\t\tif ($(this).is(':checked'))\r\n\t\t\t{\r\n\t\t\t\t$('.no-filter-selected').hideFlex();\r\n\r\n\t\t\t\t$('[data-filter_session_type=\"' + filter + '\"]').showFlex();\r\n\r\n\t\t\t\t$('[data-row_session_types]').each(function (e) {\r\n\r\n\t\t\t\t\tvar session_types_array = $(this).data('row_session_types').split(',');\r\n\r\n\t\t\t\t\tif ($.inArray(filter, session_types_array) !== -1)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(this).showFlex();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('[data-filter_session_type=\"' + filter + '\"]').hideFlex();\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// handle session reschedule selection\r\n\t$(document).on('click', 'input[name=\"sessionRescheduleRadio\"]', function (e) {\r\n\r\n\t\tif ($(\"#rescheduleSessionDialog\").data(\"is_posed\") != \"true\")\r\n\t\t{\r\n\t\t\tvar session_id = $(this).val();\r\n\t\t\tvar target = $(this).data('friendly_date_time');\r\n\t\t\tvar source = $(\"#sessionRescheduleRadio-\" + current_session_id).data('friendly_date_time');\r\n\r\n\t\t\t$('#rescheduleSessionDialog').find('#reschedule_from_session').html(source);\r\n\t\t\t$('#rescheduleSessionDialog').find('#reschedule_to_session').html(target);\r\n\r\n\t\t\tvar options = {};\r\n\t\t\t$('#rescheduleSessionDialog').data(\"target_session_id\", session_id);\r\n\t\t\t$(\"#rescheduleSessionDialog\").data(\"is_posed\", \"true\");\r\n\t\t\t$('#rescheduleSessionDialog').modal(options);\r\n\r\n\t\t\t$('#rescheduleSessionDialog').on('hide.bs.modal', function (e) {\r\n\t\t\t\t$('input[name=\"sessionRescheduleRadio\"]').prop('checked', false);\r\n\t\t\t\t$(\"#rescheduleSessionDialog\").data(\"is_posed\", \"false\");\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '#do_reschedule', function (e) {\r\n\r\n\t\tvar target_id = $('#rescheduleSessionDialog').data(\"target_session_id\");\r\n\r\n\t\t$(\"#do_reschedule\").attr(\"disabled\", \"true\");\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: \"main.php?page=session&reschedule=\" + current_order_id,\r\n\t\t\tinput: ({\r\n\t\t\t\ttarget: target_id\r\n\t\t\t})\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '.add_event_session', function (e) {\r\n\r\n\t\tvar session_id = $(this).data('session');\r\n\t\tvar pwd_input = $('[data-event_session=\"' + session_id + '\"]');\r\n\r\n\t\tvar pwd = null;\r\n\t\tif ($(pwd_input).val())\r\n\t\t{\r\n\t\t\tpwd = $(pwd_input).val().trim();\r\n\t\t}\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_session_processor',\r\n\t\t\t\top: 'save',\r\n\t\t\t\tpwd: pwd,\r\n\t\t\t\tsid: session_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.result_code == 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce('main.php?page=session_menu');\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t$(pwd_input).addClass('is-invalid').parent().find('.invalid-feedback').text(json.processor_message);\r\n\r\n\t\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t\t$('.ld-spin').remove();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('keyup', '[data-event_session]', function (e) {\r\n\r\n\t\tif ($(this).val().trim() != '' && e.which == 13)\r\n\t\t{\r\n\t\t\t$(this).parent().find('.add_event_session').trigger('click');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).removeClass('is-invalid').parent().find('.invalid-feedback').text('Invalid code');\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t// session type change\r\n\t$(document).on('click', '.change_session_type', function (e) {\r\n\r\n\t\tvar session_type = $(this).data('session_type');\r\n\t\tvar bounce = $(this).data('bounce');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'ddproc.php?processor=session_type',\r\n\t\t\tinput: ({\r\n\t\t\t\t'type': session_type,\r\n\t\t\t\t'bounce_to': bounce\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// handle rsvp only\r\n\t$(document).on('click', '.rsvp_upgrade_btn', function (e) {\r\n\r\n\t\t$(\".session_menu_div\").slideDown();\r\n\r\n\t\t$('html, body').animate({\r\n\t\t\tscrollTop: $(\".session_menu_div\").offset().top\r\n\t\t}, 2000);\r\n\r\n\t});\r\n\r\n\t$(document).on('keyup change', '.add-coupon-code', function (e) {\r\n\r\n\t\tlet code = $(this).val();\r\n\r\n\t\t$('.add-coupon-code').val(code);\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.configure-bundle:not(.disabled)', function (e) {\r\n\r\n\t\tlet mid = $(this).data('menu_item_id');\r\n\r\n\t\t$('[data-master_item_id]').not('[data-master_item_id=\"' + mid + '\"]').slideUp();\r\n\r\n\t\t$('[data-master_item_id=\"' + mid + '\"]').slideToggle();\r\n\r\n\t});\r\n\r\n\t$(document).on('focusin', '.bundle-subitem-qty', function (e) {\r\n\r\n\t\t$(this).data('org_val', $(this).val());\r\n\r\n\t}).on('keyup change', '.bundle-subitem-qty', function (e) {\r\n\r\n\t\tlet menu_item_id = $(this).data('menu_item_id');\r\n\r\n\t\tlet canIncrement = canIncrementBundleSubItem($(this), '.bundle-subitem-qty');\r\n\t\tlet passinventoryCheck = inventoryCheck(menu_item_id);\r\n\r\n\t\tif (!passinventoryCheck || canIncrement !== true)\r\n\t\t{\r\n\t\t\t$(this).val($(this).data('org_val'));\r\n\r\n\t\t\tif (canIncrement !== true)\r\n\t\t\t{\r\n\t\t\t\tmodal_message({\r\n\t\t\t\t\ttitle: 'Max Items Reached',\r\n\t\t\t\t\tmessage: canIncrement\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(this).data('org_val', $(this).val());\r\n\t\t}\r\n\r\n\t\tupdateServingsCountAndCheckoutButton();\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.add-bundle-to-cart:not(.disabled)', function (e) {\r\n\r\n\t\tlet mid = $(this).data('menu_item_id');\r\n\r\n\t\tif (inventoryCheck(mid))\r\n\t\t{\r\n\t\t\tupdate_cart(mid, 'add');\r\n\t\t}\r\n\r\n\t\t// on success clear fields\r\n\t\t$('.bundle-subitem-qty[data-parent_item=\"' + mid + '\"]:not([readonly])').val(0);\r\n\r\n\t\t// close subitems\r\n\t\t$('[data-master_item_id=\"' + mid + '\"]').slideToggle();\r\n\r\n\t\tupdateServingsCountAndCheckoutButton();\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-add:not(.disabled)', function (e) {\r\n\r\n\t\tlet add_coupon_code = $(this).parent().parent().find('.add-coupon-code').val();\r\n\r\n\t\tif (!add_coupon_code)\r\n\t\t{\r\n\t\t\tmodal_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'Please enter a promo code.'\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'cart_add_payment',\r\n\t\t\t\t\tpayment_type: 'coupon',\r\n\t\t\t\t\tcoupon_code: add_coupon_code\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcoupon = json.coupon;\r\n\r\n\t\t\t\t\t\t$('.cart-total').text(json.orderInfo.grand_total);\r\n\r\n\t\t\t\t\t\t$('.add-coupon-code').prop('disabled', true);\r\n\t\t\t\t\t\t$('.add-coupon-add').addClass('disabled');\r\n\r\n\t\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t\t$('.coupon-code-title').text(json.coupon.coupon_code_short_title);\r\n\r\n\t\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(json.coupon.coupon_code_discount_total));\r\n\r\n\t\t\t\t\t\t// show coupon row\r\n\t\t\t\t\t\t$('.coupon-code-row').showFlex();\r\n\r\n\t\t\t\t\t\t// add menu item if applicable\r\n\t\t\t\t\t\tif (json.cart_update)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($('[data-cart_menu_item=\"' + json.menu_item_id + '\"]').length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-cart_menu_item=\"' + json.menu_item_id + '\"]').replaceWith(json.cart_update);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(json.cart_update).appendTo($('.meals-list')).hide().slideDown();\r\n\t\t\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideDown();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$('.clear-all-cart-items-div').show();\r\n\r\n\t\t\t\t\t\t\tmenuItemInfo['mid'][json.menu_item_id].qty_in_cart = json.qty_in_cart;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tupdateServingsCountAndCheckoutButton();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '.clear-cart-session', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\top: 'do_clear_session',\r\n\t\t\t\toutput: 'json'\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.clear-all-cart-items', function (e) {\r\n\r\n\t\tvar category = 'all';\r\n\t\tif (window.location.href.indexOf('gift_card_cart') != -1)\r\n\t\t{\r\n\t\t\tcategory = 'giftcard';\r\n\t\t}\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\top: 'get_clear_form',\r\n\t\t\t\toutput: 'json'\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tmodal_message({\r\n\t\t\t\t\ttitle: 'Clear your Cart',\r\n\t\t\t\t\tmessage: json.html,\r\n\t\t\t\t\theight: 300,\r\n\t\t\t\t\twidth: 300,\r\n\t\t\t\t\tresizable: false,\r\n\t\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\tprocessor: 'cart_item_processor',\r\n\t\t\t\t\t\t\t\top: 'remove_all_items',\r\n\t\t\t\t\t\t\t\toutput: 'json'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t\t// salesforce clear cart\r\n\t\t\t\t\t\t\t\tif (typeof _etmc !== 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t_etmc.push([\r\n\t\t\t\t\t\t\t\t\t\t\"trackCart\",\r\n\t\t\t\t\t\t\t\t\t\t{\"clear_cart\": true}\r\n\t\t\t\t\t\t\t\t\t]);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// reload page\r\n\t\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcancel: function () {\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-remove', function (e) {\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_remove_payment',\r\n\t\t\t\tpayment_type: 'coupon'\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t$('.cart-total').text(json.orderInfo.grand_total);\r\n\r\n\t\t\t\t\t// restore coupon input\r\n\t\t\t\t\t$('.add-coupon-code').prop('disabled', false);\r\n\t\t\t\t\t$('.add-coupon-add').removeClass('disabled');\r\n\r\n\t\t\t\t\tcoupon = false;\r\n\r\n\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t$('.coupon-code-title').text('');\r\n\r\n\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(0.00));\r\n\r\n\t\t\t\t\t// hide coupon row\r\n\t\t\t\t\t$('.coupon-code-row').hideFlex();\r\n\r\n\t\t\t\t\tif (json.limit_to_recipe_id)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmenuItemInfo['mid'][json.limit_to_recipe_id].qty_in_cart = json.qty_in_cart;\r\n\r\n\t\t\t\t\t\tif (json.qty_in_cart > 0)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($('[data-cart_menu_item=\"' + json.limit_to_recipe_id + '\"]').length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-cart_menu_item=\"' + json.limit_to_recipe_id + '\"]').replaceWith(json.cart_update);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(json.cart_update).appendTo($('.meals-list')).hide().slideDown();\r\n\t\t\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideDown();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$('.clear-all-cart-items-div').show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t$('.add-to-cart[data-menu_item_id=\"' + json.limit_to_recipe_id + '\"] > .fas').show();\r\n\r\n\t\t\t\t\t\t\t$('[data-cart_menu_item=\"' + json.limit_to_recipe_id + '\"]').slideUp('slow', function () {\r\n\r\n\t\t\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t\t\tif (!$('.meals-list').html().trim().length)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tif (order_minimum.is_applicable == false)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tif (order_minimum.has_freezer_inventory != true)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t$('.meals-list, .cart-total-div').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideDown();\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tupdateServingsCountAndCheckoutButton();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tmodal_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// handle rsvp submit\r\n\t$(document).on('click', '.rsvp_submit_btn', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tif ($('#rsvp_only_form')[0].checkValidity() === false)\r\n\t\t{\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t$('.ld-spin').remove();\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'session_rsvp',\r\n\t\t\t\t\top: 'rsvp_dream_taste',\r\n\t\t\t\t\tprimary_email_login: $('#rsvp_primary_email_login').val(),\r\n\t\t\t\t\tpassword_login: $('#rsvp_password_login').val(),\r\n\t\t\t\t\tfirstname: $('#rsvp_firstname').val(),\r\n\t\t\t\t\tlastname: $('#rsvp_lastname').val(),\r\n\t\t\t\t\ttelephone_1: $('#rsvp_telephone_1').val(),\r\n\t\t\t\t\tnobo: 1,\r\n\t\t\t\t\tsubmit_login: 1,\r\n\t\t\t\t\tremember_login: 1\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$('.rsvp_only_form_incomplete').slideUp();\r\n\t\t\t\t\t\t$('.rsvp_only_form_complete').slideDown();\r\n\r\n\t\t\t\t\t\t$('.login_first_name').text($('#rsvp_firstname').val());\r\n\t\t\t\t\t\t$('.login_sign_in').hide();\r\n\t\t\t\t\t\t$('.login_signed_in').show();\r\n\r\n\t\t\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t\t\t$('.ld-spin').remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (!json.processor_success && json.processor_message)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmodal_message({\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t\t\t$('.ld-spin').remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$('#rsvp_only_form').addClass('was-validated');\r\n\r\n\t});\r\n\r\n\t// scroll cart into view on mobile\r\n\t$('.mobile-cart-div').find('.menuCart').on('show.bs.collapse', function () {\r\n\r\n\t\t$('.show-cart-button > .fas').removeClass('fa-shopping-cart');\r\n\t\t$('.show-cart-button > .fas').addClass('fa-chevron-up');\r\n\r\n\t\t//$('body').addClass('modal-open').append('<div class=\"menuCart-modal modal-backdrop fade show\"></div>');\r\n\t\t$('body').addClass('modal-open');\r\n\t\t$('.menuCart').addClass('.panel-fullscreen');\r\n\r\n\t\tupdateServingsCountAndCheckoutButton();\r\n\t});\r\n\r\n\t// scroll cart into view on mobile\r\n\t$('.mobile-cart-div').find('.menuCart').on('shown.bs.collapse', function () {\r\n\r\n\t\t$('.mobile-cart-div')[0].scrollIntoView({\r\n\t\t\tbehavior: \"smooth\",\r\n\t\t\tblock: \"start\"\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// close cart if they click outside it\r\n\t$(document).on('click', '.menuCart-modal, .mobile-cart-div > * .msg_empty_cart', function (e) {\r\n\r\n\t\t$('.show-cart-button').trigger('click');\r\n\r\n\t});\r\n\r\n\t$('.mobile-cart-div').find('.menuCart').on('hide.bs.collapse', function () {\r\n\r\n\t\t$('.show-cart-button > .fas').removeClass('fa-chevron-up');\r\n\t\t$('.show-cart-button > .fas').addClass('fa-shopping-cart');\r\n\t\t$('.continue-btn-div').toggle();\r\n\r\n\t\t$('body').removeClass('modal-open');\r\n\t\t$('.menuCart-modal').remove();\r\n\r\n\t\tupdateServingsCountAndCheckoutButton();\r\n\t});\r\n\r\n\t// setup back button to handle closing cart window\r\n\t/*\r\n\t$(document).on('click', '.show-cart-button', function (e) {\r\n\r\n\t\t// opening cart\r\n\t\tif ($(this).attr('aria-expanded') == 'true' && location.hash != \"#cart\")\r\n\t\t{\r\n\t\t\thistoryPush({url: 'main.php?page=session_menu#cart'});\r\n\t\t}\r\n\t\telse // closing cart\r\n\t\t{\r\n\t\t\tif (location.hash === \"#cart\")\r\n\t\t\t{\r\n\t\t\t\thistory.replaceState(null, null, ' ');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t// handle close cart when #cart is removed via back button\r\n\t$(window).on('hashchange', function (e) {\r\n\r\n\t\tif (location.hash === \"\")\r\n\t\t{\r\n\t\t\t$('.mobile-cart-div').find('.menuCart').collapse('hide');\r\n\t\t\t$('.show-cart-button').attr('aria-expanded', false);\r\n\t\t}\r\n\r\n\t});\r\n\t*/\r\n\r\n\t// handle sessions that expire while page is loaded\r\n\tif ($('[data-unix_expiry]').length > 0)\r\n\t{\r\n\t\t// cancel existing timer if there is one\r\n\t\t$.doTimeout('unix_expiry_timer');\r\n\r\n\t\t// check every minute and set radio to disabled based on session/day expiry\r\n\t\t$.doTimeout('unix_expiry_timer', 60000, function () {\r\n\t\t\tvar unixtime = Math.round(new Date().getTime() / 1000);\r\n\r\n\t\t\t$('[data-unix_expiry]').filter(function () {\r\n\r\n\t\t\t\treturn $(this).data('unix_expiry') < unixtime && !$(this).hasClass('disabled');\r\n\r\n\t\t\t}).addClass('disabled');\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\t// call it immediately\r\n\t\t$.doTimeout('unix_expiry_timer', true);\r\n\t}\r\n\t/*\r\n\t* End Session Selection\r\n\t*/\r\n\r\n\t// fix for IE\r\n\tif (isIE())\r\n\t{\r\n\t\tvar mobileCartElem = $('.mobile-cart-div');\r\n\t\tvar fixMobileTop = $(mobileCartElem).offset().top;\r\n\t\t$(window).scroll(function () {\r\n\t\t\tvar currentScroll = $(window).scrollTop();\r\n\t\t\tif (currentScroll >= fixMobileTop)\r\n\t\t\t{\r\n\t\t\t\t$(mobileCartElem).css({\r\n\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\tleft: 0,\r\n\t\t\t\t\ttop: 0\r\n\t\t\t\t}).removeClass('px-0');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(mobileCartElem).css({\r\n\t\t\t\t\tposition: 'static',\r\n\t\t\t\t\tleft: 'auto',\r\n\t\t\t\t\ttop: 'auto'\r\n\t\t\t\t}).addClass('px-0');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\tvar desktopCartElem = $('.desktop-cart-div');\r\n\t\tvar fixDesktopTop = $(desktopCartElem).offset().top;\r\n\t\t$(window).scroll(function () {\r\n\t\t\tvar currentScroll = $(window).scrollTop();\r\n\t\t\tif (currentScroll >= fixDesktopTop)\r\n\t\t\t{\r\n\t\t\t\t$(desktopCartElem).css({\r\n\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\ttop: 0\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(desktopCartElem).css({\r\n\t\t\t\t\tposition: 'static',\r\n\t\t\t\t\ttop: 'auto'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n});"],"mappings":"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"}