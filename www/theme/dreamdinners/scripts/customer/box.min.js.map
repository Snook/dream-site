{"version":3,"file":"box.min.js","names":["BOX_PROCESSING","BOX_QUEUE","inventoryCheck","menu_item_id","operation","newInventory","qty","qty_in_box","undefined","box_info","custom_box","items","parseInt","menuItemInfo","mid","remaining_servings","servings_per_item","incrementBox","update_action","info","number_items","number_items_required","number_servings","number_servings_required","dd_message","message","buttons","$","trigger","recalculateBox","box_type","addClass","removeClass","css","width","attr","text","number_servings_total","find","box_items","each","number_servings_this_item","button","progress_val","progress_txt","Math","round","document","on","e","preventDefault","sid","this","getAttribute","create_and_submit_form","input","box_id","bundle_id","action","view_box","view_bundle","box_instance_id","push","data","ajax","url","type","timeout","dataType","processor","op","box_bundle_id","success","json","processor_success","cart_box_instance_id","length","key","item","replaceWith","cart_update","appendTo","hide","slideDown","html","trim","slideUp","error","objAJAXRequest","strError","bounce","boxButton","hasClass","out_of_stock","price","bundle_name","remove","total_items_price","code","val","add_coupon_code","parent","payment_type","coupon_code","coupon","prop","coupon_code_short_title","formatAsMoney","coupon_code_discount_total","showFlex","title","processor_message","hideFlex","recipe_id"],"sourceRoot":"js/src/dreamdinners/customer","sources":["box.js"],"sourcesContent":["let BOX_PROCESSING = false;\r\nlet BOX_QUEUE = [];\r\n\r\nfunction inventoryCheck(menu_item_id, operation)\r\n{\r\n\tlet newInventory;\r\n\tlet qty = 0;\r\n\tlet qty_in_box = 0;\r\n\t// is item already in box - include in inventory check if so\r\n\tif (box_info.custom_box.items[menu_item_id] != undefined)\r\n\t{\r\n\t\tqty_in_box = box_info.custom_box.items[menu_item_id];\r\n\t}\r\n\r\n\r\n\tif (operation == 'add')\r\n\t{\r\n\t\tqty = qty_in_box + 1;\r\n\t\tnewInventory = parseInt(menuItemInfo.mid[menu_item_id].remaining_servings) - (parseInt(menuItemInfo.mid[menu_item_id].servings_per_item * qty));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tqty = qty_in_box - 1;\r\n\t\tnewInventory = parseInt(menuItemInfo.mid[menu_item_id].remaining_servings) + parseInt(menuItemInfo.mid[menu_item_id].servings_per_item * qty);\r\n\t}\r\n\r\n\tif (newInventory < 0)\r\n\t{\r\n\t\treturn false;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn newInventory;\r\n\t}\r\n}\r\n\r\nfunction incrementBox(menu_item_id, update_action)\r\n{\r\n\tif (update_action === 'add')\r\n\t{\r\n\t\tif (box_info.custom_box.info.number_items == box_info.number_items_required && box_info.custom_box.info.number_servings == box_info.number_servings_required)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\tmessage: 'The box is full, you may now add the box to your cart.',\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\t\"Add Box\": function () {\r\n\t\t\t\t\t\t$('.box-add').trigger('click');\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Not Yet\": function () {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (typeof box_info.custom_box.items[menu_item_id] === 'undefined')\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] = 1;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] += 1;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tif (typeof box_info.custom_box.items[menu_item_id] === 'undefined')\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] = 0;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] -= 1;\r\n\t\t}\r\n\r\n\t\tif (box_info.custom_box.items[menu_item_id] <= 0)\r\n\t\t{\r\n\t\t\tdelete box_info.custom_box.items[menu_item_id];\r\n\t\t}\r\n\t}\r\n\r\n\trecalculateBox();\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction recalculateBox()\r\n{\r\n\tif (typeof box_info !== 'undefined')\r\n\t{\r\n\t\tif (box_info.box_type == 'DELIVERED_FIXED')\r\n\t\t{\r\n\t\t\t$('.progress-box').addClass('box-add').removeClass('progress-bar-striped disabled');\r\n\t\t\t$('.progress-box').css({'width': '100%'}).attr('aria-valuenow', 100).text('Add box to cart');\r\n\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t}\r\n\t\telse if (box_info.box_type == 'DELIVERED_CUSTOM')\r\n\t\t{\r\n\t\t\tlet number_items = 0;\r\n\t\t\tlet number_servings_total = 0;\r\n\t\t\tlet number_servings_per_item = [];\r\n\r\n\t\t\t// fresh start by disabling ability to add box\r\n\t\t\t$('.box-add').addClass('disabled');\r\n\t\t\t// fresh start by enabling all menu item buttons\r\n\t\t\t$('.box-item-update[data-box_update_action=\"add\"]').removeClass('disabled').find('.title').text('Add item');\r\n\r\n\t\t\tif (box_info.custom_box.items)\r\n\t\t\t{\r\n\t\t\t\tlet box_items = box_info.custom_box.items;\r\n\r\n\t\t\t\t$.each(box_items, function (mid, qty) {\r\n\t\t\t\t\tnumber_items += qty;\r\n\t\t\t\t\tnumber_servings_total += parseInt(menuItemInfo.mid[mid].servings_per_item) * qty;\r\n\r\n\t\t\t\t\tlet number_servings_this_item = parseInt(menuItemInfo.mid[mid].servings_per_item) * qty;\r\n\r\n\t\t\t\t\tlet newInventory = parseInt(menuItemInfo.mid[mid].remaining_servings) - number_servings_this_item;\r\n\r\n\t\t\t\t\tlet button = $('.box-item-update[data-box_update_action=\"add\"][data-menu_item_id=\"' + mid + '\"]');\r\n\r\n\t\t\t\t\t// disable individual menu button state by max allowed or remaining inventory\r\n\t\t\t\t\tif (qty >= 2 || newInventory < menuItemInfo.mid[mid].servings_per_item)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tbutton.addClass('disabled');\r\n\r\n\t\t\t\t\t\t// max allowed reached\r\n\t\t\t\t\t\tif (qty >= 2)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbutton.find('.title').text('Max allowed');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// out of inventory\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbutton.find('.title').text('Sold out');\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tbox_info.custom_box.info = {\r\n\t\t\t\t'number_items' : number_items,\r\n\t\t\t\t'number_servings' : number_servings_total\r\n\t\t\t};\r\n\r\n\t\t\tlet progress_val = (box_info.custom_box.info.number_items / box_info.number_items_required) * 100;\r\n\t\t\tlet progress_txt = ((progress_val >= 100) ? 'Add box to cart' : ((progress_val <= 0) ? '' : Math.round(progress_val) + '%'));\r\n\r\n\t\t\tif (progress_val >= 100)\r\n\t\t\t{\r\n\t\t\t\t$('.progress-box').addClass('box-add').removeClass('progress-bar-striped disabled');\r\n\t\t\t\t$('.cart-button').removeClass('fa-box-open').addClass('fa-box');\r\n\t\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.progress-box').addClass('progress-bar-striped').removeClass('box-add disabled');\r\n\t\t\t\t$('.cart-button').removeClass('fa-box').addClass('fa-box-open');\r\n\t\t\t}\r\n\r\n\t\t\t$('.progress-box').css({'width': progress_val + '%'}).attr('aria-valuenow', progress_val).text(progress_txt);\r\n\r\n\t\t\t// enable add box button\r\n\t\t\tif (box_info.custom_box.info.number_items == box_info.number_items_required && box_info.custom_box.info.number_servings == box_info.number_servings_required)\r\n\t\t\t{\r\n\t\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\n$(function () {\r\n\r\n\trecalculateBox();\r\n\r\n\t$(document).on('click', '[data-select_delivery_day]:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet sid = this.getAttribute('data-select_delivery_day');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\tinput: ({\r\n\t\t\t\tsid: sid\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '[data-view_box]:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet box_id = this.getAttribute('data-view_box');\r\n\t\tlet bundle_id = this.getAttribute('data-view_bundle');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'main.php?page=box_menu',\r\n\t\t\tinput: ({\r\n\t\t\t\tview_box: box_id,\r\n\t\t\t\tview_bundle: bundle_id\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// handle cart addition\r\n\t$(document).on('click', '.box-item-update:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t// new box instance, haven't retrieved a new id yet\r\n\t\tif (BOX_PROCESSING && box_info.box_instance_id == 0)\r\n\t\t{\r\n\t\t\t// hang onto this and process after we get an id\r\n\t\t\tBOX_QUEUE.push($(this));\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet menu_item_id = $(this).data('menu_item_id');\r\n\t\tlet update_action = $(this).data('box_update_action');\r\n\r\n\t\tif (inventoryCheck(menu_item_id, update_action) !== false)\r\n\t\t{\r\n\t\t\tif (incrementBox(menu_item_id, update_action))\r\n\t\t\t{\r\n\t\t\t\tBOX_PROCESSING = true;\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\t\t\top: 'update',\r\n\t\t\t\t\t\tmenu_item_id: menu_item_id,\r\n\t\t\t\t\t\tbox_id: box_info.box_id,\r\n\t\t\t\t\t\tbox_instance_id: box_info.box_instance_id,\r\n\t\t\t\t\t\tbundle_id: box_info.box_bundle_id,\r\n\t\t\t\t\t\tqty: box_info.custom_box.items[menu_item_id]\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbox_info.box_instance_id = json.cart_box_instance_id;\r\n\t\t\t\t\t\t\tBOX_PROCESSING = false;\r\n\r\n\t\t\t\t\t\t\tif (BOX_QUEUE.length != 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$.each(BOX_QUEUE, function (key, item) {\r\n\r\n\t\t\t\t\t\t\t\t\t$(item).trigger('click');\r\n\t\t\t\t\t\t\t\t\tdelete BOX_QUEUE[key];\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ($('[data-cart_menu_item=\"' + menu_item_id + '\"]').length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-cart_menu_item=\"' + menu_item_id + '\"]').replaceWith(json.cart_update);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(json.cart_update).appendTo($('.meals-list')).hide().slideDown();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (!$('.meals-list').html().trim().length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('.cart-list-div').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideDown();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t$('.cart-list-div').slideDown();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\trecalculateBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '.box-add:not(.disabled)', function (e) {\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\top: 'add',\r\n\t\t\t\tbox_id: box_info.box_id,\r\n\t\t\t\tbundle_id: box_info.box_bundle_id,\r\n\t\t\t\tbox_instance_id: box_info.box_instance_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce('main.php?page=box_select');\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.box-remove:not(.disabled)', function (e) {\r\n\r\n\t\tlet box_instance_id = $(this).data('box_instance_id');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\top: 'remove',\r\n\t\t\t\tbox_instance_id: box_instance_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet boxButton = $('[data-view_box=\"' + json.data.box_info.box_id + '\"][data-view_bundle=\"' + json.data.box_info.bundle_id + '\"]');\r\n\r\n\t\t\t\t\tif (boxButton.hasClass('disabled') && json.data.box_info.out_of_stock != 'false')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tboxButton.removeClass('disabled').text('$' + json.data.box_info.price + ' ' + json.data.box_info.bundle_name);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('[data-cart_box_id=\"' + box_instance_id + '\"]').slideUp(function(e) {\r\n\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t$('.cart-total').text(json.data.total_items_price);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('keyup change', '.add-coupon-code', function (e) {\r\n\r\n\t\tlet code = $(this).val();\r\n\r\n\t\t$('.add-coupon-code').val(code);\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-add:not(.disabled)', function (e) {\r\n\r\n\t\tlet add_coupon_code = $(this).parent().parent().find('.add-coupon-code').val();\r\n\r\n\t\tif (!add_coupon_code)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'Please enter a promo code.'\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'cart_add_payment',\r\n\t\t\t\t\tpayment_type: 'coupon',\r\n\t\t\t\t\tcoupon_code: add_coupon_code\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcoupon = json.coupon;\r\n\r\n\t\t\t\t\t\t$('.add-coupon-code').prop('disabled', true);\r\n\t\t\t\t\t\t$('.add-coupon-add').addClass('disabled');\r\n\r\n\t\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t\t$('.coupon-code-title').text(coupon.coupon_code_short_title);\r\n\r\n\t\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(coupon.coupon_code_discount_total));\r\n\r\n\t\t\t\t\t\t// show coupon row\r\n\t\t\t\t\t\t$('.coupon-code-row').showFlex();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-remove', function (e) {\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_remove_payment',\r\n\t\t\t\tpayment_type: 'coupon'\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t// restore coupon input\r\n\t\t\t\t\t$('.add-coupon-code').prop('disabled', false);\r\n\t\t\t\t\t$('.add-coupon-add').removeClass('disabled');\r\n\r\n\t\t\t\t\tcoupon = false;\r\n\r\n\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t$('.coupon-code-title').text('');\r\n\r\n\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(0.00));\r\n\r\n\t\t\t\t\t// hide coupon row\r\n\t\t\t\t\t$('.coupon-code-row').hideFlex();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '[data-dinner_details]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet recipe_id = $(this).data('dinner_details');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'main.php?page=item&recipe=' + recipe_id,\r\n\t\t\tinput: ({\r\n\t\t\t\t'box_id': box_info.box_id\r\n\t\t\t})\r\n\t\t});\r\n\r\n\r\n\t});\r\n});"],"mappings":"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"}