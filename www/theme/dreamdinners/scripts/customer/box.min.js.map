{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["box.js"],"sourcesContent":["let BOX_PROCESSING = false;\r\nlet BOX_QUEUE = [];\r\n\r\nfunction inventoryCheck(menu_item_id, operation)\r\n{\r\n\tlet newInventory;\r\n\tlet qty = 0;\r\n\tlet qty_in_box = 0;\r\n\t// is item already in box - include in inventory check if so\r\n\tif (box_info.custom_box.items[menu_item_id] != undefined)\r\n\t{\r\n\t\tqty_in_box = box_info.custom_box.items[menu_item_id];\r\n\t}\r\n\r\n\r\n\tif (operation == 'add')\r\n\t{\r\n\t\tqty = qty_in_box + 1;\r\n\t\tnewInventory = parseInt(menuItemInfo.mid[menu_item_id].remaining_servings) - (parseInt(menuItemInfo.mid[menu_item_id].servings_per_item * qty));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tqty = qty_in_box - 1;\r\n\t\tnewInventory = parseInt(menuItemInfo.mid[menu_item_id].remaining_servings) + parseInt(menuItemInfo.mid[menu_item_id].servings_per_item * qty);\r\n\t}\r\n\r\n\tif (newInventory < 0)\r\n\t{\r\n\t\treturn false;\r\n\t}\r\n\telse\r\n\t{\r\n\t\treturn newInventory;\r\n\t}\r\n}\r\n\r\nfunction incrementBox(menu_item_id, update_action)\r\n{\r\n\tif (update_action === 'add')\r\n\t{\r\n\t\tif (box_info.custom_box.info.number_items == box_info.number_items_required && box_info.custom_box.info.number_servings == box_info.number_servings_required)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\tmessage: 'The box is full, you may now add the box to your cart.',\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\t\"Add Box\": function () {\r\n\t\t\t\t\t\t$('.box-add').trigger('click');\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Not Yet\": function () {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (typeof box_info.custom_box.items[menu_item_id] === 'undefined')\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] = 1;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] += 1;\r\n\t\t}\r\n\t}\r\n\telse\r\n\t{\r\n\t\tif (typeof box_info.custom_box.items[menu_item_id] === 'undefined')\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] = 0;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tbox_info.custom_box.items[menu_item_id] -= 1;\r\n\t\t}\r\n\r\n\t\tif (box_info.custom_box.items[menu_item_id] <= 0)\r\n\t\t{\r\n\t\t\tdelete box_info.custom_box.items[menu_item_id];\r\n\t\t}\r\n\t}\r\n\r\n\trecalculateBox();\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction recalculateBox()\r\n{\r\n\tif (typeof box_info !== 'undefined')\r\n\t{\r\n\t\tif (box_info.box_type == 'DELIVERED_FIXED')\r\n\t\t{\r\n\t\t\t$('.progress-box').addClass('box-add').removeClass('progress-bar-striped disabled');\r\n\t\t\t$('.progress-box').css({'width': '100%'}).attr('aria-valuenow', 100).text('Add box to cart');\r\n\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t}\r\n\t\telse if (box_info.box_type == 'DELIVERED_CUSTOM')\r\n\t\t{\r\n\t\t\tlet number_items = 0;\r\n\t\t\tlet number_servings_total = 0;\r\n\t\t\tlet number_servings_per_item = [];\r\n\r\n\t\t\t// fresh start by disabling ability to add box\r\n\t\t\t$('.box-add').addClass('disabled');\r\n\t\t\t// fresh start by enabling all menu item buttons\r\n\t\t\t$('.box-item-update[data-box_update_action=\"add\"]').removeClass('disabled').find('.title').text('Add item');\r\n\r\n\t\t\tif (box_info.custom_box.items)\r\n\t\t\t{\r\n\t\t\t\tlet box_items = box_info.custom_box.items;\r\n\r\n\t\t\t\t$.each(box_items, function (mid, qty) {\r\n\t\t\t\t\tnumber_items += qty;\r\n\t\t\t\t\tnumber_servings_total += parseInt(menuItemInfo.mid[mid].servings_per_item) * qty;\r\n\r\n\t\t\t\t\tlet number_servings_this_item = parseInt(menuItemInfo.mid[mid].servings_per_item) * qty;\r\n\r\n\t\t\t\t\tlet newInventory = parseInt(menuItemInfo.mid[mid].remaining_servings) - number_servings_this_item;\r\n\r\n\t\t\t\t\tlet button = $('.box-item-update[data-box_update_action=\"add\"][data-menu_item_id=\"' + mid + '\"]');\r\n\r\n\t\t\t\t\t// disable individual menu button state by max allowed or remaining inventory\r\n\t\t\t\t\tif (qty >= 2 || newInventory < menuItemInfo.mid[mid].servings_per_item)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tbutton.addClass('disabled');\r\n\r\n\t\t\t\t\t\t// max allowed reached\r\n\t\t\t\t\t\tif (qty >= 2)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbutton.find('.title').text('Max allowed');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// out of inventory\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbutton.find('.title').text('Sold out');\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tbox_info.custom_box.info = {\r\n\t\t\t\t'number_items' : number_items,\r\n\t\t\t\t'number_servings' : number_servings_total\r\n\t\t\t};\r\n\r\n\t\t\tlet progress_val = (box_info.custom_box.info.number_items / box_info.number_items_required) * 100;\r\n\t\t\tlet progress_txt = ((progress_val >= 100) ? 'Add box to cart' : ((progress_val <= 0) ? '' : Math.round(progress_val) + '%'));\r\n\r\n\t\t\tif (progress_val >= 100)\r\n\t\t\t{\r\n\t\t\t\t$('.progress-box').addClass('box-add').removeClass('progress-bar-striped disabled');\r\n\t\t\t\t$('.cart-button').removeClass('fa-box-open').addClass('fa-box');\r\n\t\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$('.progress-box').addClass('progress-bar-striped').removeClass('box-add disabled');\r\n\t\t\t\t$('.cart-button').removeClass('fa-box').addClass('fa-box-open');\r\n\t\t\t}\r\n\r\n\t\t\t$('.progress-box').css({'width': progress_val + '%'}).attr('aria-valuenow', progress_val).text(progress_txt);\r\n\r\n\t\t\t// enable add box button\r\n\t\t\tif (box_info.custom_box.info.number_items == box_info.number_items_required && box_info.custom_box.info.number_servings == box_info.number_servings_required)\r\n\t\t\t{\r\n\t\t\t\t$('.box-add').removeClass('disabled');\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\n$(function () {\r\n\r\n\trecalculateBox();\r\n\r\n\t$(document).on('click', '[data-select_delivery_day]:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet sid = this.getAttribute('data-select_delivery_day');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\tinput: ({\r\n\t\t\t\tsid: sid\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '[data-view_box]:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet box_id = this.getAttribute('data-view_box');\r\n\t\tlet bundle_id = this.getAttribute('data-view_bundle');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'main.php?page=box_menu',\r\n\t\t\tinput: ({\r\n\t\t\t\tview_box: box_id,\r\n\t\t\t\tview_bundle: bundle_id\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t// handle cart addition\r\n\t$(document).on('click', '.box-item-update:not(.disabled)', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\t// new box instance, haven't retrieved a new id yet\r\n\t\tif (BOX_PROCESSING && box_info.box_instance_id == 0)\r\n\t\t{\r\n\t\t\t// hang onto this and process after we get an id\r\n\t\t\tBOX_QUEUE.push($(this));\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet menu_item_id = $(this).data('menu_item_id');\r\n\t\tlet update_action = $(this).data('box_update_action');\r\n\r\n\t\tif (inventoryCheck(menu_item_id, update_action) !== false)\r\n\t\t{\r\n\t\t\tif (incrementBox(menu_item_id, update_action))\r\n\t\t\t{\r\n\t\t\t\tBOX_PROCESSING = true;\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\t\t\top: 'update',\r\n\t\t\t\t\t\tmenu_item_id: menu_item_id,\r\n\t\t\t\t\t\tbox_id: box_info.box_id,\r\n\t\t\t\t\t\tbox_instance_id: box_info.box_instance_id,\r\n\t\t\t\t\t\tbundle_id: box_info.box_bundle_id,\r\n\t\t\t\t\t\tqty: box_info.custom_box.items[menu_item_id]\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tbox_info.box_instance_id = json.cart_box_instance_id;\r\n\t\t\t\t\t\t\tBOX_PROCESSING = false;\r\n\r\n\t\t\t\t\t\t\tif (BOX_QUEUE.length != 0)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$.each(BOX_QUEUE, function (key, item) {\r\n\r\n\t\t\t\t\t\t\t\t\t$(item).trigger('click');\r\n\t\t\t\t\t\t\t\t\tdelete BOX_QUEUE[key];\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ($('[data-cart_menu_item=\"' + menu_item_id + '\"]').length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('[data-cart_menu_item=\"' + menu_item_id + '\"]').replaceWith(json.cart_update);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$(json.cart_update).appendTo($('.meals-list')).hide().slideDown();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (!$('.meals-list').html().trim().length)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('.cart-list-div').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideDown();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t$('.msg_empty_cart').slideUp('slow', function () {\r\n\t\t\t\t\t\t\t\t\t$('.cart-list-div').slideDown();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\trecalculateBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '.box-add:not(.disabled)', function (e) {\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\top: 'add',\r\n\t\t\t\tbox_id: box_info.box_id,\r\n\t\t\t\tbundle_id: box_info.box_bundle_id,\r\n\t\t\t\tbox_instance_id: box_info.box_instance_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tbounce('main.php?page=box_select');\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.box-remove:not(.disabled)', function (e) {\r\n\r\n\t\tlet box_instance_id = $(this).data('box_instance_id');\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'delivered_box',\r\n\t\t\t\top: 'remove',\r\n\t\t\t\tbox_instance_id: box_instance_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet boxButton = $('[data-view_box=\"' + json.data.box_info.box_id + '\"][data-view_bundle=\"' + json.data.box_info.bundle_id + '\"]');\r\n\r\n\t\t\t\t\tif (boxButton.hasClass('disabled') && json.data.box_info.out_of_stock != 'false')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tboxButton.removeClass('disabled').text('$' + json.data.box_info.price + ' ' + json.data.box_info.bundle_name);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('[data-cart_box_id=\"' + box_instance_id + '\"]').slideUp(function(e) {\r\n\t\t\t\t\t\t$(this).remove();\r\n\r\n\t\t\t\t\t\t$('.cart-total').text(json.data.total_items_price);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t});\r\n\r\n\t$(document).on('keyup change', '.add-coupon-code', function (e) {\r\n\r\n\t\tlet code = $(this).val();\r\n\r\n\t\t$('.add-coupon-code').val(code);\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-add:not(.disabled)', function (e) {\r\n\r\n\t\tlet add_coupon_code = $(this).parent().parent().find('.add-coupon-code').val();\r\n\r\n\t\tif (!add_coupon_code)\r\n\t\t{\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Error',\r\n\t\t\t\tmessage: 'Please enter a promo code.'\r\n\t\t\t});\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\ttimeout: 20000,\r\n\t\t\t\tdataType: 'json',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tprocessor: 'cart_add_payment',\r\n\t\t\t\t\tpayment_type: 'coupon',\r\n\t\t\t\t\tcoupon_code: add_coupon_code\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\tif (json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcoupon = json.coupon;\r\n\r\n\t\t\t\t\t\t$('.add-coupon-code').prop('disabled', true);\r\n\t\t\t\t\t\t$('.add-coupon-add').addClass('disabled');\r\n\r\n\t\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t\t$('.coupon-code-title').text(coupon.coupon_code_short_title);\r\n\r\n\t\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(coupon.coupon_code_discount_total));\r\n\r\n\t\t\t\t\t\t// show coupon row\r\n\t\t\t\t\t\t$('.coupon-code-row').showFlex();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(document).on('click', '.add-coupon-remove', function (e) {\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'cart_remove_payment',\r\n\t\t\t\tpayment_type: 'coupon'\r\n\t\t\t},\r\n\t\t\tsuccess: function (json) {\r\n\t\t\t\tif (json.processor_success)\r\n\t\t\t\t{\r\n\t\t\t\t\t// restore coupon input\r\n\t\t\t\t\t$('.add-coupon-code').prop('disabled', false);\r\n\t\t\t\t\t$('.add-coupon-add').removeClass('disabled');\r\n\r\n\t\t\t\t\tcoupon = false;\r\n\r\n\t\t\t\t\t// update coupon title\r\n\t\t\t\t\t$('.coupon-code-title').text('');\r\n\r\n\t\t\t\t\t// update coupon total\r\n\t\t\t\t\t$('.coupon-code-total').text(formatAsMoney(0.00));\r\n\r\n\t\t\t\t\t// hide coupon row\r\n\t\t\t\t\t$('.coupon-code-row').hideFlex();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tdd_message({\r\n\t\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\t\tmessage: json.processor_message\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tdd_message({\r\n\t\t\t\t\ttitle: 'Error',\r\n\t\t\t\t\tmessage: 'Unexpected error: ' + strError\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(document).on('click', '[data-dinner_details]', function (e) {\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tlet recipe_id = $(this).data('dinner_details');\r\n\r\n\t\tcreate_and_submit_form({\r\n\t\t\taction: 'main.php?page=item&recipe=' + recipe_id,\r\n\t\t\tinput: ({\r\n\t\t\t\t'box_id': box_info.box_id\r\n\t\t\t})\r\n\t\t});\r\n\r\n\r\n\t});\r\n});"],"names":["let","BOX_PROCESSING","BOX_QUEUE","inventoryCheck","menu_item_id","operation","newInventory","qty","qty_in_box","box_info","custom_box","items","undefined","parseInt","menuItemInfo","mid","remaining_servings","servings_per_item","incrementBox","update_action","info","number_items","number_items_required","number_servings","number_servings_required","dd_message","message","buttons","Add Box","$","trigger","Not Yet","recalculateBox","box_type","addClass","removeClass","css","width","attr","text","number_servings_total","number_servings_per_item","find","box_items","each","number_servings_this_item","button","progress_val","progress_txt","Math","round","document","on","e","preventDefault","sid","this","getAttribute","create_and_submit_form","input","box_id","bundle_id","action","view_box","view_bundle","box_instance_id","push","data","ajax","url","type","timeout","dataType","processor","op","box_bundle_id","success","json","processor_success","cart_box_instance_id","length","key","item","replaceWith","cart_update","appendTo","hide","slideDown","html","trim","slideUp","error","objAJAXRequest","strError","bounce","boxButton","hasClass","out_of_stock","price","bundle_name","remove","total_items_price","code","val","add_coupon_code","parent","title","payment_type","coupon_code","coupon","prop","coupon_code_short_title","formatAsMoney","coupon_code_discount_total","showFlex","processor_message","hideFlex","recipe_id"],"mappings":"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"}