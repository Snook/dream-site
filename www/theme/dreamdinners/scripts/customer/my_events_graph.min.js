const graphConfig={clientID:CLIENT.microsoft.id,endpoint:"https://graph.microsoft.com/v1.0",options:{redirectUri:PATH.https_server+"/authms_my_events"},scope:["User.Read","Contacts.Read"]};async function getGraphContacts(t){const o=await authWithGraph(graphConfig);if(o){const e=new Headers,n="Bearer "+o;e.append("Authorization",n);const r={method:"GET",headers:e},a=graphConfig.endpoint+"/me/contacts";try{const o=await fetch(a,r),e=await o.json();if("function"!=typeof t)return e;t(e)}catch(t){console.error(`There was an error making the request: ${t}`)}}else console.error("An auth token must be passed in. To learn more about how to get an auth token for the Microsoft Graph API, check out https://github.com/AzureAD/microsoft-authentication-library-for-js")}async function authWithGraph(t){if(t.clientID&&t.scope){const o=new Msal.UserAgentApplication(t.clientID,null,null,t.options);try{await o.loginPopup(t.scope)}catch(t){console.error("Error during login",t)}try{return await o.acquireTokenSilent(t.scope)}catch(e){return await o.acquireTokenPopup(t.scope)}}else console.log("You must supply a client id and authentication scopes for your app")}$((function(){new Msal.UserAgentApplication(CLIENT.microsoft.id,null,null,graphConfig.options)}));