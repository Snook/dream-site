{"version":3,"names":["AJAX_IN_PROCESS","GUEST_PREFERENCES","lang","en","dd","dream_dinners","tc","terms_and_conditions","delayed_payment","delayed_payment_decline","set_user_pref","pref","setting","user_id","callBack","toUpperCase","pref_value","USER_PREFERENCES","value","$","isPlainObject","JSON","stringify","extend","toString","ajax","url","type","timeout","dataType","data","processor","op","key","success","json","status","response","error","objAJAXRequest","strError","get_user_pref","select_location_click_handler","document","on","e","config","store_id","order_type","this","id","indexOf","split","setStoreAndBeginOrder","preventDefault","bounce","location","target","window","open","href","back_path","encodeURIComponent","pathname","substring","search","incrementVal","incrementBy","parseInt","isNaN","toggleId","slideToggle","setQueryString","variable","vars","var_found","new_query","i","length","pair","getQueryVariable","decodeURI","removeQueryVariable","sourceURL","rtn","params_arr","queryString","splice","join","mailHideOnSubmit","token","getElementById","submit","historyPush","history","pushState","title","showPopup","settings","height","width","modal","resizable","module","message","dd_message","create_and_submit_form","method","form","property","attr","action","input","name","appendTo","body","append","remove","show","store","showMap","address","confirmNavigate","goUrl","confirm","dd_console_log","is_debug","console","log","address_location","latlong","getLocation","geolocation","geoparams","geocoder","google","maps","Geocoder","undefined","trim","latLng","latlng","componentRestrictions","postalCode","lat","parseFloat","lng","LatLng","coords","latitude","longitude","geocode","results","GeocoderStatus","OK","navigator","getCurrentPosition","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","dd_toast","animation","autohide","delay","css_header","html","toast","fetchToasts","dd_toasts","time","each","doTimeout","size","buttons","label","className","callback","cancel","bootbox","dialog","alert","showTermsAndConditions","jobject","tandc_url","noOk","Agree","prop","change","Decline","dd_alert","msg","formatAsMoney","mnt","Math","round","floor","get_todays_date","today","Date","getDate","slice","mm","getMonth","getFullYear","cookieCheck","hostAccess","overrideCookieCheck","cookie","domain","COOKIE","DEBUG","dd_print","print","nl2br","str","is_xhtml","replace","strip_tags","allowed","toLowerCase","match","$0","$1","PayFlow_Payload","encodedString","isIE","ua","userAgent","msie","trident","isSafari","test","oauthpopup","onCloseCallBack","Error","options","windowOptions","path","ref_page","reload_page","windowName","dualScreenLeft","screenLeft","screenX","dualScreenTop","screenTop","screenY","innerWidth","documentElement","clientWidth","screen","innerHeight","clientHeight","left","top","windowConfig","openPath","oauthWindow","closed","fn","$this","click","bind","attention","set_color","set_duration","stop","css","animate","backgroundColor","duration","center","max","outerHeight","scrollTop","outerWidth","scrollLeft","getVal","val","eq","addSpinner","hasClass","find","addClass","removeSpinner","removeClass","hideFlex","showFlex","toggleFlex","is","valDefault","dataset","valdefault","defaultValue","defaultSelected","selectedIndex","valCheckDiff","dataObj","group","checkdiff","diffData","trigger","valCheckDiffRemove","removeData","off","validateForm","validity","checkbox_groups","group_name","push","hide","checkValidity","classList","add","jQuery","prototype","constructor","addNameValuePair","cleanName","cleanValue","addAssocArray","arr","arrString","cleanPropName","retrieveEncodedString","stopPropagation","relatedTarget","tabid","new_query_string","ajaxSuccess","event","xhr","index","Cleave","delimiters","blocks","obj","parseJSON","responseText","user_preferences","guest_preferences","bounce_to","messages","toastArray","removeCookie","tooltip","selector","_gaq","gaq_cat","gaq_action","gaq_label","bg_image","category","output","clear_items","_etmc","clear_cart","reload","ready","FreshworksWidget","onresize","clear_edit_order","limit","text","new_text","substr","set_req","required","services","dropdown_menu","service","share","moreOpts","wrap","after","delivered_zip","getAttribute","click_id","tab","scrollToFixed","bottom","offset","collapse","ajaxError","jqxhr","exception","statusText","pref_elem","preferenceChangeListener","processor_success","processor_message","save_button","slideUp","cancel_button","spacer","prepend","slideDown","ClipboardJS"],"sourceRoot":"js/src/customer","sources":["global.js"],"sourcesContent":["var AJAX_IN_PROCESS = false;\r\nvar GUEST_PREFERENCES = {};\r\nvar lang = {\r\n\t'en': {\r\n\t\t'dd': {\r\n\t\t\t'dream_dinners': 'Dream Dinners'\r\n\t\t},\r\n\t\t'tc': {\r\n\t\t\t'terms_and_conditions': 'Terms & Conditions',\r\n\t\t\t'delayed_payment': 'When I opt to use the Delayed Payment service to pay for my order, I understand that the balance due for this and future orders will be automatically withdrawn (5) five days prior to my session date and will transact using the same credit card as was used to pay for the order deposit.',\r\n\t\t\t'delayed_payment_decline': 'By declining the Delayed Payment Terms and Conditions future orders are required to be paid in full upon submission. The balance due for existing Delayed Payement orders will be due at session.'\r\n\t\t}\r\n\t}\r\n};\r\nfunction set_user_pref(pref, setting, user_id, callBack)\r\n{\r\n\tpref = pref.toUpperCase();\r\n\tlet pref_value = USER_PREFERENCES[pref].value;\r\n\r\n\tif ($.isPlainObject(pref_value) && $.isPlainObject(setting))\r\n\t{\r\n\t\tsetting = JSON.stringify($.extend(USER_PREFERENCES[pref].value, setting));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tsetting = setting.toString()\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'account',\r\n\t\t\top: 'update_pref',\r\n\t\t\tkey: pref,\r\n\t\t\tuser_id: user_id,\r\n\t\t\tvalue: setting.toString()\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (typeof callBack === 'function')\r\n\t\t\t{\r\n\t\t\t\tcallBack(json, status);\r\n\t\t\t}\r\n\r\n\t\t\tresponse = json;\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\nfunction get_user_pref(pref, user_id, callBack)\r\n{\r\n\r\n\tif (typeof user_id != 'undefined') // get guest pref\r\n\t{\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'account',\r\n\t\t\t\top: 'get_pref',\r\n\t\t\t\tkey: pref,\r\n\t\t\t\tuser_id: user_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json, status) {\r\n\t\t\t\tif (typeof callBack === 'function')\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack(json, status);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn json;\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\telse // get current user pref\r\n\t{\r\n\r\n\t\tif (typeof USER_PREFERENCES !== 'undefined')\r\n\t\t{\r\n\t\t\tif (typeof USER_PREFERENCES[pref] === 'object')\r\n\t\t\t{\r\n\t\t\t\treturn USER_PREFERENCES[pref];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction select_location_click_handler()\r\n{\r\n\t// Register click handler to select store\r\n\t$(document).on('click', '[id^=\"select_location-\"], [id^=\"select_intro_location-\"]', function (e) {\r\n\r\n\t\tvar config = {\r\n\t\t\tstore_id: null,\r\n\t\t\torder_type: 'standard'\r\n\t\t};\r\n\r\n\t\tif (this.id.indexOf('intro_location') > 0)\r\n\t\t{\r\n\t\t\tconfig.order_type = 'intro';\r\n\t\t}\r\n\r\n\t\tconfig.store_id = this.id.split(\"-\")[1];\r\n\r\n\t\tsetStoreAndBeginOrder(config);\r\n\r\n\t\t// Stop browser from following href\r\n\t\te.preventDefault();\r\n\t});\r\n}\r\n\r\nfunction bounce(location, target)\r\n{\r\n\tif (!location)\r\n\t{\r\n\t\tlocation = 'main.php';\r\n\t}\r\n\r\n\tif (target)\r\n\t{\r\n\t\twindow.open(location, target);\r\n\t}\r\n\telse\r\n\t{\r\n\t\twindow.location.href = location;\r\n\t}\r\n}\r\n\r\nfunction back_path()\r\n{\r\n\t// returns encoded string to pass to back=\r\n\treturn encodeURIComponent(location.pathname.substring(1) + location.search);\r\n}\r\n\r\nfunction incrementVal(value, incrementBy)\r\n{\r\n\tvalue = parseInt(value);\r\n\tincrementBy = parseInt(incrementBy);\r\n\r\n\tif (isNaN(value))\r\n\t{\r\n\t\tvalue = 0;\r\n\t}\r\n\r\n\tvalue = value + incrementBy;\r\n\r\n\tif (parseInt(value) < 0)\r\n\t{\r\n\t\tvalue = 0;\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nfunction toggleId(id)\r\n{\r\n\t$('#' + id).slideToggle();\r\n}\r\n\r\nfunction setQueryString(variable, value)\r\n{\r\n\tvar query = window.location.search.substring(1);\r\n\tvar vars = query.split(\"&\");\r\n\tvar_found = false;\r\n\tnew_query = 'main.php?';\r\n\r\n\tfor (var i = 0; i < vars.length; i++)\r\n\t{\r\n\t\tvar pair = vars[i].split(\"=\");\r\n\r\n\t\tif (pair[0] == variable)\r\n\t\t{\r\n\t\t\tpair[1] = value;\r\n\t\t\tvar_found = true;\r\n\t\t}\r\n\r\n\t\tif (i > 0)\r\n\t\t{\r\n\t\t\tnew_query += '&';\r\n\t\t}\r\n\r\n\t\tnew_query += pair[0] + '=' + pair[1];\r\n\t}\r\n\r\n\tif (!var_found)\r\n\t{\r\n\t\tif (i > 0)\r\n\t\t{\r\n\t\t\tnew_query += '&';\r\n\t\t}\r\n\r\n\t\tnew_query += variable + '=' + value;\r\n\t}\r\n\r\n\treturn new_query;\r\n}\r\n\r\nfunction getQueryVariable(variable)\r\n{\r\n\tvar query = window.location.search.substring(1);\r\n\tvar vars = query.split(\"&\");\r\n\r\n\tfor (var i = 0; i < vars.length; i++)\r\n\t{\r\n\t\tvar pair = vars[i].split(\"=\");\r\n\t\tif (pair[0] == variable)\r\n\t\t{\r\n\t\t\treturn decodeURI(pair[1]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction removeQueryVariable(key, sourceURL)\r\n{\r\n\tvar rtn = sourceURL.split(\"?\")[0],\r\n\t\tparam,\r\n\t\tparams_arr = [],\r\n\t\tqueryString = (sourceURL.indexOf(\"?\") !== -1) ? sourceURL.split(\"?\")[1] : \"\";\r\n\r\n\tif (queryString !== \"\")\r\n\t{\r\n\t\tparams_arr = queryString.split(\"&\");\r\n\r\n\t\tfor (var i = params_arr.length - 1; i >= 0; i -= 1)\r\n\t\t{\r\n\t\t\tparam = params_arr[i].split(\"=\")[0];\r\n\r\n\t\t\tif (param === key)\r\n\t\t\t{\r\n\t\t\t\tparams_arr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trtn = rtn + \"?\" + params_arr.join(\"&\");\r\n\t}\r\n\r\n\treturn rtn;\r\n}\r\n\r\nfunction mailHideOnSubmit(token)\r\n{\r\n\tdocument.getElementById(\"mailhide_form\").submit();\r\n}\r\n\r\nfunction historyPush(config)\r\n{\r\n\t// Record history in html5 browser if supported\r\n\tif (window.history && window.history.pushState)\r\n\t{\r\n\t\tvar title = document.title;\r\n\t\tif (config.title)\r\n\t\t{\r\n\t\t\ttitle = config.title;\r\n\t\t}\r\n\r\n\t\thistory.pushState(null, title, config.url);\r\n\r\n\t}\r\n}\r\n\r\nfunction showPopup(config)\r\n{\r\n\tvar settings = { //defaults\r\n\t\ttype: 'GET',\r\n\t\theight: 500,\r\n\t\twidth: 600,\r\n\t\tmodal: false,\r\n\t\tcallBack: false,\r\n\t\tresizable: true\r\n\t};\r\n\r\n\t$.extend(settings, config);\r\n\r\n\t$.ajax({\r\n\t\turl: 'main.php?' + settings.module,\r\n\t\ttype: settings.type,\r\n\t\tsuccess: function (data, status) {\r\n\t\t\tsettings.message = data;\r\n\r\n\t\t\tdd_message(settings);\r\n\r\n\t\t\tif (typeof settings.callBack == 'function')\r\n\t\t\t{\r\n\t\t\t\tsettings.callBack();\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction create_and_submit_form(config)\r\n{\r\n\tvar settings = { //defaults\r\n\t\tmethod: 'post',\r\n\t\ttarget: false\r\n\t};\r\n\r\n\t$.extend(settings, config);\r\n\r\n\t// Create dynamic form to post and redirect to session_menu\r\n\tvar form = $('<form></form>');\r\n\tform.attr('method', settings.method);\r\n\r\n\tif (settings.action)\r\n\t{\r\n\t\tform.attr('action', settings.action);\r\n\t}\r\n\r\n\tif (settings.target)\r\n\t{\r\n\t\tform.attr('target', settings.target);\r\n\t}\r\n\r\n\tfor (var property in settings.input)\r\n\t{\r\n\t\t$('<input>').attr({\r\n\t\t\ttype: 'hidden',\r\n\t\t\tname: property,\r\n\t\t\tvalue: settings.input[property]\r\n\t\t}).appendTo(form);\r\n\t}\r\n\r\n\t$(document.body).append(form);\r\n\tform.submit();\r\n\t$(form).remove();\r\n}\r\n\r\nfunction setStoreAndBeginOrder(config)\r\n{\r\n\t// Show trobber\r\n\t$('.img_throbber_circle').show();\r\n\r\n\t// Create dynamic form to post and redirect to session_menu\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=session_menu',\r\n\t\tinput: ({\r\n\t\t\tstore: config.store_id,\r\n\t\t\torder_type: config.order_type\r\n\t\t})\r\n\t});\r\n}\r\n\r\nfunction showMap(address)\r\n{\r\n\tdd_message({\r\n\t\twidth: 670,\r\n\t\theight: 580,\r\n\t\tmodal: false,\r\n\t\tresizable: true,\r\n\t\tmessage: '<iframe width=\"100%\" height=\"97%\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"//maps.google.com/maps?q=Dream%20Dinners%20' + encodeURIComponent(address) + '&amp;hnear=Dream%20Dinners%20' + encodeURIComponent(address) + '&amp;f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;&amp;ie=UTF8&amp;hq=&amp;t=m3&amp;spn=0.02878,0.054932&amp;z=14&amp;iwloc=A&amp;output=embed\"></iframe>'\r\n\t});\r\n}\r\n\r\nfunction confirmNavigate(goUrl, message)\r\n{\r\n\tdd_message({\r\n\t\tmessage: message,\r\n\t\tconfirm: function () {\r\n\t\t\tbounce(goUrl);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction dd_console_log(message)\r\n{\r\n\tif (is_debug() && window.console)\r\n\t{\r\n\t\tconsole.log('DD Console Log: ' + message);\r\n\t}\r\n}\r\n\r\nfunction address_location(settings, callBack)\r\n{\r\n\tvar config = {\r\n\t\taddress: false, // mailing address string, can be partial address like just zip code or city and state.\r\n\t\tlatlong: false // latitude,longitude\r\n\t};\r\n\r\n\t// settings can be optional so check if callback is the first parameter\r\n\tif (typeof callBack === 'undefined' && typeof settings === 'function')\r\n\t{\r\n\t\tcallBack = settings;\r\n\t\tsettings = config;\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$.extend(config, settings);\r\n\t}\r\n\r\n\tvar getLocation = function (geolocation, address, latlong) {\r\n\t\t//dd_console_log('Fresh Geolocation data.');\r\n\r\n\t\tvar geocoder = new google.maps.Geocoder();\r\n\t\tvar geoparams;\r\n\r\n\t\tif (address != undefined)\r\n\t\t{\r\n\t\t\taddress = address.trim();\r\n\t\t\t//the entered address was a postal code or it was less than 5 characters, will send it as a postal code anyways, but will return an invalid zip code\r\n\t\t\tif (address.length <= 5)\r\n\t\t\t{\r\n\t\t\t\tgeoparams = {'latLng': latlng, 'componentRestrictions': {'postalCode': address}};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof latlong != 'undefined' && latlong)\r\n\t\t{\r\n\t\t\tlatlong = latlong.split(\",\");\r\n\t\t\tvar lat = parseFloat(latlong[0]);\r\n\t\t\tvar lng = parseFloat(latlong[1]);\r\n\t\t\tvar latlng = new google.maps.LatLng(lat, lng);\r\n\r\n\t\t\tgeoparams = {'latLng': latlng};\r\n\t\t}\r\n\t\telse if (geolocation !== false)\r\n\t\t{\r\n\t\t\tvar lat = parseFloat(geolocation.coords.latitude);\r\n\t\t\tvar lng = parseFloat(geolocation.coords.longitude);\r\n\t\t\tvar latlng = new google.maps.LatLng(lat, lng);\r\n\r\n\r\n\t\t\tgeoparams = {'latLng': latlng};\r\n\t\t}\r\n\t\t//the entered address was not a postal code\r\n\t\telse if(address != undefined && address.length > 5){\r\n\t\t\tgeoparams = {'address': address};\r\n\t\t}\r\n\r\n\t\tgeocoder.geocode(geoparams, function (results, status) {\r\n\r\n\t\t\tif (status == google.maps.GeocoderStatus.OK)\r\n\t\t\t{\r\n\r\n\t\t\t\tif (results)\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack('ok', results);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack('no_result', 'No geocoder results found.');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcallBack('error', 'No geocoder results found.');\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n\r\n\tvar onError = function (error) {\r\n\t\tswitch (error.code)\r\n\t\t{\r\n\t\t\tcase error.PERMISSION_DENIED:\r\n\t\t\t\tcallBack('gl_error', 'User denied the request for Geolocation.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.POSITION_UNAVAILABLE:\r\n\t\t\t\tcallBack('gl_error', 'Geolocation information is unavailable.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.TIMEOUT:\r\n\t\t\t\tcallBack('gl_error', 'The request to get user location timed out.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.UNKNOWN_ERROR:\r\n\t\t\t\tcallBack('gl_error', 'An unknown error occurred.');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tif (settings.address) // query by address\r\n\t{\r\n\t\tgetLocation(false, settings.address, false);\r\n\t}\r\n\telse if (settings.latlong) // query by latlong\r\n\t{\r\n\t\tgetLocation(false, false, settings.latlong);\r\n\t}\r\n\telse // browser geolocation\r\n\t{\r\n\t\tif (navigator.geolocation)\r\n\t\t{\r\n\t\t\tnavigator.geolocation.getCurrentPosition(getLocation, onError);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\r\n\r\n\t\t\tcallBack('gl_error', 'Geolocation not supported.');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction dd_toast(settings)\r\n{\r\n\tvar config = {\r\n\t\tanimation: true,\r\n\t\tautohide: true,\r\n\t\tdelay: 5000,\r\n\t\ttitle: false,\r\n\t\tmessage: false,\r\n\t\ttype: 'primary'\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (!$('.toast-container').length)\r\n\t{\r\n\t\t$('<div class=\"toast-container fixed-top mt-4\"></div>').appendTo('body');\r\n\t}\r\n\r\n\tswitch (config.type)\r\n\t{\r\n\t\tcase 'primary':\r\n\t\t\tconfig.css_header = 'bg-green-dark text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'secondary':\r\n\t\t\tconfig.css_header = 'bg-secondary text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'info':\r\n\t\t\tconfig.css_header = 'bg-info text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'success':\r\n\t\t\tconfig.css_header = 'bg-success text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Success');\r\n\t\t\tbreak;\r\n\t\tcase 'warning':\r\n\t\tcase 'warn':\r\n\t\t\tconfig.css_header = 'bg-warning text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Warning');\r\n\t\t\tbreak;\r\n\t\tcase 'error':\r\n\t\tcase 'danger':\r\n\t\t\tconfig.css_header = 'bg-danger text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Error');\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tvar html = '<div class=\"toast mx-auto\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" data-delay=\"' + config.delay + '\" data-autohide=\"' + config.autohide + '\">';\r\n\thtml += '<div class=\"toast-header ' + config.css_header + '\">';\r\n\thtml += '<strong class=\"mr-auto\">' + ((config.title) ? config.title : 'Notice') + '</strong>';\r\n\thtml += '<button type=\"button\" class=\"ml-2 mb-1 close\" data-dismiss=\"toast\" aria-label=\"Close\"><span aria-hidden=\"true\" class=\"text-white\">&times;</span></button>';\r\n\thtml += '</div>';\r\n\thtml += '<div class=\"toast-body\">' + config.message + '</div>';\r\n\thtml += '</div>';\r\n\r\n\t$('.toast-container').append(html);\r\n\t$('.toast-container .toast:last').toast('show');\r\n}\r\n\r\nfunction fetchToasts(json)\r\n{\r\n\tif (json.dd_toasts)\r\n\t{\r\n\t\tlet time = 0;\r\n\r\n\t\t$.each(json.dd_toasts, function (key) {\r\n\t\t\t// do a short delay so they don't all show up at once.\r\n\t\t\t$.doTimeout(time, function () {\r\n\t\t\t\tdd_toast(json.dd_toasts[key]);\r\n\t\t\t});\r\n\t\t\ttime += 500; // .5 seconds, time between toasts for a response containing multiple toasts\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction dd_message(settings)\r\n{\r\n\tvar config = {\r\n\t\ttitle: false,\r\n\t\tmessage: false,\r\n\t\tsize: false // small, large\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (typeof config.confirm != 'undefined')\r\n\t{\r\n\t\t// convert old dd_message\r\n\t\tif (typeof config.confirm == 'function')\r\n\t\t{\r\n\t\t\tconfig.buttons = {\r\n\t\t\t\tconfirm: {\r\n\t\t\t\t\tlabel: 'Confirm',\r\n\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\tcallback: config.confirm\r\n\t\t\t\t},\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\tlabel: 'Cancel',\r\n\t\t\t\t\tclassName: 'btn-secondary',\r\n\t\t\t\t\tcallback: config.cancel\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbootbox.dialog(config);\r\n\t}\r\n\telse if (typeof config.buttons != 'undefined')\r\n\t{\r\n\t\t// convert old dd_message\r\n\t\tvar buttons = {};\r\n\r\n\t\t$.each(config.buttons, function (key, value) {\r\n\r\n\t\t\tif (typeof value == 'function')\r\n\t\t\t{\r\n\t\t\t\tbuttons[key] = {\r\n\t\t\t\t\tlabel: key,\r\n\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\tcallback: value\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tconfig.buttons = buttons;\r\n\r\n\t\tbootbox.dialog(config);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tbootbox.alert(config);\r\n\t}\r\n\r\n}\r\n\r\nfunction showTermsAndConditions(jobject)\r\n{\r\n\tif (jobject && jobject.attr('data-tandc_page') == 'checkout')\r\n\t{\r\n\t\ttandc_url = 'main.php?static=module/tandc_popup_checkout';\r\n\t}\r\n\telse\r\n\t{\r\n\t\ttandc_url = 'main.php?static=module/tandc_popup';\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: tandc_url,\r\n\t\ttype: 'GET',\r\n\t\tsuccess: function (data, status) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Dream Dinners Terms and Conditions',\r\n\t\t\t\tmessage: data,\r\n\t\t\t\theight: 500,\r\n\t\t\t\twidth: 600,\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tnoOk: true,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\t\"Agree\": function () {\r\n\t\t\t\t\t\t$('#customers_terms').prop(\"checked\", true).change();\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Decline\": function () {\r\n\t\t\t\t\t\t$('#customers_terms').prop(\"checked\", false).change();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction dd_alert(msg)\r\n{\r\n\tdd_message({\r\n\t\ttitle: 'Alert',\r\n\t\tmessage: msg\r\n\t});\r\n}\r\n\r\nfunction formatAsMoney(mnt)\r\n{\r\n\tif (typeof mnt == 'undefined')\r\n\t{\r\n\t\tmnt = 0;\r\n\t}\r\n\r\n\tmnt -= 0;\r\n\tmnt = (Math.round(mnt * 100)) / 100;\r\n\treturn (mnt == Math.floor(mnt)) ? mnt + '.00'\r\n\t\t: ((mnt * 10 == Math.floor(mnt * 10)) ?\r\n\t\t\tmnt + '0' : mnt);\r\n}\r\n\r\nfunction get_todays_date()\r\n{\r\n\tvar today = new Date();\r\n\tvar dd = (\"0\" + today.getDate()).slice(-2);\r\n\tvar mm = ('0' + (today.getMonth() + 1)).slice(-2); //January is 0!\r\n\tvar yyyy = today.getFullYear();\r\n\r\n\treturn yyyy + '-' + mm + '-' + dd;\r\n}\r\n\r\nfunction cookieCheck()\r\n{\r\n\tvar hostAccess = getQueryVariable('host_url');\r\n\tvar overrideCookieCheck = false;\r\n\tif (hostAccess && hostAccess == 'http://support.dreamdinners.com')\r\n\t{\r\n\t\toverrideCookieCheck = true;\r\n\t}\r\n\r\n\t$.cookie('chkcookie', true, {domain: COOKIE.domain});\r\n\r\n\tif (!$.cookie('chkcookie') && !overrideCookieCheck)\r\n\t{\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Alert',\r\n\t\t\tmessage: 'You have cookies turned off in your browser. Please check your settings, and enable cookies for this site in order to continue. Thank you.'\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction is_debug()\r\n{\r\n\tif (typeof DEBUG !== 'undefined' && DEBUG === true)\r\n\t{\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_print()\r\n{\r\n\tif (is_debug())\r\n\t{\r\n\t\tdd_console_log('Debug: Print dialog called here.');\r\n\t}\r\n\telse\r\n\t{\r\n\t\twindow.print();\r\n\t}\r\n}\r\n\r\n///------------ phpjs functions ----------------------\r\nfunction nl2br(str, is_xhtml)\r\n{\r\n\t//  discuss at: http://phpjs.org/functions/nl2br/\r\n\t//   example 1: nl2br('Kevin\\nvan\\nZonneveld');\r\n\t//   returns 1: 'Kevin<br />\\nvan<br />\\nZonneveld'\r\n\t//   example 2: nl2br(\"\\nOne\\nTwo\\n\\nThree\\n\", false);\r\n\t//   returns 2: '<br>\\nOne<br>\\nTwo<br>\\n<br>\\nThree<br>\\n'\r\n\t//   example 3: nl2br(\"\\nOne\\nTwo\\n\\nThree\\n\", true);\r\n\t//   returns 3: '<br />\\nOne<br />\\nTwo<br />\\n<br />\\nThree<br />\\n'\r\n\r\n\tvar breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br ' + '/>' : '<br>'; // Adjust comment to avoid issue on phpjs.org display\r\n\r\n\treturn (str + '')\r\n\t\t.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + breakTag + '$2');\r\n}\r\n\r\nfunction strip_tags(input, allowed)\r\n{\r\n\t//  discuss at: http://phpjs.org/functions/strip_tags/\r\n\t//   example 1: strip_tags('<p>Kevin</p> <br /><b>van</b> <i>Zonneveld</i>', '<i><b>');\r\n\t//   returns 1: 'Kevin <b>van</b> <i>Zonneveld</i>'\r\n\t//   example 2: strip_tags('<p>Kevin <img src=\"someimage.png\" onmouseover=\"someFunction()\">van <i>Zonneveld</i></p>', '<p>');\r\n\t//   returns 2: '<p>Kevin van Zonneveld</p>'\r\n\t//   example 3: strip_tags(\"<a href='http://kevin.vanzonneveld.net'>Kevin van Zonneveld</a>\", \"<a>\");\r\n\t//   returns 3: \"<a href='http://kevin.vanzonneveld.net'>Kevin van Zonneveld</a>\"\r\n\t//   example 4: strip_tags('1 < 5 5 > 1');\r\n\t//   returns 4: '1 < 5 5 > 1'\r\n\t//   example 5: strip_tags('1 <br/> 1');\r\n\t//   returns 5: '1  1'\r\n\t//   example 6: strip_tags('1 <br/> 1', '<br>');\r\n\t//   returns 6: '1 <br/> 1'\r\n\t//   example 7: strip_tags('1 <br/> 1', '<br><br/>');\r\n\t//   returns 7: '1 <br/> 1'\r\n\r\n\tallowed = (((allowed || '') + '')\r\n\t\t.toLowerCase()\r\n\t\t.match(/<[a-z][a-z0-9]*>/g) || [])\r\n\t\t.join(''); // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)\r\n\tvar tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi,\r\n\t\tcommentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\r\n\treturn input.replace(commentsAndPhpTags, '')\r\n\t\t.replace(tags, function ($0, $1) {\r\n\t\t\treturn allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\r\n\t\t});\r\n}\r\n\r\n///------------ Dream Dinners JQuery Extensions ----------------------\r\n(function ($) {\r\n\r\n\t$.oauthpopup = function (onCloseCallBack) {\r\n\t\tif (!$(this).data('path'))\r\n\t\t{\r\n\t\t\tthrow new Error(\"data-path must not be empty\");\r\n\t\t}\r\n\r\n\t\tvar defaults = {\r\n\t\t\twindowName: 'ConnectWithOAuth',\r\n\t\t\twindowOptions: {\r\n\t\t\t\twidth: '800',\r\n\t\t\t\theight: '400',\r\n\t\t\t\tlocation: '0',\r\n\t\t\t\tstatus: '0'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar options = {\r\n\t\t\twindowOptions: {\r\n\t\t\t\twidth: $(this).data('width'),\r\n\t\t\t\theight: $(this).data('height')\r\n\t\t\t},\r\n\t\t\tpath: $(this).data('path'),\r\n\t\t\tref_page: $(this).data('ref_page'),\r\n\t\t\treload_page: $(this).data('reload'),\r\n\t\t\tcallback: onCloseCallBack\r\n\t\t};\r\n\r\n\t\tvar settings = $.extend({}, defaults, options);\r\n\r\n\t\tvar dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : window.screenX;\r\n\t\tvar dualScreenTop = window.screenTop != undefined ? window.screenTop : window.screenY;\r\n\r\n\t\tvar width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\r\n\t\tvar height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\r\n\r\n\t\tvar left = ((width / 2) - (settings.windowOptions.width / 2)) + dualScreenLeft;\r\n\t\tvar top = ((height / 2) - (settings.windowOptions.height / 2)) + dualScreenTop;\r\n\r\n\t\tvar windowConfig = 'location=' + settings.windowOptions.location + ', status=' + settings.windowOptions.status + ', width=' + settings.windowOptions.width + ', height=' + settings.windowOptions.height + ', top=' + top + ', left=' + left;\r\n\r\n\t\tvar openPath = settings.path;\r\n\r\n\t\tif (typeof settings.ref_page != 'undefined')\r\n\t\t{\r\n\t\t\topenPath += '&ref_page=' + settings.ref_page;\r\n\t\t}\r\n\r\n\t\tif (typeof settings.reload_page != 'undefined')\r\n\t\t{\r\n\t\t\topenPath += '&reload_page=' + settings.reload_page;\r\n\t\t}\r\n\r\n\t\tvar oauthWindow = window.open(openPath, settings.windowName, windowConfig);\r\n\r\n\t\tif (typeof settings.callback == 'function')\r\n\t\t{\r\n\r\n\t\t\t$.doTimeout('oauth_interval', 1000, function () {\r\n\r\n\t\t\t\tif (oauthWindow.closed)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.doTimeout('oauth_interval');\r\n\t\t\t\t\tsettings.callback();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t//bind to element and pop oauth when clicked\r\n\t$.fn.oauthpopup = function (options) {\r\n\t\t$this = $(this);\r\n\t\t$this.click($.oauthpopup.bind(this, options));\r\n\t};\r\n\r\n\t// highlight an elements background color temporarily to call attention to it\r\n\t$.fn.attention = function (set_color, set_duration) {\r\n\t\tif (set_color == undefined)\r\n\t\t{\r\n\t\t\tset_color = '#ffed8c';\r\n\t\t}\r\n\r\n\t\tif (set_duration == undefined)\r\n\t\t{\r\n\t\t\tset_duration = 2000;\r\n\t\t}\r\n\r\n\t\t$(this).stop().css('background-color', set_color).animate({backgroundColor: 'transparent'}, {duration: set_duration});\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t// center an element on the screen\r\n\t$.fn.center = function () {\r\n\t\tthis.css(\"position\", \"absolute\");\r\n\t\tthis.css(\"top\", Math.max(0, (($(window).height() - $(this).outerHeight()) / 2) + $(window).scrollTop()) + \"px\");\r\n\t\tthis.css(\"left\", Math.max(0, (($(window).width() - $(this).outerWidth()) / 2) + $(window).scrollLeft()) + \"px\");\r\n\t\treturn this;\r\n\t};\r\n\r\n\t// get value if not equal to placeholder, primarily for ie\r\n\t$.fn.getVal = function () {\r\n\t\tvar $this = $(this),\r\n\t\t\tval = $this.eq(0).val();\r\n\r\n\t\tif (val == $this.attr('placeholder'))\r\n\t\t{\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn val;\r\n\t\t}\r\n\t};\r\n\r\n\t$.fn.addSpinner = function (e) {\r\n\t\tif (this.hasClass('btn-spin') && this.find('.spinner-border').length === 0)\r\n\t\t{\r\n\t\t\t// bootstrap Spinner\r\n\t\t\tthis.append('<span class=\"spinner-border spinner-border-sm float-right mt-1\" role=\"status\" aria-hidden=\"true\"></span>');\r\n\t\t}\r\n\t\telse if (this.hasClass('btn-spinner') && !this.hasClass('btn-spinning'))\r\n\t\t{\r\n\t\t\t// DD spinner\r\n\t\t\tthis.addClass('btn-spinning').append('<div class=\"ld-spin\"></div>');\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.removeSpinner = function (e) {\r\n\t\t// remove DD spinner\r\n\t\tthis.removeClass('btn-spinning');\r\n\t\tthis.find('.ld-spin').remove();\r\n\t\t// remove Bootstrap\r\n\t\tthis.find('.spinner-border').remove();\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.hideFlex = function (e) {\r\n\t\tthis.addClass('collapse');\r\n\t\tthis.removeClass('show');\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.showFlex = function (e) {\r\n\t\tthis.addClass('collapse show');\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.toggleFlex = function (e) {\r\n\r\n\t\tif (this.is(':visible'))\r\n\t\t{\r\n\t\t\tthis.hideFlex(e)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.showFlex(e);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valDefault = function (value) {\r\n\r\n\t\tif (typeof value !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(value);\r\n\t\t}\r\n\t\telse if (typeof this[0].dataset.valdefault !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(function () {\r\n\t\t\t\treturn this.dataset.valdefault;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (typeof this[0].defaultValue !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(function () {\r\n\t\t\t\treturn this.defaultValue;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (this[0].type == 'select-one')\r\n\t\t{\r\n\t\t\tfor (var i = 0; i < this[0].options.length; i++)\r\n\t\t\t{\r\n\t\t\t\tif (this[0].options[i].defaultSelected == true)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis[0].selectedIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valCheckDiff = function (dataObj) {\r\n\r\n\t\t// no value, use input's value as the base value\r\n\t\tif (typeof dataObj === 'undefined' || typeof dataObj.value === 'undefined')\r\n\t\t{\r\n\t\t\tdataObj.value = this.value;\r\n\t\t}\r\n\r\n\t\tif (typeof dataObj.group === 'undefined')\r\n\t\t{\r\n\t\t\tdataObj.group = '_main';\r\n\t\t}\r\n\r\n\t\tthis.data({'checkdiff' : dataObj}).val(dataObj.value).on('change keyup', function (e) {\r\n\r\n\t\t\tlet diffData = {};\r\n\t\t\tlet dataObj = $(this).data().checkdiff;\r\n\r\n\t\t\tif (typeof $(document).data().checkdiff != 'undefined')\r\n\t\t\t{\r\n\t\t\t\tdiffData = $(document).data().checkdiff;\r\n\t\t\t}\r\n\r\n\t\t\tif ((dataObj.value != null && this.value != dataObj.value) || (this.value != '' && dataObj.value == null))\r\n\t\t\t{\r\n\t\t\t\tif (typeof diffData[dataObj.group] == 'undefined')\r\n\t\t\t\t{\r\n\t\t\t\t\tdiffData[dataObj.group] = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdiffData[dataObj.group][this.id] = dataObj;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// values are not different, remove from diff object\r\n\t\t\t\tdelete diffData[dataObj.group][this.id];\r\n\t\t\t}\r\n\r\n\t\t\t$(document).data({'checkdiff': diffData}).trigger('dd:checkdiff');\r\n\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valCheckDiffRemove = function (value) {\r\n\r\n\t\tif (typeof value != 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(value);\r\n\t\t}\r\n\r\n\t\tlet dataObj = $(this).data();\r\n\r\n\t\tif (typeof dataObj != 'undefined')\r\n\t\t{\r\n\t\t\tif (typeof dataObj.checkdiff != 'undefined')\r\n\t\t\t{\r\n\t\t\t\tthis.removeData('checkdiff').off('change keyup');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\t$.fn.validateForm = function () {\r\n\r\n\t\tlet form = $(this);\r\n\t\tlet validity = true;\r\n\r\n\t\tif (form.length)\r\n\t\t{\r\n\t\t\t// prevent spaces from validating form\r\n\t\t\t$(form).find('input, textarea').each(function (e) {\r\n\t\t\t\t$(this).val($(this).val().trim());\r\n\t\t\t});\r\n\r\n\t\t\tif ($(this).find(':submit').hasClass('btn-onclick-disable'))\r\n\t\t\t{\r\n\t\t\t\t$(this).find(':submit').addClass('disabled');\r\n\t\t\t}\r\n\r\n\t\t\t// handle checkbox groups\r\n\t\t\tlet checkbox_groups = [];\r\n\r\n\t\t\t// collect list of unique checkbox required groups\r\n\t\t\t$(form).find('[data-checkbox_group_required=\"true\"]').each(function (e) {\r\n\t\t\t\tlet group_name = $(this).data('checkbox_group');\r\n\t\t\t\tif (checkbox_groups[group_name] !== 'undefined')\r\n\t\t\t\t{\r\n\t\t\t\t\tcheckbox_groups.push(group_name);\r\n\t\t\t\t}\r\n\t\t\t\t// set them all to required\r\n\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').attr('required', true);\r\n\t\t\t});\r\n\r\n\t\t\t// check each group\r\n\t\t\t$.each(checkbox_groups, function (key, group_name) {\r\n\t\t\t\t// check each checkbox in group for validity\r\n\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').each(function () {\r\n\t\t\t\t\t// found a box that is checked\r\n\t\t\t\t\tif ($(this).is(':checked'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// one was checked, remove required\r\n\t\t\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').attr('required', false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t// end handle checkbox groups\r\n\r\n\t\t\t$(form).find('.form-feedback').hide();\r\n\r\n\t\t\tif (form['0'].checkValidity() === false)\r\n\t\t\t{\r\n\t\t\t\tvalidity = false;\r\n\r\n\t\t\t\tif ($(this).find(':submit').hasClass('btn-onclick-disable'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).find(':submit').removeClass('disabled');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\r\n\t\t\t\t$(form).find('.form-feedback').show();\r\n\r\n\t\t\t\t$(form).data('was_submitted', false);\r\n\t\t\t}\r\n\r\n\t\t\tform['0'].classList.add('was-validated');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tconsole.log();\r\n\t\t}\r\n\r\n\t\treturn validity;\r\n\t};\r\n\r\n})(jQuery);\r\n\r\n// --------------------------------------------------------------------\r\n//\tPayFlow_Payload\r\n//  support for encoding custom data sent to PayFlow as a commnt\r\n// ---------------------------------------------------------------------\r\nfunction PayFlow_Payload()\r\n{\r\n\tthis.encodedString = \"\";\r\n}\r\n\r\nPayFlow_Payload.prototype = {\r\n\tconstructor: PayFlow_Payload,\r\n\taddNameValuePair: function (name, value) {\r\n\t\tvalue += \"\";\r\n\r\n\t\tvar cleanName = name.replace(\"+\", \"\");\r\n\t\tcleanName = cleanName.replace(\":\", \"\");\r\n\t\tvar cleanValue = value.replace(\"+\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\":\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"`\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"'\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"\\\"\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"&\", \"and\");\r\n\r\n\t\tif (this.encodedString == \"\")\r\n\t\t{\r\n\t\t\tthis.encodedString = cleanName + \":\" + cleanValue;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.encodedString += \"+\" + cleanName + \":\" + cleanValue;\r\n\t\t}\r\n\t},\r\n\taddAssocArray: function (name, arr) {\r\n\t\tvar cleanName = name.replace(\"+\", \"\");\r\n\t\tcleanName = cleanName.replace(\":\", \"\");\r\n\r\n\t\tarrString = \"\";\r\n\r\n\t\tfor (var value in arr)\r\n\t\t{\r\n\t\t\tif (arr[value])\r\n\t\t\t{\r\n\t\t\t\tvar cleanValue = arr[value].replace(\"+\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\":\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"|\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"~\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"`\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"'\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"\\\"\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"&\", \"and\");\r\n\r\n\t\t\t\tvar cleanPropName = value.replace(\"+\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\":\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\"|\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\"~\", \"\");\r\n\r\n\t\t\t\tif (arrString == \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tarrString = cleanPropName + \"~\" + cleanValue;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tarrString += \"|\" + cleanPropName + \"~\" + cleanValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.encodedString == \"\")\r\n\t\t{\r\n\t\t\tthis.encodedString = cleanName + \":\" + arrString;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.encodedString += \"+\" + cleanName + \":\" + arrString;\r\n\t\t}\r\n\t},\r\n\tretrieveEncodedString: function () {\r\n\r\n\t\treturn this.encodedString;\r\n\r\n\t}\r\n};\r\n\r\n/* handle Bootstrap form validation */\r\n$(document).on('submit', '.needs-validation', function (e) {\r\n\r\n\tif ($(this).validateForm() !== true)\r\n\t{\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n});\r\n\r\n/* Handle Bootstrap Tabbed Content */\r\n$('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n\te.target; // newly activated tab\r\n\te.relatedTarget; // previous active tab\r\n\r\n\t// html5 update url history\r\n\tif ($(e.target).data('urlpush') !== undefined && $(e.target).data('urlpush') === true)\r\n\t{\r\n\t\tif ($(e.target).data('target') !== undefined)\r\n\t\t{\r\n\t\t\tvar target = $(e.target).data('target');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar target = $(e.target).attr('href');\r\n\t\t}\r\n\r\n\t\tvar tabid = $(target).attr('id');\r\n\r\n\t\tnew_query_string = setQueryString('tab', tabid);\r\n\t\thistoryPush({url: new_query_string});\r\n\t}\r\n});\r\n\r\nfunction isIE()\r\n{\r\n\tvar ua = window.navigator.userAgent; //Check the userAgent property of the window.navigator object\r\n\tvar msie = ua.indexOf('MSIE '); // IE 10 or older\r\n\tvar trident = ua.indexOf('Trident/'); //IE 11\r\n\r\n\treturn (msie > 0 || trident > 0);\r\n}\r\n\r\nfunction isSafari()\r\n{\r\n\tvar isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n\r\n\treturn isSafari;\r\n}\r\n\r\n$(document).ajaxSuccess(function (event, xhr, settings) {\r\n\r\n\t$('.telephone:not(.no-tel), [type=\"tel\"]:not(.no-tel)').each(function (index) {\r\n\t\tnew Cleave(this, {\r\n\t\t\tdelimiters: [\r\n\t\t\t\t'-',\r\n\t\t\t\t'-',\r\n\t\t\t\t'-'\r\n\t\t\t],\r\n\t\t\tblocks: [\r\n\t\t\t\t3,\r\n\t\t\t\t3,\r\n\t\t\t\t4\r\n\t\t\t]\r\n\t\t});\r\n\t});\r\n\r\n\t// inside try to attempt to decode response as json\r\n\ttry\r\n\t{\r\n\t\t// decode the response as json\r\n\t\tvar obj = $.parseJSON(xhr.responseText);\r\n\r\n\t\t// if the json contains toasts, pop them up\r\n\t\tif (obj.dd_toasts)\r\n\t\t{\r\n\t\t\tfetchToasts(obj)\r\n\t\t}\r\n\r\n\t\t// updated user preferences\r\n\t\tif (obj.user_preferences)\r\n\t\t{\r\n\t\t\tUSER_PREFERENCES = obj.user_preferences;\r\n\t\t}\r\n\r\n\t\t// updated guest preferences\r\n\t\tif (obj.guest_preferences)\r\n\t\t{\r\n\t\t\tGUEST_PREFERENCES = $.extend(GUEST_PREFERENCES, obj.guest_preferences);\r\n\t\t}\r\n\r\n\t\t// bounce\r\n\t\tif (obj.bounce_to)\r\n\t\t{\r\n\t\t\tbounce(obj.bounce_to);\r\n\t\t}\r\n\t}\r\n\tcatch (e)\r\n\t{\r\n\t\t// not json\r\n\t}\r\n\r\n});\r\n\r\n// Click handler for terms and conditions\r\n$(document).on('click', '#tc_popup-cart', function (e) {\r\n\tshowTermsAndConditions($(this));\r\n\te.preventDefault();\r\n});\r\n\r\n// handle setToastMsg\r\nif ($.cookie('toastMsg'))\r\n{\r\n\tvar messages = $.parseJSON($.cookie('toastMsg'));\r\n\r\n\tvar time = 0;\r\n\r\n\t$.each(messages, function (key, toastArray) {\r\n\r\n\t\t// do a short delay so they don't all show up at once.\r\n\t\t$.doTimeout(time, function () {\r\n\t\t\tdd_toast(toastArray);\r\n\t\t});\r\n\r\n\t\ttime += 500; // .5 seconds, time between toasts for a response containing multiple toasts\r\n\r\n\t});\r\n\r\n\t$.removeCookie('toastMsg', {domain: COOKIE.domain});\r\n}\r\n\r\n// load bootstrap tooltips\r\n//$('[data-toggle=\"tooltip\"]').tooltip();\r\n$(document).tooltip({selector: '[data-toggle=\"tooltip\"]'});\r\n\r\n// handle analytics click\r\n$('[data-gaq_cat]').each(function () {\r\n\t$(this).on('click', function () {\r\n\r\n\t\tif (typeof _gaq != 'undefined')\r\n\t\t{\r\n\t\t\tgaq_cat = $(this).data('gaq_cat');\r\n\t\t\tgaq_action = $(this).data('gaq_action');\r\n\t\t\tgaq_label = $(this).data('gaq_label');\r\n\r\n\t\t\t_gaq.push([\r\n\t\t\t\t'_trackEvent',\r\n\t\t\t\tgaq_cat,\r\n\t\t\t\tgaq_action,\r\n\t\t\t\tgaq_label\r\n\t\t\t]);\r\n\t\t}\r\n\t});\r\n});\r\n\r\n$('[data-background-image]').each(function () {\r\n\tvar bg_image = $(this).data('background-image');\r\n\t$(this).css('background-image', 'url(' + bg_image + ')');\r\n});\r\n\r\n// Click handler for clear cart\r\n$(document).on('click', '.clear-cart, .clear-cart-gc', function (e) {\r\n\r\n\tvar category = 'all';\r\n\tif (window.location.href.indexOf('gift_card_cart') != -1)\r\n\t{\r\n\t\tcategory = 'giftcard';\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\top: 'get_clear_form',\r\n\t\t\toutput: 'json'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Clear your Cart',\r\n\t\t\t\tmessage: json.html,\r\n\t\t\t\theight: 300,\r\n\t\t\t\twidth: 300,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\t\t\t\top: 'do_clear',\r\n\t\t\t\t\t\t\tclear_items: category,\r\n\t\t\t\t\t\t\toutput: 'json'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t// salesforce clear cart\r\n\t\t\t\t\t\t\tif (typeof _etmc !== 'undefined')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_etmc.push([\r\n\t\t\t\t\t\t\t\t\t\"trackCart\",\r\n\t\t\t\t\t\t\t\t\t{\"clear_cart\": true}\r\n\t\t\t\t\t\t\t\t]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// reload page\r\n\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcancel: function () {\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n\r\n//Freshworks help widget - responsive view control\r\n$(document).ready(function() {\r\n\tif(window.innerWidth <= 1000)\r\n\t{\r\n\t\tFreshworksWidget('hide', 'launcher');\r\n\t}\r\n});\r\n\r\nwindow.onresize = function() {\r\n\tif(typeof FreshworksWidget !== 'undefined'){\r\n\t\tif(window.innerWidth <= 1000)\r\n\t\t{\r\n\t\t\tFreshworksWidget('hide', 'launcher');\r\n\t\t}else{\r\n\t\t\tFreshworksWidget('show', 'launcher');\r\n\t\t}\r\n\t}\r\n};\r\n\r\n$(document).on('click', '.help-search-launcher', function (event) {\r\n\tevent.preventDefault();\r\n\tFreshworksWidget('open');\r\n});\r\n\r\n\r\n$(document).on('click', '.clear-edit-delivered-order', function (e) {\r\n\r\n\t$.ajax({\r\n\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\top: 'get_clear_form',\r\n\t\t\toutput: 'json'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Clear Cart',\r\n\t\t\t\tmessage: 'Are you sure you want to stop editing this Delivered order?',\r\n\t\t\t\theight: 300,\r\n\t\t\t\twidth: 300,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\t\t\t\top: 'do_clear',\r\n\t\t\t\t\t\t\tclear_items: 'all',\r\n\t\t\t\t\t\t\tclear_edit_order: 'all',\r\n\t\t\t\t\t\t\toutput: 'json'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\t\t\t\t// reload page\r\n\t\t\t\t\t\t\twindow.location = '/main.php?page=my_meals&tab=nav-past_orders';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\tconsole.log('Unexpected error');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcancel: function () {\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n// Handle textarea maxlength\r\n$(document).on('keyup', 'textarea[maxlength]', function (e) {\r\n\r\n\t//get the limit from maxlength attribute\r\n\tvar limit = parseInt($(this).attr('maxlength'));\r\n\t//get the current text inside the textarea\r\n\tvar text = $(this).val();\r\n\t//count the number of characters in the text\r\n\tvar chars = text.length;\r\n\r\n\t//check if there are more characters then allowed\r\n\tif (chars > limit)\r\n\t{\r\n\t\t//and if there are use substr to get the text before the limit\r\n\t\tvar new_text = text.substr(0, limit);\r\n\r\n\t\t//and change the current text with the new text\r\n\t\t$(this).val(new_text);\r\n\t}\r\n});\r\n\r\n// handle btn spinner\r\n$(document).on('click', '.btn-spinner:not(.disabled), .btn-spin:not(.disabled)', function (e) {\r\n\t$(this).addSpinner();\r\n});\r\n\r\n// handle masks\r\n$('.telephone:not(.no-tel), [type=\"tel\"]:not(.no-tel)').each(function (index) {\r\n\tnew Cleave(this, {\r\n\t\tdelimiters: [\r\n\t\t\t'-',\r\n\t\t\t'-',\r\n\t\t\t'-'\r\n\t\t],\r\n\t\tblocks: [\r\n\t\t\t3,\r\n\t\t\t3,\r\n\t\t\t4\r\n\t\t]\r\n\t});\r\n});\r\n\r\n// nutritionals menu dropdown\r\n$(document).on('change', '#menus_dropdown', function (e) {\r\n\tbounce('main.php?page=nutritionals&menu=' + this.value);\r\n});\r\n\r\n// platepoints enroll\r\n$(document).on('click change', '#enroll_in_plate_points', function (e) {\r\n\tset_req = false;\r\n\tif ($(this).is(\":checked\"))\r\n\t{\r\n\t\tset_req = true;\r\n\t}\r\n\t$('#referral_source, #gender, #birthday_month, #birthday_year, #number_of_kids, #desired_homemade_meals_per_week, #number_feeding,  #number_of_adults, #contribute_income, #use_lists, #number_monthly_dine_outs').attr('required', set_req);\r\n\t$('#prefer_daytime_sessions, #prefer_evening_sessions, #prefer_weekend_sessions').attr({\r\n\t\t'data-checkbox_group_required': set_req,\r\n\t\t'required': set_req\r\n\t});\r\n});\r\n\r\n// handle share event\r\n$('[data-share-social]').each(function () {\r\n\r\n\tvar title = $(this).data('share-title');\r\n\tvar text = $(this).data('share-text');\r\n\tvar url = $(this).data('share-url');\r\n\r\n\tvar services = $(this).data('share-social').split(\",\");\r\n\r\n\tvar dropdown_menu = $('<div></div>').addClass('dropdown-menu');\r\n\r\n\t$(services).each(function (key, service) {\r\n\r\n\t\tif (service == 'facebook')\r\n\t\t{\r\n\t\t\t$(dropdown_menu).append('<a class=\"dropdown-item nav-link facebook-share\" data-share-url=\"' + url + '\" href=\"#\"><i class=\"dd-icon icon-facebook mr-2\"></i> Facebook</a>');\r\n\t\t}\r\n\r\n\t\tif (service == 'twitter')\r\n\t\t{\r\n\t\t\t$(dropdown_menu).append('<a class=\"dropdown-item nav-link\" target=\"_blank\" href=\"https://twitter.com/intent/tweet?via=DreamDinners&&hashtags=TheOriginalMealKit&text=' + text + '&url=' + url + '\"><i class=\"dd-icon icon-twitter mr-2\"></i> Twitter</a>');\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (navigator.share)\r\n\t{\r\n\t\tlet moreOpts = $('<a href=\"#\" class=\"dropdown-item nav-link\"><i class=\"dd-icon icon-share2 mr-2\"></i> More Options</a>').on('click', function (e) {\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tnavigator.share({\r\n\t\t\t\ttitle: title,\r\n\t\t\t\ttext: text,\r\n\t\t\t\turl: url\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(dropdown_menu).append(moreOpts);\r\n\t}\r\n\r\n\t$(this).attr({\r\n\t\t'data-toggle': 'dropdown',\r\n\t\t'aria-haspopup': 'true',\r\n\t\t'aria-expanded': 'false'\r\n\t})\r\n\t\t.wrap('<div></div>')\r\n\t\t.addClass('dropdown')\r\n\t\t.after(dropdown_menu);\r\n\r\n});\r\n\r\n/*\r\n$(document).on('click', '.start-intro-offer', function (e) {\r\n\r\n\te.preventDefault();\r\n\r\n\t$.cookie('dd_start_intro', true);\r\n\r\n\tcreate_and_submit_form({\r\n\t\taction: 'ddproc.php?processor=session_type',\r\n\t\tinput: ({\r\n\t\t\ttype: 'starter'\r\n\t\t})\r\n\t});\r\n\r\n});\r\n*/\r\n\r\n$(document).on('click', '[data-start-delivered-order]', function (e) {\r\n\r\n\te.preventDefault();\r\n\r\n\tlet start_delivered_zip = this.getAttribute('data-start-delivered-order');\r\n\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=box_select',\r\n\t\tinput: ({\r\n\t\t\tdelivered_zip: start_delivered_zip\r\n\t\t})\r\n\t});\r\n\r\n});\r\n\r\n$(document).on('click', '.btn-click-add-cart', function (e) {\r\n\r\n\t$('.btn-click-add-cart').find('.fa-shopping-cart').remove();\r\n\r\n\t$(this).append('<i class=\"fas fa-shopping-cart float-left text-green-dark-extra pt-1\"></i>');\r\n\r\n});\r\n\r\n$(document).on('click', '[data-click_id]', function (e) {\r\n\r\n\tlet click_id = $(this).data('click_id');\r\n\r\n\t$('#' + click_id).trigger('click');\r\n\r\n\tif (typeof $('#' + click_id).attr('href') !== 'undefined')\r\n\t{\r\n\t\twindow.location.href = $('#' + click_id).attr('href');\r\n\t}\r\n\r\n});\r\n\r\n// handle platepoints enroll\r\nif (getQueryVariable('pp_enroll'))\r\n{\r\n\t$('#enroll_in_plate_points').attr('checked', true).trigger('change');\r\n}\r\n\r\n// handle tab selection\r\nif (getQueryVariable('tab'))\r\n{\r\n\tvar tabid = getQueryVariable('tab');\r\n\r\n\t$('#' + tabid + '-tab').tab('show');\r\n}\r\n\r\n// footer nav\r\nif ($('.footer-nav').length)\r\n{\r\n\t$('.footer-nav').scrollToFixed({\r\n\t\tbottom: 0,\r\n\t\tlimit: $('.footer-nav').offset().top\r\n\t});\r\n}\r\n\r\n// sidenav\r\n$('#main-sidenav').on('hide.bs.collapse', function () {\r\n\t$('body').removeClass('modal-open');\r\n\t$('.sidenav-modal').removeClass('show');\r\n\r\n\t$.doTimeout(500, function () {\r\n\t\t$('.sidenav-modal').remove();\r\n\t});\r\n\r\n});\r\n\r\n$('#main-sidenav').on('show.bs.collapse', function () {\r\n\t$('body').addClass('modal-open').append($('<div class=\"sidenav-modal modal-backdrop fade\"></div>'));\r\n\t$('.sidenav-modal').tab('show');\r\n});\r\n\r\n$(document).on('click', '.sidenav-modal', function (e) {\r\n\t$('#main-sidenav').collapse('toggle');\r\n});\r\n\r\n$(document).on('keyup change', '.dd-strip-tags', function (e) {\r\n\r\n\tvar allowed;\r\n\r\n\tif ($(this).data('allowed-tags'))\r\n\t{\r\n\t\tallowed = $(this).data('allowed-tags');\r\n\t}\r\n\r\n\tif ($(this).val() != strip_tags($(this).val(), allowed))\r\n\t{\r\n\t\t$(this).val(strip_tags($(this).val(), allowed));\r\n\t}\r\n\r\n});\r\n\r\n// On error, show dd_console_log\r\n$(document).ajaxError(function (event, jqxhr, settings, exception) {\r\n\tAJAX_IN_PROCESS = false;\r\n\tdd_console_log('Ajax Error: ' + jqxhr.statusText);\r\n\t//dd_message({ title: 'Ajax Error', message: request.statusText });\r\n});\r\n\r\n// userpreferences\r\nif (typeof USER_PREFERENCES === 'string')\r\n{\r\n\tUSER_PREFERENCES = $.parseJSON(USER_PREFERENCES);\r\n}\r\n\r\n// handle checkboxes\r\n$(document).on('click', '[data-user_pref][type=checkbox]', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\tvar value = $(this).is(':checked');\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).is(':checked'));\r\n\t}\r\n\r\n\tif (value && $(this).data('user_pref_value_check'))\r\n\t{\r\n\t\tvalue = $(this).data('user_pref_value_check');\r\n\t}\r\n\telse if (!value && $(this).data('user_pref_value_uncheck'))\r\n\t{\r\n\t\tvalue = $(this).data('user_pref_value_uncheck');\r\n\t}\r\n\r\n\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\tpreferenceChangeListener($(this).data('user_pref'), value, user_id, function (json) {\r\n\r\n\t\t\tif (!json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t$(this).prop('checked', $(pref_elem).data('user_pref_orig'));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(this).data('user_pref_orig', $(pref_elem).is(':checked'));\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}else{\r\n\t\tset_user_pref($(this).data('user_pref'), value, user_id, function (json) {\r\n\r\n\t\t\tif (!json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t$(this).prop('checked', $(pref_elem).data('user_pref_orig'));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(this).data('user_pref_orig', $(pref_elem).is(':checked'));\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n});\r\n\r\n// handle dropdown select\r\n$(document).on('change', '[data-user_pref]select', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tset_user_pref($(this).data('user_pref'), $(this).val(), user_id, function (json) {\r\n\r\n\t\tif (!json.processor_success)\r\n\t\t{\r\n\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t}\r\n\r\n\t});\r\n\r\n});\r\n\r\n\r\n// handle input\r\n$(document).on('focus', '[data-user_pref]input[type=text]', function (e) {\r\n\r\n\tif($(this).attr('type') == 'checkbox' ){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\t$(this).on('keyup', function (e) {\r\n\r\n\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t{\r\n\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tif (!$('#' + $(this).data('user_pref') + '_buttons').length)\r\n\t{\r\n\t\tvar buttons = $('<div />').attr('id', $(this).data('user_pref') + '_buttons').addClass('text-left collapse');\r\n\r\n\t\t$(this).after(buttons);\r\n\r\n\t\tvar save_button = $('<span />').addClass('btn btn-sm btn-primary mr-2 mt-2').text('Save').on('click', function (e) {\r\n\r\n\t\t\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\t\t\tpreferenceChangeListener($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tset_user_pref($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t\tvar cancel_button = $('<span />').addClass('btn btn-sm btn-primary mt-2').text('Cancel').on('click', function (e) {\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\r\n\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\tvar spacer = $('<span />').addClass(' mt-2');\r\n\r\n\t\t$(buttons).prepend(cancel_button).prepend(save_button).prepend(spacer).slideDown();\r\n\r\n\t}\r\n\r\n});\r\n\r\n// handle textarea\r\n$(document).on('focus', '[data-user_pref]textarea', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\t$(this).on('keyup', function (e) {\r\n\r\n\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t{\r\n\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tif (!$('#' + $(this).data('user_pref') + '_buttons').length)\r\n\t{\r\n\t\tvar buttons = $('<div />').attr('id', $(this).data('user_pref') + '_buttons').addClass('text-right collapse');\r\n\r\n\t\t$(this).after(buttons);\r\n\r\n\t\tvar save_button = $('<span />').addClass('btn btn-sm btn-primary mr-2 mt-2').text('Save').on('click', function (e) {\r\n\r\n\t\t\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\t\t\tpreferenceChangeListener($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tset_user_pref($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t\tvar cancel_button = $('<span />').addClass('btn btn-sm btn-primary mt-2').text('Cancel').on('click', function (e) {\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\r\n\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(buttons).prepend(cancel_button).prepend(save_button).slideDown();\r\n\r\n\t}\r\n\r\n});\r\n\r\n// handle thaw reminder\r\n$(document).on('click', '[data-user_pref=\"text_message_thaw_primary\"][type=checkbox]', function (e) {\r\n\r\n\t// var user_id = 0;\r\n\t// var value = $(this).is(':checked');\r\n\t//\r\n\t// if ($(this).data('user_id'))\r\n\t// {\r\n\t// \tuser_id = $(this).data('user_id');\r\n\t// }\r\n\t//\r\n\t// $.ajax({\r\n\t// \turl: 'ddproc.php',\r\n\t// \ttype: 'POST',\r\n\t// \ttimeout: 20000,\r\n\t// \tdataType: 'json',\r\n\t// \tdata: {\r\n\t// \t\tprocessor: 'account',\r\n\t// \t\top: 'optin',\r\n\t// \t\ttype: 'thaw',\r\n\t// \t\tphone: 'primary',\r\n\t// \t\tuser_id: user_id,\r\n\t// \t\tvalue: value.toString()\r\n\t// \t},\r\n\t// \tsuccess: function (json, status) {\r\n\t//\r\n\t// \t},\r\n\t// \terror: function (objAJAXRequest, strError) {\r\n\t// \t\tresponse = 'Unexpected error';\r\n\t// \t}\r\n\t// });\r\n\r\n});\r\n\r\n$(function() {\r\n\t// clipboard\r\n\tif (typeof ClipboardJS !== 'undefined')\r\n\t{\r\n\t\tlet clipboard = new ClipboardJS('.btn-clip');\r\n\t}\r\n});"],"mappings":"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"}