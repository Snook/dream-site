{"version":3,"sourceRoot":"js/src/dreamdinners","sources":["global.js"],"sourcesContent":["var AJAX_IN_PROCESS = false;\r\nvar GUEST_PREFERENCES = {};\r\nvar lang = {\r\n\t'en': {\r\n\t\t'dd': {\r\n\t\t\t'dream_dinners': 'Dream Dinners'\r\n\t\t},\r\n\t\t'tc': {\r\n\t\t\t'terms_and_conditions': 'Terms & Conditions',\r\n\t\t\t'delayed_payment': 'When I opt to use the Delayed Payment service to pay for my order, I understand that the balance due for this and future orders will be automatically withdrawn (5) five days prior to my session date and will transact using the same credit card as was used to pay for the order deposit.',\r\n\t\t\t'delayed_payment_decline': 'By declining the Delayed Payment Terms and Conditions future orders are required to be paid in full upon submission. The balance due for existing Delayed Payement orders will be due at session.'\r\n\t\t}\r\n\t}\r\n};\r\nfunction set_user_pref(pref, setting, user_id, callBack)\r\n{\r\n\tpref = pref.toUpperCase();\r\n\tlet pref_value = USER_PREFERENCES[pref].value;\r\n\r\n\tif ($.isPlainObject(pref_value) && $.isPlainObject(setting))\r\n\t{\r\n\t\tsetting = JSON.stringify($.extend(USER_PREFERENCES[pref].value, setting));\r\n\t}\r\n\telse\r\n\t{\r\n\t\tsetting = setting.toString()\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'account',\r\n\t\t\top: 'update_pref',\r\n\t\t\tkey: pref,\r\n\t\t\tuser_id: user_id,\r\n\t\t\tvalue: setting.toString()\r\n\t\t},\r\n\t\tsuccess: function (json, status) {\r\n\t\t\tif (typeof callBack === 'function')\r\n\t\t\t{\r\n\t\t\t\tcallBack(json, status);\r\n\t\t\t}\r\n\r\n\t\t\tresponse = json;\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\nfunction get_user_pref(pref, user_id, callBack)\r\n{\r\n\r\n\tif (typeof user_id != 'undefined') // get guest pref\r\n\t{\r\n\t\t$.ajax({\r\n\t\t\turl: 'ddproc.php',\r\n\t\t\ttype: 'POST',\r\n\t\t\ttimeout: 20000,\r\n\t\t\tdataType: 'json',\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: 'account',\r\n\t\t\t\top: 'get_pref',\r\n\t\t\t\tkey: pref,\r\n\t\t\t\tuser_id: user_id\r\n\t\t\t},\r\n\t\t\tsuccess: function (json, status) {\r\n\t\t\t\tif (typeof callBack === 'function')\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack(json, status);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn json;\r\n\t\t\t},\r\n\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\telse // get current user pref\r\n\t{\r\n\r\n\t\tif (typeof USER_PREFERENCES !== 'undefined')\r\n\t\t{\r\n\t\t\tif (typeof USER_PREFERENCES[pref] === 'object')\r\n\t\t\t{\r\n\t\t\t\treturn USER_PREFERENCES[pref];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction select_location_click_handler()\r\n{\r\n\t// Register click handler to select store\r\n\t$(document).on('click', '[id^=\"select_location-\"], [id^=\"select_intro_location-\"]', function (e) {\r\n\r\n\t\tvar config = {\r\n\t\t\tstore_id: null,\r\n\t\t\torder_type: 'standard'\r\n\t\t};\r\n\r\n\t\tif (this.id.indexOf('intro_location') > 0)\r\n\t\t{\r\n\t\t\tconfig.order_type = 'intro';\r\n\t\t}\r\n\r\n\t\tconfig.store_id = this.id.split(\"-\")[1];\r\n\r\n\t\tsetStoreAndBeginOrder(config);\r\n\r\n\t\t// Stop browser from following href\r\n\t\te.preventDefault();\r\n\t});\r\n}\r\n\r\nfunction bounce(location, target)\r\n{\r\n\tif (!location)\r\n\t{\r\n\t\tlocation = 'main.php';\r\n\t}\r\n\r\n\tif (target)\r\n\t{\r\n\t\twindow.open(location, target);\r\n\t}\r\n\telse\r\n\t{\r\n\t\twindow.location.href = location;\r\n\t}\r\n}\r\n\r\nfunction back_path()\r\n{\r\n\t// returns encoded string to pass to back=\r\n\treturn encodeURIComponent(location.pathname.substring(1) + location.search);\r\n}\r\n\r\nfunction incrementVal(value, incrementBy)\r\n{\r\n\tvalue = parseInt(value);\r\n\tincrementBy = parseInt(incrementBy);\r\n\r\n\tif (isNaN(value))\r\n\t{\r\n\t\tvalue = 0;\r\n\t}\r\n\r\n\tvalue = value + incrementBy;\r\n\r\n\tif (parseInt(value) < 0)\r\n\t{\r\n\t\tvalue = 0;\r\n\t}\r\n\r\n\treturn value;\r\n}\r\n\r\nfunction toggleId(id)\r\n{\r\n\t$('#' + id).slideToggle();\r\n}\r\n\r\nfunction setQueryString(variable, value)\r\n{\r\n\tvar query = window.location.search.substring(1);\r\n\tvar vars = query.split(\"&\");\r\n\tvar_found = false;\r\n\tnew_query = 'main.php?';\r\n\r\n\tfor (var i = 0; i < vars.length; i++)\r\n\t{\r\n\t\tvar pair = vars[i].split(\"=\");\r\n\r\n\t\tif (pair[0] == variable)\r\n\t\t{\r\n\t\t\tpair[1] = value;\r\n\t\t\tvar_found = true;\r\n\t\t}\r\n\r\n\t\tif (i > 0)\r\n\t\t{\r\n\t\t\tnew_query += '&';\r\n\t\t}\r\n\r\n\t\tnew_query += pair[0] + '=' + pair[1];\r\n\t}\r\n\r\n\tif (!var_found)\r\n\t{\r\n\t\tif (i > 0)\r\n\t\t{\r\n\t\t\tnew_query += '&';\r\n\t\t}\r\n\r\n\t\tnew_query += variable + '=' + value;\r\n\t}\r\n\r\n\treturn new_query;\r\n}\r\n\r\nfunction getQueryVariable(variable)\r\n{\r\n\tvar query = window.location.search.substring(1);\r\n\tvar vars = query.split(\"&\");\r\n\r\n\tfor (var i = 0; i < vars.length; i++)\r\n\t{\r\n\t\tvar pair = vars[i].split(\"=\");\r\n\t\tif (pair[0] == variable)\r\n\t\t{\r\n\t\t\treturn decodeURI(pair[1]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction removeQueryVariable(key, sourceURL)\r\n{\r\n\tvar rtn = sourceURL.split(\"?\")[0],\r\n\t\tparam,\r\n\t\tparams_arr = [],\r\n\t\tqueryString = (sourceURL.indexOf(\"?\") !== -1) ? sourceURL.split(\"?\")[1] : \"\";\r\n\r\n\tif (queryString !== \"\")\r\n\t{\r\n\t\tparams_arr = queryString.split(\"&\");\r\n\r\n\t\tfor (var i = params_arr.length - 1; i >= 0; i -= 1)\r\n\t\t{\r\n\t\t\tparam = params_arr[i].split(\"=\")[0];\r\n\r\n\t\t\tif (param === key)\r\n\t\t\t{\r\n\t\t\t\tparams_arr.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trtn = rtn + \"?\" + params_arr.join(\"&\");\r\n\t}\r\n\r\n\treturn rtn;\r\n}\r\n\r\nfunction mailHideOnSubmit(token)\r\n{\r\n\tdocument.getElementById(\"mailhide_form\").submit();\r\n}\r\n\r\nfunction historyPush(config)\r\n{\r\n\t// Record history in html5 browser if supported\r\n\tif (window.history && window.history.pushState)\r\n\t{\r\n\t\tvar title = document.title;\r\n\t\tif (config.title)\r\n\t\t{\r\n\t\t\ttitle = config.title;\r\n\t\t}\r\n\r\n\t\thistory.pushState(null, title, config.url);\r\n\r\n\t}\r\n}\r\n\r\nfunction showPopup(config)\r\n{\r\n\tvar settings = { //defaults\r\n\t\ttype: 'GET',\r\n\t\theight: 500,\r\n\t\twidth: 600,\r\n\t\tmodal: false,\r\n\t\tcallBack: false,\r\n\t\tresizable: true\r\n\t};\r\n\r\n\t$.extend(settings, config);\r\n\r\n\t$.ajax({\r\n\t\turl: 'main.php?' + settings.module,\r\n\t\ttype: settings.type,\r\n\t\tsuccess: function (data, status) {\r\n\t\t\tsettings.message = data;\r\n\r\n\t\t\tdd_message(settings);\r\n\r\n\t\t\tif (typeof settings.callBack == 'function')\r\n\t\t\t{\r\n\t\t\t\tsettings.callBack();\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction create_and_submit_form(config)\r\n{\r\n\tvar settings = { //defaults\r\n\t\tmethod: 'post',\r\n\t\ttarget: false\r\n\t};\r\n\r\n\t$.extend(settings, config);\r\n\r\n\t// Create dynamic form to post and redirect to session_menu\r\n\tvar form = $('<form></form>');\r\n\tform.attr('method', settings.method);\r\n\r\n\tif (settings.action)\r\n\t{\r\n\t\tform.attr('action', settings.action);\r\n\t}\r\n\r\n\tif (settings.target)\r\n\t{\r\n\t\tform.attr('target', settings.target);\r\n\t}\r\n\r\n\tfor (var property in settings.input)\r\n\t{\r\n\t\t$('<input>').attr({\r\n\t\t\ttype: 'hidden',\r\n\t\t\tname: property,\r\n\t\t\tvalue: settings.input[property]\r\n\t\t}).appendTo(form);\r\n\t}\r\n\r\n\t$(document.body).append(form);\r\n\tform.submit();\r\n\t$(form).remove();\r\n}\r\n\r\nfunction setStoreAndBeginOrder(config)\r\n{\r\n\t// Show trobber\r\n\t$('.img_throbber_circle').show();\r\n\r\n\t// Create dynamic form to post and redirect to session_menu\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=session_menu',\r\n\t\tinput: ({\r\n\t\t\tstore: config.store_id,\r\n\t\t\torder_type: config.order_type\r\n\t\t})\r\n\t});\r\n}\r\n\r\nfunction showMap(address)\r\n{\r\n\tdd_message({\r\n\t\twidth: 670,\r\n\t\theight: 580,\r\n\t\tmodal: false,\r\n\t\tresizable: true,\r\n\t\tmessage: '<iframe width=\"100%\" height=\"97%\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"//maps.google.com/maps?q=Dream%20Dinners%20' + encodeURIComponent(address) + '&amp;hnear=Dream%20Dinners%20' + encodeURIComponent(address) + '&amp;f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;&amp;ie=UTF8&amp;hq=&amp;t=m3&amp;spn=0.02878,0.054932&amp;z=14&amp;iwloc=A&amp;output=embed\"></iframe>'\r\n\t});\r\n}\r\n\r\nfunction confirmNavigate(goUrl, message)\r\n{\r\n\tdd_message({\r\n\t\tmessage: message,\r\n\t\tconfirm: function () {\r\n\t\t\tbounce(goUrl);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction dd_console_log(message)\r\n{\r\n\tif (is_debug() && window.console)\r\n\t{\r\n\t\tconsole.log('DD Console Log: ' + message);\r\n\t}\r\n}\r\n\r\nfunction address_location(settings, callBack)\r\n{\r\n\tvar config = {\r\n\t\taddress: false, // mailing address string, can be partial address like just zip code or city and state.\r\n\t\tlatlong: false // latitude,longitude\r\n\t};\r\n\r\n\t// settings can be optional so check if callback is the first parameter\r\n\tif (typeof callBack === 'undefined' && typeof settings === 'function')\r\n\t{\r\n\t\tcallBack = settings;\r\n\t\tsettings = config;\r\n\t}\r\n\telse\r\n\t{\r\n\t\t$.extend(config, settings);\r\n\t}\r\n\r\n\tvar getLocation = function (geolocation, address, latlong) {\r\n\t\t//dd_console_log('Fresh Geolocation data.');\r\n\r\n\t\tvar geocoder = new google.maps.Geocoder();\r\n\t\tvar geoparams;\r\n\r\n\t\tif (address != undefined)\r\n\t\t{\r\n\t\t\taddress = address.trim();\r\n\t\t\t//the entered address was a postal code or it was less than 5 characters, will send it as a postal code anyways, but will return an invalid zip code\r\n\t\t\tif (address.length <= 5)\r\n\t\t\t{\r\n\t\t\t\tgeoparams = {'latLng': latlng, 'componentRestrictions': {'postalCode': address}};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof latlong != 'undefined' && latlong)\r\n\t\t{\r\n\t\t\tlatlong = latlong.split(\",\");\r\n\t\t\tvar lat = parseFloat(latlong[0]);\r\n\t\t\tvar lng = parseFloat(latlong[1]);\r\n\t\t\tvar latlng = new google.maps.LatLng(lat, lng);\r\n\r\n\t\t\tgeoparams = {'latLng': latlng};\r\n\t\t}\r\n\t\telse if (geolocation !== false)\r\n\t\t{\r\n\t\t\tvar lat = parseFloat(geolocation.coords.latitude);\r\n\t\t\tvar lng = parseFloat(geolocation.coords.longitude);\r\n\t\t\tvar latlng = new google.maps.LatLng(lat, lng);\r\n\r\n\r\n\t\t\tgeoparams = {'latLng': latlng};\r\n\t\t}\r\n\t\t//the entered address was not a postal code\r\n\t\telse if(address != undefined && address.length > 5){\r\n\t\t\tgeoparams = {'address': address};\r\n\t\t}\r\n\r\n\t\tgeocoder.geocode(geoparams, function (results, status) {\r\n\r\n\t\t\tif (status == google.maps.GeocoderStatus.OK)\r\n\t\t\t{\r\n\r\n\t\t\t\tif (results)\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack('ok', results);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tcallBack('no_result', 'No geocoder results found.');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tcallBack('error', 'No geocoder results found.');\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t};\r\n\r\n\tvar onError = function (error) {\r\n\t\tswitch (error.code)\r\n\t\t{\r\n\t\t\tcase error.PERMISSION_DENIED:\r\n\t\t\t\tcallBack('gl_error', 'User denied the request for Geolocation.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.POSITION_UNAVAILABLE:\r\n\t\t\t\tcallBack('gl_error', 'Geolocation information is unavailable.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.TIMEOUT:\r\n\t\t\t\tcallBack('gl_error', 'The request to get user location timed out.');\r\n\t\t\t\tbreak;\r\n\t\t\tcase error.UNKNOWN_ERROR:\r\n\t\t\t\tcallBack('gl_error', 'An unknown error occurred.');\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tif (settings.address) // query by address\r\n\t{\r\n\t\tgetLocation(false, settings.address, false);\r\n\t}\r\n\telse if (settings.latlong) // query by latlong\r\n\t{\r\n\t\tgetLocation(false, false, settings.latlong);\r\n\t}\r\n\telse // browser geolocation\r\n\t{\r\n\t\tif (navigator.geolocation)\r\n\t\t{\r\n\t\t\tnavigator.geolocation.getCurrentPosition(getLocation, onError);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\r\n\r\n\t\t\tcallBack('gl_error', 'Geolocation not supported.');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction dd_toast(settings)\r\n{\r\n\tvar config = {\r\n\t\tanimation: true,\r\n\t\tautohide: true,\r\n\t\tdelay: 5000,\r\n\t\ttitle: false,\r\n\t\tmessage: false,\r\n\t\ttype: 'primary'\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (!$('.toast-container').length)\r\n\t{\r\n\t\t$('<div class=\"toast-container fixed-top mt-4\"></div>').appendTo('body');\r\n\t}\r\n\r\n\tswitch (config.type)\r\n\t{\r\n\t\tcase 'primary':\r\n\t\t\tconfig.css_header = 'bg-green-dark text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'secondary':\r\n\t\t\tconfig.css_header = 'bg-secondary text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'info':\r\n\t\t\tconfig.css_header = 'bg-info text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Notice');\r\n\t\t\tbreak;\r\n\t\tcase 'success':\r\n\t\t\tconfig.css_header = 'bg-success text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Success');\r\n\t\t\tbreak;\r\n\t\tcase 'warning':\r\n\t\tcase 'warn':\r\n\t\t\tconfig.css_header = 'bg-warning text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Warning');\r\n\t\t\tbreak;\r\n\t\tcase 'error':\r\n\t\tcase 'danger':\r\n\t\t\tconfig.css_header = 'bg-danger text-white';\r\n\t\t\tconfig.title = ((config.title) ? config.title : 'Error');\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tvar html = '<div class=\"toast mx-auto\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\" data-delay=\"' + config.delay + '\" data-autohide=\"' + config.autohide + '\">';\r\n\thtml += '<div class=\"toast-header ' + config.css_header + '\">';\r\n\thtml += '<strong class=\"mr-auto\">' + ((config.title) ? config.title : 'Notice') + '</strong>';\r\n\thtml += '<button type=\"button\" class=\"ml-2 mb-1 close\" data-dismiss=\"toast\" aria-label=\"Close\"><span aria-hidden=\"true\" class=\"text-white\">&times;</span></button>';\r\n\thtml += '</div>';\r\n\thtml += '<div class=\"toast-body\">' + config.message + '</div>';\r\n\thtml += '</div>';\r\n\r\n\t$('.toast-container').append(html);\r\n\t$('.toast-container .toast:last').toast('show');\r\n}\r\n\r\nfunction fetchToasts(json)\r\n{\r\n\tif (json.dd_toasts)\r\n\t{\r\n\t\tlet time = 0;\r\n\r\n\t\t$.each(json.dd_toasts, function (key) {\r\n\t\t\t// do a short delay so they don't all show up at once.\r\n\t\t\t$.doTimeout(time, function () {\r\n\t\t\t\tdd_toast(json.dd_toasts[key]);\r\n\t\t\t});\r\n\t\t\ttime += 500; // .5 seconds, time between toasts for a response containing multiple toasts\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction dd_message(settings)\r\n{\r\n\tvar config = {\r\n\t\ttitle: false,\r\n\t\tmessage: false,\r\n\t\tsize: false // small, large\r\n\t};\r\n\r\n\t$.extend(config, settings);\r\n\r\n\tif (typeof config.confirm != 'undefined')\r\n\t{\r\n\t\t// convert old dd_message\r\n\t\tif (typeof config.confirm == 'function')\r\n\t\t{\r\n\t\t\tconfig.buttons = {\r\n\t\t\t\tconfirm: {\r\n\t\t\t\t\tlabel: 'Confirm',\r\n\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\tcallback: config.confirm\r\n\t\t\t\t},\r\n\t\t\t\tcancel: {\r\n\t\t\t\t\tlabel: 'Cancel',\r\n\t\t\t\t\tclassName: 'btn-secondary',\r\n\t\t\t\t\tcallback: config.cancel\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbootbox.dialog(config);\r\n\t}\r\n\telse if (typeof config.buttons != 'undefined')\r\n\t{\r\n\t\t// convert old dd_message\r\n\t\tvar buttons = {};\r\n\r\n\t\t$.each(config.buttons, function (key, value) {\r\n\r\n\t\t\tif (typeof value == 'function')\r\n\t\t\t{\r\n\t\t\t\tbuttons[key] = {\r\n\t\t\t\t\tlabel: key,\r\n\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\tcallback: value\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tconfig.buttons = buttons;\r\n\r\n\t\tbootbox.dialog(config);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tbootbox.alert(config);\r\n\t}\r\n\r\n}\r\n\r\nfunction showTermsAndConditions(jobject)\r\n{\r\n\tif (jobject && jobject.attr('data-tandc_page') == 'checkout')\r\n\t{\r\n\t\ttandc_url = 'main.php?static=module/tandc_popup_checkout';\r\n\t}\r\n\telse\r\n\t{\r\n\t\ttandc_url = 'main.php?static=module/tandc_popup';\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: tandc_url,\r\n\t\ttype: 'GET',\r\n\t\tsuccess: function (data, status) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Dream Dinners Terms and Conditions',\r\n\t\t\t\tmessage: data,\r\n\t\t\t\theight: 500,\r\n\t\t\t\twidth: 600,\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tnoOk: true,\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\t\"Agree\": function () {\r\n\t\t\t\t\t\t$('#customers_terms').prop(\"checked\", true).change();\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"Decline\": function () {\r\n\t\t\t\t\t\t$('#customers_terms').prop(\"checked\", false).change();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction dd_alert(msg)\r\n{\r\n\tdd_message({\r\n\t\ttitle: 'Alert',\r\n\t\tmessage: msg\r\n\t});\r\n}\r\n\r\nfunction formatAsMoney(mnt)\r\n{\r\n\tif (typeof mnt == 'undefined')\r\n\t{\r\n\t\tmnt = 0;\r\n\t}\r\n\r\n\tmnt -= 0;\r\n\tmnt = (Math.round(mnt * 100)) / 100;\r\n\treturn (mnt == Math.floor(mnt)) ? mnt + '.00'\r\n\t\t: ((mnt * 10 == Math.floor(mnt * 10)) ?\r\n\t\t\tmnt + '0' : mnt);\r\n}\r\n\r\nfunction get_todays_date()\r\n{\r\n\tvar today = new Date();\r\n\tvar dd = (\"0\" + today.getDate()).slice(-2);\r\n\tvar mm = ('0' + (today.getMonth() + 1)).slice(-2); //January is 0!\r\n\tvar yyyy = today.getFullYear();\r\n\r\n\treturn yyyy + '-' + mm + '-' + dd;\r\n}\r\n\r\nfunction cookieCheck()\r\n{\r\n\tvar hostAccess = getQueryVariable('host_url');\r\n\tvar overrideCookieCheck = false;\r\n\tif (hostAccess && hostAccess == 'http://support.dreamdinners.com')\r\n\t{\r\n\t\toverrideCookieCheck = true;\r\n\t}\r\n\r\n\t$.cookie('chkcookie', true, {domain: COOKIE.domain});\r\n\r\n\tif (!$.cookie('chkcookie') && !overrideCookieCheck)\r\n\t{\r\n\t\tdd_message({\r\n\t\t\ttitle: 'Alert',\r\n\t\t\tmessage: 'You have cookies turned off in your browser. Please check your settings, and enable cookies for this site in order to continue. Thank you.'\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction is_debug()\r\n{\r\n\tif (typeof DEBUG !== 'undefined' && DEBUG === true)\r\n\t{\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction dd_print()\r\n{\r\n\tif (is_debug())\r\n\t{\r\n\t\tdd_console_log('Debug: Print dialog called here.');\r\n\t}\r\n\telse\r\n\t{\r\n\t\twindow.print();\r\n\t}\r\n}\r\n\r\n///------------ phpjs functions ----------------------\r\nfunction nl2br(str, is_xhtml)\r\n{\r\n\t//  discuss at: http://phpjs.org/functions/nl2br/\r\n\t//   example 1: nl2br('Kevin\\nvan\\nZonneveld');\r\n\t//   returns 1: 'Kevin<br />\\nvan<br />\\nZonneveld'\r\n\t//   example 2: nl2br(\"\\nOne\\nTwo\\n\\nThree\\n\", false);\r\n\t//   returns 2: '<br>\\nOne<br>\\nTwo<br>\\n<br>\\nThree<br>\\n'\r\n\t//   example 3: nl2br(\"\\nOne\\nTwo\\n\\nThree\\n\", true);\r\n\t//   returns 3: '<br />\\nOne<br />\\nTwo<br />\\n<br />\\nThree<br />\\n'\r\n\r\n\tvar breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br ' + '/>' : '<br>'; // Adjust comment to avoid issue on phpjs.org display\r\n\r\n\treturn (str + '')\r\n\t\t.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + breakTag + '$2');\r\n}\r\n\r\nfunction strip_tags(input, allowed)\r\n{\r\n\t//  discuss at: http://phpjs.org/functions/strip_tags/\r\n\t//   example 1: strip_tags('<p>Kevin</p> <br /><b>van</b> <i>Zonneveld</i>', '<i><b>');\r\n\t//   returns 1: 'Kevin <b>van</b> <i>Zonneveld</i>'\r\n\t//   example 2: strip_tags('<p>Kevin <img src=\"someimage.png\" onmouseover=\"someFunction()\">van <i>Zonneveld</i></p>', '<p>');\r\n\t//   returns 2: '<p>Kevin van Zonneveld</p>'\r\n\t//   example 3: strip_tags(\"<a href='http://kevin.vanzonneveld.net'>Kevin van Zonneveld</a>\", \"<a>\");\r\n\t//   returns 3: \"<a href='http://kevin.vanzonneveld.net'>Kevin van Zonneveld</a>\"\r\n\t//   example 4: strip_tags('1 < 5 5 > 1');\r\n\t//   returns 4: '1 < 5 5 > 1'\r\n\t//   example 5: strip_tags('1 <br/> 1');\r\n\t//   returns 5: '1  1'\r\n\t//   example 6: strip_tags('1 <br/> 1', '<br>');\r\n\t//   returns 6: '1 <br/> 1'\r\n\t//   example 7: strip_tags('1 <br/> 1', '<br><br/>');\r\n\t//   returns 7: '1 <br/> 1'\r\n\r\n\tallowed = (((allowed || '') + '')\r\n\t\t.toLowerCase()\r\n\t\t.match(/<[a-z][a-z0-9]*>/g) || [])\r\n\t\t.join(''); // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)\r\n\tvar tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi,\r\n\t\tcommentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\r\n\treturn input.replace(commentsAndPhpTags, '')\r\n\t\t.replace(tags, function ($0, $1) {\r\n\t\t\treturn allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\r\n\t\t});\r\n}\r\n\r\n///------------ Dream Dinners JQuery Extensions ----------------------\r\n(function ($) {\r\n\r\n\t$.oauthpopup = function (onCloseCallBack) {\r\n\t\tif (!$(this).data('path'))\r\n\t\t{\r\n\t\t\tthrow new Error(\"data-path must not be empty\");\r\n\t\t}\r\n\r\n\t\tvar defaults = {\r\n\t\t\twindowName: 'ConnectWithOAuth',\r\n\t\t\twindowOptions: {\r\n\t\t\t\twidth: '800',\r\n\t\t\t\theight: '400',\r\n\t\t\t\tlocation: '0',\r\n\t\t\t\tstatus: '0'\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar options = {\r\n\t\t\twindowOptions: {\r\n\t\t\t\twidth: $(this).data('width'),\r\n\t\t\t\theight: $(this).data('height')\r\n\t\t\t},\r\n\t\t\tpath: $(this).data('path'),\r\n\t\t\tref_page: $(this).data('ref_page'),\r\n\t\t\treload_page: $(this).data('reload'),\r\n\t\t\tcallback: onCloseCallBack\r\n\t\t};\r\n\r\n\t\tvar settings = $.extend({}, defaults, options);\r\n\r\n\t\tvar dualScreenLeft = window.screenLeft != undefined ? window.screenLeft : window.screenX;\r\n\t\tvar dualScreenTop = window.screenTop != undefined ? window.screenTop : window.screenY;\r\n\r\n\t\tvar width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : screen.width;\r\n\t\tvar height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : screen.height;\r\n\r\n\t\tvar left = ((width / 2) - (settings.windowOptions.width / 2)) + dualScreenLeft;\r\n\t\tvar top = ((height / 2) - (settings.windowOptions.height / 2)) + dualScreenTop;\r\n\r\n\t\tvar windowConfig = 'location=' + settings.windowOptions.location + ', status=' + settings.windowOptions.status + ', width=' + settings.windowOptions.width + ', height=' + settings.windowOptions.height + ', top=' + top + ', left=' + left;\r\n\r\n\t\tvar openPath = settings.path;\r\n\r\n\t\tif (typeof settings.ref_page != 'undefined')\r\n\t\t{\r\n\t\t\topenPath += '&ref_page=' + settings.ref_page;\r\n\t\t}\r\n\r\n\t\tif (typeof settings.reload_page != 'undefined')\r\n\t\t{\r\n\t\t\topenPath += '&reload_page=' + settings.reload_page;\r\n\t\t}\r\n\r\n\t\tvar oauthWindow = window.open(openPath, settings.windowName, windowConfig);\r\n\r\n\t\tif (typeof settings.callback == 'function')\r\n\t\t{\r\n\r\n\t\t\t$.doTimeout('oauth_interval', 1000, function () {\r\n\r\n\t\t\t\tif (oauthWindow.closed)\r\n\t\t\t\t{\r\n\t\t\t\t\t$.doTimeout('oauth_interval');\r\n\t\t\t\t\tsettings.callback();\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t//bind to element and pop oauth when clicked\r\n\t$.fn.oauthpopup = function (options) {\r\n\t\t$this = $(this);\r\n\t\t$this.click($.oauthpopup.bind(this, options));\r\n\t};\r\n\r\n\t// highlight an elements background color temporarily to call attention to it\r\n\t$.fn.attention = function (set_color, set_duration) {\r\n\t\tif (set_color == undefined)\r\n\t\t{\r\n\t\t\tset_color = '#ffed8c';\r\n\t\t}\r\n\r\n\t\tif (set_duration == undefined)\r\n\t\t{\r\n\t\t\tset_duration = 2000;\r\n\t\t}\r\n\r\n\t\t$(this).stop().css('background-color', set_color).animate({backgroundColor: 'transparent'}, {duration: set_duration});\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t// center an element on the screen\r\n\t$.fn.center = function () {\r\n\t\tthis.css(\"position\", \"absolute\");\r\n\t\tthis.css(\"top\", Math.max(0, (($(window).height() - $(this).outerHeight()) / 2) + $(window).scrollTop()) + \"px\");\r\n\t\tthis.css(\"left\", Math.max(0, (($(window).width() - $(this).outerWidth()) / 2) + $(window).scrollLeft()) + \"px\");\r\n\t\treturn this;\r\n\t};\r\n\r\n\t// get value if not equal to placeholder, primarily for ie\r\n\t$.fn.getVal = function () {\r\n\t\tvar $this = $(this),\r\n\t\t\tval = $this.eq(0).val();\r\n\r\n\t\tif (val == $this.attr('placeholder'))\r\n\t\t{\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn val;\r\n\t\t}\r\n\t};\r\n\r\n\t$.fn.addSpinner = function (e) {\r\n\t\tif (this.hasClass('btn-spin') && this.find('.spinner-border').length === 0)\r\n\t\t{\r\n\t\t\t// bootstrap Spinner\r\n\t\t\tthis.append('<span class=\"spinner-border spinner-border-sm float-right mt-1\" role=\"status\" aria-hidden=\"true\"></span>');\r\n\t\t}\r\n\t\telse if (this.hasClass('btn-spinner') && !this.hasClass('btn-spinning'))\r\n\t\t{\r\n\t\t\t// DD spinner\r\n\t\t\tthis.addClass('btn-spinning').append('<div class=\"ld-spin\"></div>');\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.removeSpinner = function (e) {\r\n\t\t// remove DD spinner\r\n\t\tthis.removeClass('btn-spinning');\r\n\t\tthis.find('.ld-spin').remove();\r\n\t\t// remove Bootstrap\r\n\t\tthis.find('.spinner-border').remove();\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.hideFlex = function (e) {\r\n\t\tthis.addClass('collapse');\r\n\t\tthis.removeClass('show');\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.showFlex = function (e) {\r\n\t\tthis.addClass('collapse show');\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.toggleFlex = function (e) {\r\n\r\n\t\tif (this.is(':visible'))\r\n\t\t{\r\n\t\t\tthis.hideFlex(e)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.showFlex(e);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valDefault = function (value) {\r\n\r\n\t\tif (typeof value !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(value);\r\n\t\t}\r\n\t\telse if (typeof this[0].dataset.valdefault !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(function () {\r\n\t\t\t\treturn this.dataset.valdefault;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (typeof this[0].defaultValue !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(function () {\r\n\t\t\t\treturn this.defaultValue;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (this[0].type == 'select-one')\r\n\t\t{\r\n\t\t\tfor (var i = 0; i < this[0].options.length; i++)\r\n\t\t\t{\r\n\t\t\t\tif (this[0].options[i].defaultSelected == true)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis[0].selectedIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valCheckDiff = function (dataObj) {\r\n\r\n\t\t// no value, use input's value as the base value\r\n\t\tif (typeof dataObj === 'undefined' || typeof dataObj.value === 'undefined')\r\n\t\t{\r\n\t\t\tdataObj.value = this.value;\r\n\t\t}\r\n\r\n\t\tif (typeof dataObj.group === 'undefined')\r\n\t\t{\r\n\t\t\tdataObj.group = '_main';\r\n\t\t}\r\n\r\n\t\tthis.data({'checkdiff' : dataObj}).val(dataObj.value).on('change keyup', function (e) {\r\n\r\n\t\t\tlet diffData = {};\r\n\t\t\tlet dataObj = $(this).data().checkdiff;\r\n\r\n\t\t\tif (typeof $(document).data().checkdiff != 'undefined')\r\n\t\t\t{\r\n\t\t\t\tdiffData = $(document).data().checkdiff;\r\n\t\t\t}\r\n\r\n\t\t\tif ((dataObj.value != null && this.value != dataObj.value) || (this.value != '' && dataObj.value == null))\r\n\t\t\t{\r\n\t\t\t\tif (typeof diffData[dataObj.group] == 'undefined')\r\n\t\t\t\t{\r\n\t\t\t\t\tdiffData[dataObj.group] = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdiffData[dataObj.group][this.id] = dataObj;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// values are not different, remove from diff object\r\n\t\t\t\tdelete diffData[dataObj.group][this.id];\r\n\t\t\t}\r\n\r\n\t\t\t$(document).data({'checkdiff': diffData}).trigger('dd:checkdiff');\r\n\r\n\t\t});\r\n\r\n\t\treturn this;\r\n\t};\r\n\r\n\t$.fn.valCheckDiffRemove = function (value) {\r\n\r\n\t\tif (typeof value != 'undefined')\r\n\t\t{\r\n\t\t\tthis.val(value);\r\n\t\t}\r\n\r\n\t\tlet dataObj = $(this).data();\r\n\r\n\t\tif (typeof dataObj != 'undefined')\r\n\t\t{\r\n\t\t\tif (typeof dataObj.checkdiff != 'undefined')\r\n\t\t\t{\r\n\t\t\t\tthis.removeData('checkdiff').off('change keyup');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\t$.fn.validateForm = function () {\r\n\r\n\t\tlet form = $(this);\r\n\t\tlet validity = true;\r\n\r\n\t\tif (form.length)\r\n\t\t{\r\n\t\t\t// prevent spaces from validating form\r\n\t\t\t$(form).find('input, textarea').each(function (e) {\r\n\t\t\t\t$(this).val($(this).val().trim());\r\n\t\t\t});\r\n\r\n\t\t\tif ($(this).find(':submit').hasClass('btn-onclick-disable'))\r\n\t\t\t{\r\n\t\t\t\t$(this).find(':submit').addClass('disabled');\r\n\t\t\t}\r\n\r\n\t\t\t// handle checkbox groups\r\n\t\t\tlet checkbox_groups = [];\r\n\r\n\t\t\t// collect list of unique checkbox required groups\r\n\t\t\t$(form).find('[data-checkbox_group_required=\"true\"]').each(function (e) {\r\n\t\t\t\tlet group_name = $(this).data('checkbox_group');\r\n\t\t\t\tif (checkbox_groups[group_name] !== 'undefined')\r\n\t\t\t\t{\r\n\t\t\t\t\tcheckbox_groups.push(group_name);\r\n\t\t\t\t}\r\n\t\t\t\t// set them all to required\r\n\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').attr('required', true);\r\n\t\t\t});\r\n\r\n\t\t\t// check each group\r\n\t\t\t$.each(checkbox_groups, function (key, group_name) {\r\n\t\t\t\t// check each checkbox in group for validity\r\n\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').each(function () {\r\n\t\t\t\t\t// found a box that is checked\r\n\t\t\t\t\tif ($(this).is(':checked'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// one was checked, remove required\r\n\t\t\t\t\t\t$('[data-checkbox_group=\"' + group_name + '\"]').attr('required', false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t// end handle checkbox groups\r\n\r\n\t\t\t$(form).find('.form-feedback').hide();\r\n\r\n\t\t\tif (form['0'].checkValidity() === false)\r\n\t\t\t{\r\n\t\t\t\tvalidity = false;\r\n\r\n\t\t\t\tif ($(this).find(':submit').hasClass('btn-onclick-disable'))\r\n\t\t\t\t{\r\n\t\t\t\t\t$(this).find(':submit').removeClass('disabled');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('.btn-spinning').removeClass('btn-spinning');\r\n\t\t\t\t$('.ld-spin').remove();\r\n\r\n\t\t\t\t$(form).find('.form-feedback').show();\r\n\r\n\t\t\t\t$(form).data('was_submitted', false);\r\n\t\t\t}\r\n\r\n\t\t\tform['0'].classList.add('was-validated');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tconsole.log();\r\n\t\t}\r\n\r\n\t\treturn validity;\r\n\t};\r\n\r\n})(jQuery);\r\n\r\n// --------------------------------------------------------------------\r\n//\tPayFlow_Payload\r\n//  support for encoding custom data sent to PayFlow as a commnt\r\n// ---------------------------------------------------------------------\r\nfunction PayFlow_Payload()\r\n{\r\n\tthis.encodedString = \"\";\r\n}\r\n\r\nPayFlow_Payload.prototype = {\r\n\tconstructor: PayFlow_Payload,\r\n\taddNameValuePair: function (name, value) {\r\n\t\tvalue += \"\";\r\n\r\n\t\tvar cleanName = name.replace(\"+\", \"\");\r\n\t\tcleanName = cleanName.replace(\":\", \"\");\r\n\t\tvar cleanValue = value.replace(\"+\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\":\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"`\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"'\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"\\\"\", \"\");\r\n\t\tcleanValue = cleanValue.replace(\"&\", \"and\");\r\n\r\n\t\tif (this.encodedString == \"\")\r\n\t\t{\r\n\t\t\tthis.encodedString = cleanName + \":\" + cleanValue;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.encodedString += \"+\" + cleanName + \":\" + cleanValue;\r\n\t\t}\r\n\t},\r\n\taddAssocArray: function (name, arr) {\r\n\t\tvar cleanName = name.replace(\"+\", \"\");\r\n\t\tcleanName = cleanName.replace(\":\", \"\");\r\n\r\n\t\tarrString = \"\";\r\n\r\n\t\tfor (var value in arr)\r\n\t\t{\r\n\t\t\tif (arr[value])\r\n\t\t\t{\r\n\t\t\t\tvar cleanValue = arr[value].replace(\"+\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\":\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"|\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"~\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"`\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"'\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"\\\"\", \"\");\r\n\t\t\t\tcleanValue = cleanValue.replace(\"&\", \"and\");\r\n\r\n\t\t\t\tvar cleanPropName = value.replace(\"+\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\":\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\"|\", \"\");\r\n\t\t\t\tcleanPropName = cleanPropName.replace(\"~\", \"\");\r\n\r\n\t\t\t\tif (arrString == \"\")\r\n\t\t\t\t{\r\n\t\t\t\t\tarrString = cleanPropName + \"~\" + cleanValue;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tarrString += \"|\" + cleanPropName + \"~\" + cleanValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.encodedString == \"\")\r\n\t\t{\r\n\t\t\tthis.encodedString = cleanName + \":\" + arrString;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.encodedString += \"+\" + cleanName + \":\" + arrString;\r\n\t\t}\r\n\t},\r\n\tretrieveEncodedString: function () {\r\n\r\n\t\treturn this.encodedString;\r\n\r\n\t}\r\n};\r\n\r\n/* handle Bootstrap form validation */\r\n$(document).on('submit', '.needs-validation', function (e) {\r\n\r\n\tif ($(this).validateForm() !== true)\r\n\t{\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n});\r\n\r\n/* Handle Bootstrap Tabbed Content */\r\n$('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\r\n\te.target; // newly activated tab\r\n\te.relatedTarget; // previous active tab\r\n\r\n\t// html5 update url history\r\n\tif ($(e.target).data('urlpush') !== undefined && $(e.target).data('urlpush') === true)\r\n\t{\r\n\t\tif ($(e.target).data('target') !== undefined)\r\n\t\t{\r\n\t\t\tvar target = $(e.target).data('target');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar target = $(e.target).attr('href');\r\n\t\t}\r\n\r\n\t\tvar tabid = $(target).attr('id');\r\n\r\n\t\tnew_query_string = setQueryString('tab', tabid);\r\n\t\thistoryPush({url: new_query_string});\r\n\t}\r\n});\r\n\r\nfunction isIE()\r\n{\r\n\tvar ua = window.navigator.userAgent; //Check the userAgent property of the window.navigator object\r\n\tvar msie = ua.indexOf('MSIE '); // IE 10 or older\r\n\tvar trident = ua.indexOf('Trident/'); //IE 11\r\n\r\n\treturn (msie > 0 || trident > 0);\r\n}\r\n\r\nfunction isSafari()\r\n{\r\n\tvar isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n\r\n\treturn isSafari;\r\n}\r\n\r\n$(document).ajaxSuccess(function (event, xhr, settings) {\r\n\r\n\t$('.telephone:not(.no-tel), [type=\"tel\"]:not(.no-tel)').each(function (index) {\r\n\t\tnew Cleave(this, {\r\n\t\t\tdelimiters: [\r\n\t\t\t\t'-',\r\n\t\t\t\t'-',\r\n\t\t\t\t'-'\r\n\t\t\t],\r\n\t\t\tblocks: [\r\n\t\t\t\t3,\r\n\t\t\t\t3,\r\n\t\t\t\t4\r\n\t\t\t]\r\n\t\t});\r\n\t});\r\n\r\n\t// inside try to attempt to decode response as json\r\n\ttry\r\n\t{\r\n\t\t// decode the response as json\r\n\t\tvar obj = $.parseJSON(xhr.responseText);\r\n\r\n\t\t// if the json contains toasts, pop them up\r\n\t\tif (obj.dd_toasts)\r\n\t\t{\r\n\t\t\tfetchToasts(obj)\r\n\t\t}\r\n\r\n\t\t// updated user preferences\r\n\t\tif (obj.user_preferences)\r\n\t\t{\r\n\t\t\tUSER_PREFERENCES = obj.user_preferences;\r\n\t\t}\r\n\r\n\t\t// updated guest preferences\r\n\t\tif (obj.guest_preferences)\r\n\t\t{\r\n\t\t\tGUEST_PREFERENCES = $.extend(GUEST_PREFERENCES, obj.guest_preferences);\r\n\t\t}\r\n\r\n\t\t// bounce\r\n\t\tif (obj.bounce_to)\r\n\t\t{\r\n\t\t\tbounce(obj.bounce_to);\r\n\t\t}\r\n\t}\r\n\tcatch (e)\r\n\t{\r\n\t\t// not json\r\n\t}\r\n\r\n});\r\n\r\n// Click handler for terms and conditions\r\n$(document).on('click', '#tc_popup-cart', function (e) {\r\n\tshowTermsAndConditions($(this));\r\n\te.preventDefault();\r\n});\r\n\r\n// handle setToastMsg\r\nif ($.cookie('toastMsg'))\r\n{\r\n\tvar messages = $.parseJSON($.cookie('toastMsg'));\r\n\r\n\tvar time = 0;\r\n\r\n\t$.each(messages, function (key, toastArray) {\r\n\r\n\t\t// do a short delay so they don't all show up at once.\r\n\t\t$.doTimeout(time, function () {\r\n\t\t\tdd_toast(toastArray);\r\n\t\t});\r\n\r\n\t\ttime += 500; // .5 seconds, time between toasts for a response containing multiple toasts\r\n\r\n\t});\r\n\r\n\t$.removeCookie('toastMsg', {domain: COOKIE.domain});\r\n}\r\n\r\n// load bootstrap tooltips\r\n//$('[data-toggle=\"tooltip\"]').tooltip();\r\n$(document).tooltip({selector: '[data-toggle=\"tooltip\"]'});\r\n\r\n// handle analytics click\r\n$('[data-gaq_cat]').each(function () {\r\n\t$(this).on('click', function () {\r\n\r\n\t\tif (typeof _gaq != 'undefined')\r\n\t\t{\r\n\t\t\tgaq_cat = $(this).data('gaq_cat');\r\n\t\t\tgaq_action = $(this).data('gaq_action');\r\n\t\t\tgaq_label = $(this).data('gaq_label');\r\n\r\n\t\t\t_gaq.push([\r\n\t\t\t\t'_trackEvent',\r\n\t\t\t\tgaq_cat,\r\n\t\t\t\tgaq_action,\r\n\t\t\t\tgaq_label\r\n\t\t\t]);\r\n\t\t}\r\n\t});\r\n});\r\n\r\n$('[data-background-image]').each(function () {\r\n\tvar bg_image = $(this).data('background-image');\r\n\t$(this).css('background-image', 'url(' + bg_image + ')');\r\n});\r\n\r\n// Click handler for clear cart\r\n$(document).on('click', '.clear-cart, .clear-cart-gc', function (e) {\r\n\r\n\tvar category = 'all';\r\n\tif (window.location.href.indexOf('gift_card_cart') != -1)\r\n\t{\r\n\t\tcategory = 'giftcard';\r\n\t}\r\n\r\n\t$.ajax({\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\top: 'get_clear_form',\r\n\t\t\toutput: 'json'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Clear your Cart',\r\n\t\t\t\tmessage: json.html,\r\n\t\t\t\theight: 300,\r\n\t\t\t\twidth: 300,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\t\t\t\top: 'do_clear',\r\n\t\t\t\t\t\t\tclear_items: category,\r\n\t\t\t\t\t\t\toutput: 'json'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json) {\r\n\t\t\t\t\t\t\t// salesforce clear cart\r\n\t\t\t\t\t\t\tif (typeof _etmc !== 'undefined')\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t_etmc.push([\r\n\t\t\t\t\t\t\t\t\t\"trackCart\",\r\n\t\t\t\t\t\t\t\t\t{\"clear_cart\": true}\r\n\t\t\t\t\t\t\t\t]);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// reload page\r\n\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\tresponse = 'Unexpected error';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcancel: function () {\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n\r\n//Freshworks help widget - responsive view control\r\n$(document).ready(function() {\r\n\tif(window.innerWidth <= 1000)\r\n\t{\r\n\t\tFreshworksWidget('hide', 'launcher');\r\n\t}\r\n});\r\n\r\nwindow.onresize = function() {\r\n\tif(typeof FreshworksWidget !== 'undefined'){\r\n\t\tif(window.innerWidth <= 1000)\r\n\t\t{\r\n\t\t\tFreshworksWidget('hide', 'launcher');\r\n\t\t}else{\r\n\t\t\tFreshworksWidget('show', 'launcher');\r\n\t\t}\r\n\t}\r\n};\r\n\r\n$(document).on('click', '.help-search-launcher', function (event) {\r\n\tevent.preventDefault();\r\n\tFreshworksWidget('open');\r\n});\r\n\r\n\r\n$(document).on('click', '.clear-edit-delivered-order', function (e) {\r\n\r\n\t$.ajax({\r\n\r\n\t\turl: 'ddproc.php',\r\n\t\ttype: 'POST',\r\n\t\ttimeout: 20000,\r\n\t\tdataType: 'json',\r\n\t\tdata: {\r\n\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\top: 'get_clear_form',\r\n\t\t\toutput: 'json'\r\n\t\t},\r\n\t\tsuccess: function (json) {\r\n\t\t\tdd_message({\r\n\t\t\t\ttitle: 'Clear Cart',\r\n\t\t\t\tmessage: 'Are you sure you want to stop editing this Delivered order?',\r\n\t\t\t\theight: 300,\r\n\t\t\t\twidth: 300,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tconfirm: function () {\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: 'ddproc.php',\r\n\t\t\t\t\t\ttype: 'POST',\r\n\t\t\t\t\t\ttimeout: 20000,\r\n\t\t\t\t\t\tdataType: 'json',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tprocessor: 'cart_clear_category',\r\n\t\t\t\t\t\t\top: 'do_clear',\r\n\t\t\t\t\t\t\tclear_items: 'all',\r\n\t\t\t\t\t\t\tclear_edit_order: 'all',\r\n\t\t\t\t\t\t\toutput: 'json'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function (json) {\r\n\r\n\t\t\t\t\t\t\t// reload page\r\n\t\t\t\t\t\t\twindow.location = '/main.php?page=my_meals&tab=nav-past_orders';\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\t\t\t\t\tconsole.log('Unexpected error');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcancel: function () {\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\terror: function (objAJAXRequest, strError) {\r\n\t\t\tresponse = 'Unexpected error';\r\n\t\t}\r\n\t});\r\n});\r\n\r\n// Handle textarea maxlength\r\n$(document).on('keyup', 'textarea[maxlength]', function (e) {\r\n\r\n\t//get the limit from maxlength attribute\r\n\tvar limit = parseInt($(this).attr('maxlength'));\r\n\t//get the current text inside the textarea\r\n\tvar text = $(this).val();\r\n\t//count the number of characters in the text\r\n\tvar chars = text.length;\r\n\r\n\t//check if there are more characters then allowed\r\n\tif (chars > limit)\r\n\t{\r\n\t\t//and if there are use substr to get the text before the limit\r\n\t\tvar new_text = text.substr(0, limit);\r\n\r\n\t\t//and change the current text with the new text\r\n\t\t$(this).val(new_text);\r\n\t}\r\n});\r\n\r\n// handle btn spinner\r\n$(document).on('click', '.btn-spinner:not(.disabled), .btn-spin:not(.disabled)', function (e) {\r\n\t$(this).addSpinner();\r\n});\r\n\r\n// handle masks\r\n$('.telephone:not(.no-tel), [type=\"tel\"]:not(.no-tel)').each(function (index) {\r\n\tnew Cleave(this, {\r\n\t\tdelimiters: [\r\n\t\t\t'-',\r\n\t\t\t'-',\r\n\t\t\t'-'\r\n\t\t],\r\n\t\tblocks: [\r\n\t\t\t3,\r\n\t\t\t3,\r\n\t\t\t4\r\n\t\t]\r\n\t});\r\n});\r\n\r\n// nutritionals menu dropdown\r\n$(document).on('change', '#menus_dropdown', function (e) {\r\n\tbounce('main.php?page=nutritionals&menu=' + this.value);\r\n});\r\n\r\n// platepoints enroll\r\n$(document).on('click change', '#enroll_in_plate_points', function (e) {\r\n\tset_req = false;\r\n\tif ($(this).is(\":checked\"))\r\n\t{\r\n\t\tset_req = true;\r\n\t}\r\n\t$('#referral_source, #gender, #birthday_month, #birthday_year, #number_of_kids, #desired_homemade_meals_per_week, #number_feeding,  #number_of_adults, #contribute_income, #use_lists, #number_monthly_dine_outs').attr('required', set_req);\r\n\t$('#prefer_daytime_sessions, #prefer_evening_sessions, #prefer_weekend_sessions').attr({\r\n\t\t'data-checkbox_group_required': set_req,\r\n\t\t'required': set_req\r\n\t});\r\n});\r\n\r\n// handle share event\r\n$('[data-share-social]').each(function () {\r\n\r\n\tvar title = $(this).data('share-title');\r\n\tvar text = $(this).data('share-text');\r\n\tvar url = $(this).data('share-url');\r\n\r\n\tvar services = $(this).data('share-social').split(\",\");\r\n\r\n\tvar dropdown_menu = $('<div></div>').addClass('dropdown-menu');\r\n\r\n\t$(services).each(function (key, service) {\r\n\r\n\t\tif (service == 'facebook')\r\n\t\t{\r\n\t\t\t$(dropdown_menu).append('<a class=\"dropdown-item nav-link facebook-share\" data-share-url=\"' + url + '\" href=\"#\"><i class=\"dd-icon icon-facebook mr-2\"></i> Facebook</a>');\r\n\t\t}\r\n\r\n\t\tif (service == 'twitter')\r\n\t\t{\r\n\t\t\t$(dropdown_menu).append('<a class=\"dropdown-item nav-link\" target=\"_blank\" href=\"https://twitter.com/intent/tweet?via=DreamDinners&&hashtags=TheOriginalMealKit&text=' + text + '&url=' + url + '\"><i class=\"dd-icon icon-twitter mr-2\"></i> Twitter</a>');\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (navigator.share)\r\n\t{\r\n\t\tlet moreOpts = $('<a href=\"#\" class=\"dropdown-item nav-link\"><i class=\"dd-icon icon-share2 mr-2\"></i> More Options</a>').on('click', function (e) {\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tnavigator.share({\r\n\t\t\t\ttitle: title,\r\n\t\t\t\ttext: text,\r\n\t\t\t\turl: url\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(dropdown_menu).append(moreOpts);\r\n\t}\r\n\r\n\t$(this).attr({\r\n\t\t'data-toggle': 'dropdown',\r\n\t\t'aria-haspopup': 'true',\r\n\t\t'aria-expanded': 'false'\r\n\t})\r\n\t\t.wrap('<div></div>')\r\n\t\t.addClass('dropdown')\r\n\t\t.after(dropdown_menu);\r\n\r\n});\r\n\r\n/*\r\n$(document).on('click', '.start-intro-offer', function (e) {\r\n\r\n\te.preventDefault();\r\n\r\n\t$.cookie('dd_start_intro', true);\r\n\r\n\tcreate_and_submit_form({\r\n\t\taction: 'ddproc.php?processor=session_type',\r\n\t\tinput: ({\r\n\t\t\ttype: 'starter'\r\n\t\t})\r\n\t});\r\n\r\n});\r\n*/\r\n\r\n$(document).on('click', '[data-start-delivered-order]', function (e) {\r\n\r\n\te.preventDefault();\r\n\r\n\tlet start_delivered_zip = this.getAttribute('data-start-delivered-order');\r\n\r\n\tcreate_and_submit_form({\r\n\t\taction: 'main.php?page=box_select',\r\n\t\tinput: ({\r\n\t\t\tdelivered_zip: start_delivered_zip\r\n\t\t})\r\n\t});\r\n\r\n});\r\n\r\n$(document).on('click', '.btn-click-add-cart', function (e) {\r\n\r\n\t$('.btn-click-add-cart').find('.fa-shopping-cart').remove();\r\n\r\n\t$(this).append('<i class=\"fas fa-shopping-cart float-left text-green-dark-extra pt-1\"></i>');\r\n\r\n});\r\n\r\n$(document).on('click', '[data-click_id]', function (e) {\r\n\r\n\tlet click_id = $(this).data('click_id');\r\n\r\n\t$('#' + click_id).trigger('click');\r\n\r\n\tif (typeof $('#' + click_id).attr('href') !== 'undefined')\r\n\t{\r\n\t\twindow.location.href = $('#' + click_id).attr('href');\r\n\t}\r\n\r\n});\r\n\r\n// handle platepoints enroll\r\nif (getQueryVariable('pp_enroll'))\r\n{\r\n\t$('#enroll_in_plate_points').attr('checked', true).trigger('change');\r\n}\r\n\r\n// handle tab selection\r\nif (getQueryVariable('tab'))\r\n{\r\n\tvar tabid = getQueryVariable('tab');\r\n\r\n\t$('#' + tabid + '-tab').tab('show');\r\n}\r\n\r\n// footer nav\r\nif ($('.footer-nav').length)\r\n{\r\n\t$('.footer-nav').scrollToFixed({\r\n\t\tbottom: 0,\r\n\t\tlimit: $('.footer-nav').offset().top\r\n\t});\r\n}\r\n\r\n// sidenav\r\n$('#main-sidenav').on('hide.bs.collapse', function () {\r\n\t$('body').removeClass('modal-open');\r\n\t$('.sidenav-modal').removeClass('show');\r\n\r\n\t$.doTimeout(500, function () {\r\n\t\t$('.sidenav-modal').remove();\r\n\t});\r\n\r\n});\r\n\r\n$('#main-sidenav').on('show.bs.collapse', function () {\r\n\t$('body').addClass('modal-open').append($('<div class=\"sidenav-modal modal-backdrop fade\"></div>'));\r\n\t$('.sidenav-modal').tab('show');\r\n});\r\n\r\n$(document).on('click', '.sidenav-modal', function (e) {\r\n\t$('#main-sidenav').collapse('toggle');\r\n});\r\n\r\n$(document).on('keyup change', '.dd-strip-tags', function (e) {\r\n\r\n\tvar allowed;\r\n\r\n\tif ($(this).data('allowed-tags'))\r\n\t{\r\n\t\tallowed = $(this).data('allowed-tags');\r\n\t}\r\n\r\n\tif ($(this).val() != strip_tags($(this).val(), allowed))\r\n\t{\r\n\t\t$(this).val(strip_tags($(this).val(), allowed));\r\n\t}\r\n\r\n});\r\n\r\n// On error, show dd_console_log\r\n$(document).ajaxError(function (event, jqxhr, settings, exception) {\r\n\tAJAX_IN_PROCESS = false;\r\n\tdd_console_log('Ajax Error: ' + jqxhr.statusText);\r\n\t//dd_message({ title: 'Ajax Error', message: request.statusText });\r\n});\r\n\r\n// userpreferences\r\nif (typeof USER_PREFERENCES === 'string')\r\n{\r\n\tUSER_PREFERENCES = $.parseJSON(USER_PREFERENCES);\r\n}\r\n\r\n// handle checkboxes\r\n$(document).on('click', '[data-user_pref][type=checkbox]', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\tvar value = $(this).is(':checked');\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).is(':checked'));\r\n\t}\r\n\r\n\tif (value && $(this).data('user_pref_value_check'))\r\n\t{\r\n\t\tvalue = $(this).data('user_pref_value_check');\r\n\t}\r\n\telse if (!value && $(this).data('user_pref_value_uncheck'))\r\n\t{\r\n\t\tvalue = $(this).data('user_pref_value_uncheck');\r\n\t}\r\n\r\n\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\tpreferenceChangeListener($(this).data('user_pref'), value, user_id, function (json) {\r\n\r\n\t\t\tif (!json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t$(this).prop('checked', $(pref_elem).data('user_pref_orig'));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(this).data('user_pref_orig', $(pref_elem).is(':checked'));\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}else{\r\n\t\tset_user_pref($(this).data('user_pref'), value, user_id, function (json) {\r\n\r\n\t\t\tif (!json.processor_success)\r\n\t\t\t{\r\n\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t$(this).prop('checked', $(pref_elem).data('user_pref_orig'));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t$(this).data('user_pref_orig', $(pref_elem).is(':checked'));\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n});\r\n\r\n// handle dropdown select\r\n$(document).on('change', '[data-user_pref]select', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tset_user_pref($(this).data('user_pref'), $(this).val(), user_id, function (json) {\r\n\r\n\t\tif (!json.processor_success)\r\n\t\t{\r\n\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t}\r\n\r\n\t});\r\n\r\n});\r\n\r\n\r\n// handle input\r\n$(document).on('focus', '[data-user_pref]input[type=text]', function (e) {\r\n\r\n\tif($(this).attr('type') == 'checkbox' ){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\t$(this).on('keyup', function (e) {\r\n\r\n\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t{\r\n\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tif (!$('#' + $(this).data('user_pref') + '_buttons').length)\r\n\t{\r\n\t\tvar buttons = $('<div />').attr('id', $(this).data('user_pref') + '_buttons').addClass('text-left collapse');\r\n\r\n\t\t$(this).after(buttons);\r\n\r\n\t\tvar save_button = $('<span />').addClass('btn btn-sm btn-primary mr-2 mt-2').text('Save').on('click', function (e) {\r\n\r\n\t\t\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\t\t\tpreferenceChangeListener($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tset_user_pref($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t\tvar cancel_button = $('<span />').addClass('btn btn-sm btn-primary mt-2').text('Cancel').on('click', function (e) {\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\r\n\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\tvar spacer = $('<span />').addClass(' mt-2');\r\n\r\n\t\t$(buttons).prepend(cancel_button).prepend(save_button).prepend(spacer).slideDown();\r\n\r\n\t}\r\n\r\n});\r\n\r\n// handle textarea\r\n$(document).on('focus', '[data-user_pref]textarea', function (e) {\r\n\r\n\tvar pref_elem = this;\r\n\tvar user_id = 0;\r\n\r\n\tif ($(this).data('user_id'))\r\n\t{\r\n\t\tuser_id = $(this).data('user_id');\r\n\t}\r\n\r\n\t$(this).on('keyup', function (e) {\r\n\r\n\t\tif ($(this).val() != strip_tags($(this).val()))\r\n\t\t{\r\n\t\t\t$(this).val(strip_tags($(this).val()));\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tif (!$(this).data('user_pref_orig'))\r\n\t{\r\n\t\t$(this).data('user_pref_orig', $(this).val());\r\n\t}\r\n\r\n\tif (!$('#' + $(this).data('user_pref') + '_buttons').length)\r\n\t{\r\n\t\tvar buttons = $('<div />').attr('id', $(this).data('user_pref') + '_buttons').addClass('text-right collapse');\r\n\r\n\t\t$(this).after(buttons);\r\n\r\n\t\tvar save_button = $('<span />').addClass('btn btn-sm btn-primary mr-2 mt-2').text('Save').on('click', function (e) {\r\n\r\n\t\t\tif( typeof preferenceChangeListener === \"function\"){\r\n\t\t\t\tpreferenceChangeListener($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tset_user_pref($(pref_elem).data('user_pref'), $(pref_elem).val(), user_id, function (json) {\r\n\t\t\t\t\tif (!json.processor_success)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdd_message({message: json.processor_message});\r\n\r\n\t\t\t\t\t\t$(pref_elem).val($(this).data('user_pref_orig'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$(pref_elem).data('user_pref_orig', $(pref_elem).val());\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t\tvar cancel_button = $('<span />').addClass('btn btn-sm btn-primary mt-2').text('Cancel').on('click', function (e) {\r\n\r\n\t\t\t$(pref_elem).val($(pref_elem).data('user_pref_orig'));\r\n\r\n\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').slideUp(function (e) {\r\n\r\n\t\t\t\t$('#' + $(pref_elem).data('user_pref') + '_buttons').remove();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(buttons).prepend(cancel_button).prepend(save_button).slideDown();\r\n\r\n\t}\r\n\r\n});\r\n\r\n// handle thaw reminder\r\n$(document).on('click', '[data-user_pref=\"text_message_thaw_primary\"][type=checkbox]', function (e) {\r\n\r\n\t// var user_id = 0;\r\n\t// var value = $(this).is(':checked');\r\n\t//\r\n\t// if ($(this).data('user_id'))\r\n\t// {\r\n\t// \tuser_id = $(this).data('user_id');\r\n\t// }\r\n\t//\r\n\t// $.ajax({\r\n\t// \turl: 'ddproc.php',\r\n\t// \ttype: 'POST',\r\n\t// \ttimeout: 20000,\r\n\t// \tdataType: 'json',\r\n\t// \tdata: {\r\n\t// \t\tprocessor: 'account',\r\n\t// \t\top: 'optin',\r\n\t// \t\ttype: 'thaw',\r\n\t// \t\tphone: 'primary',\r\n\t// \t\tuser_id: user_id,\r\n\t// \t\tvalue: value.toString()\r\n\t// \t},\r\n\t// \tsuccess: function (json, status) {\r\n\t//\r\n\t// \t},\r\n\t// \terror: function (objAJAXRequest, strError) {\r\n\t// \t\tresponse = 'Unexpected error';\r\n\t// \t}\r\n\t// });\r\n\r\n});\r\n\r\n$(function() {\r\n\t// clipboard\r\n\tif (typeof ClipboardJS !== 'undefined')\r\n\t{\r\n\t\tlet clipboard = new ClipboardJS('.btn-clip');\r\n\t}\r\n});"],"names":["AJAX_IN_PROCESS","GUEST_PREFERENCES","lang","en","dd","dream_dinners","tc","terms_and_conditions","delayed_payment","delayed_payment_decline","set_user_pref","pref","setting","user_id","callBack","toUpperCase","let","pref_value","USER_PREFERENCES","value","$","isPlainObject","JSON","stringify","extend","toString","ajax","url","type","timeout","dataType","data","processor","op","key","success","json","status","response","error","objAJAXRequest","strError","get_user_pref","select_location_click_handler","document","on","e","config","store_id","order_type","this","id","indexOf","split","setStoreAndBeginOrder","preventDefault","bounce","location","target","window","open","href","back_path","encodeURIComponent","pathname","substring","search","incrementVal","incrementBy","parseInt","isNaN","toggleId","slideToggle","setQueryString","variable","query","vars","var_found","new_query","i","length","pair","getQueryVariable","decodeURI","removeQueryVariable","sourceURL","rtn","param","params_arr","queryString","splice","join","mailHideOnSubmit","token","getElementById","submit","historyPush","history","pushState","title","showPopup","settings","height","width","modal","resizable","module","message","dd_message","create_and_submit_form","method","form","attr","action","property","input","name","appendTo","body","append","remove","show","store","showMap","address","confirmNavigate","goUrl","confirm","dd_console_log","is_debug","console","log","address_location","latlong","getLocation","geolocation","geocoder","google","maps","Geocoder","geoparams","undefined","trim","latLng","latlng","componentRestrictions","postalCode","lat","parseFloat","lng","LatLng","coords","latitude","longitude","geocode","results","GeocoderStatus","OK","onError","code","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","UNKNOWN_ERROR","navigator","getCurrentPosition","dd_toast","animation","autohide","delay","css_header","html","toast","fetchToasts","dd_toasts","time","each","doTimeout","size","buttons","label","className","callback","cancel","bootbox","dialog","alert","showTermsAndConditions","jobject","tandc_url","noOk","Agree","prop","change","Decline","dd_alert","msg","formatAsMoney","mnt","Math","round","floor","get_todays_date","today","Date","getDate","slice","mm","getMonth","yyyy","getFullYear","cookieCheck","hostAccess","overrideCookieCheck","cookie","domain","COOKIE","DEBUG","dd_print","print","nl2br","str","is_xhtml","breakTag","replace","strip_tags","allowed","toLowerCase","match","tags","commentsAndPhpTags","$0","$1","oauthpopup","onCloseCallBack","Error","defaults","windowName","windowOptions","options","path","ref_page","reload_page","dualScreenLeft","screenLeft","screenX","dualScreenTop","screenTop","screenY","innerWidth","documentElement","clientWidth","screen","innerHeight","clientHeight","left","top","windowConfig","openPath","oauthWindow","closed","fn","$this","click","bind","attention","set_color","set_duration","stop","css","animate","backgroundColor","duration","center","max","outerHeight","scrollTop","outerWidth","scrollLeft","getVal","val","eq","addSpinner","hasClass","find","addClass","removeSpinner","removeClass","hideFlex","showFlex","toggleFlex","is","valDefault","dataset","valdefault","defaultValue","defaultSelected","selectedIndex","valCheckDiff","dataObj","group","checkdiff","diffData","trigger","valCheckDiffRemove","removeData","off","validateForm","validity","checkbox_groups","group_name","push","hide","checkValidity","classList","add","jQuery","PayFlow_Payload","encodedString","prototype","constructor","addNameValuePair","cleanName","cleanValue","addAssocArray","arr","arrString","cleanPropName","retrieveEncodedString","stopPropagation","relatedTarget","tabid","new_query_string","isIE","ua","userAgent","msie","trident","isSafari","test","ajaxSuccess","event","xhr","index","Cleave","delimiters","blocks","obj","parseJSON","responseText","user_preferences","guest_preferences","bounce_to","messages","toastArray","removeCookie","tooltip","selector","_gaq","gaq_cat","gaq_action","gaq_label","bg_image","category","output","clear_items","_etmc","clear_cart","reload","ready","FreshworksWidget","onresize","clear_edit_order","limit","text","chars","new_text","substr","set_req","data-checkbox_group_required","required","services","dropdown_menu","service","share","moreOpts","data-toggle","aria-haspopup","aria-expanded","wrap","after","start_delivered_zip","getAttribute","delivered_zip","click_id","tab","scrollToFixed","bottom","offset","collapse","ajaxError","jqxhr","exception","statusText","pref_elem","preferenceChangeListener","processor_success","processor_message","save_button","slideUp","cancel_button","spacer","prepend","slideDown","ClipboardJS","clipboard"],"mappings":"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"}